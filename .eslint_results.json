[
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\app.d.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\demo.spec.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\do-worker.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\env.d.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\global.d.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\hooks.server.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\index.js",
		"messages": [],
		"suppressedMessages": [
			{
				"ruleId": "@typescript-eslint/ban-ts-comment",
				"severity": 2,
				"message": "Do not use \"@ts-nocheck\" because it alters compilation errors.",
				"line": 2,
				"column": 1,
				"nodeType": "Line",
				"messageId": "tsDirectiveComment",
				"endLine": 2,
				"endColumn": 15,
				"suppressions": [{ "kind": "directive", "justification": "" }]
			}
		],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\actions\\swipe.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\components\\AsyncErrorBoundary.svelte",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\components\\ErrorBoundary.svelte",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\components\\Loading.svelte",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\components\\PWAInstall.svelte",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\components\\SyncIndicator.svelte",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\components\\TripCard.spec.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\components\\TripSkeleton.svelte",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\components\\data\\ExportView.svelte",
		"messages": [
			{
				"ruleId": "svelte/no-navigation-without-resolve",
				"severity": 1,
				"message": "Unexpected href link without resolve().",
				"line": 427,
				"column": 11,
				"nodeType": null,
				"messageId": "linkWithoutResolve",
				"endLine": 427,
				"endColumn": 30
			}
		],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 1,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"source": "<script lang=\"ts\">\n\timport { trips } from '$lib/stores/trips';\n\timport { expenses } from '$lib/stores/expenses';\n\timport { currentUser } from '$lib/stores/currentUser';\n\timport Modal from '$lib/components/ui/Modal.svelte';\n\timport Button from '$lib/components/ui/Button.svelte';\n\n\timport { SvelteSet, SvelteDate } from '$lib/utils/svelte-reactivity';\n\n\tlet exportFormat = 'csv';\n\tlet exportDataType = 'trips'; // 'trips' | 'expenses' | 'tax_bundle'\n\tlet dateFrom = '';\n\tlet dateTo = '';\n\tlet selectedTrips = new SvelteSet<string>();\n\tlet selectedExpenses = new SvelteSet<string>();\n\tlet selectAll = false;\n\tlet isUpgradeModalOpen = false;\n\n\t// Reactive filter logic for Trips\n\t$: filteredTrips = $trips.filter((trip) => {\n\t\tif (!trip.date) return false;\n\t\tconst tripDate = SvelteDate.from(trip.date).startOfDay();\n\t\tif (dateFrom && tripDate.getTime() < SvelteDate.from(dateFrom).startOfDay().getTime())\n\t\t\treturn false;\n\t\tif (dateTo && tripDate.getTime() > SvelteDate.from(dateTo).startOfDay().getTime()) return false;\n\t\treturn true;\n\t});\n\n\t// Reactive filter logic for Expenses\n\t$: filteredExpenses = $expenses.filter((expense) => {\n\t\tconst dStr = expense.date || expense.createdAt;\n\t\tif (!dStr) return false;\n\t\tconst expenseDate = SvelteDate.from(dStr).startOfDay();\n\t\tif (dateFrom && expenseDate.getTime() < SvelteDate.from(dateFrom).startOfDay().getTime())\n\t\t\treturn false;\n\t\tif (dateTo && expenseDate.getTime() > SvelteDate.from(dateTo).startOfDay().getTime())\n\t\t\treturn false;\n\t\treturn true;\n\t});\n\n\t// Reactive selection logic\n\t$: if (selectAll) {\n\t\tif (exportDataType === 'trips') {\n\t\t\tselectedTrips = new SvelteSet(filteredTrips.map((t) => t.id));\n\t\t} else if (exportDataType === 'expenses') {\n\t\t\tselectedExpenses = new SvelteSet(filteredExpenses.map((e) => e.id));\n\t\t}\n\t} else {\n\t\t// Auto-check selectAll status based on individual selections\n\t\tif (exportDataType === 'trips') {\n\t\t\tif (selectedTrips.size === filteredTrips.length && filteredTrips.length > 0) selectAll = true;\n\t\t} else if (exportDataType === 'expenses') {\n\t\t\tif (selectedExpenses.size === filteredExpenses.length && filteredExpenses.length > 0)\n\t\t\t\tselectAll = true;\n\t\t}\n\t}\n\n\t// Auto-select everything for Tax Bundle\n\t$: if (exportDataType === 'tax_bundle') {\n\t\tselectAll = true;\n\t\tselectedTrips = new SvelteSet(filteredTrips.map((t) => t.id));\n\t\tselectedExpenses = new SvelteSet(filteredExpenses.map((e) => e.id));\n\t}\n\n\t// Check Pro Status\n\t$: isPro = ['pro', 'business', 'premium', 'enterprise'].includes(\n\t\t($currentUser?.plan ?? '') as string\n\t);\n\n\tfunction toggleSelectAll() {\n\t\tif (selectAll) {\n\t\t\tselectedTrips = new SvelteSet();\n\t\t\tselectedExpenses = new SvelteSet();\n\t\t} else {\n\t\t\tselectedTrips = new SvelteSet(filteredTrips.map((t) => t.id));\n\t\t\tselectedExpenses = new SvelteSet(filteredExpenses.map((e) => e.id));\n\t\t}\n\t\tselectAll = !selectAll;\n\t}\n\n\tfunction toggleTrip(id: string) {\n\t\tselectedTrips = selectedTrips.has(id) ? selectedTrips.delete(id) : selectedTrips.add(id);\n\t\tselectAll = selectedTrips.size === filteredTrips.length;\n\t}\n\n\tfunction toggleExpense(id: string) {\n\t\tselectedExpenses = selectedExpenses.has(id)\n\t\t\t? selectedExpenses.delete(id)\n\t\t\t: selectedExpenses.add(id);\n\t\tselectAll = selectedExpenses.size === filteredExpenses.length;\n\t}\n\n\tfunction formatDate(dateString: string): string {\n\t\treturn SvelteDate.from(dateString).toLocaleDateString();\n\t}\n\n\t// --- EXPORT LOGIC ---\n\n\tfunction handleExport() {\n\t\t// 1. Export is available to all users; quotas are enforced on creation of data\n\n\t\tif (exportFormat === 'pdf') {\n\t\t\talert(\"PDF export requires a library like 'jspdf'. Please install it to enable PDF support.\");\n\t\t\treturn;\n\t\t}\n\n\t\t// 2. Handle different export types\n\t\tif (exportDataType === 'trips') {\n\t\t\tconst tripsToExport = filteredTrips.filter((t) => selectedTrips.has(t.id));\n\t\t\tif (tripsToExport.length === 0) return alert('No trips selected.');\n\t\t\tgenerateTripCSV(tripsToExport);\n\t\t} else if (exportDataType === 'expenses') {\n\t\t\tconst expensesToExport = filteredExpenses.filter((e) => selectedExpenses.has(e.id));\n\t\t\tif (expensesToExport.length === 0) return alert('No expenses selected.');\n\t\t\tgenerateExpenseCSV(expensesToExport);\n\t\t} else if (exportDataType === 'tax_bundle') {\n\t\t\tif (filteredTrips.length === 0 && filteredExpenses.length === 0)\n\t\t\t\treturn alert('No data found in this range.');\n\n\t\t\t// Trigger multiple downloads\n\t\t\tif (filteredTrips.length > 0) generateTripCSV(filteredTrips, 'Tax_Mileage_Log');\n\n\t\t\t// Small delay to ensure browser handles multiple downloads\n\t\t\tsetTimeout(() => {\n\t\t\t\tif (filteredExpenses.length > 0) generateExpenseCSV(filteredExpenses, 'Tax_Expense_Log');\n\t\t\t}, 500);\n\n\t\t\tsetTimeout(() => {\n\t\t\t\tgenerateTaxSummary(filteredTrips, filteredExpenses);\n\t\t\t}, 1000);\n\t\t}\n\t}\n\n\tfunction generateTripCSV(data: any[], filenamePrefix = 'trips_export') {\n\t\tconst headers = [\n\t\t\t'Date',\n\t\t\t'Miles',\n\t\t\t'Start Address',\n\t\t\t'End Address',\n\t\t\t'Purpose',\n\t\t\t'Vehicle',\n\t\t\t'Notes'\n\t\t];\n\t\tconst rows = data.map((trip) => {\n\t\t\tconst date = trip.date ? SvelteDate.from(trip.date).toLocaleDateString() : '';\n\t\t\tconst miles = trip.totalMiles || 0;\n\t\t\tconst start = `\"${(trip.startAddress || '').replace(/\"/g, '\"\"')}\"`;\n\t\t\tconst last = trip.stops?.[trip.stops.length - 1];\n\t\t\tconst end = `\"${(last?.address || trip.endAddress || 'End').replace(/\"/g, '\"\"')}\"`;\n\n\t\t\tconst purpose = `\"${(trip.purpose || 'Business').replace(/\"/g, '\"\"')}\"`;\n\t\t\tconst vehicle = `\"${(trip.vehicleId || '').replace(/\"/g, '\"\"')}\"`;\n\t\t\tconst notes = `\"${(trip.notes || '').replace(/\"/g, '\"\"')}\"`;\n\n\t\t\treturn [date, miles, start, end, purpose, vehicle, notes].join(',');\n\t\t});\n\n\t\tdownloadFile(\n\t\t\t[headers.join(','), ...rows].join('\\n'),\n\t\t\t`${filenamePrefix}_${new Date().toISOString().slice(0, 10)}.csv`,\n\t\t\t'text/csv'\n\t\t);\n\t}\n\n\tfunction generateExpenseCSV(data: any[], filenamePrefix = 'expenses_export') {\n\t\tconst headers = ['Date', 'Category', 'Amount', 'Description'];\n\t\tconst rows = data.map((e) => {\n\t\t\tconst date = e.date ? SvelteDate.from(e.date).toLocaleDateString() : '';\n\t\t\tconst category = `\"${(e.category || 'General').replace(/\"/g, '\"\"')}\"`;\n\t\t\tconst amount = e.amount || 0;\n\t\t\tconst desc = `\"${(e.description || '').replace(/\"/g, '\"\"')}\"`;\n\t\t\treturn [date, category, amount, desc].join(',');\n\t\t});\n\t\tdownloadFile(\n\t\t\t[headers.join(','), ...rows].join('\\n'),\n\t\t\t`${filenamePrefix}_${new Date().toISOString().slice(0, 10)}.csv`,\n\t\t\t'text/csv'\n\t\t);\n\t}\n\n\tfunction generateTaxSummary(tripsData: any[], expensesData: any[]) {\n\t\tconst totalMiles = tripsData.reduce((sum, t) => sum + (t.totalMiles || 0), 0);\n\t\tconst totalExpenses = expensesData.reduce((sum, e) => sum + (e.amount || 0), 0);\n\n\t\t// Group expenses by category\n\t\tconst byCategory: Record<string, number> = {};\n\t\texpensesData.forEach((e) => {\n\t\t\tconst cat = e.category || 'Other';\n\t\t\tbyCategory[cat] = (byCategory[cat] || 0) + (e.amount || 0);\n\t\t});\n\n\t\tlet summary = `TAX SUMMARY REPORT\\n`;\n\t\tsummary += `Generated: ${SvelteDate.now().toLocaleDateString()}\\n`;\n\t\tsummary += `Period: ${dateFrom || 'Start'} to ${dateTo || 'Present'}\\n\\n`;\n\n\t\tsummary += `----------------------------------------\\n`;\n\t\tsummary += `MILEAGE\\n`;\n\t\tsummary += `----------------------------------------\\n`;\n\t\tsummary += `Total Business Miles: ${totalMiles.toFixed(1)}\\n`;\n\t\tsummary += `Total Trips: ${tripsData.length}\\n\\n`;\n\n\t\tsummary += `----------------------------------------\\n`;\n\t\tsummary += `EXPENSES\\n`;\n\t\tsummary += `----------------------------------------\\n`;\n\t\tsummary += `Total Expenses: $${totalExpenses.toFixed(2)}\\n`;\n\t\tObject.entries(byCategory).forEach(([cat, amt]) => {\n\t\t\tsummary += `  - ${cat}: $${amt.toFixed(2)}\\n`;\n\t\t});\n\n\t\tdownloadFile(summary, `Tax_Summary_${SvelteDate.now().getFullYear()}.txt`, 'text/plain');\n\t}\n\n\tfunction downloadFile(content: string, fileName: string, mimeType: string) {\n\t\tconst blob = new Blob([content], { type: `${mimeType};charset=utf-8;` });\n\t\tconst url = URL.createObjectURL(blob);\n\t\tconst link = document.createElement('a');\n\t\tlink.setAttribute('href', url);\n\t\tlink.setAttribute('download', fileName);\n\t\tlink.style.visibility = 'hidden';\n\t\tdocument.body.appendChild(link);\n\t\tlink.click();\n\t\tdocument.body.removeChild(link);\n\t}\n</script>\n\n<div class=\"export-grid\">\n\t<div class=\"options-card\">\n\t\t<h2 class=\"card-title\">1. Export Settings</h2>\n\n\t\t<div class=\"option-group\">\n\t\t\t<h3 class=\"option-label\">Data Type</h3>\n\t\t\t<div class=\"format-buttons\">\n\t\t\t\t<button\n\t\t\t\t\tclass=\"format-btn\"\n\t\t\t\t\tclass:active={exportDataType === 'trips'}\n\t\t\t\t\ton:click={() => (exportDataType = 'trips')}>Trips</button\n\t\t\t\t>\n\t\t\t\t<button\n\t\t\t\t\tclass=\"format-btn\"\n\t\t\t\t\tclass:active={exportDataType === 'expenses'}\n\t\t\t\t\ton:click={() => (exportDataType = 'expenses')}>Expenses</button\n\t\t\t\t>\n\t\t\t\t<button\n\t\t\t\t\tclass=\"format-btn full-width\"\n\t\t\t\t\tclass:active={exportDataType === 'tax_bundle'}\n\t\t\t\t\ton:click={() => (exportDataType = 'tax_bundle')}>Tax Bundle (All)</button\n\t\t\t\t>\n\t\t\t</div>\n\t\t</div>\n\n\t\t{#if exportDataType !== 'tax_bundle'}\n\t\t\t<div class=\"option-group\">\n\t\t\t\t<h3 class=\"option-label\">Format</h3>\n\t\t\t\t<div class=\"format-buttons\">\n\t\t\t\t\t<button\n\t\t\t\t\t\tclass=\"format-btn\"\n\t\t\t\t\t\tclass:active={exportFormat === 'csv'}\n\t\t\t\t\t\ton:click={() => (exportFormat = 'csv')}>CSV (Excel)</button\n\t\t\t\t\t>\n\t\t\t\t\t<button\n\t\t\t\t\t\tclass=\"format-btn\"\n\t\t\t\t\t\tclass:active={exportFormat === 'pdf'}\n\t\t\t\t\t\ton:click={() => (exportFormat = 'pdf')}>PDF (Print)</button\n\t\t\t\t\t>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t{/if}\n\n\t\t<div class=\"option-group\">\n\t\t\t<h3 class=\"option-label\">Date Range</h3>\n\t\t\t<div class=\"date-inputs\">\n\t\t\t\t<div class=\"date-field\">\n\t\t\t\t\t<label for=\"from\">From</label>\n\t\t\t\t\t<input id=\"from\" type=\"date\" bind:value={dateFrom} />\n\t\t\t\t</div>\n\t\t\t\t<div class=\"date-field\">\n\t\t\t\t\t<label for=\"to\">To</label>\n\t\t\t\t\t<input id=\"to\" type=\"date\" bind:value={dateTo} />\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<button\n\t\t\tclass=\"btn-action\"\n\t\t\ton:click={handleExport}\n\t\t\tdisabled={exportDataType !== 'tax_bundle' &&\n\t\t\t\t(exportDataType === 'trips' ? selectedTrips.size === 0 : selectedExpenses.size === 0)}\n\t\t\ttitle={!isPro ? 'Upgrade to Export' : 'Export Data'}\n\t\t>\n\t\t\t{#if !isPro}≡ƒöÆ{/if}\n\t\t\t{#if exportDataType === 'tax_bundle'}\n\t\t\t\tDownload Tax Package\n\t\t\t{:else}\n\t\t\t\tExport {exportDataType === 'trips' ? selectedTrips.size : selectedExpenses.size} Item{selectedTrips.size !==\n\t\t\t\t\t1 && selectedExpenses.size !== 1\n\t\t\t\t\t? 's'\n\t\t\t\t\t: ''}\n\t\t\t{/if}\n\t\t</button>\n\t</div>\n\n\t<div class=\"selection-card\">\n\t\t<div class=\"selection-header\">\n\t\t\t<h2 class=\"card-title\">\n\t\t\t\t{#if exportDataType === 'tax_bundle'}\n\t\t\t\t\t2. Review Summary\n\t\t\t\t{:else}\n\t\t\t\t\t2. Select {exportDataType === 'trips' ? 'Trips' : 'Expenses'}\n\t\t\t\t{/if}\n\t\t\t</h2>\n\t\t\t{#if exportDataType !== 'tax_bundle'}\n\t\t\t\t<button class=\"btn-text\" on:click={toggleSelectAll}\n\t\t\t\t\t>{selectAll ? 'Deselect All' : 'Select All'}</button\n\t\t\t\t>\n\t\t\t{/if}\n\t\t</div>\n\n\t\t<div class=\"trips-list\">\n\t\t\t{#if exportDataType === 'tax_bundle'}\n\t\t\t\t<div class=\"summary-preview\">\n\t\t\t\t\t<div class=\"summary-stat\">\n\t\t\t\t\t\t<span class=\"label\">Total Miles</span>\n\t\t\t\t\t\t<span class=\"value\"\n\t\t\t\t\t\t\t>{filteredTrips.reduce((s, t) => s + (t.totalMiles || 0), 0).toFixed(1)}</span\n\t\t\t\t\t\t>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"summary-stat\">\n\t\t\t\t\t\t<span class=\"label\">Total Expenses</span>\n\t\t\t\t\t\t<span class=\"value\"\n\t\t\t\t\t\t\t>${filteredExpenses.reduce((s, e) => s + (e.amount || 0), 0).toFixed(2)}</span\n\t\t\t\t\t\t>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"summary-note\">\n\t\t\t\t\t\tIncludes {filteredTrips.length} trips and {filteredExpenses.length} expense records.\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t{:else if exportDataType === 'trips'}\n\t\t\t\t{#if filteredTrips.length > 0}\n\t\t\t\t\t{#each filteredTrips as trip (trip.id)}\n\t\t\t\t\t\t<label class=\"trip-item\" class:selected={selectedTrips.has(trip.id)}>\n\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\ttype=\"checkbox\"\n\t\t\t\t\t\t\t\tchecked={selectedTrips.has(trip.id)}\n\t\t\t\t\t\t\t\ton:change={() => toggleTrip(trip.id)}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<div class=\"trip-content\">\n\t\t\t\t\t\t\t\t<div class=\"trip-top\">\n\t\t\t\t\t\t\t\t\t<span class=\"trip-date\">{formatDate(trip.date || '')}</span>\n\t\t\t\t\t\t\t\t\t<span class=\"trip-miles\">{trip.totalMiles?.toFixed(1) || '0'} mi</span>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class=\"trip-route\">\n\t\t\t\t\t\t\t\t\t{typeof trip.startAddress === 'string'\n\t\t\t\t\t\t\t\t\t\t? trip.startAddress.split(',')[0]\n\t\t\t\t\t\t\t\t\t\t: 'Unknown'} ΓåÆ\n\t\t\t\t\t\t\t\t\t{String(trip.stops?.at(-1)?.address ?? trip.endAddress ?? 'End').split(',')[0]}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</label>\n\t\t\t\t\t{/each}\n\t\t\t\t{:else}\n\t\t\t\t\t<div class=\"empty-state\">No trips found</div>\n\t\t\t\t{/if}\n\t\t\t{:else if exportDataType === 'expenses'}\n\t\t\t\t{#if filteredExpenses.length > 0}\n\t\t\t\t\t{#each filteredExpenses as expense (expense.id)}\n\t\t\t\t\t\t<label class=\"trip-item\" class:selected={selectedExpenses.has(expense.id)}>\n\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\ttype=\"checkbox\"\n\t\t\t\t\t\t\t\tchecked={selectedExpenses.has(expense.id)}\n\t\t\t\t\t\t\t\ton:change={() => toggleExpense(expense.id)}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<div class=\"trip-content\">\n\t\t\t\t\t\t\t\t<div class=\"trip-top\">\n\t\t\t\t\t\t\t\t\t<span class=\"trip-date\">{formatDate(expense.date || expense.createdAt)}</span>\n\t\t\t\t\t\t\t\t\t<span class=\"trip-miles\">${expense.amount?.toFixed(2)}</span>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class=\"trip-route\">\n\t\t\t\t\t\t\t\t\t{expense.category || 'General'}\n\t\t\t\t\t\t\t\t\t{#if expense.description}\n\t\t\t\t\t\t\t\t\t\t- {expense.description}{/if}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</label>\n\t\t\t\t\t{/each}\n\t\t\t\t{:else}\n\t\t\t\t\t<div class=\"empty-state\">No expenses found</div>\n\t\t\t\t{/if}\n\t\t\t{/if}\n\t\t</div>\n\t</div>\n</div>\n\n<Modal bind:open={isUpgradeModalOpen} title=\"Upgrade to Pro\">\n\t<div class=\"space-y-6 text-center py-4\">\n\t\t<div class=\"mx-auto w-16 h-16 bg-orange-100 rounded-full flex items-center justify-center mb-4\">\n\t\t\t<span class=\"text-3xl\">≡ƒÜÇ</span>\n\t\t</div>\n\n\t\t<h3 class=\"text-xl font-bold text-gray-900\">Unlock Pro Features</h3>\n\n\t\t<p class=\"text-gray-600 text-base leading-relaxed\">\n\t\t\tData Export is a Pro feature. Upgrade now to download your trip history for taxes!\n\t\t</p>\n\n\t\t<div class=\"bg-gray-50 p-4 rounded-lg text-left text-sm space-y-2 border border-gray-100\">\n\t\t\t<div class=\"flex items-center gap-2\">\n\t\t\t\t<span class=\"text-green-500 text-lg\">Γ£ô</span>\n\t\t\t\t<span class=\"text-gray-700\">Unlimited Stops per Trip</span>\n\t\t\t</div>\n\t\t\t<div class=\"flex items-center gap-2\">\n\t\t\t\t<span class=\"text-green-500 text-lg\">Γ£ô</span>\n\t\t\t\t<span class=\"text-gray-700\">One-Click Route Optimization</span>\n\t\t\t</div>\n\t\t\t<div class=\"flex items-center gap-2\">\n\t\t\t\t<span class=\"text-green-500 text-lg\">Γ£ô</span>\n\t\t\t\t<span class=\"text-gray-700\">Unlimited Monthly Trips</span>\n\t\t\t</div>\n\t\t\t<div class=\"flex items-center gap-2\">\n\t\t\t\t<span class=\"text-green-500 text-lg\">Γ£ô</span>\n\t\t\t\t<span class=\"text-gray-700\">Data Export</span>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<div class=\"flex gap-3 justify-center pt-2\">\n\t\t\t<Button variant=\"outline\" on:click={() => (isUpgradeModalOpen = false)}>Maybe Later</Button>\n\t\t\t<a\n\t\t\t\thref=\"/dashboard/settings\"\n\t\t\t\tclass=\"inline-flex items-center justify-center rounded-lg bg-orange-600 px-6 py-2.5 text-sm font-semibold text-white shadow-sm hover:bg-orange-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-orange-600 transition-all\"\n\t\t\t>\n\t\t\t\tUpgrade Now\n\t\t\t</a>\n\t\t</div>\n\t</div>\n</Modal>\n\n<style>\n\t.export-grid {\n\t\tdisplay: grid;\n\t\tgrid-template-columns: 1fr;\n\t\tgap: 24px;\n\t}\n\t.options-card,\n\t.selection-card {\n\t\tbackground: white;\n\t\tborder: 1px solid #e5e7eb;\n\t\tborder-radius: 16px;\n\t\tpadding: 20px;\n\t}\n\t.card-title {\n\t\tfont-size: 16px;\n\t\tfont-weight: 700;\n\t\tmargin-bottom: 16px;\n\t\tcolor: #111827;\n\t}\n\t.option-group {\n\t\tmargin-bottom: 24px;\n\t}\n\t.option-label {\n\t\tfont-size: 13px;\n\t\tfont-weight: 600;\n\t\tcolor: #374151;\n\t\tmargin-bottom: 8px;\n\t}\n\t.format-buttons {\n\t\tdisplay: grid;\n\t\tgrid-template-columns: 1fr 1fr;\n\t\tgap: 12px;\n\t}\n\t.format-btn {\n\t\tpadding: 12px;\n\t\tborder: 2px solid #e5e7eb;\n\t\tborder-radius: 10px;\n\t\tbackground: white;\n\t\tfont-weight: 600;\n\t\tfont-size: 14px;\n\t\tcolor: #6b7280;\n\t\tcursor: pointer;\n\t}\n\t.format-btn.active {\n\t\tborder-color: #ff7f50;\n\t\tcolor: #ff7f50;\n\t\tbackground: #fff5f2;\n\t}\n\t.format-btn.full-width {\n\t\tgrid-column: span 2;\n\t}\n\t.date-inputs {\n\t\tdisplay: flex;\n\t\tgap: 12px;\n\t}\n\t.date-field {\n\t\tflex: 1;\n\t}\n\t.date-field input {\n\t\twidth: 100%;\n\t\tpadding: 10px;\n\t\tborder: 1px solid #e5e7eb;\n\t\tborder-radius: 8px;\n\t}\n\t.btn-action {\n\t\twidth: 100%;\n\t\tpadding: 14px;\n\t\tbackground: linear-gradient(135deg, #ff7f50 0%, #ff6a3d 100%);\n\t\tcolor: white;\n\t\tborder: none;\n\t\tborder-radius: 10px;\n\t\tfont-weight: 700;\n\t\tcursor: pointer;\n\t}\n\t.btn-action:disabled {\n\t\topacity: 0.5;\n\t}\n\t.selection-header {\n\t\tdisplay: flex;\n\t\tjustify-content: space-between;\n\t\talign-items: center;\n\t\tmargin-bottom: 16px;\n\t}\n\t.btn-text {\n\t\tcolor: #ff7f50;\n\t\tbackground: none;\n\t\tborder: none;\n\t\tfont-weight: 600;\n\t\tcursor: pointer;\n\t}\n\t.trips-list {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tgap: 8px;\n\t\tmax-height: 400px;\n\t\toverflow-y: auto;\n\t}\n\t.trip-item {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tgap: 12px;\n\t\tpadding: 12px;\n\t\tborder: 1px solid #e5e7eb;\n\t\tborder-radius: 10px;\n\t\tbackground: #f9fafb;\n\t\tcursor: pointer;\n\t}\n\t.trip-item.selected {\n\t\tborder-color: #ff7f50;\n\t\tbackground: #fff5f2;\n\t}\n\t.trip-content {\n\t\tflex: 1;\n\t}\n\t.trip-top {\n\t\tdisplay: flex;\n\t\tjustify-content: space-between;\n\t\tfont-size: 12px;\n\t\tfont-weight: 600;\n\t}\n\t.empty-state {\n\t\ttext-align: center;\n\t\tcolor: #9ca3af;\n\t\tpadding: 20px;\n\t}\n\n\t.summary-preview {\n\t\tpadding: 16px;\n\t\tbackground: #f9fafb;\n\t\tborder-radius: 12px;\n\t\tborder: 1px solid #e5e7eb;\n\t}\n\t.summary-stat {\n\t\tdisplay: flex;\n\t\tjustify-content: space-between;\n\t\tmargin-bottom: 8px;\n\t\tfont-weight: 600;\n\t\tcolor: #111827;\n\t}\n\t.summary-note {\n\t\tmargin-top: 16px;\n\t\tfont-size: 12px;\n\t\tcolor: #6b7280;\n\t\ttext-align: center;\n\t}\n\n\t@media (min-width: 1024px) {\n\t\t.export-grid {\n\t\t\tgrid-template-columns: 350px 1fr;\n\t\t\talign-items: start;\n\t\t}\n\t}\n</style>\n",
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\components\\data\\ImportView.svelte",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\components\\hughesnet\\ArchivedRestore.svelte",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\components\\hughesnet\\ConfigForm.svelte",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\components\\hughesnet\\ConnectionStatus.svelte",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\components\\hughesnet\\DebugConsole.svelte",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\components\\hughesnet\\OrderList.svelte",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\components\\layout\\Footer.svelte",
		"messages": [
			{
				"ruleId": "svelte/no-navigation-without-resolve",
				"severity": 1,
				"message": "Unexpected href link without resolve().",
				"line": 18,
				"column": 12,
				"nodeType": null,
				"messageId": "linkWithoutResolve",
				"endLine": 18,
				"endColumn": 33
			},
			{
				"ruleId": "svelte/no-navigation-without-resolve",
				"severity": 1,
				"message": "Unexpected href link without resolve().",
				"line": 19,
				"column": 12,
				"nodeType": null,
				"messageId": "linkWithoutResolve",
				"endLine": 19,
				"endColumn": 31
			},
			{
				"ruleId": "svelte/no-navigation-without-resolve",
				"severity": 1,
				"message": "Unexpected href link without resolve().",
				"line": 20,
				"column": 12,
				"nodeType": null,
				"messageId": "linkWithoutResolve",
				"endLine": 20,
				"endColumn": 33
			}
		],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 3,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"source": "<script lang=\"ts\">\n\timport { base } from '$app/paths';\n\tconst resolve = (href: string) => `${base}${href}`;\n\n\tconst { class: className = '' } = $props();\n</script>\n\n<footer\n\tclass=\"w-full border-t border-neutral-border bg-neutral-bg-secondary mt-10 {className}\"\n\tstyle=\"padding-bottom: calc(env(safe-area-inset-bottom, 20px) + 12px);\"\n>\n\t<div\n\t\tclass=\"max-w-7xl mx-auto px-4 py-6 text-neutral-secondary text-sm flex flex-col tablet:flex-row justify-between items-center gap-4\"\n\t>\n\t\t<p>┬⌐ {new Date().getFullYear()} Go Route Yourself</p>\n\n\t\t<nav class=\"flex gap-6\">\n\t\t\t<a href={resolve('/privacy')} class=\"hover:text-primary-green\">Privacy</a>\n\t\t\t<a href={resolve('/terms')} class=\"hover:text-primary-green\">Terms</a>\n\t\t\t<a href={resolve('/support')} class=\"hover:text-primary-green\">Support</a>\n\t\t</nav>\n\t</div>\n</footer>\n",
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\components\\layout\\Header.svelte",
		"messages": [
			{
				"ruleId": "svelte/no-navigation-without-resolve",
				"severity": 1,
				"message": "Unexpected goto() call without resolve().",
				"line": 21,
				"column": 8,
				"nodeType": null,
				"messageId": "gotoWithoutResolve",
				"endLine": 21,
				"endColumn": 20
			},
			{
				"ruleId": "svelte/no-navigation-without-resolve",
				"severity": 1,
				"message": "Unexpected href link without resolve().",
				"line": 43,
				"column": 12,
				"nodeType": null,
				"messageId": "linkWithoutResolve",
				"endLine": 43,
				"endColumn": 26
			},
			{
				"ruleId": "svelte/no-navigation-without-resolve",
				"severity": 1,
				"message": "Unexpected href link without resolve().",
				"line": 62,
				"column": 15,
				"nodeType": null,
				"messageId": "linkWithoutResolve",
				"endLine": 62,
				"endColumn": 35
			},
			{
				"ruleId": "svelte/no-navigation-without-resolve",
				"severity": 1,
				"message": "Unexpected href link without resolve().",
				"line": 71,
				"column": 15,
				"nodeType": null,
				"messageId": "linkWithoutResolve",
				"endLine": 71,
				"endColumn": 35
			},
			{
				"ruleId": "svelte/no-navigation-without-resolve",
				"severity": 1,
				"message": "Unexpected href link without resolve().",
				"line": 74,
				"column": 14,
				"nodeType": null,
				"messageId": "linkWithoutResolve",
				"endLine": 74,
				"endColumn": 33
			},
			{
				"ruleId": "svelte/no-navigation-without-resolve",
				"severity": 1,
				"message": "Unexpected href link without resolve().",
				"line": 75,
				"column": 14,
				"nodeType": null,
				"messageId": "linkWithoutResolve",
				"endLine": 75,
				"endColumn": 36
			},
			{
				"ruleId": "svelte/no-navigation-without-resolve",
				"severity": 1,
				"message": "Unexpected href link without resolve().",
				"line": 81,
				"column": 14,
				"nodeType": null,
				"messageId": "linkWithoutResolve",
				"endLine": 81,
				"endColumn": 33
			},
			{
				"ruleId": "svelte/no-navigation-without-resolve",
				"severity": 1,
				"message": "Unexpected href link without resolve().",
				"line": 110,
				"column": 14,
				"nodeType": null,
				"messageId": "linkWithoutResolve",
				"endLine": 110,
				"endColumn": 34
			},
			{
				"ruleId": "svelte/no-navigation-without-resolve",
				"severity": 1,
				"message": "Unexpected href link without resolve().",
				"line": 122,
				"column": 14,
				"nodeType": null,
				"messageId": "linkWithoutResolve",
				"endLine": 122,
				"endColumn": 34
			},
			{
				"ruleId": "svelte/no-navigation-without-resolve",
				"severity": 1,
				"message": "Unexpected href link without resolve().",
				"line": 125,
				"column": 13,
				"nodeType": null,
				"messageId": "linkWithoutResolve",
				"endLine": 125,
				"endColumn": 35
			}
		],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 10,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"source": "<script lang=\"ts\">\n\timport { goto } from '$app/navigation';\n\timport { base } from '$app/paths';\n\timport { getUserState } from '$lib/stores/user.svelte';\n\timport SyncIndicator from '$lib/components/SyncIndicator.svelte';\n\n\tconst resolve = (href: string) => `${base}${href}`;\n\n\t// Get reactive state\n\tconst userState = getUserState();\n\n\tlet isMobileMenuOpen = $state(false);\n\n\tfunction toggleMenu() {\n\t\tisMobileMenuOpen = !isMobileMenuOpen;\n\t}\n\n\tasync function logout() {\n\t\tawait fetch('/api/logout', { method: 'POST' });\n\t\tuserState.logout();\n\t\tgoto(resolve('/'));\n\t}\n\n\t// Links for the public site (Logged Out)\n\tconst publicLinks = [\n\t\t{ name: 'Features', href: '/#features' },\n\t\t{ name: 'Pricing', href: '/#pricing' },\n\t\t{ name: 'How It Works', href: '/#how-it-works' },\n\t\t{ name: 'Docs', href: '/docs' }\n\t];\n\n\t// Links for the app (Logged In)\n\tconst appLinks = [\n\t\t{ name: 'Dashboard', href: '/dashboard' },\n\t\t{ name: 'Trips', href: '/dashboard/trips' },\n\t\t{ name: 'Settings', href: '/dashboard/settings' }\n\t];\n</script>\n\n<header class=\"header\">\n\t<div class=\"container\">\n\t\t<div class=\"header-content\">\n\t\t\t<a href={resolve('/')} class=\"logo-link\">\n\t\t\t\t<picture>\n\t\t\t\t\t<source type=\"image/avif\" srcset=\"/180x75.avif 180w\" sizes=\"64px\" />\n\t\t\t\t\t<source type=\"image/webp\" srcset=\"/180x75.avif 180w\" sizes=\"64px\" />\n\t\t\t\t\t<img\n\t\t\t\t\t\tsrc=\"/180x75.avif\"\n\t\t\t\t\t\talt=\"Go Route Yourself\"\n\t\t\t\t\t\tclass=\"logo\"\n\t\t\t\t\t\twidth=\"180\"\n\t\t\t\t\t\theight=\"75\"\n\t\t\t\t\t\tsrcset=\"/180x75.avif 1x, /180x75.avif 2x\"\n\t\t\t\t\t\tdecoding=\"async\"\n\t\t\t\t\t/>\n\t\t\t\t</picture>\n\t\t\t</a>\n\n\t\t\t<nav class=\"nav desktop-nav\">\n\t\t\t\t{#if userState.value}\n\t\t\t\t\t{#each appLinks as link (link.href)}\n\t\t\t\t\t\t<a href={resolve(link.href)} class=\"nav-link\">{link.name}</a>\n\t\t\t\t\t{/each}\n\n\t\t\t\t\t<div class=\"separator\"></div>\n\n\t\t\t\t\t<SyncIndicator />\n\t\t\t\t\t<button onclick={logout} class=\"btn-login\">Logout</button>\n\t\t\t\t{:else}\n\t\t\t\t\t{#each publicLinks as link (link.href)}\n\t\t\t\t\t\t<a href={resolve(link.href)} class=\"nav-link\">{link.name}</a>\n\t\t\t\t\t{/each}\n\n\t\t\t\t\t<a href={resolve('/login')} class=\"btn-login\">Sign In</a>\n\t\t\t\t\t<a href={resolve('/register')} class=\"btn-primary\">Get Started Free</a>\n\t\t\t\t{/if}\n\t\t\t</nav>\n\n\t\t\t<div class=\"mobile-nav-controls\">\n\t\t\t\t{#if !userState.value}\n\t\t\t\t\t<a href={resolve('/login')} class=\"mobile-signin\">Sign In</a>\n\t\t\t\t{/if}\n\n\t\t\t\t<button class=\"hamburger-btn\" onclick={toggleMenu} aria-label=\"Toggle menu\">\n\t\t\t\t\t<svg\n\t\t\t\t\t\twidth=\"24\"\n\t\t\t\t\t\theight=\"24\"\n\t\t\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\t\t\tfill=\"none\"\n\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\t\t\tstroke-linejoin=\"round\"\n\t\t\t\t\t>\n\t\t\t\t\t\t{#if isMobileMenuOpen}\n\t\t\t\t\t\t\t<path d=\"M18 6L6 18M6 6L18 18\"></path>\n\t\t\t\t\t\t{:else}\n\t\t\t\t\t\t\t<path d=\"M3 12h18M3 6h18M3 18h18\"></path>\n\t\t\t\t\t\t{/if}\n\t\t\t\t\t</svg>\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\n\t{#if isMobileMenuOpen}\n\t\t<div class=\"mobile-menu\">\n\t\t\t{#if userState.value}\n\t\t\t\t{#each appLinks as link (link.href)}\n\t\t\t\t\t<a href={resolve(link.href)} class=\"mobile-link\" onclick={toggleMenu}>{link.name}</a>\n\t\t\t\t{/each}\n\t\t\t\t<div class=\"divider\"></div>\n\t\t\t\t<button\n\t\t\t\t\tonclick={() => {\n\t\t\t\t\t\tlogout();\n\t\t\t\t\t\ttoggleMenu();\n\t\t\t\t\t}}\n\t\t\t\t\tclass=\"mobile-link text-red\">Logout</button\n\t\t\t\t>\n\t\t\t{:else}\n\t\t\t\t{#each publicLinks as link (link.href)}\n\t\t\t\t\t<a href={resolve(link.href)} class=\"mobile-link\" onclick={toggleMenu}>{link.name}</a>\n\t\t\t\t{/each}\n\t\t\t\t<div class=\"divider\"></div>\n\t\t\t\t<a href={resolve('/register')} class=\"btn-primary mobile-btn\" onclick={toggleMenu}\n\t\t\t\t\t>Get Started Free</a\n\t\t\t\t>\n\t\t\t{/if}\n\t\t</div>\n\t{/if}\n</header>\n\n<style>\n\t/* Match variables from the main page */\n\t:root {\n\t\t--orange: #ff7f50;\n\t\t--navy: #2c4a6e;\n\t\t--gray-100: #f3f4f6;\n\t\t--gray-600: #4b5563;\n\t\t--gray-900: #111827;\n\t}\n\n\t.header {\n\t\tposition: sticky;\n\t\ttop: 0;\n\t\tleft: 0;\n\t\tright: 0;\n\t\tbackground: white;\n\t\tborder-bottom: 1px solid var(--gray-100);\n\t\tz-index: 1000;\n\t\tpadding: 16px 0;\n\t\tfont-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\n\t}\n\n\t.container {\n\t\tmax-width: 1200px;\n\t\tmargin: 0 auto;\n\t\tpadding: 0 20px;\n\t}\n\n\t.header-content {\n\t\tdisplay: flex;\n\t\tjustify-content: space-between;\n\t\talign-items: center;\n\t}\n\n\t.logo {\n\t\theight: 100%;\n\t\twidth: 100%;\n\t\tobject-fit: contain;\n\t}\n\n\t.logo-link {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t}\n\n\t/* Desktop Nav */\n\t.desktop-nav {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tgap: 24px;\n\t}\n\n\t.nav-link {\n\t\tbackground: none;\n\t\tborder: none;\n\t\tcolor: var(--gray-600);\n\t\tfont-size: 16px;\n\t\tcursor: pointer;\n\t\ttext-decoration: none;\n\t\ttransition: color 0.2s;\n\t\tfont-weight: 500;\n\t}\n\n\t.nav-link:hover {\n\t\tcolor: var(--orange);\n\t}\n\n\t.btn-login {\n\t\tbackground: none;\n\t\tborder: none;\n\t\tcolor: var(--gray-600);\n\t\ttext-decoration: none;\n\t\tfont-weight: 500;\n\t\tfont-size: 16px;\n\t\tcursor: pointer;\n\t\tdisplay: inline-flex;\n\t\talign-items: center;\n\t\theight: 44px;\n\t\tpadding: 0 8px;\n\t}\n\n\t.btn-login:hover {\n\t\tcolor: var(--navy);\n\t}\n\n\t.btn-primary {\n\t\tbackground: var(--orange);\n\t\tcolor: white;\n\t\tpadding: 10px 24px;\n\t\tborder-radius: 8px;\n\t\ttext-decoration: none;\n\t\tfont-weight: 600;\n\t\ttransition: transform 0.2s;\n\t}\n\n\t.btn-primary:hover {\n\t\ttransform: translateY(-2px);\n\t}\n\n\t.separator {\n\t\twidth: 1px;\n\t\theight: 24px;\n\t\tbackground-color: var(--gray-100);\n\t}\n\n\t/* Mobile Controls */\n\t.mobile-nav-controls {\n\t\tdisplay: none;\n\t\talign-items: center;\n\t\tgap: 16px;\n\t}\n\n\t.mobile-signin {\n\t\ttext-decoration: none;\n\t\tcolor: var(--navy);\n\t\tfont-weight: 600;\n\t\tfont-size: 15px;\n\t}\n\n\t.hamburger-btn {\n\t\tbackground: none;\n\t\tborder: none;\n\t\tcursor: pointer;\n\t\tcolor: var(--gray-600);\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tpadding: 4px;\n\t}\n\n\t/* Mobile Menu */\n\t.mobile-menu {\n\t\tposition: absolute;\n\t\ttop: 100%;\n\t\tleft: 0;\n\t\twidth: 100%;\n\t\tbackground: white;\n\t\tborder-bottom: 1px solid var(--gray-100);\n\t\tpadding: 16px;\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tgap: 16px;\n\t\tbox-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);\n\t}\n\n\t.mobile-link {\n\t\tbackground: none;\n\t\tborder: none;\n\t\ttext-align: left;\n\t\tfont-size: 16px;\n\t\tcolor: var(--gray-600);\n\t\tpadding: 8px 0;\n\t\tcursor: pointer;\n\t\ttext-decoration: none;\n\t}\n\n\t.mobile-link.text-red {\n\t\tcolor: #dc2626;\n\t}\n\n\t.divider {\n\t\theight: 1px;\n\t\tbackground: var(--gray-100);\n\t\tmargin: 4px 0;\n\t}\n\n\t.mobile-btn {\n\t\ttext-align: center;\n\t\tdisplay: block;\n\t}\n\n\t@media (max-width: 768px) {\n\t\t.desktop-nav {\n\t\t\tdisplay: none;\n\t\t}\n\t\t.mobile-nav-controls {\n\t\t\tdisplay: flex;\n\t\t}\n\t}\n</style>\n",
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\components\\trip\\DestinationList.svelte",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\components\\trip\\TripDebug.svelte",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\components\\trip\\TripForm.svelte",
		"messages": [
			{
				"ruleId": "svelte/no-navigation-without-resolve",
				"severity": 1,
				"message": "Unexpected href link without resolve().",
				"line": 765,
				"column": 11,
				"nodeType": null,
				"messageId": "linkWithoutResolve",
				"endLine": 765,
				"endColumn": 30
			}
		],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 1,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"source": "<script lang=\"ts\">\n\timport { userSettings } from '$lib/stores/userSettings';\n\timport { get } from 'svelte/store';\n\timport { onMount } from 'svelte';\n\timport { slide } from 'svelte/transition';\n\timport type { Destination, Trip, LatLng } from '$lib/types';\n\timport { calculateTripTotals } from '$lib/utils/calculations';\n\timport { storage } from '$lib/utils/storage';\n\timport { draftTrip } from '$lib/stores/trips';\n\timport { autocomplete } from '$lib/utils/autocomplete';\n\timport { calculateRoute as getRouteData, optimizeRoute } from '$lib/services/maps';\n\timport DestinationList from './DestinationList.svelte';\n\timport TripSummary from './TripSummary.svelte';\n\timport TripDebug from './TripDebug.svelte';\n\timport { toasts } from '$lib/stores/toast';\n\timport Skeleton from '$lib/components/ui/Skeleton.svelte';\n\timport Modal from '$lib/components/ui/Modal.svelte';\n\timport Button from '$lib/components/ui/Button.svelte';\n\timport { getUserState } from '$lib/stores/user.svelte';\n\timport { PLAN_LIMITS } from '$lib/constants';\n\n\t// Svelte 5 Props using Runes\n\tconst { googleApiKey = '', loading = false, trip = null } = $props();\n\n\tconst settings = get(userSettings);\n\tconst API_KEY = $derived(() => googleApiKey || 'dummy_key');\n\n\tconst userState = getUserState();\n\n\t// --- Form State (Runes) ---\n\tlet date = $state(new Date().toISOString().split('T')[0]);\n\tlet startTime = $state('');\n\tlet endTime = $state('');\n\n\tlet startAddress = $state<string>(\n\t\tString(settings.startLocation || storage.getSetting('defaultStartAddress') || '')\n\t);\n\tlet endAddress = $state<string>(\n\t\tString(settings.endLocation || storage.getSetting('defaultEndAddress') || '')\n\t);\n\n\t// Coordinates State\n\tlet startLocation = $state<LatLng | undefined>(undefined);\n\tlet endLocation = $state<LatLng | undefined>(undefined);\n\n\tlet mpg = $state(settings.defaultMPG ?? storage.getSetting('defaultMPG') ?? 25);\n\tlet gasPrice = $state(settings.defaultGasPrice ?? storage.getSetting('defaultGasPrice') ?? 3.5);\n\n\tconst distanceUnit = $state(settings.distanceUnit || 'mi');\n\n\t// Destinations State\n\tlet destinations = $state<Destination[]>([{ address: '', earnings: 0 }]);\n\tlet notes = $state('');\n\n\t// Financials State (Runes)\n\tlet supplies = $state<{ id: string; type: string; cost: number }[]>([]);\n\tlet maintenance = $state<{ id: string; type: string; cost: number }[]>([]);\n\tlet showFinancials = $state(true);\n\n\t// --- Calculation State (Runes) ---\n\tlet calculating = $state(false);\n\tlet calculated = $state(false);\n\tlet calculationError = $state('');\n\n\tlet totalMileage = $state(0);\n\tlet totalTime = $state('');\n\tlet fuelCost = $state(0);\n\n\t// Computed Costs\n\tconst suppliesCost = $derived(supplies.reduce((sum, item) => sum + (Number(item.cost) || 0), 0));\n\tconst maintenanceCost = $derived(\n\t\tmaintenance.reduce((sum, item) => sum + (Number(item.cost) || 0), 0)\n\t);\n\n\tlet netProfit = $state(0);\n\n\t// Upgrade Modal State with specific reason tracking\n\tlet showUpgradeModal = $state(false);\n\tlet upgradeReason = $state<'stops' | 'optimize' | 'trips' | 'general'>('general');\n\n\t// Computed upgrade message based on reason\n\tconst upgradeMessage = $derived(() => {\n\t\tswitch (upgradeReason) {\n\t\t\tcase 'stops':\n\t\t\t\treturn `You've hit the ${PLAN_LIMITS.FREE.MAX_STOPS || 5}-stop limit for Free plans. Upgrade to Pro for unlimited stops per trip!`;\n\t\t\tcase 'optimize':\n\t\t\t\treturn 'Route Optimization is available to all users; free tier limits still apply to trip size.';\n\t\t\tcase 'trips':\n\t\t\t\treturn `You've reached your limit (${PLAN_LIMITS.FREE.MAX_TRIPS_PER_MONTH || PLAN_LIMITS.FREE.MAX_TRIPS_IN_WINDOW || 10} trips per ${PLAN_LIMITS.FREE.WINDOW_DAYS || 30} days).`;\n\t\t\tdefault:\n\t\t\t\treturn 'Upgrade to Pro to unlock additional conveniences and higher quotas.';\n\t\t}\n\t});\n\n\t// --- Auto-Calculation Effect ---\n\t$effect(() => {\n\t\tconst _deps = { startAddress, endAddress, destinations, mpg, gasPrice };\n\t\tvoid _deps; // referenced intentionally to capture dependencies\n\t\tconst hasStart = !!(startAddress && startAddress.length > 3);\n\t\tconst hasDest =\n\t\t\t(destinations?.length ?? 0) > 0 && (destinations?.[0]?.address?.length ?? 0) > 3;\n\n\t\tif (hasStart && hasDest) {\n\t\t\tconst timer = setTimeout(() => {\n\t\t\t\thandleCalculate(true); // true = silent mode\n\t\t\t}, 1500);\n\n\t\t\treturn () => clearTimeout(timer);\n\t\t}\n\n\t\treturn; // ensure consistent return type for the effect\n\t});\n\n\t// --- Handlers ---\n\tfunction handleAddressSelect(field: 'start' | 'end', e: CustomEvent) {\n\t\tconst place = e.detail;\n\t\tconst val = place.formatted_address || place.name || '';\n\n\t\tlet location: LatLng | undefined;\n\t\tif (place.geometry && place.geometry.location) {\n\t\t\tconst lat =\n\t\t\t\ttypeof place.geometry.location.lat === 'function'\n\t\t\t\t\t? place.geometry.location.lat()\n\t\t\t\t\t: place.geometry.location.lat;\n\t\t\tconst lng =\n\t\t\t\ttypeof place.geometry.location.lng === 'function'\n\t\t\t\t\t? place.geometry.location.lng()\n\t\t\t\t\t: place.geometry.location.lng;\n\t\t\tlocation = { lat, lng };\n\t\t}\n\n\t\tif (field === 'start') {\n\t\t\tstartAddress = val;\n\t\t\tstartLocation = location;\n\t\t} else {\n\t\t\tendAddress = val;\n\t\t\tendLocation = location;\n\t\t}\n\t}\n\n\t// Action to listen for 'place-selected' events dispatched by the autocomplete action\n\tfunction placeSelector(node: HTMLElement, cb: (e: CustomEvent) => void) {\n\t\tconst handler = (ev: Event) => cb(ev as CustomEvent);\n\t\tnode.addEventListener('place-selected', handler);\n\t\treturn {\n\t\t\tdestroy() {\n\t\t\t\tnode.removeEventListener('place-selected', handler);\n\t\t\t}\n\t\t};\n\t}\n\n\t// Financial Handlers\n\tfunction addSupply() {\n\t\tsupplies = [...supplies, { id: crypto.randomUUID(), type: '', cost: 0 }];\n\t}\n\tfunction removeSupply(index: number) {\n\t\tsupplies = supplies.filter((_, i) => i !== index);\n\t}\n\tfunction addMaintenance() {\n\t\tmaintenance = [...maintenance, { id: crypto.randomUUID(), type: '', cost: 0 }];\n\t}\n\tfunction removeMaintenance(index: number) {\n\t\tmaintenance = maintenance.filter((_, i) => i !== index);\n\t}\n\n\tasync function handleCalculate(silent = false): Promise<any | null> {\n\t\tif (!startAddress) {\n\t\t\tif (!silent) toasts.error('Please enter a start address.');\n\t\t\treturn null;\n\t\t}\n\n\t\t// Stop Limit Check\n\t\tif (!silent) {\n\t\t\tconst validStopCount = destinations.filter(\n\t\t\t\t(d) => d.address && d.address.trim().length > 0\n\t\t\t).length;\n\t\t\tif (userState.value?.plan === 'free' && validStopCount > (PLAN_LIMITS.FREE.MAX_STOPS || 5)) {\n\t\t\t\ttoasts.error(\n\t\t\t\t\t`You've hit the ${PLAN_LIMITS.FREE.MAX_STOPS || 5}-stop limit for Free plans.`\n\t\t\t\t);\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}\n\n\t\tcalculating = true;\n\t\tcalculationError = '';\n\t\ttry {\n\t\t\tconst effectiveEndAddress = endAddress ? endAddress : startAddress;\n\t\t\tconst destsCopy = $state.snapshot(destinations) as Destination[];\n\n\t\t\tconst routeData = await getRouteData(\n\t\t\t\tstartAddress,\n\t\t\t\teffectiveEndAddress,\n\t\t\t\tdestsCopy,\n\t\t\t\tdistanceUnit as 'mi' | 'km'\n\t\t\t);\n\n\t\t\t// [!code fix] Capture 'miles' first, then 'totalMiles'\n\t\t\tconst rawDist = (routeData as any).miles ?? routeData.totalMiles ?? 0;\n\t\t\ttotalMileage = Number(rawDist);\n\n\t\t\tconst duration = routeData.totalMinutes ?? (routeData as any).minutes ?? 0;\n\n\t\t\tconst totals = calculateTripTotals(\n\t\t\t\ttotalMileage,\n\t\t\t\tduration,\n\t\t\t\tdestsCopy,\n\t\t\t\tmpg,\n\t\t\t\tgasPrice,\n\t\t\t\t[],\n\t\t\t\t[],\n\t\t\t\tstartTime,\n\t\t\t\tendTime\n\t\t\t);\n\n\t\t\ttotalTime = totals.totalTime || '';\n\n\t\t\tif (trip && trip.fuelCost && !startLocation) {\n\t\t\t\tfuelCost = trip.fuelCost;\n\t\t\t} else {\n\t\t\t\tfuelCost = totals.fuelCost || 0;\n\t\t\t}\n\n\t\t\tconst grossEarnings = destsCopy.reduce(\n\t\t\t\t(acc: number, d: Destination) => acc + (Number(d.earnings) || 0),\n\t\t\t\t0\n\t\t\t);\n\t\t\tnetProfit = grossEarnings - (fuelCost + suppliesCost + maintenanceCost);\n\n\t\t\tcalculated = true;\n\t\t\tconsole.log('[TripForm] handleCalculate success', {\n\t\t\t\tmiles: totalMileage,\n\t\t\t\tminutes: duration\n\t\t\t});\n\n\t\t\tif (!silent) toasts.success('Route calculated successfully!');\n\n\t\t\treturn routeData;\n\t\t} catch (_err) {\n\t\t\tconsole.error('Calculation Error:', err);\n\t\t\tconst msg = (err.message || '').toLowerCase();\n\n\t\t\t// Plan limit detection\n\t\t\tif (msg.includes('plan limit') || msg.includes('pro feature') || msg.includes('trip limit')) {\n\t\t\t\tupgradeReason = 'general';\n\t\t\t\tshowUpgradeModal = true;\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tif (!silent || !msg.includes('zero_results')) {\n\t\t\t\tcalculationError = err.message;\n\t\t\t\tif (!silent) toasts.error(err.message);\n\t\t\t}\n\t\t\treturn null;\n\t\t} finally {\n\t\t\tcalculating = false;\n\t\t}\n\t}\n\n\tasync function handleOptimize() {\n\t\tif (!startAddress) {\n\t\t\ttoasts.error('Please enter a start address first.');\n\t\t\treturn;\n\t\t}\n\n\t\tconst validDests = destinations.filter((d) => d.address && d.address.trim() !== '');\n\t\tif (validDests.length < 2) {\n\t\t\ttoasts.error('Need at least 2 stops to optimize.');\n\t\t\treturn;\n\t\t}\n\n\t\tcalculating = true;\n\n\t\ttry {\n\t\t\tconst result: any = await optimizeRoute(startAddress, endAddress || '', validDests);\n\n\t\t\tif (result && (result as any).optimizedOrder && (result as any).optimizedOrder.length > 0) {\n\t\t\t\tconst currentDestinations = $state.snapshot(destinations) as Destination[];\n\t\t\t\tconst validDestinations = currentDestinations.filter(\n\t\t\t\t\t(d) => d.address && d.address.trim() !== ''\n\t\t\t\t);\n\t\t\t\tconst emptyDestinations = currentDestinations.filter(\n\t\t\t\t\t(d) => !d.address || d.address.trim() === ''\n\t\t\t\t);\n\n\t\t\t\tlet waypointsToReorder: Destination[] = [];\n\t\t\t\tlet fixedEnd: Destination | null = null;\n\n\t\t\t\tif (!endAddress) {\n\t\t\t\t\tfixedEnd = validDestinations[validDestinations.length - 1] ?? null;\n\t\t\t\t\twaypointsToReorder = validDestinations.slice(0, -1);\n\t\t\t\t} else {\n\t\t\t\t\twaypointsToReorder = validDestinations;\n\t\t\t\t}\n\n\t\t\t\tconst reorderedWaypoints = (result as any).optimizedOrder\n\t\t\t\t\t.map((index: number) => waypointsToReorder[index])\n\t\t\t\t\t.filter(Boolean) as Destination[];\n\n\t\t\t\tlet newDestinations = [...reorderedWaypoints];\n\n\t\t\t\tif (fixedEnd) {\n\t\t\t\t\tnewDestinations.push(fixedEnd);\n\t\t\t\t}\n\n\t\t\t\tnewDestinations = [...newDestinations, ...emptyDestinations];\n\t\t\t\tdestinations = newDestinations;\n\n\t\t\t\ttoasts.success('Stops optimized for fastest route!');\n\t\t\t\thandleCalculate(true);\n\t\t\t} else {\n\t\t\t\ttoasts.info('Route is already optimized or could not be improved.');\n\t\t\t}\n\t\t} catch (e: any) {\n\t\t\tconst msg = (e.message || '').toLowerCase();\n\n\t\t\t// Catch ALL potential plan limit indicators\n\t\t\tconst isPlanLimit =\n\t\t\t\te.code === 'PLAN_LIMIT' ||\n\t\t\t\tmsg.includes('plan limit') ||\n\t\t\t\tmsg.includes('pro feature') ||\n\t\t\t\tmsg.includes('upgrade');\n\n\t\t\tif (isPlanLimit) {\n\t\t\t\tupgradeReason = 'optimize';\n\t\t\t\tshowUpgradeModal = true;\n\t\t\t} else {\n\t\t\t\tconsole.error('Optimization failed:', e);\n\t\t\t\ttoasts.error(`Optimization failed: ${e.message}`);\n\t\t\t}\n\t\t} finally {\n\t\t\tcalculating = false;\n\t\t}\n\t}\n\n\t// --- Draft Logic ---\n\tfunction loadDraft(draft: Partial<Trip>) {\n\t\tif (!draft || typeof draft !== 'object') return;\n\t\tif (draft.date) date = draft.date;\n\t\tif (draft.startTime) startTime = draft.startTime;\n\t\tif (draft.endTime) endTime = draft.endTime;\n\t\tif (draft.startAddress) startAddress = draft.startAddress;\n\t\tif (draft.endAddress) endAddress = draft.endAddress;\n\t\tif (draft.startLocation) startLocation = draft.startLocation;\n\t\tif (draft.endLocation) endLocation = draft.endLocation;\n\t\tif (draft.mpg) mpg = draft.mpg;\n\t\tif (draft.gasPrice) gasPrice = draft.gasPrice;\n\t\tif (draft.destinations && Array.isArray(draft.destinations)) destinations = draft.destinations;\n\t\tif (draft.notes) notes = draft.notes;\n\t\t// Load Supplies from Draft/Trip, normalize and ensure ids\n\t\tif (draft.suppliesItems && Array.isArray(draft.suppliesItems)) {\n\t\t\tsupplies = (draft.suppliesItems as any[]).map((s) => ({\n\t\t\t\tid: s.id ?? crypto.randomUUID(),\n\t\t\t\ttype: s.type ?? s.name ?? '',\n\t\t\t\tcost: Number(s.cost) || 0\n\t\t\t}));\n\t\t} else if ((draft as any).supplyItems && Array.isArray((draft as any).supplyItems)) {\n\t\t\tsupplies = ((draft as any).supplyItems as any[]).map((s) => ({\n\t\t\t\tid: s.id ?? crypto.randomUUID(),\n\t\t\t\ttype: s.type ?? s.name ?? '',\n\t\t\t\tcost: Number(s.cost) || 0\n\t\t\t}));\n\t\t}\n\n\t\tif (draft.maintenanceItems && Array.isArray(draft.maintenanceItems)) {\n\t\t\tmaintenance = (draft.maintenanceItems as any[]).map((m) => ({\n\t\t\t\tid: m.id ?? crypto.randomUUID(),\n\t\t\t\ttype: m.item ?? m.type ?? '',\n\t\t\t\tcost: Number(m.cost) || 0\n\t\t\t}));\n\t\t}\n\t}\n\n\tfunction saveDraft() {\n\t\tconst draftData: Partial<Trip> = {\n\t\t\tdate,\n\t\t\tstartTime,\n\t\t\tendTime,\n\t\t\tstartAddress,\n\t\t\tendAddress,\n\t\t\tstartLocation,\n\t\t\tendLocation,\n\t\t\tdestinations,\n\t\t\tmpg,\n\t\t\tgasPrice,\n\t\t\tnotes,\n\t\t\tsuppliesItems: supplies,\n\t\t\tmaintenanceItems: maintenance\n\t\t};\n\t\tdraftTrip.save(draftData);\n\t}\n\n\tonMount(() => {\n\t\t// Support loading trip via prop (Edit Mode)\n\t\tif (trip) {\n\t\t\tloadDraft(trip);\n\t\t\tif (trip.totalMiles) totalMileage = trip.totalMiles;\n\t\t\tif (trip.fuelCost) fuelCost = trip.fuelCost;\n\t\t} else {\n\t\t\tconst rawDraft = draftTrip.load();\n\t\t\tif (rawDraft && confirm('Resume your last unsaved trip?')) {\n\t\t\t\tloadDraft(rawDraft as Partial<Trip>);\n\t\t\t}\n\t\t}\n\n\t\tconst interval = setInterval(saveDraft, 5000);\n\t\treturn () => clearInterval(interval);\n\t});\n</script>\n\n<div class=\"max-w-4xl mx-auto p-4 md:p-6\">\n\t<h2 class=\"text-2xl font-bold mb-6\">{trip ? 'Edit Trip' : 'Plan Your Trip'}</h2>\n\n\t<TripDebug />\n\n\t<div class=\"bg-white p-4 md:p-6 rounded-xl shadow-sm border border-gray-100 mb-6 space-y-6\">\n\t\t<div class=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n\t\t\t<div>\n\t\t\t\t<label for=\"trip-date\" class=\"block font-semibold mb-2 text-sm text-gray-700\">Date</label>\n\t\t\t\t{#if loading}\n\t\t\t\t\t<Skeleton height=\"48px\" className=\"rounded-lg\" />\n\t\t\t\t{:else}\n\t\t\t\t\t<input\n\t\t\t\t\t\tid=\"trip-date\"\n\t\t\t\t\t\ttype=\"date\"\n\t\t\t\t\t\tbind:value={date}\n\t\t\t\t\t\tclass=\"w-full p-3 text-base border-gray-300 border rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500 outline-none transition-all\"\n\t\t\t\t\t/>\n\t\t\t\t{/if}\n\t\t\t</div>\n\t\t</div>\n\n\t\t<div>\n\t\t\t<label for=\"start-address\" class=\"block font-semibold mb-2 text-sm text-gray-700\"\n\t\t\t\t>Start Address</label\n\t\t\t>\n\t\t\t{#if loading}\n\t\t\t\t<Skeleton height=\"48px\" className=\"rounded-lg\" />\n\t\t\t{:else}\n\t\t\t\t<input\n\t\t\t\t\tid=\"start-address\"\n\t\t\t\t\ttype=\"text\"\n\t\t\t\t\tbind:value={startAddress}\n\t\t\t\t\tplaceholder=\"Enter start location\"\n\t\t\t\t\tclass=\"w-full p-3 text-base border-gray-300 border rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500 outline-none transition-all\"\n\t\t\t\t\tautocomplete=\"off\"\n\t\t\t\t\tuse:autocomplete={{ apiKey: API_KEY() }}\n\t\t\t\t\tuse:placeSelector={(e: CustomEvent) => handleAddressSelect('start', e)}\n\t\t\t\t/>\n\t\t\t{/if}\n\t\t</div>\n\n\t\t{#if loading}\n\t\t\t<div class=\"space-y-3\">\n\t\t\t\t<div class=\"block font-semibold text-sm text-gray-700\">Destinations</div>\n\t\t\t\t<Skeleton height=\"50px\" className=\"rounded-lg\" />\n\t\t\t\t<Skeleton height=\"50px\" className=\"rounded-lg\" />\n\t\t\t</div>\n\t\t{:else}\n\t\t\t<DestinationList bind:destinations apiKey={API_KEY()} />\n\t\t{/if}\n\n\t\t<div>\n\t\t\t<label for=\"end-address\" class=\"block font-semibold mb-2 text-sm text-gray-700\"\n\t\t\t\t>End Address (Optional)</label\n\t\t\t>\n\t\t\t{#if loading}\n\t\t\t\t<Skeleton height=\"48px\" className=\"rounded-lg\" />\n\t\t\t{:else}\n\t\t\t\t<input\n\t\t\t\t\tid=\"end-address\"\n\t\t\t\t\ttype=\"text\"\n\t\t\t\t\tbind:value={endAddress}\n\t\t\t\t\tplaceholder=\"Leave empty to return to Start\"\n\t\t\t\t\tclass=\"w-full p-3 text-base border-gray-300 border rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500 outline-none transition-all\"\n\t\t\t\t\tautocomplete=\"off\"\n\t\t\t\t\tuse:autocomplete={{ apiKey: API_KEY() }}\n\t\t\t\t\tuse:placeSelector={(e: CustomEvent) => handleAddressSelect('end', e)}\n\t\t\t\t/>\n\t\t\t{/if}\n\t\t</div>\n\n\t\t<div class=\"grid grid-cols-2 gap-4\">\n\t\t\t<div>\n\t\t\t\t<label for=\"mpg\" class=\"block font-semibold mb-2 text-sm text-gray-700\">MPG</label>\n\t\t\t\t{#if loading}\n\t\t\t\t\t<Skeleton height=\"48px\" className=\"rounded-lg\" />\n\t\t\t\t{:else}\n\t\t\t\t\t<input\n\t\t\t\t\t\tid=\"mpg\"\n\t\t\t\t\t\ttype=\"number\"\n\t\t\t\t\t\tbind:value={mpg}\n\t\t\t\t\t\tstep=\"0.1\"\n\t\t\t\t\t\tclass=\"w-full p-3 text-base border-gray-300 border rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500 outline-none transition-all\"\n\t\t\t\t\t/>\n\t\t\t\t{/if}\n\t\t\t</div>\n\t\t\t<div>\n\t\t\t\t<label for=\"gas-price\" class=\"block font-semibold mb-2 text-sm text-gray-700\"\n\t\t\t\t\t>Gas Price ($)</label\n\t\t\t\t>\n\t\t\t\t{#if loading}\n\t\t\t\t\t<Skeleton height=\"48px\" className=\"rounded-lg\" />\n\t\t\t\t{:else}\n\t\t\t\t\t<input\n\t\t\t\t\t\tid=\"gas-price\"\n\t\t\t\t\t\ttype=\"number\"\n\t\t\t\t\t\tbind:value={gasPrice}\n\t\t\t\t\t\tstep=\"0.01\"\n\t\t\t\t\t\tclass=\"w-full p-3 text-base border-gray-300 border rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500 outline-none transition-all\"\n\t\t\t\t\t/>\n\t\t\t\t{/if}\n\t\t\t</div>\n\t\t\t<div>\n\t\t\t\t<label for=\"start-time\" class=\"block font-semibold mb-2 text-sm text-gray-700\"\n\t\t\t\t\t>Start Time</label\n\t\t\t\t>\n\t\t\t\t{#if loading}\n\t\t\t\t\t<Skeleton height=\"48px\" className=\"rounded-lg\" />\n\t\t\t\t{:else}\n\t\t\t\t\t<input\n\t\t\t\t\t\tid=\"start-time\"\n\t\t\t\t\t\ttype=\"time\"\n\t\t\t\t\t\tbind:value={startTime}\n\t\t\t\t\t\tclass=\"w-full p-3 text-base border-gray-300 border rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500 outline-none transition-all\"\n\t\t\t\t\t/>\n\t\t\t\t{/if}\n\t\t\t</div>\n\t\t\t<div>\n\t\t\t\t<label for=\"end-time\" class=\"block font-semibold mb-2 text-sm text-gray-700\">End Time</label\n\t\t\t\t>\n\t\t\t\t{#if loading}\n\t\t\t\t\t<Skeleton height=\"48px\" className=\"rounded-lg\" />\n\t\t\t\t{:else}\n\t\t\t\t\t<input\n\t\t\t\t\t\tid=\"end-time\"\n\t\t\t\t\t\ttype=\"time\"\n\t\t\t\t\t\tbind:value={endTime}\n\t\t\t\t\t\tclass=\"w-full p-3 text-base border-gray-300 border rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500 outline-none transition-all\"\n\t\t\t\t\t/>\n\t\t\t\t{/if}\n\t\t\t</div>\n\t\t</div>\n\n\t\t<div class=\"border-t border-gray-100 pt-4\">\n\t\t\t<div class=\"flex justify-between items-center mb-4\">\n\t\t\t\t<div class=\"block font-semibold text-sm text-gray-700\">Expenses & Supplies</div>\n\t\t\t\t<button\n\t\t\t\t\ttype=\"button\"\n\t\t\t\t\tclass=\"text-sm text-blue-600\"\n\t\t\t\t\tonclick={() => (showFinancials = !showFinancials)}\n\t\t\t\t>\n\t\t\t\t\t{showFinancials ? 'Hide' : 'Show'}\n\t\t\t\t</button>\n\t\t\t</div>\n\n\t\t\t{#if showFinancials}\n\t\t\t\t<div transition:slide class=\"space-y-4 bg-gray-50 p-4 rounded-lg\">\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<div class=\"flex justify-between items-center mb-2\">\n\t\t\t\t\t\t\t<span class=\"text-xs font-semibold text-gray-500 uppercase\"\n\t\t\t\t\t\t\t\t>Supplies (Pole, Concrete)</span\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\tonclick={addSupply}\n\t\t\t\t\t\t\t\tclass=\"text-xs bg-white border px-2 py-1 rounded hover:bg-gray-100\">+ Add</button\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t{#each supplies as item, i (i)}\n\t\t\t\t\t\t\t<div class=\"flex gap-2 mb-2 items-center\">\n\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\t\tplaceholder=\"Item Type\"\n\t\t\t\t\t\t\t\t\tbind:value={item.type}\n\t\t\t\t\t\t\t\t\tclass=\"w-full p-2 text-sm border rounded\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\ttype=\"number\"\n\t\t\t\t\t\t\t\t\tplaceholder=\"$\"\n\t\t\t\t\t\t\t\t\tstep=\"0.01\"\n\t\t\t\t\t\t\t\t\tbind:value={item.cost}\n\t\t\t\t\t\t\t\t\tclass=\"w-24 p-2 text-sm border rounded\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\t\tonclick={() => removeSupply(i)}\n\t\t\t\t\t\t\t\t\tclass=\"text-red-400 hover:text-red-600\">Γ£ò</button\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t{/each}\n\t\t\t\t\t\t{#if supplies.length > 0}\n\t\t\t\t\t\t\t<div class=\"text-right text-xs text-gray-600 font-medium\">\n\t\t\t\t\t\t\t\tSubtotal: ${suppliesCost.toFixed(2)}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t{/if}\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<div class=\"flex justify-between items-center mb-2\">\n\t\t\t\t\t\t\t<span class=\"text-xs font-semibold text-gray-500 uppercase\">Vehicle / Other</span>\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\tonclick={addMaintenance}\n\t\t\t\t\t\t\t\tclass=\"text-xs bg-white border px-2 py-1 rounded hover:bg-gray-100\">+ Add</button\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t{#each maintenance as item, i (i)}\n\t\t\t\t\t\t\t<div class=\"flex gap-2 mb-2 items-center\">\n\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\t\tplaceholder=\"Description\"\n\t\t\t\t\t\t\t\t\tbind:value={item.type}\n\t\t\t\t\t\t\t\t\tclass=\"w-full p-2 text-sm border rounded\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\ttype=\"number\"\n\t\t\t\t\t\t\t\t\tplaceholder=\"$\"\n\t\t\t\t\t\t\t\t\tstep=\"0.01\"\n\t\t\t\t\t\t\t\t\tbind:value={item.cost}\n\t\t\t\t\t\t\t\t\tclass=\"w-24 p-2 text-sm border rounded\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\t\tonclick={() => removeMaintenance(i)}\n\t\t\t\t\t\t\t\t\tclass=\"text-red-400 hover:text-red-600\">Γ£ò</button\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t{/each}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t{/if}\n\t\t</div>\n\n\t\t<div>\n\t\t\t<label for=\"notes\" class=\"block font-semibold mb-2 text-sm text-gray-700\">Notes</label>\n\t\t\t{#if loading}\n\t\t\t\t<Skeleton height=\"100px\" className=\"rounded-lg\" />\n\t\t\t{:else}\n\t\t\t\t<textarea\n\t\t\t\t\tid=\"notes\"\n\t\t\t\t\tbind:value={notes}\n\t\t\t\t\trows=\"3\"\n\t\t\t\t\tclass=\"w-full p-3 text-base border-gray-300 border rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500 outline-none transition-all\"\n\t\t\t\t></textarea>\n\t\t\t{/if}\n\t\t</div>\n\t</div>\n\n\t{#if calculationError}\n\t\t<div class=\"bg-red-50 text-red-700 p-4 rounded-lg mb-6 border border-red-200\">\n\t\t\t{calculationError}\n\t\t</div>\n\t{/if}\n\n\t{#if calculated}\n\t\t<TripSummary {totalMileage} {distanceUnit} {totalTime} {fuelCost} {netProfit} />\n\t{:else if calculating}\n\t\t<div\n\t\t\tclass=\"p-6 text-center text-gray-500 bg-gray-50 rounded-xl border border-dashed border-gray-300\"\n\t\t>\n\t\t\t<div class=\"inline-block animate-spin mr-2\">Γƒ│</div>\n\t\t\tCalculating route...\n\t\t</div>\n\t{/if}\n\n\t<div class=\"flex flex-col sm:flex-row gap-3 mt-6\">\n\t\t{#if loading}\n\t\t\t<Skeleton height=\"48px\" width=\"160px\" className=\"rounded-lg\" />\n\t\t{:else}\n\t\t\t<button\n\t\t\t\tclass=\"w-full sm:w-auto px-6 py-3 bg-blue-600 text-white rounded-lg font-semibold hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors shadow-sm\"\n\t\t\t\tonclick={() => handleCalculate(false)}\n\t\t\t\tdisabled={calculating}\n\t\t\t>\n\t\t\t\t{calculating ? 'Calculating...' : 'Recalculate Route'}\n\t\t\t</button>\n\n\t\t\t<button\n\t\t\t\tclass=\"w-full sm:w-auto px-6 py-3 bg-green-600 text-white rounded-lg font-semibold hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors shadow-sm\"\n\t\t\t\tonclick={handleOptimize}\n\t\t\t\tdisabled={calculating}\n\t\t\t\ttitle={userState.value?.plan === 'free'\n\t\t\t\t\t? 'Pro Feature - Upgrade to Unlock'\n\t\t\t\t\t: 'Reorder stops for fastest route'}\n\t\t\t>\n\t\t\t\t{#if userState.value?.plan === 'free'}\n\t\t\t\t\t≡ƒöÆ Optimize Stops (Pro)\n\t\t\t\t{:else}\n\t\t\t\t\tOptimize Stops\n\t\t\t\t{/if}\n\t\t\t</button>\n\t\t{/if}\n\t</div>\n</div>\n\n<Modal bind:open={showUpgradeModal} title=\"Upgrade to Pro\">\n\t<div class=\"space-y-6 text-center py-4\">\n\t\t<div class=\"mx-auto w-16 h-16 bg-orange-100 rounded-full flex items-center justify-center mb-4\">\n\t\t\t{#if upgradeReason === 'stops'}\n\t\t\t\t<span class=\"text-3xl\">≡ƒôì</span>\n\t\t\t{:else if upgradeReason === 'optimize'}\n\t\t\t\t<span class=\"text-3xl\">≡ƒÜÇ</span>\n\t\t\t{:else if upgradeReason === 'trips'}\n\t\t\t\t<span class=\"text-3xl\">≡ƒôè</span>\n\t\t\t{:else}\n\t\t\t\t<span class=\"text-3xl\">Γ¡É</span>\n\t\t\t{/if}\n\t\t</div>\n\n\t\t<h3 class=\"text-xl font-bold text-gray-900\">\n\t\t\t{#if upgradeReason === 'stops'}\n\t\t\t\tToo Many Stops\n\t\t\t{:else if upgradeReason === 'optimize'}\n\t\t\t\tPro Feature Required\n\t\t\t{:else if upgradeReason === 'trips'}\n\t\t\t\tMonthly Limit Reached\n\t\t\t{:else}\n\t\t\t\tUnlock Pro Features\n\t\t\t{/if}\n\t\t</h3>\n\n\t\t<p class=\"text-gray-600 text-base leading-relaxed\">\n\t\t\t{upgradeMessage()}\n\t\t</p>\n\n\t\t{#if upgradeReason === 'trips' && userState.value}\n\t\t\t<div class=\"bg-orange-50 border border-orange-200 rounded-lg p-3 text-sm\">\n\t\t\t\t<div class=\"font-semibold text-orange-900\">Your Free Plan Status:</div>\n\t\t\t\t<div class=\"text-orange-700 mt-1\">\n\t\t\t\t\t{userState.value.tripsThisMonth} / {userState.value.maxTrips} trips used this month\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t{/if}\n\n\t\t<div class=\"bg-gray-50 p-4 rounded-lg text-left text-sm space-y-2 border border-gray-100\">\n\t\t\t<div class=\"font-semibold text-gray-900 mb-3\">Pro Plan Includes:</div>\n\t\t\t<div class=\"flex items-center gap-2\">\n\t\t\t\t<span class=\"text-green-500 text-lg\">Γ£ô</span>\n\t\t\t\t<span class=\"text-gray-700\"><strong>Unlimited</strong> Stops per Trip</span>\n\t\t\t</div>\n\t\t\t<div class=\"flex items-center gap-2\">\n\t\t\t\t<span class=\"text-green-500 text-lg\">Γ£ô</span>\n\t\t\t\t<span class=\"text-gray-700\"><strong>One-Click</strong> Route Optimization</span>\n\t\t\t</div>\n\t\t\t<div class=\"flex items-center gap-2\">\n\t\t\t\t<span class=\"text-green-500 text-lg\">Γ£ô</span>\n\t\t\t\t<span class=\"text-gray-700\"><strong>Unlimited</strong> Monthly Trips</span>\n\t\t\t</div>\n\t\t\t<div class=\"flex items-center gap-2\">\n\t\t\t\t<span class=\"text-green-500 text-lg\">Γ£ô</span>\n\t\t\t\t<span class=\"text-gray-700\"><strong>Priority</strong> Support</span>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<div class=\"bg-gradient-to-r from-orange-500 to-orange-600 text-white rounded-lg p-4\">\n\t\t\t<div class=\"text-sm opacity-90\">Only</div>\n\t\t\t<div class=\"text-3xl font-bold\">$9.99<span class=\"text-lg font-normal\">/mo</span></div>\n\t\t\t<div class=\"text-sm opacity-90\">Cancel anytime</div>\n\t\t</div>\n\n\t\t<div class=\"flex gap-3 justify-center pt-2\">\n\t\t\t<Button variant=\"outline\" on:click={() => (showUpgradeModal = false)}>Maybe Later</Button>\n\t\t\t<a\n\t\t\t\thref=\"/dashboard/settings\"\n\t\t\t\tclass=\"inline-flex items-center justify-center rounded-lg bg-orange-600 px-6 py-2.5 text-sm font-semibold text-white shadow-sm hover:bg-orange-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-orange-600 transition-all\"\n\t\t\t>\n\t\t\t\tUpgrade to Pro ΓåÆ\n\t\t\t</a>\n\t\t</div>\n\t</div>\n</Modal>\n",
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\components\\trip\\TripSummary.svelte",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\components\\tripstats.spec.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\components\\ui\\Button.svelte",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\components\\ui\\Button.svelte.d.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\components\\ui\\Card.svelte",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\components\\ui\\CollapsibleCard.svelte",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\components\\ui\\Input.svelte",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\components\\ui\\Modal.svelte",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\components\\ui\\SelectMobile.svelte",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\components\\ui\\Skeleton.svelte",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\components\\ui\\ToastContainer.svelte",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\constants.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\db\\indexedDB.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\db\\test.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\db\\types.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\index.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\server\\PlacesIndexDO.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\server\\TripIndexDO.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\server\\auditLog.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\server\\auth.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\server\\authenticatorService.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\server\\csrf.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\server\\debug.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\server\\dev-mock-db.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\server\\directionsCache.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\server\\email.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\server\\env.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\server\\expenseService.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\server\\geocode.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\server\\hughesnet-parser.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\server\\hughesnet\\auth.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\server\\hughesnet\\constants.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\server\\hughesnet\\fetcher.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\server\\hughesnet\\parser.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\server\\hughesnet\\router.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\server\\hughesnet\\service.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\server\\hughesnet\\tripBuilder.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\server\\hughesnet\\types.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\server\\hughesnet\\utils.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\server\\log.ts",
		"messages": [],
		"suppressedMessages": [
			{
				"ruleId": "no-console",
				"severity": 2,
				"message": "Unexpected console statement.",
				"line": 57,
				"column": 4,
				"nodeType": "MemberExpression",
				"messageId": "unexpected",
				"endLine": 57,
				"endColumn": 18,
				"suggestions": [
					{
						"fix": { "range": [1361, 1401], "text": "" },
						"messageId": "removeMethodCall",
						"desc": "Remove the console method call."
					}
				],
				"suppressions": [{ "kind": "directive", "justification": "" }]
			},
			{
				"ruleId": "no-console",
				"severity": 2,
				"message": "Unexpected console statement.",
				"line": 60,
				"column": 4,
				"nodeType": "MemberExpression",
				"messageId": "unexpected",
				"endLine": 60,
				"endColumn": 18,
				"suggestions": [
					{
						"fix": { "range": [1463, 1527], "text": "" },
						"messageId": "removeMethodCall",
						"desc": "Remove the console method call."
					}
				],
				"suppressions": [{ "kind": "directive", "justification": "" }]
			},
			{
				"ruleId": "no-console",
				"severity": 2,
				"message": "Unexpected console statement.",
				"line": 64,
				"column": 3,
				"nodeType": "MemberExpression",
				"messageId": "unexpected",
				"endLine": 64,
				"endColumn": 17,
				"suggestions": [
					{
						"fix": { "range": [1585, 1609], "text": "" },
						"messageId": "removeMethodCall",
						"desc": "Remove the console method call."
					}
				],
				"suppressions": [{ "kind": "directive", "justification": "" }]
			}
		],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\server\\migration\\storage-key-migration.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\server\\mileageService.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\server\\mockKv.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\server\\passwordValidation.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\server\\rateLimit.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\server\\requestValidation.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\server\\sanitize.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\server\\session.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\server\\sessionService.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\server\\stripe.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\server\\stripe\\webhook.spec.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\server\\trashPurge.spec.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\server\\trashPurge.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\server\\tripService.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\server\\user.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\server\\userService.ts",
		"messages": [],
		"suppressedMessages": [
			{
				"ruleId": "no-restricted-syntax",
				"severity": 2,
				"message": "SECURITY: Do not use user.name/email/token for ownership checks. Use 'user.id' only. (See SECURITY.md)",
				"line": 346,
				"column": 26,
				"nodeType": "MemberExpression",
				"messageId": "restrictedSyntax",
				"endLine": 346,
				"endColumn": 36,
				"suppressions": [{ "kind": "directive", "justification": "Legacy index cleanup (safe)" }]
			}
		],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\server\\webauthn-utils.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\server\\webauthn.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\services\\googleMaps.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\services\\maps.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\stores\\auth.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\stores\\currentUser.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\stores\\expenses.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\stores\\mileage.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\stores\\sync.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\stores\\toast.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\stores\\trash.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\stores\\trips.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\stores\\user.svelte.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\stores\\userSettings.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\sync\\syncManager.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\types\\index.d.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\types\\index.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\utils\\analytics.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\utils\\api.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\utils\\autocomplete.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\utils\\calculations.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\utils\\csrf.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\utils\\dashboardLogic.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\utils\\dates.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\utils\\geocode.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\utils\\keys.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\utils\\sanitize.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\utils\\storage.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\utils\\svelte-reactivity.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\utils\\trip-helpers.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\utils\\user-display.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\utils\\vehicle.spec.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\utils\\vehicle.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\vendor-stubs\\canvg-stub.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\vendor-stubs\\html2canvas-stub.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\lib\\vendor-stubs\\types\\index.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\+error.svelte",
		"messages": [
			{
				"ruleId": "svelte/no-navigation-without-resolve",
				"severity": 1,
				"message": "Unexpected href link without resolve().",
				"line": 114,
				"column": 12,
				"nodeType": null,
				"messageId": "linkWithoutResolve",
				"endLine": 114,
				"endColumn": 35
			}
		],
		"suppressedMessages": [
			{
				"ruleId": "svelte/no-at-html-tags",
				"severity": 2,
				"message": "`{@html}` can lead to XSS attack.",
				"line": 102,
				"column": 4,
				"nodeType": "SvelteMustacheTag",
				"messageId": "unexpected",
				"endLine": 102,
				"endColumn": 21,
				"suppressions": [{ "kind": "directive", "justification": "" }]
			}
		],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 1,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"source": "<script lang=\"ts\">\n\t/* eslint-disable svelte/no-at-html-tags */\n\t// Sanitized static SVG icons (created using sanitizeStaticSvg). See SECURITY.md for rationale.\n\timport { page } from '$app/stores';\n\timport { onMount } from 'svelte';\n\timport { base } from '$app/paths';\n\timport { sanitizeStaticSvg } from '$lib/utils/sanitize';\n\tconst resolve = (href: string) => `${base}${href}`;\n\n\tconst errorDetails = $state({\n\t\tstatus: $page.status || 500,\n\t\tmessage: $page.error?.message || 'An unexpected error occurred',\n\t\tshowDetails: false\n\t});\n\n\t// Log error for debugging\n\tonMount(() => {\n\t\tif ($page.error) {\n\t\t\tconsole.error('Error caught by boundary:', {\n\t\t\t\tstatus: $page.status,\n\t\t\t\terror: $page.error,\n\t\t\t\turl: $page.url.pathname\n\t\t\t});\n\t\t}\n\t});\n\n\tfunction toggleDetails() {\n\t\terrorDetails.showDetails = !errorDetails.showDetails;\n\t}\n\n\tfunction getErrorTitle(status: number): string {\n\t\tconst titles: Record<number, string> = {\n\t\t\t400: 'Bad Request',\n\t\t\t401: 'Unauthorized',\n\t\t\t403: 'Access Denied',\n\t\t\t404: 'Page Not Found',\n\t\t\t429: 'Too Many Requests',\n\t\t\t500: 'Server Error',\n\t\t\t503: 'Service Unavailable'\n\t\t};\n\t\treturn titles[status] || 'Error';\n\t}\n\n\tfunction getErrorDescription(status: number): string {\n\t\tconst descriptions: Record<number, string> = {\n\t\t\t400: 'The request could not be understood by the server.',\n\t\t\t401: 'Please log in to access this page.',\n\t\t\t403: \"You don't have permission to access this resource.\",\n\t\t\t404: \"The page you're looking for doesn't exist or has been moved.\",\n\t\t\t429: \"You've made too many requests. Please try again in a moment.\",\n\t\t\t500: 'Something went wrong on our end. Our team has been notified.',\n\t\t\t503: 'The service is temporarily unavailable. Please try again later.'\n\t\t};\n\t\treturn descriptions[status] || 'An unexpected error occurred while processing your request.';\n\t}\n\n\t// [!code fix] SECURITY (Issue #7, #43): Sanitize static SVG icons\n\tfunction getErrorIcon(status: number): string {\n\t\tif (status === 404) {\n\t\t\treturn sanitizeStaticSvg(`<svg width=\"64\" height=\"64\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n\t\t\t\t<circle cx=\"12\" cy=\"12\" r=\"10\"/>\n\t\t\t\t<path d=\"M16 16s-1.5-2-4-2-4 2-4 2\"/>\n\t\t\t\t<line x1=\"9\" y1=\"9\" x2=\"9.01\" y2=\"9\"/>\n\t\t\t\t<line x1=\"15\" y1=\"9\" x2=\"15.01\" y2=\"9\"/>\n\t\t\t</svg>`);\n\t\t}\n\t\tif (status === 403) {\n\t\t\treturn sanitizeStaticSvg(`<svg width=\"64\" height=\"64\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n\t\t\t\t<rect x=\"3\" y=\"11\" width=\"18\" height=\"11\" rx=\"2\" ry=\"2\"/>\n\t\t\t\t<path d=\"M7 11V7a5 5 0 0 1 10 0v4\"/>\n\t\t\t</svg>`);\n\t\t}\n\t\tif (status === 429) {\n\t\t\treturn sanitizeStaticSvg(`<svg width=\"64\" height=\"64\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n\t\t\t\t<circle cx=\"12\" cy=\"12\" r=\"10\"/>\n\t\t\t\t<polyline points=\"12 6 12 12 16 14\"/>\n\t\t\t</svg>`);\n\t\t}\n\t\t// Default error icon\n\t\treturn sanitizeStaticSvg(`<svg width=\"64\" height=\"64\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n\t\t\t<circle cx=\"12\" cy=\"12\" r=\"10\"/>\n\t\t\t<line x1=\"12\" y1=\"8\" x2=\"12\" y2=\"12\"/>\n\t\t\t<line x1=\"12\" y1=\"16\" x2=\"12.01\" y2=\"16\"/>\n\t\t</svg>`);\n\t}\n\n\t// ΓåÉ FIXED: Use $derived instead of $:\n\tconst errorIcon = $derived(getErrorIcon(errorDetails.status));\n\tconst errorTitle = $derived(getErrorTitle(errorDetails.status));\n\tconst errorDescription = $derived(getErrorDescription(errorDetails.status));\n</script>\n\n<svelte:head>\n\t<title>{errorDetails.status} - {errorTitle} | Go Route Yourself</title>\n</svelte:head>\n\n<div class=\"error-container\">\n\t<div class=\"error-content\">\n\t\t<div class=\"error-icon\" class:not-found={errorDetails.status === 404}>\n\t\t\t<!-- eslint-disable-next-line svelte/no-at-html-tags -->\n\t\t\t<!-- Sanitized static SVG (sanitizeStaticSvg) - safe to render with {@html} -->\n\t\t\t{@html errorIcon}\n\t\t</div>\n\t\t<h2 class=\"error-title\">{errorTitle}</h2>\n\t\t<p class=\"error-description\">{errorDescription}</p>\n\n\t\t{#if errorDetails.message && errorDetails.message !== 'An unexpected error occurred'}\n\t\t\t<div class=\"error-message\">\n\t\t\t\t<p>{errorDetails.message}</p>\n\t\t\t</div>\n\t\t{/if}\n\n\t\t<div class=\"error-actions\">\n\t\t\t<a href={resolve('/dashboard')} class=\"btn-primary\">\n\t\t\t\t<svg\n\t\t\t\t\twidth=\"20\"\n\t\t\t\t\theight=\"20\"\n\t\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\t\tfill=\"none\"\n\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t>\n\t\t\t\t\t<path d=\"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z\" />\n\t\t\t\t\t<polyline points=\"9 22 9 12 15 12 15 22\" />\n\t\t\t\t</svg>\n\t\t\t\tGo to Dashboard\n\t\t\t</a>\n\n\t\t\t<button onclick={() => window.history.back()} class=\"btn-secondary\">\n\t\t\t\t<svg\n\t\t\t\t\twidth=\"20\"\n\t\t\t\t\theight=\"20\"\n\t\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\t\tfill=\"none\"\n\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t>\n\t\t\t\t\t<line x1=\"19\" y1=\"12\" x2=\"5\" y2=\"12\" />\n\t\t\t\t\t<polyline points=\"12 19 5 12 12 5\" />\n\t\t\t\t</svg>\n\t\t\t\tGo Back\n\t\t\t</button>\n\n\t\t\t{#if errorDetails.status >= 500}\n\t\t\t\t<button onclick={toggleDetails} class=\"btn-text\">\n\t\t\t\t\t{errorDetails.showDetails ? 'Hide' : 'Show'} Technical Details\n\t\t\t\t</button>\n\t\t\t{/if}\n\t\t</div>\n\n\t\t{#if errorDetails.showDetails && $page.error}\n\t\t\t<div class=\"error-details\">\n\t\t\t\t<h3>Technical Information</h3>\n\t\t\t\t<pre><code\n\t\t\t\t\t\t>{JSON.stringify(\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tstatus: $page.status,\n\t\t\t\t\t\t\t\tmessage: $page.error.message,\n\t\t\t\t\t\t\t\turl: $page.url.pathname,\n\t\t\t\t\t\t\t\ttimestamp: new Date().toISOString()\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tnull,\n\t\t\t\t\t\t\t2\n\t\t\t\t\t\t)}</code\n\t\t\t\t\t></pre>\n\t\t\t</div>\n\t\t{/if}\n\n\t\t<div class=\"error-help\">\n\t\t\t<p>\n\t\t\t\tNeed help? <a href=\"mailto:support@gorouteyourself.com\">Contact Support</a>\n\t\t\t</p>\n\t\t</div>\n\t</div>\n</div>\n\n<style>\n\t.error-container {\n\t\tmin-height: 100vh;\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t\tpadding: 2rem;\n\t\tbackground: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n\t}\n\n\t.error-content {\n\t\tmax-width: 600px;\n\t\twidth: 100%;\n\t\tbackground: white;\n\t\tborder-radius: 16px;\n\t\tpadding: 3rem;\n\t\ttext-align: center;\n\t\tbox-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);\n\t\tanimation: slideUp 0.5s ease-out;\n\t}\n\n\t@keyframes slideUp {\n\t\tfrom {\n\t\t\topacity: 0;\n\t\t\ttransform: translateY(20px);\n\t\t}\n\t\tto {\n\t\t\topacity: 1;\n\t\t\ttransform: translateY(0);\n\t\t}\n\t}\n\n\t.error-icon {\n\t\tdisplay: inline-flex;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t\twidth: 80px;\n\t\theight: 80px;\n\t\tbackground: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n\t\tborder-radius: 50%;\n\t\tmargin-bottom: 1.5rem;\n\t\tcolor: white;\n\t\tanimation: pulse 2s ease-in-out infinite;\n\t}\n\n\t.error-icon.not-found {\n\t\tbackground: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);\n\t}\n\n\t@keyframes pulse {\n\t\t0%,\n\t\t100% {\n\t\t\ttransform: scale(1);\n\t\t}\n\t\t50% {\n\t\t\ttransform: scale(1.05);\n\t\t}\n\t}\n\n\t.error-status {\n\t\tfont-size: 4rem;\n\t\tfont-weight: 800;\n\t\tmargin: 0;\n\t\tbackground: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n\t\t-webkit-background-clip: text;\n\t\t-webkit-text-fill-color: transparent;\n\t\tbackground-clip: text;\n\t\tline-height: 1;\n\t}\n\n\t.error-title {\n\t\tfont-size: 1.75rem;\n\t\tfont-weight: 600;\n\t\tmargin: 0.5rem 0;\n\t\tcolor: #1f2937;\n\t}\n\n\t.error-description {\n\t\tfont-size: 1rem;\n\t\tcolor: #6b7280;\n\t\tmargin: 1rem 0 1.5rem;\n\t\tline-height: 1.6;\n\t}\n\n\t.error-message {\n\t\tbackground: #fef2f2;\n\t\tborder: 1px solid #fecaca;\n\t\tborder-radius: 8px;\n\t\tpadding: 1rem;\n\t\tmargin: 1.5rem 0;\n\t}\n\n\t.error-message p {\n\t\tmargin: 0;\n\t\tcolor: #991b1b;\n\t\tfont-size: 0.875rem;\n\t}\n\n\t.error-actions {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tgap: 0.75rem;\n\t\tmargin: 2rem 0;\n\t}\n\n\t.btn-primary,\n\t.btn-secondary,\n\t.btn-text {\n\t\tdisplay: inline-flex;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t\tgap: 0.5rem;\n\t\tpadding: 0.75rem 1.5rem;\n\t\tborder-radius: 8px;\n\t\tfont-weight: 500;\n\t\tfont-size: 1rem;\n\t\ttext-decoration: none;\n\t\ttransition: all 0.2s;\n\t\tcursor: pointer;\n\t\tborder: none;\n\t\tfont-family: inherit;\n\t}\n\n\t.btn-primary {\n\t\tbackground: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n\t\tcolor: white;\n\t}\n\n\t.btn-primary:hover {\n\t\ttransform: translateY(-2px);\n\t\tbox-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);\n\t}\n\n\t.btn-secondary {\n\t\tbackground: #f3f4f6;\n\t\tcolor: #374151;\n\t}\n\n\t.btn-secondary:hover {\n\t\tbackground: #e5e7eb;\n\t}\n\n\t.btn-text {\n\t\tbackground: transparent;\n\t\tcolor: #6b7280;\n\t\tpadding: 0.5rem;\n\t}\n\n\t.btn-text:hover {\n\t\tcolor: #374151;\n\t\ttext-decoration: underline;\n\t}\n\n\t.error-details {\n\t\tmargin-top: 2rem;\n\t\ttext-align: left;\n\t\tbackground: #f9fafb;\n\t\tborder-radius: 8px;\n\t\tpadding: 1.5rem;\n\t\tborder: 1px solid #e5e7eb;\n\t}\n\n\t.error-details h3 {\n\t\tmargin: 0 0 1rem;\n\t\tfont-size: 1rem;\n\t\tcolor: #374151;\n\t\tfont-weight: 600;\n\t}\n\n\t.error-details pre {\n\t\tmargin: 0;\n\t\tbackground: #1f2937;\n\t\tcolor: #f3f4f6;\n\t\tpadding: 1rem;\n\t\tborder-radius: 6px;\n\t\toverflow-x: auto;\n\t\tfont-size: 0.875rem;\n\t\tline-height: 1.5;\n\t}\n\n\t.error-help {\n\t\tmargin-top: 2rem;\n\t\tpadding-top: 2rem;\n\t\tborder-top: 1px solid #e5e7eb;\n\t}\n\n\t.error-help p {\n\t\tmargin: 0;\n\t\tcolor: #6b7280;\n\t\tfont-size: 0.875rem;\n\t}\n\n\t.error-help a {\n\t\tcolor: #667eea;\n\t\ttext-decoration: none;\n\t\tfont-weight: 500;\n\t}\n\n\t.error-help a:hover {\n\t\ttext-decoration: underline;\n\t}\n\n\t@media (min-width: 640px) {\n\t\t.error-actions {\n\t\t\tflex-direction: row;\n\t\t\tjustify-content: center;\n\t\t}\n\t}\n\n\t@media (max-width: 639px) {\n\t\t.error-content {\n\t\t\tpadding: 2rem 1.5rem;\n\t\t}\n\n\t\t.error-status {\n\t\t\tfont-size: 3rem;\n\t\t}\n\n\t\t.error-title {\n\t\t\tfont-size: 1.5rem;\n\t\t}\n\t}\n</style>\n",
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\+layout.server.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\+layout.svelte",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\+page.server.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\+page.svelte",
		"messages": [
			{
				"ruleId": "svelte/no-navigation-without-resolve",
				"severity": 1,
				"message": "Unexpected href link without resolve().",
				"line": 110,
				"column": 15,
				"nodeType": null,
				"messageId": "linkWithoutResolve",
				"endLine": 110,
				"endColumn": 21
			},
			{
				"ruleId": "svelte/no-navigation-without-resolve",
				"severity": 1,
				"message": "Unexpected href link without resolve().",
				"line": 111,
				"column": 15,
				"nodeType": null,
				"messageId": "linkWithoutResolve",
				"endLine": 111,
				"endColumn": 24
			},
			{
				"ruleId": "svelte/no-navigation-without-resolve",
				"severity": 1,
				"message": "Unexpected href link without resolve().",
				"line": 115,
				"column": 15,
				"nodeType": null,
				"messageId": "linkWithoutResolve",
				"endLine": 115,
				"endColumn": 21
			},
			{
				"ruleId": "svelte/no-navigation-without-resolve",
				"severity": 1,
				"message": "Unexpected href link without resolve().",
				"line": 145,
				"column": 14,
				"nodeType": null,
				"messageId": "linkWithoutResolve",
				"endLine": 145,
				"endColumn": 23
			},
			{
				"ruleId": "svelte/no-navigation-without-resolve",
				"severity": 1,
				"message": "Unexpected href link without resolve().",
				"line": 160,
				"column": 15,
				"nodeType": null,
				"messageId": "linkWithoutResolve",
				"endLine": 160,
				"endColumn": 24
			},
			{
				"ruleId": "svelte/no-navigation-without-resolve",
				"severity": 1,
				"message": "Unexpected href link without resolve().",
				"line": 319,
				"column": 15,
				"nodeType": null,
				"messageId": "linkWithoutResolve",
				"endLine": 319,
				"endColumn": 24
			},
			{
				"ruleId": "svelte/no-navigation-without-resolve",
				"severity": 1,
				"message": "Unexpected href link without resolve().",
				"line": 343,
				"column": 15,
				"nodeType": null,
				"messageId": "linkWithoutResolve",
				"endLine": 343,
				"endColumn": 24
			},
			{
				"ruleId": "svelte/no-navigation-without-resolve",
				"severity": 1,
				"message": "Unexpected href link without resolve().",
				"line": 358,
				"column": 15,
				"nodeType": null,
				"messageId": "linkWithoutResolve",
				"endLine": 358,
				"endColumn": 24
			},
			{
				"ruleId": "svelte/no-navigation-without-resolve",
				"severity": 1,
				"message": "Unexpected href link without resolve().",
				"line": 392,
				"column": 15,
				"nodeType": null,
				"messageId": "linkWithoutResolve",
				"endLine": 392,
				"endColumn": 21
			},
			{
				"ruleId": "svelte/no-navigation-without-resolve",
				"severity": 1,
				"message": "Unexpected href link without resolve().",
				"line": 393,
				"column": 15,
				"nodeType": null,
				"messageId": "linkWithoutResolve",
				"endLine": 393,
				"endColumn": 23
			},
			{
				"ruleId": "svelte/no-navigation-without-resolve",
				"severity": 1,
				"message": "Unexpected href link without resolve().",
				"line": 394,
				"column": 15,
				"nodeType": null,
				"messageId": "linkWithoutResolve",
				"endLine": 394,
				"endColumn": 20
			},
			{
				"ruleId": "svelte/no-navigation-without-resolve",
				"severity": 1,
				"message": "Unexpected href link without resolve().",
				"line": 399,
				"column": 15,
				"nodeType": null,
				"messageId": "linkWithoutResolve",
				"endLine": 399,
				"endColumn": 23
			},
			{
				"ruleId": "svelte/no-navigation-without-resolve",
				"severity": 1,
				"message": "Unexpected href link without resolve().",
				"line": 400,
				"column": 15,
				"nodeType": null,
				"messageId": "linkWithoutResolve",
				"endLine": 400,
				"endColumn": 21
			}
		],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 13,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"source": "<script lang=\"ts\">\n\tlet isMobileMenuOpen = false;\n\n\tfunction scrollToSection(id: string) {\n\t\tconst element = document.getElementById(id);\n\t\tif (element) {\n\t\t\telement.scrollIntoView({ behavior: 'smooth' });\n\t\t\tisMobileMenuOpen = false;\n\t\t}\n\t}\n\n\tfunction toggleMenu() {\n\t\tisMobileMenuOpen = !isMobileMenuOpen;\n\t}\n</script>\n\n<svelte:head>\n\t<title>Go Route Yourself - Route Planning & Profit Tracking for Drivers</title>\n\t<meta\n\t\tname=\"description\"\n\t\tcontent=\"The easiest way to plan routes, track costs, and maximize profits for delivery drivers and field workers. Free route optimizer and expense tracker.\"\n\t/>\n\t<meta\n\t\tname=\"keywords\"\n\t\tcontent=\"route planner, delivery driver app, profit tracker, mileage tracker, route optimization, field service software\"\n\t/>\n\n\t<link rel=\"canonical\" href=\"https://gorouteyourself.com/\" />\n\n\t<meta property=\"og:type\" content=\"website\" />\n\t<meta property=\"og:url\" content=\"https://gorouteyourself.com/\" />\n\t<meta property=\"og:title\" content=\"Go Route Yourself - Maximize Your Driving Profits\" />\n\t<meta\n\t\tproperty=\"og:description\"\n\t\tcontent=\"Plan optimal routes, track fuel and expenses, and see your true profit per hour. The all-in-one tool for drivers.\"\n\t/>\n\t<meta\n\t\tproperty=\"og:image\"\n\t\tcontent=\"https://gorouteyourself.com/optimized/og-source-1200x630.png\"\n\t/>\n\n\t<meta property=\"twitter:card\" content=\"summary_large_image\" />\n\t<meta property=\"twitter:url\" content=\"https://gorouteyourself.com/\" />\n\t<meta property=\"twitter:title\" content=\"Go Route Yourself - Route Planning & Profit Tracking\" />\n\t<meta\n\t\tproperty=\"twitter:description\"\n\t\tcontent=\"Stop guessing your profits. Track every mile, expense, and earning with Go Route Yourself.\"\n\t/>\n\t<meta\n\t\tproperty=\"twitter:image\"\n\t\tcontent=\"https://gorouteyourself.com/optimized/og-source-1200x630.png\"\n\t/>\n\t<link rel=\"icon\" href=\"/180x75.avif\" sizes=\"180x75\" type=\"image/avif\" />\n\t<link rel=\"apple-touch-icon\" href=\"/180x75.avif\" sizes=\"180x75\" />\n\t<link\n\t\trel=\"preload\"\n\t\thref=\"/180x75.avif\"\n\t\tas=\"image\"\n\t\timagesrcset=\"/180x75.avif 1x, /180x75.avif 2x\"\n\t\timagesizes=\"180px\"\n\t/>\n\n\t<script type=\"application/ld+json\">\n\t\t{\n\t\t\t\"@context\": \"https://schema.org\",\n\t\t\t\"@type\": \"SoftwareApplication\",\n\t\t\t\"name\": \"Go Route Yourself\",\n\t\t\t\"headline\": \"Route Planning & Profit Tracking for Drivers\",\n\t\t\t\"image\": \"https://gorouteyourself.com/180x75.avif\",\n\t\t\t\"applicationCategory\": \"BusinessApplication\",\n\t\t\t\"operatingSystem\": \"Web, Android, iOS\",\n\t\t\t\"offers\": {\n\t\t\t\t\"@type\": \"AggregateOffer\",\n\t\t\t\t\"priceCurrency\": \"USD\",\n\t\t\t\t\"lowPrice\": \"0\",\n\t\t\t\t\"offerCount\": \"2\"\n\t\t\t},\n\t\t\t\"aggregateRating\": {\n\t\t\t\t\"@type\": \"AggregateRating\",\n\t\t\t\t\"ratingValue\": \"4.8\",\n\t\t\t\t\"ratingCount\": \"500\"\n\t\t\t},\n\t\t\t\"featureList\": \"Route Optimization, Profit Tracking, Mileage Tracking, Expense Management, Analytics Dashboard, Tax Reports\"\n\t\t}\n\t</script>\n</svelte:head>\n\n<div class=\"landing\">\n\t<header class=\"header\">\n\t\t<div class=\"container\">\n\t\t\t<div class=\"header-content\">\n\t\t\t\t<picture>\n\t\t\t\t\t<source type=\"image/avif\" srcset=\"/180x75.avif 180w\" sizes=\"64px\" />\n\t\t\t\t\t<source type=\"image/webp\" srcset=\"/180x75.avif 180w\" sizes=\"64px\" />\n\t\t\t\t\t<img\n\t\t\t\t\t\tsrc=\"/180x75.avif\"\n\t\t\t\t\t\talt=\"Go Route Yourself\"\n\t\t\t\t\t\tclass=\"logo logo-full\"\n\t\t\t\t\t\twidth=\"64\"\n\t\t\t\t\t\theight=\"27\"\n\t\t\t\t\t\tsrcset=\"/180x75.avif 1x, /180x75.avif 2x\"\n\t\t\t\t\t\tdecoding=\"async\"\n\t\t\t\t\t/>\n\t\t\t\t</picture>\n\t\t\t\t<nav class=\"nav desktop-nav\">\n\t\t\t\t\t<button on:click={() => scrollToSection('features')}>Features</button>\n\t\t\t\t\t<button on:click={() => scrollToSection('how-it-works')}>How It Works</button>\n\t\t\t\t\t<button on:click={() => scrollToSection('pricing')}>Pricing</button>\n\n\t\t\t\t\t<a href=\"/login\" class=\"btn-login\">Sign In</a>\n\t\t\t\t\t<a href=\"/register\" class=\"btn-primary\">Get Started Free</a>\n\t\t\t\t</nav>\n\n\t\t\t\t<div class=\"mobile-nav-controls\">\n\t\t\t\t\t<a href=\"/login\" class=\"mobile-signin\">Sign In</a>\n\n\t\t\t\t\t<button class=\"hamburger-btn\" on:click={toggleMenu} aria-label=\"Toggle menu\">\n\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\twidth=\"24\"\n\t\t\t\t\t\t\theight=\"24\"\n\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\t\t\t\tfill=\"none\"\n\t\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\t\t\t\tstroke-linejoin=\"round\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{#if isMobileMenuOpen}\n\t\t\t\t\t\t\t\t<path d=\"M18 6L6 18M6 6L18 18\"></path>\n\t\t\t\t\t\t\t{:else}\n\t\t\t\t\t\t\t\t<path d=\"M3 12h18M3 6h18M3 18h18\"></path>\n\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t</svg>\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\n\t\t{#if isMobileMenuOpen}\n\t\t\t<div class=\"mobile-menu\">\n\t\t\t\t<button on:click={() => scrollToSection('features')}>Features</button>\n\t\t\t\t<button on:click={() => scrollToSection('pricing')}>Pricing</button>\n\t\t\t\t<button on:click={() => scrollToSection('how-it-works')}>How It Works</button>\n\t\t\t\t<div class=\"divider\"></div>\n\t\t\t\t<a href=\"/register\" class=\"btn-primary mobile-btn\">Get Started Free</a>\n\t\t\t</div>\n\t\t{/if}\n\t</header>\n\n\t<section class=\"hero\">\n\t\t<div class=\"container\">\n\t\t\t<div class=\"hero-content\">\n\t\t\t\t<h1>Plan Routes. Track Costs. <span class=\"highlight\">Maximize Profits.</span></h1>\n\t\t\t\t<p class=\"hero-subtitle\">\n\t\t\t\t\tThe complete route planning and profit tracking solution for delivery drivers, field\n\t\t\t\t\tworkers, and anyone who gets paid by the route.\n\t\t\t\t</p>\n\n\t\t\t\t<div class=\"hero-buttons\">\n\t\t\t\t\t<a href=\"/register\" class=\"btn-hero-primary\">Start Free Trial</a>\n\t\t\t\t\t<button on:click={() => scrollToSection('how-it-works')} class=\"btn-hero-secondary\">\n\t\t\t\t\t\tLearn More\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\n\t\t\t\t<div class=\"hero-stats\">\n\t\t\t\t\t<div class=\"stat\">\n\t\t\t\t\t\t<div class=\"stat-number\">10K+</div>\n\t\t\t\t\t\t<div class=\"stat-label\">Routes Planned</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"stat\">\n\t\t\t\t\t\t<div class=\"stat-number\">$2M+</div>\n\t\t\t\t\t\t<div class=\"stat-label\">Profit Tracked</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"stat\">\n\t\t\t\t\t\t<div class=\"stat-number\">500+</div>\n\t\t\t\t\t\t<div class=\"stat-label\">Active Drivers</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</section>\n\n\t<section id=\"features\" class=\"features\">\n\t\t<div class=\"container\">\n\t\t\t<h2 class=\"section-title\">Everything You Need to Succeed</h2>\n\t\t\t<p class=\"section-subtitle\">Powerful features designed specifically for drivers</p>\n\n\t\t\t<div class=\"features-grid\">\n\t\t\t\t<div class=\"feature-card orange\">\n\t\t\t\t\t<div class=\"feature-icon\">≡ƒù║∩╕Å</div>\n\t\t\t\t\t<h3>Google Maps Integration</h3>\n\t\t\t\t\t<p>\n\t\t\t\t\t\tPlan optimal routes with real-time traffic data, turn-by-turn directions, and automatic\n\t\t\t\t\t\tmileage calculation.\n\t\t\t\t\t</p>\n\t\t\t\t</div>\n\n\t\t\t\t<div class=\"feature-card blue\">\n\t\t\t\t\t<div class=\"feature-icon\">≡ƒÆ░</div>\n\t\t\t\t\t<h3>Profit Tracking</h3>\n\t\t\t\t\t<p>\n\t\t\t\t\t\tTrack earnings, fuel costs, maintenance, and supplies. See your actual profit per trip\n\t\t\t\t\t\tand per hour worked.\n\t\t\t\t\t</p>\n\t\t\t\t</div>\n\n\t\t\t\t<div class=\"feature-card green\">\n\t\t\t\t\t<div class=\"feature-icon\">∩┐╜</div>\n\t\t\t\t\t<h3>Mileage Tracking</h3>\n\t\t\t\t\t<p>\n\t\t\t\t\t\tAutomatically log every mile driven with GPS precision. IRS-compliant mileage logs for\n\t\t\t\t\t\ttax deductions and reimbursements.\n\t\t\t\t\t</p>\n\t\t\t\t</div>\n\n\t\t\t\t<div class=\"feature-card navy\">\n\t\t\t\t\t<div class=\"feature-icon\">≡ƒôè</div>\n\t\t\t\t\t<h3>Analytics Dashboard</h3>\n\t\t\t\t\t<p>\n\t\t\t\t\t\tBeautiful charts and stats showing trends, costs breakdown, and performance over time.\n\t\t\t\t\t</p>\n\t\t\t\t</div>\n\n\t\t\t\t<div class=\"feature-card purple\">\n\t\t\t\t\t<div class=\"feature-icon\">≡ƒô▒</div>\n\t\t\t\t\t<h3>Mobile Friendly</h3>\n\t\t\t\t\t<p>\n\t\t\t\t\t\tWorks perfectly on your phone, tablet, or computer. Access your routes anywhere,\n\t\t\t\t\t\tanytime.\n\t\t\t\t\t</p>\n\t\t\t\t</div>\n\n\t\t\t\t<div class=\"feature-card orange\">\n\t\t\t\t\t<div class=\"feature-icon\">≡ƒôñ</div>\n\t\t\t\t\t<h3>Export Reports</h3>\n\t\t\t\t\t<p>\n\t\t\t\t\t\tGenerate CSV and PDF reports for taxes, record-keeping, or sharing with your accountant.\n\t\t\t\t\t</p>\n\t\t\t\t</div>\n\n\t\t\t\t<div class=\"feature-card blue\">\n\t\t\t\t\t<div class=\"feature-icon\">≡ƒÆ╛</div>\n\t\t\t\t\t<h3>Cloud Sync</h3>\n\t\t\t\t\t<p>Your data syncs automatically across all devices. Never lose a trip log again.</p>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</section>\n\n\t<section id=\"how-it-works\" class=\"how-it-works\">\n\t\t<div class=\"container\">\n\t\t\t<h2 class=\"section-title\">How It Works</h2>\n\t\t\t<p class=\"section-subtitle\">Start tracking profits in 3 simple steps</p>\n\n\t\t\t<div class=\"steps\">\n\t\t\t\t<div class=\"step\">\n\t\t\t\t\t<div class=\"step-number orange\">1</div>\n\t\t\t\t\t<div class=\"step-content\">\n\t\t\t\t\t\t<h3>Plan Your Route</h3>\n\t\t\t\t\t\t<p>\n\t\t\t\t\t\t\tEnter your starting point and destinations. We'll calculate the optimal route and\n\t\t\t\t\t\t\testimate drive time using Google Maps.\n\t\t\t\t\t\t</p>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<div class=\"step\">\n\t\t\t\t\t<div class=\"step-number blue\">2</div>\n\t\t\t\t\t<div class=\"step-content\">\n\t\t\t\t\t\t<h3>Track Your Costs</h3>\n\t\t\t\t\t\t<p>\n\t\t\t\t\t\t\tAdd earnings per stop, fuel costs, maintenance, and supplies. We automatically\n\t\t\t\t\t\t\tcalculate your profit.\n\t\t\t\t\t\t</p>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<div class=\"step\">\n\t\t\t\t\t<div class=\"step-number green\">3</div>\n\t\t\t\t\t<div class=\"step-content\">\n\t\t\t\t\t\t<h3>View Your Analytics</h3>\n\t\t\t\t\t\t<p>\n\t\t\t\t\t\t\tSee your profit trends, cost breakdowns, and performance metrics. Export reports for\n\t\t\t\t\t\t\ttaxes.\n\t\t\t\t\t\t</p>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</section>\n\n\t<section id=\"pricing\" class=\"pricing\">\n\t\t<div class=\"container\">\n\t\t\t<h2 class=\"section-title\">Simple, Transparent Pricing</h2>\n\t\t\t<p class=\"section-subtitle\">Choose the plan that works for you</p>\n\n\t\t\t<div class=\"pricing-grid\">\n\t\t\t\t<div class=\"pricing-card\">\n\t\t\t\t\t<div class=\"plan-header\">\n\t\t\t\t\t\t<h3>Free</h3>\n\t\t\t\t\t\t<div class=\"price\">\n\t\t\t\t\t\t\t<span class=\"currency\">$</span>\n\t\t\t\t\t\t\t<span class=\"amount\">0</span>\n\t\t\t\t\t\t\t<span class=\"period\">/month</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<ul class=\"features-list\">\n\t\t\t\t\t\t<li>Γ£ô 10 trips per month</li>\n\t\t\t\t\t\t<li>Γ£ô Up to 5 stops per trip</li>\n\t\t\t\t\t\t<li>Γ£ô Google Maps routing</li>\n\t\t\t\t\t\t<li>Γ£ô Profit tracking</li>\n\t\t\t\t\t\t<li>Γ£ô Analytics dashboard</li>\n\t\t\t\t\t\t<li>Γ£ô Export CSV & PDF reports</li>\n\t\t\t\t\t\t<li>Γ£ô Cloud sync</li>\n\t\t\t\t\t</ul>\n\n\t\t\t\t\t<a href=\"/register\" class=\"btn-plan\">Get Started</a>\n\t\t\t\t</div>\n\n\t\t\t\t<div class=\"pricing-card featured\">\n\t\t\t\t\t<div class=\"badge\">Most Popular</div>\n\t\t\t\t\t<div class=\"plan-header\">\n\t\t\t\t\t\t<h3>Pro</h3>\n\t\t\t\t\t\t<div class=\"price\">\n\t\t\t\t\t\t\t<span class=\"currency\">$</span>\n\t\t\t\t\t\t\t<span class=\"amount\">2.99</span>\n\t\t\t\t\t\t\t<span class=\"period\">/month</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<ul class=\"features-list\">\n\t\t\t\t\t\t<li>Γ£ô Unlimited trips</li>\n\t\t\t\t\t\t<li>Γ£ô Unlimited stops per trip</li>\n\t\t\t\t\t\t<li>Γ£ô Google Maps routing</li>\n\t\t\t\t\t\t<li>Γ£ô Profit tracking</li>\n\t\t\t\t\t\t<li>Γ£ô Analytics dashboard</li>\n\t\t\t\t\t\t<li>Γ£ô Export CSV & PDF reports</li>\n\t\t\t\t\t\t<li>Γ£ô Cloud sync</li>\n\t\t\t\t\t</ul>\n\n\t\t\t\t\t<a href=\"/register\" class=\"btn-plan featured\">Start Free Trial</a>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</section>\n\n\t<section class=\"cta\">\n\t\t<div class=\"container\">\n\t\t\t<div class=\"cta-content\">\n\t\t\t\t<h2>Ready to Maximize Your Profits?</h2>\n\t\t\t\t<p>\n\t\t\t\t\tJoin hundreds of drivers who are already tracking their routes and increasing their\n\t\t\t\t\tearnings.\n\t\t\t\t</p>\n\t\t\t\t<div class=\"cta-buttons\">\n\t\t\t\t\t<a href=\"/register\" class=\"btn-cta-primary\">Start Free Trial</a>\n\t\t\t\t\t<span class=\"cta-note\">No credit card required</span>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</section>\n\n\t<footer class=\"footer\">\n\t\t<div class=\"container\">\n\t\t\t<div class=\"footer-content\">\n\t\t\t\t<div class=\"footer-section\">\n\t\t\t\t\t<picture>\n\t\t\t\t\t\t<source type=\"image/avif\" srcset=\"/96x40.avif 96w\" sizes=\"40px\" />\n\t\t\t\t\t\t<source type=\"image/webp\" srcset=\"/96x40.avif 96w\" sizes=\"40px\" />\n\t\t\t\t\t\t<img\n\t\t\t\t\t\t\tsrc=\"/96x40.avif\"\n\t\t\t\t\t\t\talt=\"Go Route Yourself\"\n\t\t\t\t\t\t\tclass=\"footer-logo\"\n\t\t\t\t\t\t\twidth=\"96\"\n\t\t\t\t\t\t\theight=\"40\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</picture>\n\t\t\t\t\t<p>Route planning and profit tracking for drivers.</p>\n\t\t\t\t</div>\n\n\t\t\t\t<div class=\"footer-section\">\n\t\t\t\t\t<h3>Product</h3>\n\t\t\t\t\t<a href=\"#features\">Features</a>\n\t\t\t\t\t<a href=\"#pricing\">Pricing</a>\n\t\t\t\t\t<a href=\"#how-it-works\">How It Works</a>\n\t\t\t\t</div>\n\n\t\t\t\t<div class=\"footer-section\">\n\t\t\t\t\t<h3>Company</h3>\n\t\t\t\t\t<a href=\"/about\">About</a>\n\t\t\t\t\t<a href=\"/contact\">Contact</a>\n\t\t\t\t\t<a href=\"/blog\">Blog</a>\n\t\t\t\t</div>\n\n\t\t\t\t<div class=\"footer-section\">\n\t\t\t\t\t<h3>Legal</h3>\n\t\t\t\t\t<a href=\"/privacy\">Privacy Policy</a>\n\t\t\t\t\t<a href=\"/terms\">Terms of Service</a>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div class=\"footer-bottom\">\n\t\t\t\t<p>&copy; {new Date().getFullYear()} Go Route Yourself. All rights reserved.</p>\n\t\t\t</div>\n\t\t</div>\n\t</footer>\n</div>\n\n<style>\n\t/* Brand Colors */\n\t:root {\n\t\t--orange: #ff7f50;\n\t\t--blue: #29abe2;\n\t\t--navy: #2c4a6e;\n\t\t--green: #8dc63f;\n\t\t--purple: #8b5a9e;\n\t\t--gray-50: #f9fafb;\n\t\t--gray-100: #f3f4f6;\n\t\t--gray-200: #e5e7eb;\n\t\t--gray-500: #6b7280;\n\t\t--gray-600: #4b5563;\n\t\t--gray-900: #111827;\n\t}\n\n\t* {\n\t\tmargin: 0;\n\t\tpadding: 0;\n\t\tbox-sizing: border-box;\n\t}\n\n\t.landing {\n\t\tfont-family:\n\t\t\t-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;\n\t\tline-height: 1.6;\n\t\tcolor: var(--gray-900);\n\t}\n\n\t.container {\n\t\tmax-width: 1200px;\n\t\tmargin: 0 auto;\n\t\tpadding: 0 20px;\n\t}\n\n\t/* Header & Navigation */\n\t.header {\n\t\tposition: fixed;\n\t\ttop: 0;\n\t\tleft: 0;\n\t\tright: 0;\n\t\tbackground: white;\n\t\tborder-bottom: 1px solid var(--gray-100);\n\t\tz-index: 1000;\n\t\tpadding: 16px 0;\n\t}\n\n\t.header-content {\n\t\tdisplay: flex;\n\t\tjustify-content: space-between;\n\t\talign-items: center;\n\t}\n\n\t.logo {\n\t\theight: 100%;\n\t\twidth: 100%;\n\t\tobject-fit: contain;\n\t}\n\n\t.logo-full {\n\t\theight: 100%;\n\t\twidth: 100%;\n\t\tobject-fit: contain;\n\t}\n\n\t/* Desktop Navigation */\n\t.desktop-nav {\n\t\tdisplay: none; /* Changed from flex to none */\n\t\talign-items: center;\n\t\tgap: 24px;\n\t}\n\n\t.desktop-nav button {\n\t\tbackground: none;\n\t\tborder: none;\n\t\tcolor: var(--gray-600);\n\t\tfont-size: 16px;\n\t\tcursor: pointer;\n\t\ttransition: color 0.2s;\n\t}\n\n\t.desktop-nav button:hover {\n\t\tcolor: var(--orange);\n\t}\n\n\t.btn-login {\n\t\tcolor: var(--gray-600);\n\t\ttext-decoration: none;\n\t\tfont-weight: 500;\n\t\tdisplay: inline-flex;\n\t\talign-items: center;\n\t\theight: 44px;\n\t\tpadding: 0 8px;\n\t}\n\n\t.btn-primary {\n\t\tbackground: var(--orange);\n\t\tcolor: white;\n\t\tpadding: 10px 24px;\n\t\tborder-radius: 8px;\n\t\ttext-decoration: none;\n\t\tfont-weight: 600;\n\t\ttransition: transform 0.2s;\n\t}\n\n\t.btn-primary:hover {\n\t\ttransform: translateY(-2px);\n\t}\n\n\t/* Mobile Controls Container (Hidden on Desktop) */\n\t.mobile-nav-controls {\n\t\tdisplay: flex; /* Changed from none to flex */\n\t\talign-items: center;\n\t\tgap: 16px;\n\t}\n\n\t.mobile-signin {\n\t\ttext-decoration: none;\n\t\tcolor: var(--navy);\n\t\tfont-weight: 600;\n\t\tfont-size: 15px;\n\t\tdisplay: inline-flex;\n\t\talign-items: center;\n\t\theight: 44px;\n\t\tpadding: 0 8px;\n\t}\n\n\t.hamburger-btn {\n\t\tbackground: none;\n\t\tborder: none;\n\t\tcursor: pointer;\n\t\tcolor: var(--gray-600);\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tpadding: 4px;\n\t}\n\n\t/* Mobile Dropdown Menu */\n\t.mobile-menu {\n\t\tposition: absolute;\n\t\ttop: 100%;\n\t\tleft: 0;\n\t\twidth: 100%;\n\t\tbackground: white;\n\t\tborder-bottom: 1px solid var(--gray-100);\n\t\tpadding: 16px;\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tgap: 16px;\n\t\tbox-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);\n\t}\n\n\t.mobile-menu button {\n\t\tbackground: none;\n\t\tborder: none;\n\t\ttext-align: left;\n\t\tfont-size: 16px;\n\t\tcolor: var(--gray-600);\n\t\tpadding: 8px 0;\n\t\tcursor: pointer;\n\t\ttext-decoration: none;\n\t}\n\n\t.divider {\n\t\theight: 1px;\n\t\tbackground: var(--gray-100);\n\t\tmargin: 4px 0;\n\t}\n\t.mobile-btn {\n\t\ttext-align: center;\n\t\tdisplay: block;\n\t}\n\n\t/* Hero Section */\n\t.hero {\n\t\t/* Mobile-first padding (reduced top) */\n\t\tpadding: 100px 0 60px;\n\t\tbackground: linear-gradient(135deg, var(--navy) 0%, var(--blue) 100%);\n\t\tcolor: white;\n\t\ttext-align: center;\n\t}\n\n\t.hero h1 {\n\t\t/* Mobile-first font size */\n\t\tfont-size: 36px;\n\t\tfont-weight: 800;\n\t\tmargin-bottom: 24px;\n\t\tline-height: 1.2;\n\t}\n\n\t.highlight {\n\t\tcolor: var(--orange);\n\t}\n\n\t.hero-subtitle {\n\t\tfont-size: 18px;\n\t\t/* Slightly smaller for mobile */\n\t\tmax-width: 700px;\n\t\tmargin: 0 auto 40px;\n\t\topacity: 0.95;\n\t}\n\n\t.hero-buttons {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\t/* Stack buttons on mobile */\n\t\tgap: 16px;\n\t\tjustify-content: center;\n\t\tmargin-bottom: 60px;\n\t}\n\n\t.btn-hero-primary {\n\t\tbackground: var(--orange);\n\t\tcolor: white;\n\t\tpadding: 16px 40px;\n\t\tborder-radius: 12px;\n\t\tfont-size: 18px;\n\t\tfont-weight: 700;\n\t\ttext-decoration: none;\n\t\ttransition: all 0.2s;\n\t}\n\n\t.btn-hero-primary:hover {\n\t\ttransform: translateY(-2px);\n\t\tbox-shadow: 0 8px 24px rgba(255, 127, 80, 0.4);\n\t}\n\n\t.btn-hero-secondary {\n\t\tbackground: transparent;\n\t\tcolor: white;\n\t\tborder: 2px solid white;\n\t\tpadding: 14px 38px;\n\t\tborder-radius: 12px;\n\t\tfont-size: 18px;\n\t\tfont-weight: 700;\n\t\tcursor: pointer;\n\t\ttransition: all 0.2s;\n\t}\n\n\t.btn-hero-secondary:hover {\n\t\tbackground: white;\n\t\tcolor: var(--navy);\n\t}\n\n\t.hero-stats {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\t/* Stack stats on mobile */\n\t\tjustify-content: center;\n\t\tgap: 32px;\n\t}\n\n\t.stat {\n\t\ttext-align: center;\n\t}\n\n\t.stat-number {\n\t\tfont-size: 36px;\n\t\tfont-weight: 800;\n\t\tmargin-bottom: 8px;\n\t\tmin-height: 48px; /* reserve space to avoid layout shifts */\n\t}\n\n\t.stat-label {\n\t\tfont-size: 14px;\n\t\topacity: 0.9;\n\t}\n\n\t/* Features Section */\n\t.features {\n\t\tpadding: 60px 0;\n\t\tbackground: white;\n\t}\n\n\t.section-title {\n\t\tfont-size: 32px;\n\t\t/* Smaller mobile title */\n\t\tfont-weight: 800;\n\t\ttext-align: center;\n\t\tmargin-bottom: 16px;\n\t\tcolor: var(--navy);\n\t}\n\n\t.section-subtitle {\n\t\tfont-size: 18px;\n\t\tcolor: var(--gray-600);\n\t\ttext-align: center;\n\t\tmargin-bottom: 40px;\n\t}\n\n\t.features-grid {\n\t\tdisplay: grid;\n\t\tgrid-template-columns: 1fr;\n\t\t/* 1 column on mobile */\n\t\tgap: 32px;\n\t}\n\n\t.feature-card {\n\t\tpadding: 32px;\n\t\tbackground: white;\n\t\tborder-radius: 16px;\n\t\tborder: 2px solid var(--gray-100);\n\t\ttransition: all 0.3s;\n\t}\n\n\t.feature-card:hover {\n\t\ttransform: translateY(-8px);\n\t\tbox-shadow: 0 12px 40px rgba(0, 0, 0, 0.1);\n\t}\n\n\t.feature-card.orange:hover {\n\t\tborder-color: var(--orange);\n\t}\n\t.feature-card.blue:hover {\n\t\tborder-color: var(--blue);\n\t}\n\t.feature-card.green:hover {\n\t\tborder-color: var(--green);\n\t}\n\t.feature-card.navy:hover {\n\t\tborder-color: var(--navy);\n\t}\n\t.feature-card.purple:hover {\n\t\tborder-color: var(--purple);\n\t}\n\n\t.feature-icon {\n\t\tfont-size: 48px;\n\t\tmargin-bottom: 20px;\n\t}\n\n\t.feature-card h3 {\n\t\tfont-size: 24px;\n\t\tmargin-bottom: 12px;\n\t\tcolor: var(--navy);\n\t}\n\n\t.feature-card p {\n\t\tcolor: var(--gray-600);\n\t\tline-height: 1.7;\n\t}\n\n\t/* How It Works */\n\t.how-it-works {\n\t\tpadding: 60px 0;\n\t\tbackground: var(--gray-50);\n\t}\n\n\t.steps {\n\t\tmax-width: 800px;\n\t\tmargin: 0 auto;\n\t}\n\n\t.step {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\t/* Stack vertical on mobile */\n\t\tgap: 24px;\n\t\tmargin-bottom: 60px;\n\t\talign-items: center;\n\t\t/* Center align items */\n\t\ttext-align: center;\n\t}\n\n\t.step-number {\n\t\twidth: 60px;\n\t\theight: 60px;\n\t\tcolor: white;\n\t\tborder-radius: 50%;\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t\tfont-size: 28px;\n\t\tfont-weight: 800;\n\t\tflex-shrink: 0;\n\t}\n\n\t.step-number.orange {\n\t\tbackground: var(--orange);\n\t}\n\t.step-number.blue {\n\t\tbackground: var(--blue);\n\t}\n\t.step-number.green {\n\t\tbackground: var(--green);\n\t}\n\n\t.step-content h3 {\n\t\tfont-size: 24px;\n\t\tmargin-bottom: 12px;\n\t\tcolor: var(--navy);\n\t}\n\n\t.step-content p {\n\t\tcolor: var(--gray-600);\n\t\tfont-size: 16px;\n\t\tline-height: 1.7;\n\t}\n\n\t/* Pricing Section */\n\t.pricing {\n\t\tpadding: 60px 0;\n\t\tbackground: white;\n\t}\n\n\t.pricing-grid {\n\t\tdisplay: grid;\n\t\tgrid-template-columns: 1fr;\n\t\tgap: 32px;\n\t\tmax-width: 1000px;\n\t\tmargin: 0 auto;\n\t}\n\n\t.pricing-card {\n\t\tbackground: white;\n\t\tborder: 2px solid var(--gray-100);\n\t\tborder-radius: 16px;\n\t\tpadding: 40px;\n\t\tposition: relative;\n\t\ttransition: all 0.3s;\n\t}\n\n\t.pricing-card:hover {\n\t\ttransform: translateY(-8px);\n\t\tbox-shadow: 0 12px 40px rgba(0, 0, 0, 0.1);\n\t}\n\n\t.pricing-card.featured {\n\t\tborder-color: var(--orange);\n\t\tbox-shadow: 0 8px 32px rgba(255, 127, 80, 0.2);\n\t}\n\n\t.badge {\n\t\tposition: absolute;\n\t\ttop: -12px;\n\t\tright: 20px;\n\t\tbackground: var(--orange);\n\t\tcolor: white;\n\t\tpadding: 6px 16px;\n\t\tborder-radius: 20px;\n\t\tfont-size: 12px;\n\t\tfont-weight: 700;\n\t}\n\n\t.plan-header {\n\t\ttext-align: center;\n\t\tmargin-bottom: 32px;\n\t}\n\n\t.plan-header h3 {\n\t\tfont-size: 24px;\n\t\tmargin-bottom: 16px;\n\t\tcolor: var(--navy);\n\t}\n\n\t.price {\n\t\tdisplay: flex;\n\t\talign-items: flex-start;\n\t\tjustify-content: center;\n\t}\n\n\t.currency {\n\t\tfont-size: 24px;\n\t\tfont-weight: 700;\n\t\tcolor: var(--navy);\n\t}\n\n\t.amount {\n\t\tfont-size: 56px;\n\t\tfont-weight: 800;\n\t\tline-height: 1;\n\t\tcolor: var(--navy);\n\t}\n\n\t.period {\n\t\tfont-size: 18px;\n\t\tcolor: var(--gray-600);\n\t\tmargin-left: 4px;\n\t\talign-self: flex-end;\n\t\tmargin-bottom: 8px;\n\t}\n\n\t.features-list {\n\t\tlist-style: none;\n\t\tmargin-bottom: 32px;\n\t}\n\n\t.features-list li {\n\t\tpadding: 12px 0;\n\t\tborder-bottom: 1px solid var(--gray-100);\n\t\tcolor: var(--gray-900);\n\t}\n\n\t.btn-plan {\n\t\tdisplay: block;\n\t\twidth: 100%;\n\t\ttext-align: center;\n\t\tpadding: 14px;\n\t\tbackground: var(--gray-100);\n\t\tcolor: var(--navy);\n\t\tborder-radius: 8px;\n\t\ttext-decoration: none;\n\t\tfont-weight: 600;\n\t\ttransition: all 0.2s;\n\t}\n\n\t.btn-plan:hover {\n\t\tbackground: var(--gray-100);\n\t}\n\n\t.btn-plan.featured {\n\t\tbackground: var(--orange);\n\t\tcolor: white;\n\t}\n\n\t.btn-plan.featured:hover {\n\t\ttransform: translateY(-2px);\n\t}\n\n\t/* CTA Section */\n\t.cta {\n\t\tpadding: 80px 0;\n\t\tbackground: linear-gradient(135deg, var(--orange) 0%, var(--green) 100%);\n\t\tcolor: white;\n\t\ttext-align: center;\n\t}\n\n\t.cta h2 {\n\t\tfont-size: 32px;\n\t\tfont-weight: 800;\n\t\tmargin-bottom: 16px;\n\t}\n\n\t.cta p {\n\t\tfont-size: 18px;\n\t\tmargin-bottom: 40px;\n\t\topacity: 0.95;\n\t}\n\n\t.cta-buttons {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\talign-items: center;\n\t\tgap: 12px;\n\t}\n\n\t.btn-cta-primary {\n\t\tbackground: white;\n\t\tcolor: var(--orange);\n\t\tpadding: 16px 48px;\n\t\tborder-radius: 12px;\n\t\tfont-size: 18px;\n\t\tfont-weight: 700;\n\t\ttext-decoration: none;\n\t\ttransition: all 0.2s;\n\t}\n\n\t.btn-cta-primary:hover {\n\t\ttransform: translateY(-2px);\n\t\tbox-shadow: 0 8px 24px rgba(0, 0, 0, 0.2);\n\t}\n\n\t.cta-note {\n\t\tfont-size: 14px;\n\t\topacity: 0.9;\n\t}\n\n\t/* Footer */\n\t.footer {\n\t\tbackground: var(--gray-50);\n\t\tcolor: var(--gray-900);\n\t\tpadding: 60px 0 20px;\n\t\tborder-top: 1px solid var(--gray-200);\n\t}\n\n\t.footer-content {\n\t\tdisplay: grid;\n\t\tgrid-template-columns: 1fr;\n\t\tgap: 40px;\n\t\tmargin-bottom: 40px;\n\t}\n\n\t.footer-logo {\n\t\theight: 40px;\n\t\tmargin-bottom: 16px;\n\t}\n\n\t.footer-section h3 {\n\t\tmargin-bottom: 16px;\n\t\tfont-size: 16px;\n\t\tcolor: var(--navy);\n\t\tfont-weight: 700;\n\t}\n\n\t.footer-section a {\n\t\tdisplay: block;\n\t\tcolor: var(--gray-600);\n\t\ttext-decoration: none;\n\t\tmargin-bottom: 12px;\n\t\ttransition: color 0.2s;\n\t}\n\n\t.footer-section a:hover {\n\t\tcolor: var(--orange);\n\t}\n\n\t.footer-section p {\n\t\tcolor: var(--gray-600);\n\t}\n\n\t.footer-bottom {\n\t\ttext-align: center;\n\t\tpadding-top: 20px;\n\t\tborder-top: 1px solid var(--gray-200);\n\t\tcolor: var(--gray-500);\n\t}\n\n\t/* --- Desktop Responsive --- */\n\t@media (min-width: 768px) {\n\t\t.desktop-nav {\n\t\t\tdisplay: flex;\n\t\t}\n\n\t\t.mobile-nav-controls {\n\t\t\tdisplay: none;\n\t\t}\n\n\t\t.hero {\n\t\t\tpadding: 140px 0 80px;\n\t\t}\n\n\t\t.hero h1 {\n\t\t\tfont-size: 56px;\n\t\t}\n\n\t\t.hero-subtitle {\n\t\t\tfont-size: 20px;\n\t\t}\n\n\t\t.hero-buttons {\n\t\t\tflex-direction: row;\n\t\t}\n\n\t\t.hero-stats {\n\t\t\tflex-direction: row;\n\t\t\tgap: 80px;\n\t\t}\n\n\t\t.features {\n\t\t\tpadding: 100px 0;\n\t\t}\n\n\t\t.features-grid {\n\t\t\tgrid-template-columns: repeat(auto-fit, minmax(300px, 1fr));\n\t\t}\n\n\t\t.section-title {\n\t\t\tfont-size: 42px;\n\t\t}\n\n\t\t.section-subtitle {\n\t\t\tfont-size: 20px;\n\t\t}\n\n\t\t.how-it-works {\n\t\t\tpadding: 100px 0;\n\t\t}\n\n\t\t.step {\n\t\t\tflex-direction: row;\n\t\t\ttext-align: left;\n\t\t\talign-items: flex-start;\n\t\t}\n\n\t\t.step-content h3 {\n\t\t\tfont-size: 28px;\n\t\t}\n\n\t\t.step-content p {\n\t\t\tfont-size: 18px;\n\t\t}\n\n\t\t.pricing {\n\t\t\tpadding: 100px 0;\n\t\t}\n\n\t\t.pricing-grid {\n\t\t\tgrid-template-columns: repeat(auto-fit, minmax(300px, 1fr));\n\t\t}\n\n\t\t.footer-content {\n\t\t\tgrid-template-columns: 2fr 1fr 1fr 1fr;\n\t\t}\n\t}\n</style>\n",
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\api\\auth\\session\\+server.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\api\\auth\\webauthn\\+server.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\api\\auth\\webauthn\\delete\\+server.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\api\\auth\\webauthn\\delete\\delete.spec.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\api\\auth\\webauthn\\list-for-email\\+server.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\api\\auth\\webauthn\\list\\+server.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\api\\autocomplete\\+server.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\api\\autocomplete\\cache\\+server.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\api\\change-password\\+server.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\api\\cron\\trash-purge.spec.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\api\\cron\\trash-purge\\+server.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\api\\delete-account\\+server.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\api\\directions\\cache\\+server.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\api\\directions\\optimize\\+server.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\api\\expenses\\+server.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\api\\expenses\\[id]\\+server.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\api\\forgot-password\\+page.svelte",
		"messages": [
			{
				"ruleId": "svelte/no-navigation-without-resolve",
				"severity": 1,
				"message": "Unexpected href link without resolve().",
				"line": 42,
				"column": 13,
				"nodeType": null,
				"messageId": "linkWithoutResolve",
				"endLine": 42,
				"endColumn": 19
			}
		],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 1,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"source": "<script lang=\"ts\">\n\tlet email = '';\n\tlet loading = false;\n\tlet message = '';\n\tlet error = '';\n\n\tasync function handleSubmit() {\n\t\tloading = true;\n\t\tmessage = '';\n\t\terror = '';\n\n\t\ttry {\n\t\t\tconst res = await fetch('/api/forgot-password', {\n\t\t\t\tmethod: 'POST',\n\t\t\t\theaders: { 'Content-Type': 'application/json' },\n\t\t\t\tbody: JSON.stringify({ email })\n\t\t\t});\n\n\t\t\tconst data = (await res.json()) as { message?: string };\n\n\t\t\tif (res.ok) {\n\t\t\t\tmessage = 'If an account exists with that email, we have sent a reset link.';\n\t\t\t\temail = ''; // Clear form\n\t\t\t} else {\n\t\t\t\terror = data.message || 'An error occurred.';\n\t\t\t}\n\t\t} catch {\n\t\t\terror = 'Network error. Please try again.';\n\t\t} finally {\n\t\t\tloading = false;\n\t\t}\n\t}\n</script>\n\n<svelte:head>\n\t<title>Forgot Password - Go Route Yourself</title>\n</svelte:head>\n\n<div class=\"auth-page\">\n\t<div class=\"form-container\">\n\t\t<div class=\"form-header\">\n\t\t\t<a href=\"/login\" class=\"back-link\">ΓåÉ Back to Login</a>\n\t\t\t<h1>Reset Password</h1>\n\t\t\t<p>Enter your email to receive a reset link.</p>\n\t\t</div>\n\n\t\t{#if message}\n\t\t\t<div class=\"alert success\">{message}</div>\n\t\t{/if}\n\n\t\t{#if error}\n\t\t\t<div class=\"alert error\">{error}</div>\n\t\t{/if}\n\n\t\t<form on:submit|preventDefault={handleSubmit}>\n\t\t\t<div class=\"field-group\">\n\t\t\t\t<label for=\"email\">Email Address</label>\n\t\t\t\t<input\n\t\t\t\t\ttype=\"email\"\n\t\t\t\t\tid=\"email\"\n\t\t\t\t\tbind:value={email}\n\t\t\t\t\trequired\n\t\t\t\t\tplaceholder=\"Enter your email\"\n\t\t\t\t\tclass=\"input-field\"\n\t\t\t\t/>\n\t\t\t</div>\n\n\t\t\t<button type=\"submit\" class=\"btn-submit\" disabled={loading}>\n\t\t\t\t{loading ? 'Sending...' : 'Send Reset Link'}\n\t\t\t</button>\n\t\t</form>\n\t</div>\n</div>\n\n<style>\n\t/* Reusing similar styles to your login page for consistency */\n\t.auth-page {\n\t\tmin-height: 100vh;\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t\tbackground: #f9fafb;\n\t\tfont-family: 'Inter', sans-serif;\n\t}\n\t.form-container {\n\t\tbackground: white;\n\t\tpadding: 40px;\n\t\tborder-radius: 12px;\n\t\tbox-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);\n\t\twidth: 100%;\n\t\tmax-width: 400px;\n\t}\n\t.form-header {\n\t\tmargin-bottom: 24px;\n\t\ttext-align: center;\n\t}\n\th1 {\n\t\tfont-size: 24px;\n\t\tfont-weight: 700;\n\t\tcolor: #111827;\n\t\tmargin: 10px 0;\n\t}\n\tp {\n\t\tcolor: #6b7280;\n\t\tfont-size: 14px;\n\t}\n\t.back-link {\n\t\tcolor: #ff7f50;\n\t\ttext-decoration: none;\n\t\tfont-size: 14px;\n\t\tfont-weight: 600;\n\t}\n\t.input-field {\n\t\twidth: 100%;\n\t\tpadding: 12px;\n\t\tborder: 2px solid #e5e7eb;\n\t\tborder-radius: 8px;\n\t\tfont-size: 15px;\n\t\tmargin-top: 6px;\n\t}\n\t.field-group {\n\t\tmargin-bottom: 20px;\n\t}\n\t.btn-submit {\n\t\twidth: 100%;\n\t\tpadding: 12px;\n\t\tbackground: #ff7f50;\n\t\tcolor: white;\n\t\tborder: none;\n\t\tborder-radius: 8px;\n\t\tfont-weight: 600;\n\t\tcursor: pointer;\n\t}\n\t.btn-submit:disabled {\n\t\topacity: 0.7;\n\t}\n\t.alert {\n\t\tpadding: 12px;\n\t\tborder-radius: 8px;\n\t\tmargin-bottom: 20px;\n\t\tfont-size: 14px;\n\t}\n\t.alert.success {\n\t\tbackground: #f0fdf4;\n\t\tcolor: #166534;\n\t}\n\t.alert.error {\n\t\tbackground: #fef2f2;\n\t\tcolor: #991b1b;\n\t}\n</style>\n",
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\api\\forgot-password\\+server.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\api\\hughesnet\\+server.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\api\\hughesnet\\archived\\+server.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\api\\hughesnet\\archived\\import\\+server.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\api\\internal\\trip-index\\compute-now\\+server.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\api\\logout\\+server.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\api\\logout\\logout.spec.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\api\\mileage\\+server.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\api\\mileage\\[id]\\+server.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\api\\mileage\\post-validation.spec.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\api\\mileage\\post.spec.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\api\\mileage\\put-validation.spec.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\api\\mileage\\put.spec.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\api\\places\\cache\\+server.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\api\\places\\cache\\cache.spec.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\api\\remove\\+server.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\api\\reset-password\\+page.svelte",
		"messages": [
			{
				"ruleId": "svelte/no-navigation-without-resolve",
				"severity": 1,
				"message": "Unexpected goto() call without resolve().",
				"line": 34,
				"column": 27,
				"nodeType": null,
				"messageId": "gotoWithoutResolve",
				"endLine": 34,
				"endColumn": 35
			},
			{
				"ruleId": "svelte/no-navigation-without-resolve",
				"severity": 1,
				"message": "Unexpected href link without resolve().",
				"line": 54,
				"column": 13,
				"nodeType": null,
				"messageId": "linkWithoutResolve",
				"endLine": 54,
				"endColumn": 29
			}
		],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 2,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"source": "<script lang=\"ts\">\n\timport { page } from '$app/stores';\n\timport { goto } from '$app/navigation';\n\n\tlet password = '';\n\tlet confirmPassword = '';\n\tlet loading = false;\n\tlet error = '';\n\tlet success = false;\n\n\t// Get token from URL\n\t$: token = $page.url.searchParams.get('token');\n\n\tasync function handleReset() {\n\t\tif (password !== confirmPassword) {\n\t\t\terror = 'Passwords do not match';\n\t\t\treturn;\n\t\t}\n\n\t\tloading = true;\n\t\terror = '';\n\n\t\ttry {\n\t\t\tconst res = await fetch('/api/reset-password', {\n\t\t\t\tmethod: 'POST',\n\t\t\t\theaders: { 'Content-Type': 'application/json' },\n\t\t\t\tbody: JSON.stringify({ token, password })\n\t\t\t});\n\n\t\t\tconst data = (await res.json()) as { message?: string };\n\n\t\t\tif (res.ok) {\n\t\t\t\tsuccess = true;\n\t\t\t\tsetTimeout(() => goto('/login'), 3000);\n\t\t\t} else {\n\t\t\t\terror = data.message || 'Failed to reset password.';\n\t\t\t}\n\t\t} catch {\n\t\t\terror = 'Network error occurred.';\n\t\t} finally {\n\t\t\tloading = false;\n\t\t}\n\t}\n</script>\n\n<svelte:head>\n\t<title>Set New Password - Go Route Yourself</title>\n</svelte:head>\n\n<div class=\"auth-page\">\n\t<div class=\"form-container\">\n\t\t{#if !token}\n\t\t\t<div class=\"alert error\">Invalid link. Please request a new password reset.</div>\n\t\t\t<a href=\"/forgot-password\" class=\"back-link\">Go to Forgot Password</a>\n\t\t{:else if success}\n\t\t\t<div class=\"alert success\">\n\t\t\t\t<h3>Success!</h3>\n\t\t\t\t<p>Your password has been reset. Redirecting to login...</p>\n\t\t\t</div>\n\t\t{:else}\n\t\t\t<div class=\"form-header\">\n\t\t\t\t<h1>New Password</h1>\n\t\t\t\t<p>Enter your new secure password.</p>\n\t\t\t</div>\n\n\t\t\t{#if error}\n\t\t\t\t<div class=\"alert error\">{error}</div>\n\t\t\t{/if}\n\n\t\t\t<form on:submit|preventDefault={handleReset}>\n\t\t\t\t<div class=\"field-group\">\n\t\t\t\t\t<label for=\"pass\">New Password</label>\n\t\t\t\t\t<input\n\t\t\t\t\t\ttype=\"password\"\n\t\t\t\t\t\tid=\"pass\"\n\t\t\t\t\t\tbind:value={password}\n\t\t\t\t\t\trequired\n\t\t\t\t\t\tclass=\"input-field\"\n\t\t\t\t\t\tminlength=\"6\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\n\t\t\t\t<div class=\"field-group\">\n\t\t\t\t\t<label for=\"conf\">Confirm Password</label>\n\t\t\t\t\t<input\n\t\t\t\t\t\ttype=\"password\"\n\t\t\t\t\t\tid=\"conf\"\n\t\t\t\t\t\tbind:value={confirmPassword}\n\t\t\t\t\t\trequired\n\t\t\t\t\t\tclass=\"input-field\"\n\t\t\t\t\t\tminlength=\"6\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\n\t\t\t\t<button type=\"submit\" class=\"btn-submit\" disabled={loading}>\n\t\t\t\t\t{loading ? 'Updating...' : 'Set Password'}\n\t\t\t\t</button>\n\t\t\t</form>\n\t\t{/if}\n\t</div>\n</div>\n\n<style>\n\t/* Same styles as above */\n\t.auth-page {\n\t\tmin-height: 100vh;\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t\tbackground: #f9fafb;\n\t\tfont-family: 'Inter', sans-serif;\n\t}\n\t.form-container {\n\t\tbackground: white;\n\t\tpadding: 40px;\n\t\tborder-radius: 12px;\n\t\tbox-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);\n\t\twidth: 100%;\n\t\tmax-width: 400px;\n\t}\n\t.form-header {\n\t\tmargin-bottom: 24px;\n\t\ttext-align: center;\n\t}\n\th1 {\n\t\tfont-size: 24px;\n\t\tfont-weight: 700;\n\t\tcolor: #111827;\n\t\tmargin: 10px 0;\n\t}\n\tp {\n\t\tcolor: #6b7280;\n\t\tfont-size: 14px;\n\t}\n\t.input-field {\n\t\twidth: 100%;\n\t\tpadding: 12px;\n\t\tborder: 2px solid #e5e7eb;\n\t\tborder-radius: 8px;\n\t\tfont-size: 15px;\n\t\tmargin-top: 6px;\n\t}\n\t.field-group {\n\t\tmargin-bottom: 20px;\n\t}\n\t.btn-submit {\n\t\twidth: 100%;\n\t\tpadding: 12px;\n\t\tbackground: #ff7f50;\n\t\tcolor: white;\n\t\tborder: none;\n\t\tborder-radius: 8px;\n\t\tfont-weight: 600;\n\t\tcursor: pointer;\n\t}\n\t.alert {\n\t\tpadding: 12px;\n\t\tborder-radius: 8px;\n\t\tmargin-bottom: 20px;\n\t\tfont-size: 14px;\n\t}\n\t.alert.success {\n\t\tbackground: #f0fdf4;\n\t\tcolor: #166534;\n\t\ttext-align: center;\n\t}\n\t.alert.error {\n\t\tbackground: #fef2f2;\n\t\tcolor: #991b1b;\n\t}\n\t.back-link {\n\t\tdisplay: block;\n\t\ttext-align: center;\n\t\tcolor: #ff7f50;\n\t\tmargin-top: 20px;\n\t\ttext-decoration: none;\n\t}\n</style>\n",
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\api\\reset-password\\+server.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\api\\settings\\+server.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\api\\stripe\\checkout\\+server.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\api\\stripe\\portal\\+server.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\api\\stripe\\webhook\\+server.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\api\\trash\\+server.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\api\\trash\\[id]\\+server.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\api\\trash\\[id]\\permanent-delete.spec.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\api\\trips\\+server.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\api\\trips\\[id]\\+server.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\api\\trips\\reindex\\+server.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\api\\user\\+server.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\api\\verify\\+server.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\api\\verify\\resend\\+server.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\contact\\+page.server.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\contact\\+page.svelte",
		"messages": [
			{
				"ruleId": "svelte/no-navigation-without-resolve",
				"severity": 1,
				"message": "Unexpected href link without resolve().",
				"line": 43,
				"column": 14,
				"nodeType": null,
				"messageId": "linkWithoutResolve",
				"endLine": 43,
				"endColumn": 15
			},
			{
				"ruleId": "svelte/no-navigation-without-resolve",
				"severity": 1,
				"message": "Unexpected href link without resolve().",
				"line": 52,
				"column": 14,
				"nodeType": null,
				"messageId": "linkWithoutResolve",
				"endLine": 52,
				"endColumn": 37
			},
			{
				"ruleId": "svelte/no-navigation-without-resolve",
				"severity": 1,
				"message": "Unexpected href link without resolve().",
				"line": 53,
				"column": 14,
				"nodeType": null,
				"messageId": "linkWithoutResolve",
				"endLine": 53,
				"endColumn": 36
			},
			{
				"ruleId": "svelte/no-navigation-without-resolve",
				"severity": 1,
				"message": "Unexpected href link without resolve().",
				"line": 54,
				"column": 14,
				"nodeType": null,
				"messageId": "linkWithoutResolve",
				"endLine": 54,
				"endColumn": 41
			},
			{
				"ruleId": "svelte/no-navigation-without-resolve",
				"severity": 1,
				"message": "Unexpected href link without resolve().",
				"line": 56,
				"column": 14,
				"nodeType": null,
				"messageId": "linkWithoutResolve",
				"endLine": 56,
				"endColumn": 33
			},
			{
				"ruleId": "svelte/no-navigation-without-resolve",
				"severity": 1,
				"message": "Unexpected href link without resolve().",
				"line": 57,
				"column": 14,
				"nodeType": null,
				"messageId": "linkWithoutResolve",
				"endLine": 57,
				"endColumn": 36
			},
			{
				"ruleId": "svelte/no-navigation-without-resolve",
				"severity": 1,
				"message": "Unexpected href link without resolve().",
				"line": 61,
				"column": 14,
				"nodeType": null,
				"messageId": "linkWithoutResolve",
				"endLine": 61,
				"endColumn": 33
			},
			{
				"ruleId": "svelte/no-navigation-without-resolve",
				"severity": 1,
				"message": "Unexpected href link without resolve().",
				"line": 87,
				"column": 13,
				"nodeType": null,
				"messageId": "linkWithoutResolve",
				"endLine": 87,
				"endColumn": 36
			},
			{
				"ruleId": "svelte/no-navigation-without-resolve",
				"severity": 1,
				"message": "Unexpected href link without resolve().",
				"line": 88,
				"column": 13,
				"nodeType": null,
				"messageId": "linkWithoutResolve",
				"endLine": 88,
				"endColumn": 35
			},
			{
				"ruleId": "svelte/no-navigation-without-resolve",
				"severity": 1,
				"message": "Unexpected href link without resolve().",
				"line": 89,
				"column": 13,
				"nodeType": null,
				"messageId": "linkWithoutResolve",
				"endLine": 89,
				"endColumn": 40
			},
			{
				"ruleId": "svelte/no-navigation-without-resolve",
				"severity": 1,
				"message": "Unexpected href link without resolve().",
				"line": 91,
				"column": 13,
				"nodeType": null,
				"messageId": "linkWithoutResolve",
				"endLine": 91,
				"endColumn": 35
			}
		],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 11,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"source": "<script lang=\"ts\">\n\timport { base } from '$app/paths';\n\tconst resolve = (href: string) => `${base}${href}`;\n\texport let form; // [!code ++]\n\n\tlet isMobileMenuOpen = false;\n\n\tfunction toggleMenu() {\n\t\tisMobileMenuOpen = !isMobileMenuOpen;\n\t}\n</script>\n\n<svelte:head>\n\t<title>Contact Sales - Go Route Yourself</title>\n\t<meta\n\t\tname=\"description\"\n\t\tcontent=\"Contact our sales team for custom route planning solutions. Get a tailored plan for your delivery fleet.\"\n\t/>\n\n\t<meta property=\"og:title\" content=\"Contact Sales - Go Route Yourself\" />\n\t<meta\n\t\tproperty=\"og:description\"\n\t\tcontent=\"Need a custom solution for your drivers? Contact our sales team today.\"\n\t/>\n\t<meta property=\"og:type\" content=\"website\" />\n\t<meta property=\"og:url\" content=\"https://gorouteyourself.com/contact\" />\n\n\t<script type=\"application/ld+json\">\n\t\t{\n\t\t\t\"@context\": \"https://schema.org\",\n\t\t\t\"@type\": \"ContactPage\",\n\t\t\t\"name\": \"Contact Sales\",\n\t\t\t\"description\": \"Get in touch with our sales team for Go Route Yourself business plans.\",\n\t\t\t\"url\": \"https://gorouteyourself.com/contact\"\n\t\t}\n\t</script>\n</svelte:head>\n\n<div class=\"contact-page\">\n\t<header class=\"header\">\n\t\t<div class=\"container\">\n\t\t\t<div class=\"header-content\">\n\t\t\t\t<a href=\"/\" class=\"logo-link\">\n\t\t\t\t\t<picture>\n\t\t\t\t\t\t<source type=\"image/avif\" srcset=\"/180x75.avif 48w, /180x75.avif 120w\" sizes=\"48px\" />\n\t\t\t\t\t\t<source type=\"image/webp\" srcset=\"/180x75.avif 48w, /180x75.avif 120w\" sizes=\"48px\" />\n\t\t\t\t\t\t<img src=\"/180x75.avif\" alt=\"Go Route Yourself\" class=\"logo\" width=\"512\" height=\"512\" />\n\t\t\t\t\t</picture>\n\t\t\t\t</a>\n\n\t\t\t\t<nav class=\"nav desktop-nav\">\n\t\t\t\t\t<a href={resolve('/#features')}>Features</a>\n\t\t\t\t\t<a href={resolve('/#pricing')}>Pricing</a>\n\t\t\t\t\t<a href={resolve('/#how-it-works')}>How It Works</a>\n\n\t\t\t\t\t<a href={resolve('/login')} class=\"btn-login\">Sign In</a>\n\t\t\t\t\t<a href={resolve('/register')} class=\"btn-primary\">Get Started Free</a>\n\t\t\t\t</nav>\n\n\t\t\t\t<div class=\"mobile-nav-controls\">\n\t\t\t\t\t<a href={resolve('/login')} class=\"mobile-signin\">Sign In</a>\n\n\t\t\t\t\t<button class=\"hamburger-btn\" on:click={toggleMenu} aria-label=\"Toggle menu\">\n\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\twidth=\"24\"\n\t\t\t\t\t\t\theight=\"24\"\n\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\t\t\t\tfill=\"none\"\n\t\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\t\t\t\tstroke-linejoin=\"round\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{#if isMobileMenuOpen}\n\t\t\t\t\t\t\t\t<path d=\"M18 6L6 18M6 6L18 18\"></path>\n\t\t\t\t\t\t\t{:else}\n\t\t\t\t\t\t\t\t<path d=\"M3 12h18M3 6h18M3 18h18\"></path>\n\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t</svg>\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\n\t\t{#if isMobileMenuOpen}\n\t\t\t<div class=\"mobile-menu\">\n\t\t\t\t<a href={resolve('/#features')}>Features</a>\n\t\t\t\t<a href={resolve('/#pricing')}>Pricing</a>\n\t\t\t\t<a href={resolve('/#how-it-works')}>How It Works</a>\n\t\t\t\t<div class=\"divider\"></div>\n\t\t\t\t<a href={resolve('/register')} class=\"btn-primary mobile-btn\">Get Started Free</a>\n\t\t\t</div>\n\t\t{/if}\n\t</header>\n\n\t<main class=\"main-content\">\n\t\t<div class=\"container\">\n\t\t\t<div class=\"content-wrapper\">\n\t\t\t\t<div class=\"text-column\">\n\t\t\t\t\t<h1>Contact Sales</h1>\n\t\t\t\t\t<p class=\"subtitle\">\n\t\t\t\t\t\tReady to scale your delivery operations? Let's talk about how Go Route Yourself can help\n\t\t\t\t\t\tyour team save time and maximize profits.\n\t\t\t\t\t</p>\n\n\t\t\t\t\t<div class=\"contact-info\">\n\t\t\t\t\t\t<div class=\"info-item\">\n\t\t\t\t\t\t\t<span class=\"icon\">≡ƒôº</span>\n\t\t\t\t\t\t\t<a href=\"mailto:sales@gorouteyourself.com\">sales@gorouteyourself.com</a>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"info-item\">\n\t\t\t\t\t\t\t<span class=\"icon\">≡ƒÅó</span>\n\t\t\t\t\t\t\t<p>Business Plan Inquiries</p>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<div class=\"form-column\">\n\t\t\t\t\t{#if form?.success}\n\t\t\t\t\t\t<div class=\"success-message\">\n\t\t\t\t\t\t\t<h2>Message Sent! ≡ƒÜÇ</h2>\n\t\t\t\t\t\t\t<p>Thanks for reaching out. Our team will get back to you shortly.</p>\n\t\t\t\t\t\t\t<button class=\"btn-primary\" on:click={() => window.location.reload()}\n\t\t\t\t\t\t\t\t>Send Another</button\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t{:else}\n\t\t\t\t\t\t<form class=\"contact-form\" method=\"POST\">\n\t\t\t\t\t\t\t{#if form?.error}\n\t\t\t\t\t\t\t\t<div class=\"error-banner\">{form.error}</div>\n\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t\t<div class=\"form-group\">\n\t\t\t\t\t\t\t\t<label for=\"name\">Name</label>\n\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\t\tid=\"name\"\n\t\t\t\t\t\t\t\t\tname=\"name\"\n\t\t\t\t\t\t\t\t\trequired\n\t\t\t\t\t\t\t\t\tplaceholder=\"Your name\"\n\t\t\t\t\t\t\t\t\tvalue={form?.name ?? ''}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t<div class=\"form-group\">\n\t\t\t\t\t\t\t\t<label for=\"email\">Work Email</label>\n\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\ttype=\"email\"\n\t\t\t\t\t\t\t\t\tid=\"email\"\n\t\t\t\t\t\t\t\t\tname=\"email\"\n\t\t\t\t\t\t\t\t\trequired\n\t\t\t\t\t\t\t\t\tplaceholder=\"you@company.com\"\n\t\t\t\t\t\t\t\t\tvalue={form?.email ?? ''}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t<div class=\"form-group\">\n\t\t\t\t\t\t\t\t<label for=\"company\">Company Name</label>\n\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\t\tid=\"company\"\n\t\t\t\t\t\t\t\t\tname=\"company\"\n\t\t\t\t\t\t\t\t\tplaceholder=\"Your company\"\n\t\t\t\t\t\t\t\t\tvalue={form?.company ?? ''}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t<div class=\"form-group\">\n\t\t\t\t\t\t\t\t<label for=\"message\">How can we help?</label>\n\t\t\t\t\t\t\t\t<textarea\n\t\t\t\t\t\t\t\t\tid=\"message\"\n\t\t\t\t\t\t\t\t\tname=\"message\"\n\t\t\t\t\t\t\t\t\trows=\"4\"\n\t\t\t\t\t\t\t\t\trequired\n\t\t\t\t\t\t\t\t\tplaceholder=\"Tell us about your team size and needs...\"\n\t\t\t\t\t\t\t\t\t>{form?.message ?? ''}</textarea\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t<button type=\"submit\" class=\"btn-submit\">Send Message</button>\n\t\t\t\t\t\t</form>\n\t\t\t\t\t{/if}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</main>\n</div>\n\n<style>\n\t/* Brand Colors & Variables */\n\t:root {\n\t\t--orange: #ff7f50;\n\t\t--blue: #29abe2;\n\t\t--navy: #2c4a6e;\n\t\t--gray-100: #f3f4f6;\n\t\t--gray-600: #4b5563;\n\t\t--gray-900: #111827;\n\t}\n\n\t* {\n\t\tbox-sizing: border-box;\n\t}\n\n\t/* Page Wrapper */\n\t.contact-page {\n\t\tfont-family:\n\t\t\t-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;\n\t\tcolor: var(--gray-900);\n\t\tbackground: white;\n\t\t/* Ensure it covers the full height and sits above the layout background */\n\t\tmin-height: 100vh;\n\t\tpadding-top: 80px; /* Space for fixed header */\n\t}\n\n\t.container {\n\t\tmax-width: 1200px;\n\t\tmargin: 0 auto;\n\t\tpadding: 0 20px;\n\t}\n\n\t/* Header Styles (Consistent with Landing) */\n\t.header {\n\t\tposition: fixed;\n\t\ttop: 0;\n\t\tleft: 0;\n\t\tright: 0;\n\t\tbackground: white;\n\t\tborder-bottom: 1px solid var(--gray-100);\n\t\tz-index: 1000;\n\t\tpadding: 16px 0;\n\t}\n\n\t.header-content {\n\t\tdisplay: flex;\n\t\tjustify-content: space-between;\n\t\talign-items: center;\n\t}\n\n\t.logo {\n\t\theight: 50px;\n\t\twidth: auto;\n\t}\n\n\t.desktop-nav {\n\t\tdisplay: none;\n\t\talign-items: center;\n\t\tgap: 24px;\n\t}\n\t.desktop-nav a {\n\t\ttext-decoration: none;\n\t\tcolor: var(--gray-600);\n\t\tfont-size: 16px;\n\t\tfont-weight: 500;\n\t\ttransition: color 0.2s;\n\t\tbackground: none;\n\t\tborder: none;\n\t\tcursor: pointer;\n\t}\n\t.desktop-nav a:hover {\n\t\tcolor: var(--orange);\n\t}\n\n\t.btn-login {\n\t\tcolor: var(--gray-600);\n\t\tfont-weight: 500;\n\t}\n\t.btn-primary {\n\t\tbackground: var(--orange);\n\t\tcolor: white !important;\n\t\tpadding: 10px 24px;\n\t\tborder-radius: 8px;\n\t\tfont-weight: 600;\n\t}\n\t.btn-primary:hover {\n\t\ttransform: translateY(-2px);\n\t}\n\n\t.mobile-nav-controls {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tgap: 16px;\n\t}\n\t.mobile-signin {\n\t\ttext-decoration: none;\n\t\tcolor: var(--navy);\n\t\tfont-weight: 600;\n\t\tfont-size: 15px;\n\t}\n\t.hamburger-btn {\n\t\tbackground: none;\n\t\tborder: none;\n\t\tcursor: pointer;\n\t\tcolor: var(--gray-600);\n\t\tpadding: 4px;\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t}\n\n\t.mobile-menu {\n\t\tposition: absolute;\n\t\ttop: 100%;\n\t\tleft: 0;\n\t\twidth: 100%;\n\t\tbackground: white;\n\t\tborder-bottom: 1px solid var(--gray-100);\n\t\tpadding: 16px;\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tgap: 16px;\n\t\tbox-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);\n\t}\n\t.mobile-menu a {\n\t\ttext-decoration: none;\n\t\tcolor: var(--gray-600);\n\t\tfont-size: 16px;\n\t}\n\t.divider {\n\t\theight: 1px;\n\t\tbackground: var(--gray-100);\n\t\tmargin: 4px 0;\n\t}\n\t.mobile-btn {\n\t\ttext-align: center;\n\t\tdisplay: block;\n\t}\n\n\t/* Content Area */\n\t.main-content {\n\t\tpadding: 60px 0;\n\t}\n\n\t.content-wrapper {\n\t\tdisplay: grid;\n\t\tgrid-template-columns: 1fr;\n\t\tgap: 40px;\n\t}\n\n\th1 {\n\t\tfont-size: 36px;\n\t\tfont-weight: 800;\n\t\tcolor: var(--navy);\n\t\tmargin-bottom: 16px;\n\t\tline-height: 1.2;\n\t}\n\t.subtitle {\n\t\tfont-size: 18px;\n\t\tcolor: var(--gray-600);\n\t\tmargin-bottom: 32px;\n\t\tline-height: 1.6;\n\t}\n\n\t.contact-info {\n\t\tmargin-bottom: 32px;\n\t}\n\t.info-item {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tgap: 12px;\n\t\tmargin-bottom: 16px;\n\t\tfont-size: 18px;\n\t\tcolor: var(--gray-600);\n\t}\n\t.info-item a {\n\t\tcolor: var(--blue);\n\t\ttext-decoration: none;\n\t\tfont-weight: 500;\n\t}\n\t.info-item .icon {\n\t\tfont-size: 24px;\n\t}\n\n\t/* Form Styles */\n\t.contact-form {\n\t\tbackground: var(--gray-100);\n\t\tpadding: 32px;\n\t\tborder-radius: 16px;\n\t}\n\n\t.form-group {\n\t\tmargin-bottom: 20px;\n\t}\n\tlabel {\n\t\tdisplay: block;\n\t\tmargin-bottom: 8px;\n\t\tfont-weight: 600;\n\t\tcolor: var(--navy);\n\t}\n\n\tinput,\n\ttextarea {\n\t\twidth: 100%;\n\t\tpadding: 12px;\n\t\tborder: 1px solid #e5e7eb;\n\t\tborder-radius: 8px;\n\t\tfont-size: 16px;\n\t\tfont-family: inherit;\n\t}\n\n\tinput:focus,\n\ttextarea:focus {\n\t\toutline: 2px solid var(--blue);\n\t\tborder-color: transparent;\n\t}\n\n\t.btn-submit {\n\t\twidth: 100%;\n\t\tbackground: var(--navy);\n\t\tcolor: white;\n\t\tpadding: 14px;\n\t\tborder: none;\n\t\tborder-radius: 8px;\n\t\tfont-size: 16px;\n\t\tfont-weight: 700;\n\t\tcursor: pointer;\n\t\ttransition: background 0.2s;\n\t}\n\t.btn-submit:hover {\n\t\tbackground: var(--blue);\n\t}\n\n\t/* New Success/Error Styles */\n\t.success-message {\n\t\tbackground: var(--gray-100);\n\t\tpadding: 32px;\n\t\tborder-radius: 16px;\n\t\ttext-align: center;\n\t}\n\t.success-message h2 {\n\t\tcolor: var(--navy);\n\t\tmargin-bottom: 16px;\n\t}\n\t.success-message p {\n\t\tcolor: var(--gray-600);\n\t\tmargin-bottom: 24px;\n\t\tfont-size: 18px;\n\t}\n\t.error-banner {\n\t\tbackground: #fee2e2;\n\t\tcolor: #991b1b;\n\t\tpadding: 12px;\n\t\tborder-radius: 8px;\n\t\tmargin-bottom: 20px;\n\t\tfont-weight: 500;\n\t\tborder: 1px solid #fecaca;\n\t}\n\n\t@media (min-width: 768px) {\n\t\t.desktop-nav {\n\t\t\tdisplay: flex;\n\t\t}\n\t\t.mobile-nav-controls {\n\t\t\tdisplay: none;\n\t\t}\n\n\t\t.main-content {\n\t\t\tpadding: 100px 0;\n\t\t}\n\t\t.content-wrapper {\n\t\t\tgrid-template-columns: 1fr 1fr;\n\t\t\tgap: 80px;\n\t\t\talign-items: start;\n\t\t}\n\t\th1 {\n\t\t\tfont-size: 48px;\n\t\t}\n\t}\n</style>\n",
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\dashboard\\+layout.server.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\dashboard\\+layout.svelte",
		"messages": [
			{
				"ruleId": "svelte/no-navigation-without-resolve",
				"severity": 1,
				"message": "Unexpected goto() call without resolve().",
				"line": 42,
				"column": 8,
				"nodeType": null,
				"messageId": "gotoWithoutResolve",
				"endLine": 42,
				"endColumn": 21
			},
			{
				"ruleId": "svelte/no-navigation-without-resolve",
				"severity": 1,
				"message": "Unexpected goto() call without resolve().",
				"line": 52,
				"column": 9,
				"nodeType": null,
				"messageId": "gotoWithoutResolve",
				"endLine": 52,
				"endColumn": 17
			},
			{
				"ruleId": "svelte/no-navigation-without-resolve",
				"severity": 1,
				"message": "Unexpected href link without resolve().",
				"line": 235,
				"column": 11,
				"nodeType": null,
				"messageId": "linkWithoutResolve",
				"endLine": 235,
				"endColumn": 44
			},
			{
				"ruleId": "svelte/no-navigation-without-resolve",
				"severity": 1,
				"message": "Unexpected href link without resolve().",
				"line": 281,
				"column": 11,
				"nodeType": null,
				"messageId": "linkWithoutResolve",
				"endLine": 281,
				"endColumn": 22
			},
			{
				"ruleId": "svelte/no-navigation-without-resolve",
				"severity": 1,
				"message": "Unexpected href link without resolve().",
				"line": 297,
				"column": 11,
				"nodeType": null,
				"messageId": "linkWithoutResolve",
				"endLine": 297,
				"endColumn": 22
			},
			{
				"ruleId": "svelte/no-navigation-without-resolve",
				"severity": 1,
				"message": "Unexpected href link without resolve().",
				"line": 313,
				"column": 11,
				"nodeType": null,
				"messageId": "linkWithoutResolve",
				"endLine": 313,
				"endColumn": 44
			},
			{
				"ruleId": "svelte/no-navigation-without-resolve",
				"severity": 1,
				"message": "Unexpected href link without resolve().",
				"line": 359,
				"column": 10,
				"nodeType": null,
				"messageId": "linkWithoutResolve",
				"endLine": 359,
				"endColumn": 30
			}
		],
		"suppressedMessages": [
			{
				"ruleId": "svelte/no-at-html-tags",
				"severity": 2,
				"message": "`{@html}` can lead to XSS attack.",
				"line": 288,
				"column": 29,
				"nodeType": "SvelteMustacheTag",
				"messageId": "unexpected",
				"endLine": 288,
				"endColumn": 46,
				"suppressions": [{ "kind": "directive", "justification": "" }]
			},
			{
				"ruleId": "svelte/no-at-html-tags",
				"severity": 2,
				"message": "`{@html}` can lead to XSS attack.",
				"line": 304,
				"column": 29,
				"nodeType": "SvelteMustacheTag",
				"messageId": "unexpected",
				"endLine": 304,
				"endColumn": 46,
				"suppressions": [{ "kind": "directive", "justification": "" }]
			},
			{
				"ruleId": "svelte/no-at-html-tags",
				"severity": 2,
				"message": "`{@html}` can lead to XSS attack.",
				"line": 366,
				"column": 35,
				"nodeType": "SvelteMustacheTag",
				"messageId": "unexpected",
				"endLine": 366,
				"endColumn": 52,
				"suppressions": [{ "kind": "directive", "justification": "" }]
			}
		],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 7,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"source": "<!-- eslint-disable svelte/no-at-html-tags -->\n<!-- Sanitized static SVG icons (created using sanitizeStaticSvg). See SECURITY.md for rationale. -->\n<script lang=\"ts\">\n\t/* eslint-disable svelte/no-at-html-tags */\n\t// Sanitized static SVG icons (created using sanitizeStaticSvg). See SECURITY.md for rationale.\n\timport { onMount } from 'svelte';\n\timport { page } from '$app/stores';\n\timport { auth, user } from '$lib/stores/auth';\n\timport { goto } from '$app/navigation';\n\timport { base } from '$app/paths';\n\timport { trips } from '$lib/stores/trips';\n\timport { expenses } from '$lib/stores/expenses';\n\timport { mileage } from '$lib/stores/mileage';\n\timport { sanitizeStaticSvg } from '$lib/utils/sanitize';\n\timport { csrfFetch } from '$lib/utils/csrf';\n\n\tconst resolve = (href: string) => `${base}${href}`;\n\timport { trash } from '$lib/stores/trash';\n\timport { syncManager } from '$lib/sync/syncManager';\n\timport SyncIndicator from '$lib/components/SyncIndicator.svelte';\n\timport type { LayoutData } from './$types';\n\n\texport let data: LayoutData;\n\t$: if (data?.user) {\n\t\tauth.hydrate(data.user);\n\t}\n\n\tlet sidebarOpen = false;\n\n\tfunction closeSidebar() {\n\t\tsidebarOpen = false;\n\t}\n\n\tfunction handleOverlayKeydown(e: KeyboardEvent) {\n\t\tif (e.key === 'Escape') closeSidebar();\n\t}\n\n\t// Helper to force client-side navigation using goto\n\tfunction handleNav(e: MouseEvent, href: string) {\n\t\te.preventDefault();\n\t\tcloseSidebar();\n\t\tgoto(resolve(href));\n\t}\n\n\tasync function handleLogout() {\n\t\tif (confirm('Are you sure you want to logout?')) {\n\t\t\tawait csrfFetch('/api/logout', { method: 'POST' });\n\t\t\tauth.logout();\n\t\t\ttrips.clear();\n\t\t\texpenses.clear();\n\t\t\ttrash.clear();\n\t\t\tgoto('/login');\n\t\t}\n\t}\n\n\t// [!code fix] SECURITY (Issue #7, #43): Sanitize static SVG icons in navigation\n\tconst navItems = [\n\t\t{\n\t\t\thref: '/dashboard/',\n\t\t\ticon: sanitizeStaticSvg(\n\t\t\t\t`<svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\"><path d=\"M3 9L10 2L17 9V17C17 17.5304 16.7893 18.0391 16.4142 18.4142C16.0391 18.7893 15.5304 18 15 18H5C4.46957 18 3.96086 17.7893 3.58579 17.4142C3.21071 17.0391 3 16.5304 3 16V9Z\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"/></svg>`\n\t\t\t),\n\t\t\tlabel: 'Home',\n\t\t\texact: true\n\t\t},\n\t\t{\n\t\t\thref: '/dashboard/expenses/',\n\t\t\ticon: sanitizeStaticSvg(\n\t\t\t\t`<svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\"><path d=\"M12 1V23\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\"/><path d=\"M17 5H9.5C8.57174 5 7.6815 5.36875 7.02513 6.02513C6.36875 6.6815 6 7.57174 6 8.5C6 9.42826 6.36875 10.3185 7.02513 10.9749C7.6815 11.6313 8.57174 12 9.5 12H14.5C15.4283 12 16.3185 12.3688 16.9749 13.0251C17.6313 13.6815 18 14.5717 18 15.5C18 16.4283 17.6313 17.3185 16.9749 17.9749C16.3185 18.6313 15.4283 19 14.5 19H6\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"/></svg>`\n\t\t\t),\n\t\t\tlabel: 'Expenses'\n\t\t},\n\t\t{\n\t\t\thref: '/dashboard/mileage/',\n\t\t\ticon: sanitizeStaticSvg(\n\t\t\t\t`<svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\">\n\t\t\t\t\t<path d=\"M3 11h18v3a2 2 0 0 1-2 2h-1.5a2 2 0 0 1-4 0H11.5a2 2 0 0 1-4 0H6a2 2 0 0 1-2-2v-3z\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"/>\n\t\t\t\t\t<path d=\"M5 11L7 6h10l2 5\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"/>\n\t\t\t\t\t<circle cx=\"7.5\" cy=\"17.5\" r=\"1.5\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"/>\n\t\t\t\t\t<circle cx=\"16.5\" cy=\"17.5\" r=\"1.5\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"/>\n\t\t\t\t</svg>`\n\t\t\t),\n\t\t\tlabel: 'Mileage'\n\t\t},\n\t\t{\n\t\t\thref: '/dashboard/trips/',\n\t\t\ticon: sanitizeStaticSvg(\n\t\t\t\t`<svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\">\n\t\t\t\t<path d=\"M12 2C8.13 2 5 5.13 5 9c0 5 7 11 7 11s7-6 7-11c0-3.87-3.13-7-7-7z\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"/>\n\t\t\t\t<circle cx=\"12\" cy=\"9\" r=\"2.5\" stroke=\"currentColor\" stroke-width=\"2\"/>\n\t\t\t\t<path d=\"M3 12c4-2 6 1 9-1s6 0 9 1\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-dasharray=\"3 3\"/>\n\t\t\t</svg>`\n\t\t\t),\n\t\t\tlabel: 'Trips',\n\t\t\texclude: ['/dashboard/trips/new']\n\t\t}\n\t];\n\n\t// Hamburger menu items (Data Management, Settings)\n\tconst hamburgerItems = [\n\t\t{\n\t\t\thref: '/dashboard/data-management/',\n\t\t\ticon: sanitizeStaticSvg(\n\t\t\t\t`<svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\"><path d=\"M21 15V19C21 19.5304 20.7893 20.0391 20.4142 20.4142C20.0391 20.7893 19.5304 21 19 21H5C4.46957 21 3.96086 20.7893 3.58579 20.4142C3.21071 20.0391 3 19.5304 3 19V15\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"/><path d=\"M7 10L12 15L17 10\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"/><path d=\"M12 15V3\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"/></svg>`\n\t\t\t),\n\t\t\tlabel: 'Data Management'\n\t\t},\n\t\t{\n\t\t\thref: '/dashboard/settings/',\n\t\t\ticon: sanitizeStaticSvg(\n\t\t\t\t`<svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\"><path d=\"M12 15C13.6569 15 15 13.6569 15 12C15 10.3431 13.6569 9 12 9C10.3431 9 9 10.3431 9 12C9 13.6569 10.3431 15 12 15Z\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"/><path d=\"M19.4 15C20.4 14.3 21 13.2 21 12C21 10.8 20.4 9.7 19.4 9L20 8C20.5 7.2 20.2 6.1 19.4 5.6L18.4 5C17.6 4.5 16.6 4.8 16.1 5.6L15.5 6.6C14.5 5.9 13.3 5.5 12 5.5C10.7 5.5 9.5 5.9 8.5 6.6L7.9 5.6C7.4 4.8 6.4 4.5 5.6 5L4.6 5.6C3.8 6.1 3.5 7.2 4 8L4.6 9C3.6 9.7 3 10.8 3 12C3 13.2 3.6 14.3 4.6 15L4 16C3.5 16.8 3.8 17.9 4.6 18.4L5.6 19C6.4 19.5 7.4 19.2 7.9 18.4L8.5 17.4C9.5 18.1 10.7 18.5 12 18.5C13.3 18.5 14.5 18.1 15.5 17.4L16.1 18.4C16.6 19.2 17.6 19.5 18.4 19L19.4 18.4C20.2 17.9 20.5 16.8 20 16L19.4 15Z\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"/></svg>`\n\t\t\t),\n\t\t\tlabel: 'Settings'\n\t\t}\n\t];\n\n\t// [!code fix] UPDATED: Now accepts currentPath argument for guaranteed reactivity\n\tfunction isActive(\n\t\thref: string,\n\t\tcurrentPath: string,\n\t\texact = false,\n\t\texclude: string[] = []\n\t): boolean {\n\t\t// Normalize both to ensure trailing slash consistency\n\t\tconst path = currentPath.endsWith('/') ? currentPath : currentPath + '/';\n\t\tconst link = href.endsWith('/') ? href : href + '/';\n\n\t\tif (exclude.length > 0) {\n\t\t\tif (exclude.some((e) => path.startsWith(e))) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\tif (exact) {\n\t\t\treturn path === link;\n\t\t}\n\n\t\treturn path.startsWith(link);\n\t}\n\n\tfunction getInitial(name: string): string {\n\t\treturn name ? name.charAt(0).toUpperCase() : 'U';\n\t}\n\n\tonMount(async () => {\n\t\tconsole.log('[DASHBOARD LAYOUT] Initializing...');\n\n\t\tconst apiKey = data.googleMapsApiKey;\n\n\t\tlet userId = (data?.user as any)?.id || $user?.id;\n\n\t\tif (!userId) {\n\t\t\tuserId = localStorage.getItem('offline_user_id');\n\t\t\tif (userId) {\n\t\t\t\tconsole.log('[DASHBOARD LAYOUT] Using Offline ID:', userId);\n\t\t\t}\n\t\t}\n\n\t\tif (userId) {\n\t\t\t// Defer heavy initialization until after first paint so the LCP can render quickly\n\t\t\tawait new Promise((resolve) => requestAnimationFrame(() => resolve(undefined)));\n\n\t\t\tconst doInit = async () => {\n\t\t\t\ttry {\n\t\t\t\t\tconsole.log('[DASHBOARD LAYOUT] Loading data for:', userId);\n\n\t\t\t\t\tawait syncManager.initialize(apiKey);\n\n\t\t\t\t\t// Kick off loads without awaiting them so we don't block initial paint\n\t\t\t\t\ttrips.load(userId);\n\t\t\t\t\texpenses.load(userId);\n\t\t\t\t\tmileage.load(userId);\n\t\t\t\t\ttrash.load(userId);\n\n\t\t\t\t\t// Background syncs\n\t\t\t\t\ttrips.syncFromCloud(userId);\n\t\t\t\t\texpenses.syncFromCloud(userId);\n\t\t\t\t\tmileage.syncFromCloud(userId);\n\t\t\t\t} catch (err) {\n\t\t\t\t\tconsole.error('[DASHBOARD LAYOUT] Γ¥î Failed to start data load:', err);\n\t\t\t\t}\n\t\t\t};\n\n\t\t\t// Prefer requestIdleCallback when available to do non-critical work\n\t\t\tif (typeof window !== 'undefined' && 'requestIdleCallback' in window) {\n\t\t\t\t(requestIdleCallback as any)(() => doInit().catch(console.error));\n\t\t\t} else {\n\t\t\t\tsetTimeout(() => doInit().catch(console.error), 0);\n\t\t\t}\n\t\t} else {\n\t\t\tawait auth.init();\n\t\t}\n\t});\n</script>\n\n<svelte:head>\n\t<link rel=\"preconnect\" href=\"https://fonts.googleapis.com\" />\n\t<link rel=\"preconnect\" href=\"https://fonts.gstatic.com\" crossorigin=\"anonymous\" />\n\t<link\n\t\thref=\"https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap\"\n\t\trel=\"stylesheet\"\n\t/>\n\t<!-- Preload the dashboard mobile logo to improve LCP discoverability and priority -->\n\t<link\n\t\trel=\"preload\"\n\t\thref=\"/180x75.avif\"\n\t\tas=\"image\"\n\t\ttype=\"image/avif\"\n\t\timagesrcset=\"/180x75.avif 48w, /180x75.avif 120w\"\n\t\timagesizes=\"40px\"\n\t\tfetchpriority=\"high\"\n\t/>\n</svelte:head>\n\n<div class=\"layout\">\n\t<header class=\"mobile-header\">\n\t\t<picture>\n\t\t\t<source type=\"image/avif\" srcset=\"/180x75.avif 48w, /180x75.avif 120w\" sizes=\"40px\" />\n\t\t\t<source type=\"image/webp\" srcset=\"/180x75.avif 48w, /180x75.avif 120w\" sizes=\"40px\" />\n\t\t\t<img\n\t\t\t\tsrc=\"/180x75.avif\"\n\t\t\t\talt=\"Go Route Yourself\"\n\t\t\t\tclass=\"mobile-logo\"\n\t\t\t\twidth=\"48\"\n\t\t\t\theight=\"48\"\n\t\t\t\tdecoding=\"async\"\n\t\t\t\tloading=\"eager\"\n\t\t\t\tfetchpriority=\"high\"\n\t\t\t/>\n\t\t</picture>\n\t\t<div class=\"mobile-actions\">\n\t\t\t<SyncIndicator />\n\t\t\t{#if $user}\n\t\t\t\t<a\n\t\t\t\t\thref={resolve('/dashboard/settings/')}\n\t\t\t\t\tclass=\"mobile-user\"\n\t\t\t\t\taria-label=\"Profile Settings\"\n\t\t\t\t\ton:click={(e) => handleNav(e, '/dashboard/settings/')}\n\t\t\t\t>\n\t\t\t\t\t<div class=\"user-avatar small\">\n\t\t\t\t\t\t{getInitial($user.name || $user.email || '')}\n\t\t\t\t\t</div>\n\t\t\t\t</a>\n\t\t\t{/if}\n\t\t</div>\n\t</header>\n\n\t<aside class=\"sidebar\" class:open={sidebarOpen}>\n\t\t<div class=\"sidebar-header\">\n\t\t\t<img\n\t\t\t\tsrc=\"/180x75.avif\"\n\t\t\t\talt=\"Go Route Yourself\"\n\t\t\t\tclass=\"sidebar-logo\"\n\t\t\t\twidth=\"64\"\n\t\t\t\theight=\"64\"\n\t\t\t\tdecoding=\"async\"\n\t\t\t\tloading=\"eager\"\n\t\t\t\tfetchpriority=\"high\"\n\t\t\t\tstyle=\"width:64px; height:64px; object-fit:contain;\"\n\t\t\t/>\n\n\t\t\t<button class=\"close-btn\" on:click={closeSidebar} aria-label=\"Close menu\">\n\t\t\t\t<svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\">\n\t\t\t\t\t<path\n\t\t\t\t\t\td=\"M18 6L6 18M6 6L18 18\"\n\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\t\t/>\n\t\t\t\t</svg>\n\t\t\t</button>\n\t\t</div>\n\n\t\t<div class=\"sidebar-sync\">\n\t\t\t<SyncIndicator />\n\t\t</div>\n\n\t\t<nav class=\"nav\">\n\t\t\t{#each navItems as item (item.href)}\n\t\t\t\t<a\n\t\t\t\t\thref={item.href}\n\t\t\t\t\tclass=\"nav-item\"\n\t\t\t\t\tclass:active={isActive(item.href, $page.url.pathname, item.exact, item.exclude)}\n\t\t\t\t\ton:click={(e) => handleNav(e, item.href)}\n\t\t\t\t>\n\t\t\t\t\t<!-- eslint-disable-next-line svelte/no-at-html-tags -->\n\t\t\t\t\t<!-- Sanitized static SVG inserted via sanitizeStaticSvg -->\n\t\t\t\t\t<span class=\"nav-icon\">{@html item.icon}</span>\n\t\t\t\t\t<span class=\"nav-label\">{item.label}</span>\n\t\t\t\t</a>\n\t\t\t{/each}\n\n\t\t\t<div class=\"nav-divider\"></div>\n\n\t\t\t{#each hamburgerItems as item (item.href)}\n\t\t\t\t<a\n\t\t\t\t\thref={item.href}\n\t\t\t\t\tclass=\"nav-item\"\n\t\t\t\t\tclass:active={isActive(item.href, $page.url.pathname)}\n\t\t\t\t\ton:click={(e) => handleNav(e, item.href)}\n\t\t\t\t>\n\t\t\t\t\t<!-- eslint-disable-next-line svelte/no-at-html-tags -->\n\t\t\t\t\t<!-- Sanitized static SVG inserted via sanitizeStaticSvg -->\n\t\t\t\t\t<span class=\"nav-icon\">{@html item.icon}</span>\n\t\t\t\t\t<span class=\"nav-label\">{item.label}</span>\n\t\t\t\t</a>\n\t\t\t{/each}\n\t\t</nav>\n\n\t\t<div class=\"sidebar-footer\">\n\t\t\t{#if $user}\n\t\t\t\t<a\n\t\t\t\t\thref={resolve('/dashboard/settings/')}\n\t\t\t\t\tclass=\"user-card\"\n\t\t\t\t\ton:click={(e) => handleNav(e, '/dashboard/settings/')}\n\t\t\t\t>\n\t\t\t\t\t<div class=\"user-avatar\">\n\t\t\t\t\t\t{getInitial($user.name || $user.email || '')}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"user-info\">\n\t\t\t\t\t\t<div class=\"user-name\">{$user.name || 'User'}</div>\n\t\t\t\t\t\t<div class=\"user-plan\">{$user.plan || 'Free'} Plan</div>\n\t\t\t\t\t</div>\n\t\t\t\t</a>\n\n\t\t\t\t<button class=\"logout-btn\" on:click={handleLogout}>\n\t\t\t\t\t<svg width=\"20\" height=\"20\" viewBox=\"0 0 20 20\" fill=\"none\">\n\t\t\t\t\t\t<path\n\t\t\t\t\t\t\td=\"M7 17H3C2.46957 17 1.96086 16.7893 1.58579 16.4142C1.21071 16.0391 1 15.5304 1 15V3C1 2.46957 1.21071 1.96086 1.58579 1.58579C1.96086 1.21071 2.46957 1 3 1H7M13 13L17 9M17 9L13 5M17 9H7\"\n\t\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\t\t\t\tstroke-linejoin=\"round\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</svg>\n\t\t\t\t\t<span>Logout</span>\n\t\t\t\t</button>\n\t\t\t{/if}\n\t\t</div>\n\t</aside>\n\n\t{#if sidebarOpen}\n\t\t<div\n\t\t\tclass=\"overlay\"\n\t\t\trole=\"button\"\n\t\t\ttabindex=\"0\"\n\t\t\ton:click={closeSidebar}\n\t\t\ton:keydown={handleOverlayKeydown}\n\t\t></div>\n\t{/if}\n\n\t<main class=\"main-content\">\n\t\t<slot />\n\t</main>\n\n\t<nav class=\"bottom-nav\">\n\t\t{#each navItems as item (item.href)}\n\t\t\t<a\n\t\t\t\thref={resolve(item.href)}\n\t\t\t\tclass=\"bottom-nav-item\"\n\t\t\t\tclass:active={isActive(item.href, $page.url.pathname, item.exact, item.exclude)}\n\t\t\t\ton:click={(e) => handleNav(e, item.href)}\n\t\t\t>\n\t\t\t\t<!-- eslint-disable-next-line svelte/no-at-html-tags -->\n\t\t\t\t<!-- Sanitized static SVG inserted via sanitizeStaticSvg -->\n\t\t\t\t<span class=\"bottom-nav-icon\">{@html item.icon}</span>\n\t\t\t\t<span class=\"bottom-nav-label\">{item.label}</span>\n\t\t\t</a>\n\t\t{/each}\n\t\t<button\n\t\t\tclass=\"bottom-nav-item hamburger-nav-btn\"\n\t\t\ton:click={() => (sidebarOpen = !sidebarOpen)}\n\t\t\taria-label=\"Open menu\"\n\t\t\taria-expanded={sidebarOpen}\n\t\t>\n\t\t\t<span class=\"bottom-nav-icon\">\n\t\t\t\t<svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" aria-hidden=\"true\">\n\t\t\t\t\t<path\n\t\t\t\t\t\td=\"M3 12H21M3 6H21M3 18H21\"\n\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\t\t/>\n\t\t\t\t</svg>\n\t\t\t</span>\n\t\t\t<span class=\"bottom-nav-label\">Menu</span>\n\t\t</button>\n\t</nav>\n</div>\n\n<style>\n\t/* font import moved to `src/app.css` */\n\t:root {\n\t\t--orange: #ff7f50;\n\t\t--blue: #29abe2;\n\t\t--navy: #2c4a6e;\n\t\t--green: #8dc63f;\n\t\t--purple: #8b5a9e;\n\t\t--sidebar-width: 280px;\n\t\t--mobile-header-height: 60px;\n\t}\n\n\t:global(body) {\n\t\tfont-family:\n\t\t\t'Inter',\n\t\t\t-apple-system,\n\t\t\tBlinkMacSystemFont,\n\t\t\t'Segoe UI',\n\t\t\tsans-serif;\n\t}\n\n\t:global(html) {\n\t\tscroll-padding-top: var(--mobile-header-height);\n\t}\n\n\t.layout {\n\t\tdisplay: flex;\n\t\tmin-height: 100dvh;\n\t\tbackground: #f9fafb;\n\t}\n\n\t/* --- Mobile Header --- */\n\t.mobile-header {\n\t\tdisplay: flex;\n\t\tposition: fixed;\n\t\ttop: 0;\n\t\tleft: 0;\n\t\tright: 0;\n\t\theight: var(--mobile-header-height);\n\t\tbackground: white;\n\t\tborder-bottom: 1px solid #e5e7eb;\n\t\tpadding: 0 16px;\n\t\talign-items: center;\n\t\tjustify-content: space-between;\n\t\tz-index: 100;\n\t}\n\n\t.mobile-actions {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tgap: 12px;\n\t}\n\n\t.mobile-logo {\n\t\twidth: auto;\n\t\theight: 48px;\n\t}\n\n\t.mobile-user {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\ttext-decoration: none;\n\t\tcolor: inherit;\n\t\tcursor: pointer;\n\t}\n\n\t/* --- Sidebar (Hidden by default on mobile) --- */\n\t.sidebar {\n\t\tposition: fixed;\n\t\tleft: 0;\n\t\ttop: 0;\n\t\tbottom: 0;\n\t\twidth: var(--sidebar-width);\n\t\tbackground: white;\n\t\tborder-right: 1px solid #e5e7eb;\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tz-index: 1001;\n\t\ttransform: translateX(-100%);\n\t\ttransition: transform 0.3s ease;\n\t}\n\n\t.sidebar.open {\n\t\ttransform: translateX(0);\n\t}\n\n\t.sidebar-header {\n\t\tpadding: 24px 20px;\n\t\tborder-bottom: 1px solid #e5e7eb;\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tjustify-content: space-between;\n\t}\n\n\t.sidebar-logo {\n\t\twidth: auto;\n\t\theight: 64px;\n\t}\n\n\t/* Sync Indicator in Sidebar */\n\t.sidebar-sync {\n\t\tpadding: 16px 20px;\n\t\tborder-bottom: 1px solid #e5e7eb;\n\t}\n\n\t.nav {\n\t\tflex: 1;\n\t\tpadding: 24px 16px;\n\t\toverflow-y: auto;\n\t\toverscroll-behavior: contain;\n\t}\n\n\t.nav-item {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tgap: 12px;\n\t\tpadding: 12px 16px;\n\t\tborder-radius: 10px;\n\t\ttext-decoration: none;\n\t\tcolor: #6b7280;\n\t\tfont-weight: 500;\n\t\tfont-size: 15px;\n\t\tmargin-bottom: 4px;\n\t\ttransition: all 0.2s;\n\t\tposition: relative;\n\t\tcursor: pointer;\n\t}\n\n\t.nav-item:hover {\n\t\tbackground: #f9fafb;\n\t\tcolor: #111827;\n\t}\n\n\t.nav-item.active {\n\t\tbackground: linear-gradient(135deg, var(--orange) 0%, #ff6a3d 100%);\n\t\tcolor: white;\n\t\tbox-shadow: 0 4px 12px rgba(255, 127, 80, 0.3);\n\t}\n\n\t.nav-icon {\n\t\tflex-shrink: 0;\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t}\n\n\t.nav-label {\n\t\tfont-size: 15px;\n\t}\n\n\t.nav-divider {\n\t\theight: 1px;\n\t\tbackground: #e5e7eb;\n\t\tmargin: 12px 16px;\n\t}\n\n\t.sidebar-footer {\n\t\tpadding: 20px;\n\t\tborder-top: 1px solid #e5e7eb;\n\t}\n\n\t.user-card {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tgap: 12px;\n\t\tpadding: 12px;\n\t\tbackground: #f9fafb;\n\t\tborder-radius: 12px;\n\t\tmargin-bottom: 12px;\n\t\ttext-decoration: none;\n\t\tcolor: inherit;\n\t\ttransition: background-color 0.2s ease;\n\t\tcursor: pointer;\n\t}\n\n\t.user-card:hover {\n\t\tbackground: #f3f4f6;\n\t}\n\n\t.user-avatar {\n\t\twidth: 48px;\n\t\theight: 48px;\n\t\tborder-radius: 12px;\n\t\tbackground: linear-gradient(135deg, var(--navy) 0%, var(--blue) 100%);\n\t\tcolor: white;\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t\tfont-weight: 700;\n\t\tfont-size: 18px;\n\t\tflex-shrink: 0;\n\t}\n\n\t.user-avatar.small {\n\t\twidth: 32px;\n\t\theight: 32px;\n\t\tfont-size: 14px;\n\t}\n\n\t.user-info {\n\t\tflex: 1;\n\t\tmin-width: 0;\n\t}\n\n\t.user-name {\n\t\tfont-weight: 600;\n\t\tfont-size: 14px;\n\t\tcolor: #111827;\n\t\twhite-space: nowrap;\n\t\toverflow: hidden;\n\t\ttext-overflow: ellipsis;\n\t}\n\n\t.user-plan {\n\t\tfont-size: 12px;\n\t\tcolor: #6b7280;\n\t\ttext-transform: capitalize;\n\t}\n\n\t.logout-btn {\n\t\twidth: 100%;\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t\tgap: 8px;\n\t\tpadding: 12px;\n\t\tbackground: white;\n\t\tcolor: #6b7280;\n\t\tborder: 1px solid #e5e7eb;\n\t\tborder-radius: 10px;\n\t\tfont-weight: 600;\n\t\tfont-size: 14px;\n\t\tcursor: pointer;\n\t\ttransition: all 0.2s;\n\t\tfont-family: inherit;\n\t}\n\n\t/* --- Main Content --- */\n\t.main-content {\n\t\tmargin-left: 0;\n\t\tpadding: calc(var(--mobile-header-height) + 20px) 16px 100px 16px;\n\t\tflex: 1;\n\t\tmin-height: 100dvh;\n\t}\n\n\t.overlay {\n\t\tdisplay: block;\n\t\tposition: fixed;\n\t\ttop: 0;\n\t\tleft: 0;\n\t\tright: 0;\n\t\tbottom: 0;\n\t\tbackground: rgba(0, 0, 0, 0.5);\n\t\tz-index: 1000;\n\t\tbackdrop-filter: blur(4px);\n\t}\n\n\t.close-btn {\n\t\tbackground: none;\n\t\tborder: none;\n\t\tpadding: 8px;\n\t\tcursor: pointer;\n\t\tcolor: #374151;\n\t}\n\n\t/* --- Bottom Navigation (Mobile) --- */\n\t.bottom-nav {\n\t\tdisplay: flex;\n\t\tposition: fixed;\n\t\tbottom: 0;\n\t\tleft: 0;\n\t\tright: 0;\n\t\tbackground: white;\n\t\tborder-top: 1px solid #e5e7eb;\n\t\tpadding-bottom: env(safe-area-inset-bottom, 20px);\n\t\theight: calc(60px + env(safe-area-inset-bottom, 20px));\n\t\tz-index: 900;\n\t\tjustify-content: space-around;\n\t\talign-items: flex-start;\n\t\tpadding-top: 8px;\n\t\tbox-shadow: 0 -2px 10px rgba(0, 0, 0, 0.03);\n\t}\n\n\t.bottom-nav-item {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t\ttext-decoration: none;\n\t\tcolor: #9ca3af;\n\t\tfont-size: 12px;\n\t\tfont-weight: 500;\n\t\twidth: 100%;\n\t\tgap: 6px;\n\t\tcursor: pointer;\n\t\tpadding: 6px 8px;\n\t\tmin-height: 48px;\n\t\tmin-width: 48px;\n\t\tbox-sizing: border-box;\n\t}\n\n\t.bottom-nav-item.active {\n\t\tcolor: var(--orange);\n\t}\n\n\t.bottom-nav-icon :global(svg) {\n\t\twidth: 24px;\n\t\theight: 24px;\n\t}\n\n\t.hamburger-nav-btn {\n\t\tbackground: none;\n\t\tborder: none;\n\t\tcursor: pointer;\n\t}\n\n\t/* --- Desktop Overrides --- */\n\t@media (min-width: 1024px) {\n\t\t.mobile-header {\n\t\t\tdisplay: none;\n\t\t}\n\n\t\t.sidebar {\n\t\t\ttransform: translateX(0);\n\t\t}\n\n\t\t.main-content {\n\t\t\tmargin-left: var(--sidebar-width);\n\t\t\tpadding: 32px;\n\t\t}\n\n\t\t.bottom-nav {\n\t\t\tdisplay: none;\n\t\t}\n\n\t\t.close-btn {\n\t\t\tdisplay: none;\n\t\t}\n\n\t\t.overlay {\n\t\t\tdisplay: none;\n\t\t}\n\t}\n</style>\n",
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\dashboard\\+layout.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\dashboard\\+page.svelte",
		"messages": [
			{
				"ruleId": "svelte/no-navigation-without-resolve",
				"severity": 1,
				"message": "Unexpected href link without resolve().",
				"line": 105,
				"column": 12,
				"nodeType": null,
				"messageId": "linkWithoutResolve",
				"endLine": 105,
				"endColumn": 45
			},
			{
				"ruleId": "svelte/no-navigation-without-resolve",
				"severity": 1,
				"message": "Unexpected href link without resolve().",
				"line": 127,
				"column": 41,
				"nodeType": null,
				"messageId": "linkWithoutResolve",
				"endLine": 127,
				"endColumn": 60
			},
			{
				"ruleId": "svelte/no-navigation-without-resolve",
				"severity": 1,
				"message": "Unexpected href link without resolve().",
				"line": 407,
				"column": 13,
				"nodeType": null,
				"messageId": "linkWithoutResolve",
				"endLine": 407,
				"endColumn": 29
			},
			{
				"ruleId": "svelte/no-navigation-without-resolve",
				"severity": 1,
				"message": "Unexpected href link without resolve().",
				"line": 432,
				"column": 15,
				"nodeType": null,
				"messageId": "linkWithoutResolve",
				"endLine": 432,
				"endColumn": 35
			},
			{
				"ruleId": "svelte/no-navigation-without-resolve",
				"severity": 1,
				"message": "Unexpected href link without resolve().",
				"line": 500,
				"column": 14,
				"nodeType": null,
				"messageId": "linkWithoutResolve",
				"endLine": 500,
				"endColumn": 34
			}
		],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 5,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"source": "<script lang=\"ts\">\n\timport { trips } from '$lib/stores/trips';\n\timport { base } from '$app/paths';\n\tconst resolve = (href: string) => `${base}${href}`;\n\timport { expenses } from '$lib/stores/expenses'; // [!code ++]\n\timport { userSettings } from '$lib/stores/userSettings';\n\timport { toasts } from '$lib/stores/toast';\n\timport {\n\t\tcalculateDashboardStats,\n\t\tformatCurrency,\n\t\tformatDate,\n\t\tcomputeMaintenance,\n\t\ttype TimeRange\n\t} from '$lib/utils/dashboardLogic';\n\timport { SvelteDate } from '$lib/utils/svelte-reactivity';\n\timport type { Stop } from '$lib/types';\n\n\tlet selectedRange: TimeRange = '30d';\n\n\t// [!code change] Pass $expenses to the calculator\n\t$: stats = calculateDashboardStats($trips, $expenses, selectedRange);\n\n\t// --- Maintenance reminder calculations (all-time) ---\n\t$: allStats = calculateDashboardStats($trips, $expenses, 'all');\n\t$: currentOdometer =\n\t\tNumber($userSettings.vehicleOdometerStart || 0) + Number(allStats.totalMiles || 0);\n\t$: maintenance = computeMaintenance({\n\t\tvehicleOdometerStart: $userSettings.vehicleOdometerStart,\n\t\ttotalMilesAllTime: allStats.totalMiles,\n\t\tlastServiceOdometer: $userSettings.lastServiceOdometer,\n\t\tserviceIntervalMiles: $userSettings.serviceIntervalMiles,\n\t\treminderThresholdMiles: $userSettings.reminderThresholdMiles\n\t});\n\n\timport { saveSettings } from './settings/lib/save-settings';\n\n\tasync function markServicedNow() {\n\t\tconst newOdo = Math.round(currentOdometer || 0);\n\t\tconst payload = {\n\t\t\tlastServiceOdometer: newOdo,\n\t\t\tlastServiceDate: SvelteDate.now().toISOString()\n\t\t};\n\t\ttry {\n\t\t\tuserSettings.update((s) => ({ ...s, ...payload }));\n\t\t\tconst result = await saveSettings(payload);\n\t\t\tif (!result.ok) throw new Error(result.error);\n\t\t\ttoasts.success('Marked vehicle as serviced');\n\t\t} catch (e) {\n\t\t\tconsole.error(e);\n\t\t\ttoasts.error('Could not mark serviced');\n\t\t}\n\t}\n\n\tconst rangeLabels = {\n\t\t// ... existing labels\n\t\t'7d': 'Last 7 days',\n\t\t'30d': 'Last 30 Days',\n\t\t'60d': 'Last 60 Days',\n\t\t'90d': 'Last 90 Days',\n\t\t'1y': 'Current Year',\n\t\t'prev-1y': 'Previous Year',\n\t\tall: 'All Time'\n\t};\n\n\tfunction getDestinationFromStops(stops?: Stop[] | undefined): string {\n\t\tif (!stops || stops.length === 0) return 'No stops';\n\t\tconst last = stops[stops.length - 1];\n\t\tif (last && typeof last.address === 'string') {\n\t\t\tconst first = (last.address as string).split(',')[0];\n\t\t\treturn first || 'Multiple stops';\n\t\t}\n\t\treturn 'Multiple stops';\n\t}\n</script>\n\n<svelte:head>\n\t<title>Dashboard - Go Route Yourself</title>\n</svelte:head>\n\n<div class=\"dashboard\">\n\t<div class=\"page-header\">\n\t\t<div class=\"header-left\">\n\t\t\t<h1 class=\"page-title\">Dashboard</h1>\n\t\t\t<p class=\"page-subtitle\">\n\t\t\t\tOverview for <span class=\"highlight-text\">{rangeLabels[selectedRange]}</span>\n\t\t\t</p>\n\t\t</div>\n\n\t\t<div class=\"header-actions\">\n\t\t\t<select\n\t\t\t\tid=\"range-select\"\n\t\t\t\tname=\"selectedRange\"\n\t\t\t\tbind:value={selectedRange}\n\t\t\t\tclass=\"range-select\"\n\t\t\t\taria-label=\"Select time range\"\n\t\t\t>\n\t\t\t\t<option value=\"7d\">Last 7 Days</option>\n\t\t\t\t<option value=\"30d\">Last 30 Days</option>\n\t\t\t\t<option value=\"60d\">Last 60 Days</option>\n\t\t\t\t<option value=\"90d\">Last 90 Days</option>\n\t\t\t\t<option value=\"1y\">Current Year</option>\n\t\t\t\t<option value=\"prev-1y\">Previous Year</option>\n\t\t\t</select>\n\n\t\t\t<a href={resolve('/dashboard/trips/new')} class=\"btn-primary\">\n\t\t\t\t<svg width=\"20\" height=\"20\" viewBox=\"0 0 20 20\" fill=\"none\">\n\t\t\t\t\t<path\n\t\t\t\t\t\td=\"M10 4V16M4 10H16\"\n\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\t\t\tstroke-linejoin=\"round\"\n\t\t\t\t\t/>\n\t\t\t\t</svg>\n\t\t\t\tNew Trip\n\t\t\t</a>\n\t\t</div>\n\t</div>\n\n\t{#if $userSettings.lastServiceOdometer && $userSettings.lastServiceOdometer > currentOdometer}\n\t\t<div\n\t\t\tclass=\"alert info\"\n\t\t\tstyle=\"background:#E0F2FE; color:#0369A1; border:1px solid #60A5FA; padding:12px; border-radius:8px; margin:16px 0;\"\n\t\t>\n\t\t\tNote: Your recorded last service odometer ({$userSettings.lastServiceOdometer.toLocaleString()})\n\t\t\tis higher than the current estimated odometer ({Math.round(currentOdometer).toLocaleString()} mi).\n\t\t\tIf this isn't expected, set <a href=\"/dashboard/settings\">Vehicle odometer start</a> in Settings\n\t\t\tor update your last service reading.\n\t\t</div>\n\t{/if}\n\n\t{#if maintenance.visible}\n\t\t<div\n\t\t\tclass=\"alert maintenance\"\n\t\t\tclass:error={maintenance.dueIn < 0}\n\t\t\tclass:warning={maintenance.dueIn >= 0 && maintenance.dueIn <= maintenance.reminderThreshold}\n\t\t\tstyle=\"display:flex; align-items:center; gap:12px; margin:16px 0; padding:12px; border-radius:10px; background:#FFFBEB; color:#92400E; border:1px solid #F59E0B;\"\n\t\t>\n\t\t\t<div style=\"font-weight:600\">{maintenance.message}</div>\n\t\t\t<div style=\"margin-left:auto\">\n\t\t\t\t<button class=\"btn-secondary\" on:click={markServicedNow}>Mark serviced now</button>\n\t\t\t</div>\n\t\t</div>\n\t{/if}\n\n\t<div class=\"stats-grid\">\n\t\t<div class=\"stat-card featured\">\n\t\t\t<div class=\"stat-header\">\n\t\t\t\t<div class=\"stat-icon orange\">\n\t\t\t\t\t<svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\">\n\t\t\t\t\t\t<path\n\t\t\t\t\t\t\td=\"M12 2L2 7L12 12L22 7L12 2Z\"\n\t\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\t\t\t\tstroke-linejoin=\"round\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<path\n\t\t\t\t\t\t\td=\"M2 17L12 22L22 17\"\n\t\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\t\t\t\tstroke-linejoin=\"round\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<path\n\t\t\t\t\t\t\td=\"M2 12L12 17L22 12\"\n\t\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\t\t\t\tstroke-linejoin=\"round\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</svg>\n\t\t\t\t</div>\n\t\t\t\t<span class=\"stat-label\">Total Profit</span>\n\t\t\t</div>\n\t\t\t<div class=\"stat-value\">{formatCurrency(stats.totalProfit)}</div>\n\n\t\t\t{#if selectedRange !== 'all'}\n\t\t\t\t<div\n\t\t\t\t\tclass=\"stat-change\"\n\t\t\t\t\tclass:positive={stats.periodComparison.isPositive}\n\t\t\t\t\tclass:negative={!stats.periodComparison.isPositive}\n\t\t\t\t>\n\t\t\t\t\t<svg width=\"16\" height=\"16\" viewBox=\"0 0 16 16\" fill=\"none\">\n\t\t\t\t\t\t{#if stats.periodComparison.isPositive}\n\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\td=\"M8 12V4M8 4L4 8M8 4L12 8\"\n\t\t\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\t\t\t\t\tstroke-linejoin=\"round\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t{:else}\n\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\td=\"M8 4V12M8 12L4 8M8 12L12 8\"\n\t\t\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\t\t\t\t\tstroke-linejoin=\"round\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t{/if}\n\t\t\t\t\t</svg>\n\t\t\t\t\t{Math.abs(stats.periodComparison.change).toFixed(1)}% vs previous\n\t\t\t\t</div>\n\t\t\t{/if}\n\t\t</div>\n\n\t\t<div class=\"stat-card\">\n\t\t\t<div class=\"stat-header\">\n\t\t\t\t<div class=\"stat-icon blue\">\n\t\t\t\t\t<svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\">\n\t\t\t\t\t\t<path\n\t\t\t\t\t\t\td=\"M21 10C21 17 12 23 12 23C12 23 3 17 3 10C3 7.61305 3.94821 5.32387 5.63604 3.63604C7.32387 1.94821 9.61305 1 12 1C14.3869 1 16.6761 1.94821 18.364 3.63604C20.0518 5.32387 21 7.61305 21 10Z\"\n\t\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\t\t\t\tstroke-linejoin=\"round\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<path\n\t\t\t\t\t\t\td=\"M12 13C13.6569 13 15 11.6569 15 10C15 8.34315 13.6569 7 12 7C10.3431 7 9 8.34315 9 10C9 11.6569 10.3431 13 12 13Z\"\n\t\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\t\t\t\tstroke-linejoin=\"round\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</svg>\n\t\t\t\t</div>\n\t\t\t\t<span class=\"stat-label\">Total Trips</span>\n\t\t\t</div>\n\t\t\t<div class=\"stat-value\">{stats.totalTrips}</div>\n\t\t\t<div class=\"stat-info\">{rangeLabels[selectedRange]}</div>\n\t\t</div>\n\n\t\t<div class=\"stat-card\">\n\t\t\t<div class=\"stat-header\">\n\t\t\t\t<div class=\"stat-icon green\">\n\t\t\t\t\t<svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\">\n\t\t\t\t\t\t<path\n\t\t\t\t\t\t\td=\"M13 2L3 14H12L11 22L21 10H12L13 2Z\"\n\t\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\t\t\t\tstroke-linejoin=\"round\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</svg>\n\t\t\t\t</div>\n\t\t\t\t<span class=\"stat-label\">Avg Profit/Trip</span>\n\t\t\t</div>\n\t\t\t<div class=\"stat-value\">{formatCurrency(stats.avgProfitPerTrip)}</div>\n\t\t\t<div class=\"stat-info\">{rangeLabels[selectedRange]}</div>\n\t\t</div>\n\n\t\t<div class=\"stat-card\">\n\t\t\t<div class=\"stat-header\">\n\t\t\t\t<div class=\"stat-icon purple\">\n\t\t\t\t\t<svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\">\n\t\t\t\t\t\t<path\n\t\t\t\t\t\t\td=\"M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z\"\n\t\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\t\t\t\tstroke-linejoin=\"round\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<path\n\t\t\t\t\t\t\td=\"M2 12H22\"\n\t\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\t\t\t\tstroke-linejoin=\"round\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</svg>\n\t\t\t\t</div>\n\t\t\t\t<span class=\"stat-label\">Total Miles</span>\n\t\t\t</div>\n\t\t\t<div class=\"stat-value\">\n\t\t\t\t{stats.totalMiles.toLocaleString(undefined, { maximumFractionDigits: 1 })}\n\t\t\t</div>\n\t\t\t<div class=\"stat-info\">{rangeLabels[selectedRange]}</div>\n\t\t</div>\n\t</div>\n\n\t<div class=\"charts-grid\">\n\t\t<div class=\"chart-card\">\n\t\t\t<div class=\"chart-header\">\n\t\t\t\t<div>\n\t\t\t\t\t<h2 class=\"chart-title\">Profit Trend</h2>\n\t\t\t\t\t<p class=\"chart-subtitle\">{rangeLabels[selectedRange]}</p>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"chart-legend\">\n\t\t\t\t\t<div class=\"legend-item\">\n\t\t\t\t\t\t<div class=\"legend-dot orange\"></div>\n\t\t\t\t\t\t<span>Daily Profit</span>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div class=\"chart-container\">\n\t\t\t\t{#if stats.chartData.some((d) => d.profit !== 0)}\n\t\t\t\t\t{@const maxProfit = Math.max(...stats.chartData.map((d) => Math.abs(d.profit)), 1)}\n\t\t\t\t\t<div class=\"bar-chart\">\n\t\t\t\t\t\t{#each stats.chartData as day (day.date)}\n\t\t\t\t\t\t\t{@const height = (Math.abs(day.profit) / maxProfit) * 100}\n\t\t\t\t\t\t\t<div class=\"bar-wrapper\">\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tclass=\"bar\"\n\t\t\t\t\t\t\t\t\tclass:negative={day.profit < 0}\n\t\t\t\t\t\t\t\t\tstyle=\"height: {height}%; opacity: {day.profit === 0 ? 0 : 1}\"\n\t\t\t\t\t\t\t\t\ttitle=\"{formatDate(day.date)}: {formatCurrency(day.profit)}\"\n\t\t\t\t\t\t\t\t></div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t{/each}\n\t\t\t\t\t</div>\n\t\t\t\t{:else}\n\t\t\t\t\t<div class=\"empty-state\">\n\t\t\t\t\t\t<svg width=\"48\" height=\"48\" viewBox=\"0 0 48 48\" fill=\"none\">\n\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\td=\"M8 36V12M16 36V20M24 36V24M32 36V16M40 36V28\"\n\t\t\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\t\t\t\t\tstroke-linejoin=\"round\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t<p>No data for this period</p>\n\t\t\t\t\t</div>\n\t\t\t\t{/if}\n\t\t\t</div>\n\t\t</div>\n\n\t\t<div class=\"chart-card\">\n\t\t\t<div class=\"chart-header\">\n\t\t\t\t<div>\n\t\t\t\t\t<h2 class=\"chart-title\">Cost Breakdown</h2>\n\t\t\t\t\t<p class=\"chart-subtitle\">Expenses in period</p>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div class=\"chart-container\">\n\t\t\t\t{#if stats.totalCost > 0}\n\t\t\t\t\t{#key stats.costBreakdown}\n\t\t\t\t\t\t{@const radius = 70}\n\t\t\t\t\t\t{@const circumference = 2 * Math.PI * radius}\n\n\t\t\t\t\t\t<div class=\"donut-chart\">\n\t\t\t\t\t\t\t<svg viewBox=\"0 0 200 200\">\n\t\t\t\t\t\t\t\t{#each stats.costBreakdown as item, i (item.category)}\n\t\t\t\t\t\t\t\t\t{@const prevItems = stats.costBreakdown.slice(0, i)}\n\t\t\t\t\t\t\t\t\t{@const offset = prevItems.reduce(\n\t\t\t\t\t\t\t\t\t\t(acc, curr) => acc + (curr.percentage / 100) * circumference,\n\t\t\t\t\t\t\t\t\t\t0\n\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t{@const length = (item.percentage / 100) * circumference}\n\n\t\t\t\t\t\t\t\t\t<circle\n\t\t\t\t\t\t\t\t\t\tcx=\"100\"\n\t\t\t\t\t\t\t\t\t\tcy=\"100\"\n\t\t\t\t\t\t\t\t\t\tr={radius}\n\t\t\t\t\t\t\t\t\t\tfill=\"none\"\n\t\t\t\t\t\t\t\t\t\tstroke={item.color}\n\t\t\t\t\t\t\t\t\t\tstroke-width=\"30\"\n\t\t\t\t\t\t\t\t\t\tstroke-dasharray=\"{length} {circumference}\"\n\t\t\t\t\t\t\t\t\t\tstroke-dashoffset={-offset}\n\t\t\t\t\t\t\t\t\t\ttransform=\"rotate(-90 100 100)\"\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t{/each}\n\t\t\t\t\t\t\t</svg>\n\n\t\t\t\t\t\t\t<div class=\"donut-legend\">\n\t\t\t\t\t\t\t\t{#each stats.costBreakdown as item (item.category)}\n\t\t\t\t\t\t\t\t\t<div class=\"legend-item\">\n\t\t\t\t\t\t\t\t\t\t<div class=\"legend-dot\" style=\"background: {item.color}\"></div>\n\t\t\t\t\t\t\t\t\t\t<div class=\"legend-text\">\n\t\t\t\t\t\t\t\t\t\t\t<span class=\"legend-label\" style=\"text-transform: capitalize\"\n\t\t\t\t\t\t\t\t\t\t\t\t>{item.category}</span\n\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t<span class=\"legend-value\">{formatCurrency(item.amount)}</span>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t{/each}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t{/key}\n\t\t\t\t{:else}\n\t\t\t\t\t<div class=\"empty-state\">\n\t\t\t\t\t\t<svg width=\"48\" height=\"48\" viewBox=\"0 0 48 48\" fill=\"none\">\n\t\t\t\t\t\t\t<circle cx=\"24\" cy=\"24\" r=\"20\" stroke=\"currentColor\" stroke-width=\"2\" />\n\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\td=\"M24 14V24L30 30\"\n\t\t\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t<p>No expenses for this period</p>\n\t\t\t\t\t</div>\n\t\t\t\t{/if}\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\n\t<div class=\"section-card\">\n\t\t<div class=\"section-header\">\n\t\t\t<div>\n\t\t\t\t<h2 class=\"section-title\">Recent Trips</h2>\n\t\t\t\t<p class=\"section-subtitle\">Latest from selected period</p>\n\t\t\t</div>\n\t\t\t<a href=\"/dashboard/trips\" class=\"btn-secondary\">\n\t\t\t\tView All\n\t\t\t\t<svg width=\"16\" height=\"16\" viewBox=\"0 0 16 16\" fill=\"none\">\n\t\t\t\t\t<path\n\t\t\t\t\t\td=\"M6 12L10 8L6 4\"\n\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\t\t\tstroke-linejoin=\"round\"\n\t\t\t\t\t/>\n\t\t\t\t</svg>\n\t\t\t</a>\n\t\t</div>\n\n\t\t{#if stats.recentTrips.length > 0}\n\t\t\t<div class=\"trips-list\">\n\t\t\t\t{#each stats.recentTrips as trip (trip.id)}\n\t\t\t\t\t{@const earnings =\n\t\t\t\t\t\ttrip.stops?.reduce((s: number, stop: any) => s + (Number(stop.earnings) || 0), 0) || 0}\n\t\t\t\t\t{@const costs =\n\t\t\t\t\t\t(Number(trip.fuelCost) || 0) +\n\t\t\t\t\t\t(Number(trip.maintenanceCost) || 0) +\n\t\t\t\t\t\t(Number(trip.suppliesCost) || 0)}\n\t\t\t\t\t{@const profit = earnings - costs}\n\n\t\t\t\t\t<a href=\"/dashboard/trips?id={trip.id}\" class=\"trip-item\">\n\t\t\t\t\t\t<div class=\"trip-icon\">\n\t\t\t\t\t\t\t<svg width=\"20\" height=\"20\" viewBox=\"0 0 20 20\" fill=\"none\">\n\t\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\t\td=\"M17 9L9 2L1 9V17C1 17.5304 1.21071 18.0391 1.58579 18.4142C1.96086 18.7893 2.46957 19 3 19H15C15.5304 19 16.0391 18.7893 16.4142 18.4142C16.7893 18.0391 17 17.5304 17 17V9Z\"\n\t\t\t\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\t\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\t\t\t\t\t\tstroke-linejoin=\"round\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class=\"trip-info\">\n\t\t\t\t\t\t\t<div class=\"trip-route\">\n\t\t\t\t\t\t\t\t<span class=\"trip-start\"\n\t\t\t\t\t\t\t\t\t>{typeof trip.startAddress === 'string'\n\t\t\t\t\t\t\t\t\t\t? trip.startAddress.split(',')[0]\n\t\t\t\t\t\t\t\t\t\t: 'Unknown'}</span\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<svg width=\"16\" height=\"16\" viewBox=\"0 0 16 16\" fill=\"none\">\n\t\t\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\t\t\td=\"M6 12L10 8L6 4\"\n\t\t\t\t\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\t\t\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\t\t\t\t\t\t\tstroke-linejoin=\"round\"\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t\t<span class=\"trip-destination\">{getDestinationFromStops(trip.stops)}</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"trip-meta\">\n\t\t\t\t\t\t\t\t<span>{formatDate(trip.date || '')}</span>\n\t\t\t\t\t\t\t\t<span>ΓÇó</span>\n\t\t\t\t\t\t\t\t<span>{(Number(trip.totalMiles) || 0).toFixed(1)} mi</span>\n\t\t\t\t\t\t\t\t{#if trip.stops && trip.stops.length > 0}\n\t\t\t\t\t\t\t\t\t<span>ΓÇó</span>\n\t\t\t\t\t\t\t\t\t<span>{trip.stops.length} stops</span>\n\t\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class=\"trip-profit\" class:positive={profit >= 0} class:negative={profit < 0}>\n\t\t\t\t\t\t\t{formatCurrency(profit)}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</a>\n\t\t\t\t{/each}\n\t\t\t</div>\n\t\t{:else}\n\t\t\t<div class=\"empty-state-large\">\n\t\t\t\t<svg width=\"64\" height=\"64\" viewBox=\"0 0 64 64\" fill=\"none\">\n\t\t\t\t\t<path\n\t\t\t\t\t\td=\"M8 24L32 8L56 24V48C56 49.0609 55.5786 50.0783 54.8284 50.8284C54.0783 51.5786 53.0609 52 52 52H12C10.9391 52 9.92172 51.5786 9.17157 50.8284C8.42143 50.0783 8 49.0609 8 48V24Z\"\n\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\t\t\tstroke-linejoin=\"round\"\n\t\t\t\t\t/>\n\t\t\t\t\t<path\n\t\t\t\t\t\td=\"M24 52V32H40V52\"\n\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\t\t\tstroke-linejoin=\"round\"\n\t\t\t\t\t/>\n\t\t\t\t</svg>\n\t\t\t\t<h3>No trips found</h3>\n\t\t\t\t<p>No trips found in this date range.</p>\n\t\t\t\t<a href=\"/dashboard/trips/new\" class=\"btn-primary\">\n\t\t\t\t\t<svg width=\"20\" height=\"20\" viewBox=\"0 0 20 20\" fill=\"none\">\n\t\t\t\t\t\t<path\n\t\t\t\t\t\t\td=\"M10 4V16M4 10H16\"\n\t\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\t\t\t\tstroke-linejoin=\"round\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</svg>\n\t\t\t\t\tCreate Trip\n\t\t\t\t</a>\n\t\t\t</div>\n\t\t{/if}\n\t</div>\n</div>\n\n<style>\n\t.bar.negative {\n\t\tbackground: linear-gradient(180deg, #ef4444 0%, #dc2626 100%);\n\t}\n\n\t.dashboard {\n\t\tmax-width: 1400px;\n\t\tmargin: 0 auto;\n\t\tpadding: 16px;\n\t}\n\t.page-header {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tgap: 16px;\n\t\tmargin-bottom: 24px;\n\t}\n\t.header-actions {\n\t\tdisplay: flex;\n\t\tgap: 12px;\n\t\twidth: 100%;\n\t}\n\t.range-select {\n\t\tflex: 1;\n\t\tpadding: 10px;\n\t\tborder-radius: 10px;\n\t\tborder: 1px solid #e5e7eb;\n\t\tbackground: white;\n\t\tfont-size: 14px;\n\t\tcolor: #374151;\n\t\tcursor: pointer;\n\t}\n\t@media (min-width: 640px) {\n\t\t.page-header {\n\t\t\tflex-direction: row;\n\t\t\tjustify-content: space-between;\n\t\t\talign-items: center;\n\t\t}\n\t\t.header-actions {\n\t\t\twidth: auto;\n\t\t}\n\t\t.range-select {\n\t\t\twidth: 160px;\n\t\t\tflex: none;\n\t\t}\n\t}\n\t.page-title {\n\t\tfont-size: 24px;\n\t\tfont-weight: 800;\n\t\tcolor: #111827;\n\t\tmargin-bottom: 4px;\n\t\tmargin-top: 0;\n\t}\n\t.page-subtitle {\n\t\tfont-size: 14px;\n\t\tcolor: #6b7280;\n\t\tmargin: 0;\n\t}\n\t.highlight-text {\n\t\tcolor: #b0422a; /* darker orange for WCAG contrast */\n\t\tfont-weight: 600;\n\t}\n\t.btn-primary {\n\t\tdisplay: inline-flex;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t\tgap: 8px;\n\t\tpadding: 12px 16px;\n\t\tbackground: linear-gradient(135deg, var(--orange) 0%, #ff6a3d 100%);\n\t\tcolor: white;\n\t\tborder: none;\n\t\tborder-radius: 10px;\n\t\tfont-weight: 600;\n\t\tfont-size: 14px;\n\t\ttext-decoration: none;\n\t\tcursor: pointer;\n\t\ttransition: all 0.2s;\n\t\tbox-shadow: 0 4px 12px rgba(255, 127, 80, 0.3);\n\t\twhite-space: nowrap;\n\t}\n\t.btn-primary:hover {\n\t\ttransform: translateY(-2px);\n\t\tbox-shadow: 0 8px 16px rgba(255, 127, 80, 0.4);\n\t}\n\t.btn-secondary {\n\t\tdisplay: inline-flex;\n\t\talign-items: center;\n\t\tgap: 6px;\n\t\tpadding: 8px 16px;\n\t\tbackground: white;\n\t\tcolor: #6b7280;\n\t\tborder: 1px solid #e5e7eb;\n\t\tborder-radius: 8px;\n\t\tfont-weight: 600;\n\t\tfont-size: 14px;\n\t\ttext-decoration: none;\n\t\ttransition: all 0.2s;\n\t}\n\t.btn-secondary:hover {\n\t\tborder-color: var(--orange);\n\t\tcolor: var(--orange);\n\t}\n\t.stats-grid {\n\t\tdisplay: grid;\n\t\tgrid-template-columns: 1fr;\n\t\tgap: 16px;\n\t\tmargin-bottom: 24px;\n\t}\n\t.stat-card {\n\t\tbackground: white;\n\t\tborder: 1px solid #e5e7eb;\n\t\tborder-radius: 16px;\n\t\tpadding: 20px;\n\t\ttransition: all 0.2s;\n\t}\n\t.stat-card:hover {\n\t\tbox-shadow: 0 8px 24px rgba(0, 0, 0, 0.08);\n\t\ttransform: translateY(-2px);\n\t}\n\t.stat-card.featured {\n\t\tbackground: linear-gradient(135deg, var(--orange) 0%, #ff6a3d 100%);\n\t\tcolor: white;\n\t\tborder: none;\n\t\tbox-shadow: 0 8px 24px rgba(255, 127, 80, 0.3);\n\t}\n\t.stat-header {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tgap: 12px;\n\t\tmargin-bottom: 12px;\n\t}\n\t.stat-icon {\n\t\twidth: 40px;\n\t\theight: 40px;\n\t\tborder-radius: 10px;\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t\tcolor: white;\n\t}\n\t.stat-icon.orange {\n\t\tbackground: rgba(255, 127, 80, 0.2);\n\t}\n\t.stat-icon.blue {\n\t\tbackground: linear-gradient(135deg, var(--blue) 0%, #1e9bcf 100%);\n\t}\n\t.stat-icon.green {\n\t\tbackground: linear-gradient(135deg, var(--green) 0%, #7ab82e 100%);\n\t}\n\t.stat-icon.purple {\n\t\tbackground: linear-gradient(135deg, var(--purple) 0%, #764a89 100%);\n\t}\n\t.stat-card.featured .stat-icon {\n\t\tbackground: rgba(255, 255, 255, 0.2);\n\t}\n\t.stat-label {\n\t\tfont-size: 14px;\n\t\tfont-weight: 600;\n\t\tcolor: #6b7280;\n\t}\n\t.stat-card.featured .stat-label {\n\t\tcolor: rgba(255, 255, 255, 0.9);\n\t}\n\t.stat-value {\n\t\tfont-size: 28px;\n\t\tfont-weight: 800;\n\t\tcolor: #111827;\n\t\tmargin-bottom: 4px;\n\t\t/* Reserve vertical space so numbers changing on load don't cause CLS */\n\t\tmin-height: 36px;\n\t\t/* Use tabular numbers to avoid width changes when digits update */\n\t\tfont-variant-numeric: tabular-nums;\n\t\twhite-space: nowrap;\n\t\tmin-width: 6ch;\n\t}\n\n\t.stat-change {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tgap: 6px;\n\t\tfont-size: 13px;\n\t\tfont-weight: 600;\n\t\t/* Reserve space even when the element is visually empty */\n\t\tmin-height: 20px;\n\t\tmin-width: 6ch;\n\t}\n\n\t/* Reserve horizontal space when .stat-change is empty (prevents CLS) */\n\t.stat-change:empty::after {\n\t\tcontent: '\\00a0';\n\t\tdisplay: inline-block;\n\t\twidth: 6ch;\n\t\theight: 16px;\n\t\topacity: 0;\n\t}\n\t.stat-card.featured .stat-value {\n\t\tcolor: white;\n\t}\n\t.stat-change {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tgap: 6px;\n\t\tfont-size: 13px;\n\t\tfont-weight: 600;\n\t}\n\t.stat-change.positive {\n\t\tcolor: rgba(255, 255, 255, 0.9);\n\t}\n\t.stat-change.negative {\n\t\tcolor: rgba(255, 255, 255, 0.8);\n\t}\n\t.stat-info {\n\t\tfont-size: 13px;\n\t\tcolor: #4b5563; /* darker gray for sufficient contrast */\n\t}\n\t.charts-grid {\n\t\tdisplay: grid;\n\t\tgrid-template-columns: 1fr;\n\t\tgap: 24px;\n\t\tmargin-bottom: 32px;\n\t}\n\t.chart-card {\n\t\tbackground: white;\n\t\tborder: 1px solid #e5e7eb;\n\t\tborder-radius: 16px;\n\t\tpadding: 20px;\n\t}\n\t.chart-header {\n\t\tdisplay: flex;\n\t\tjustify-content: space-between;\n\t\talign-items: flex-start;\n\t\tmargin-bottom: 20px;\n\t\tflex-wrap: wrap;\n\t\tgap: 12px;\n\t}\n\t.chart-title {\n\t\tfont-size: 18px;\n\t\tfont-weight: 700;\n\t\tcolor: #111827;\n\t\tmargin: 0 0 4px 0;\n\t}\n\t.chart-subtitle {\n\t\tfont-size: 14px;\n\t\tcolor: #6b7280;\n\t\tmargin: 0;\n\t}\n\t.chart-legend {\n\t\tdisplay: flex;\n\t\tgap: 16px;\n\t}\n\t.legend-item {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tgap: 8px;\n\t\tfont-size: 13px;\n\t\tcolor: #6b7280;\n\t}\n\t.legend-dot {\n\t\twidth: 12px;\n\t\theight: 12px;\n\t\tborder-radius: 50%;\n\t}\n\t.legend-dot.orange {\n\t\tbackground: var(--orange);\n\t}\n\t.chart-container {\n\t\theight: 240px;\n\t\tposition: relative;\n\t}\n\t.bar-chart {\n\t\tdisplay: flex;\n\t\talign-items: flex-end;\n\t\tgap: 2px;\n\t\theight: 100%;\n\t\tpadding: 12px 0;\n\t}\n\t.bar-wrapper {\n\t\tflex: 1;\n\t\theight: 100%;\n\t\tdisplay: flex;\n\t\talign-items: flex-end;\n\t}\n\t.bar {\n\t\twidth: 100%;\n\t\tbackground: linear-gradient(180deg, var(--orange) 0%, #ff6a3d 100%);\n\t\tborder-radius: 4px 4px 0 0;\n\t\tmin-height: 4px;\n\t\ttransition: all 0.2s;\n\t\tcursor: pointer;\n\t}\n\t.bar:hover {\n\t\topacity: 0.8;\n\t}\n\t.donut-chart {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tgap: 24px;\n\t\talign-items: center;\n\t\theight: 100%;\n\t\tjustify-content: center;\n\t}\n\t.donut-chart svg {\n\t\twidth: 180px;\n\t\theight: 180px;\n\t}\n\t.donut-legend {\n\t\twidth: 100%;\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tgap: 12px;\n\t}\n\t.donut-legend .legend-item {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tgap: 12px;\n\t\twidth: 100%;\n\t}\n\t.donut-legend .legend-dot {\n\t\twidth: 16px;\n\t\theight: 16px;\n\t\tborder-radius: 4px;\n\t\tflex-shrink: 0;\n\t}\n\t.legend-text {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tjustify-content: space-between;\n\t\twidth: 100%;\n\t}\n\t.legend-label {\n\t\tfont-size: 14px;\n\t\tcolor: #6b7280;\n\t}\n\t.legend-value {\n\t\tfont-size: 16px;\n\t\tfont-weight: 700;\n\t\tcolor: #111827;\n\t}\n\t.section-card {\n\t\tbackground: white;\n\t\tborder: 1px solid #e5e7eb;\n\t\tborder-radius: 16px;\n\t\tpadding: 20px;\n\t}\n\t.section-header {\n\t\tdisplay: flex;\n\t\tjustify-content: space-between;\n\t\talign-items: center;\n\t\tmargin-bottom: 20px;\n\t}\n\t.section-title {\n\t\tfont-size: 18px;\n\t\tfont-weight: 700;\n\t\tcolor: #111827;\n\t\tmargin: 0 0 4px 0;\n\t}\n\t.section-subtitle {\n\t\tfont-size: 14px;\n\t\tcolor: #6b7280;\n\t\tmargin: 0;\n\t}\n\t.trips-list {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tgap: 12px;\n\t}\n\t.trip-item {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tgap: 12px;\n\t\tpadding: 16px;\n\t\tbackground: #f9fafb;\n\t\tborder: 1px solid #e5e7eb;\n\t\tborder-radius: 12px;\n\t\ttext-decoration: none;\n\t\ttransition: all 0.2s;\n\t}\n\t.trip-item:hover {\n\t\tborder-color: var(--orange);\n\t\tbackground: white;\n\t\tbox-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);\n\t}\n\t.trip-icon {\n\t\twidth: 40px;\n\t\theight: 40px;\n\t\tbackground: white;\n\t\tborder: 1px solid #e5e7eb;\n\t\tborder-radius: 10px;\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t\tcolor: var(--orange);\n\t\tflex-shrink: 0;\n\t\talign-self: flex-start;\n\t}\n\t.trip-info {\n\t\tflex: 1;\n\t\tmin-width: 0;\n\t\twidth: 100%;\n\t}\n\t.trip-route {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tgap: 8px;\n\t\tfont-weight: 600;\n\t\tcolor: #111827;\n\t\tmargin-bottom: 4px;\n\t\tflex-wrap: wrap;\n\t}\n\t.trip-route svg {\n\t\tcolor: #9ca3af;\n\t\tflex-shrink: 0;\n\t}\n\t.trip-start,\n\t.trip-destination {\n\t\twhite-space: nowrap;\n\t\toverflow: hidden;\n\t\ttext-overflow: ellipsis;\n\t\tmax-width: 100%;\n\t}\n\t.trip-meta {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tgap: 8px;\n\t\tfont-size: 13px;\n\t\tcolor: #4b5563; /* darker gray for sufficient contrast */\n\t}\n\t.trip-profit {\n\t\tfont-size: 18px;\n\t\tfont-weight: 700;\n\t\tflex-shrink: 0;\n\t\talign-self: flex-end;\n\t}\n\t.trip-profit.positive {\n\t\tcolor: #2e7d32; /* darker green for contrast */\n\t}\n\t.trip-profit.negative {\n\t\tcolor: #dc2626;\n\t}\n\t.empty-state {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t\theight: 100%;\n\t\tcolor: #9ca3af;\n\t\ttext-align: center;\n\t}\n\t.empty-state svg {\n\t\tmargin-bottom: 12px;\n\t\tcolor: #d1d5db;\n\t}\n\t.empty-state p {\n\t\tfont-size: 14px;\n\t\tcolor: #6b7280;\n\t}\n\t.empty-state-large {\n\t\tpadding: 48px 24px;\n\t\ttext-align: center;\n\t}\n\t.empty-state-large svg {\n\t\tcolor: #d1d5db;\n\t\tmargin: 0 auto 24px;\n\t}\n\t.empty-state-large h3 {\n\t\tfont-size: 18px;\n\t\tfont-weight: 700;\n\t\tcolor: #111827;\n\t\tmargin-bottom: 8px;\n\t}\n\t.empty-state-large p {\n\t\tfont-size: 15px;\n\t\tcolor: #6b7280;\n\t\tmargin-bottom: 24px;\n\t}\n\t@media (min-width: 640px) {\n\t\t.page-title {\n\t\t\tfont-size: 32px;\n\t\t}\n\t\t.page-subtitle {\n\t\t\tfont-size: 16px;\n\t\t}\n\t\t.btn-primary {\n\t\t\tpadding: 12px 24px;\n\t\t\tfont-size: 15px;\n\t\t}\n\t\t.stats-grid {\n\t\t\tgrid-template-columns: repeat(2, 1fr);\n\t\t}\n\t\t.trip-item {\n\t\t\tflex-direction: row;\n\t\t\talign-items: center;\n\t\t}\n\t\t.trip-icon {\n\t\t\talign-self: center;\n\t\t}\n\t\t.trip-profit {\n\t\t\talign-self: center;\n\t\t}\n\t}\n\t@media (min-width: 1024px) {\n\t\t.stats-grid {\n\t\t\tgrid-template-columns: repeat(4, 1fr);\n\t\t}\n\t\t.charts-grid {\n\t\t\tgrid-template-columns: repeat(2, 1fr);\n\t\t}\n\t\t.donut-chart {\n\t\t\tflex-direction: row;\n\t\t\tjustify-content: flex-start;\n\t\t}\n\t\t.donut-chart svg {\n\t\t\twidth: 200px;\n\t\t\theight: 200px;\n\t\t}\n\t\t.legend-text {\n\t\t\tflex-direction: column;\n\t\t\talign-items: flex-start;\n\t\t}\n\t}\n</style>\n",
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\dashboard\\data-management\\+page.svelte",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\dashboard\\data-management\\lib\\mileage-export.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\dashboard\\data-management\\lib\\pdf-export.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\dashboard\\data\\+page.svelte",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\dashboard\\expenses\\+page.server.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\dashboard\\expenses\\+page.svelte",
		"messages": [
			{
				"ruleId": "svelte/no-navigation-without-resolve",
				"severity": 1,
				"message": "Unexpected goto() call without resolve().",
				"line": 225,
				"column": 8,
				"nodeType": null,
				"messageId": "gotoWithoutResolve",
				"endLine": 225,
				"endColumn": 33
			},
			{
				"ruleId": "svelte/no-navigation-without-resolve",
				"severity": 1,
				"message": "Unexpected goto() call without resolve().",
				"line": 230,
				"column": 9,
				"nodeType": null,
				"messageId": "gotoWithoutResolve",
				"endLine": 230,
				"endColumn": 48
			},
			{
				"ruleId": "svelte/no-navigation-without-resolve",
				"severity": 1,
				"message": "Unexpected goto() call without resolve().",
				"line": 232,
				"column": 9,
				"nodeType": null,
				"messageId": "gotoWithoutResolve",
				"endLine": 232,
				"endColumn": 49
			},
			{
				"ruleId": "svelte/no-navigation-without-resolve",
				"severity": 1,
				"message": "Unexpected goto() call without resolve().",
				"line": 535,
				"column": 26,
				"nodeType": null,
				"messageId": "gotoWithoutResolve",
				"endLine": 535,
				"endColumn": 58
			}
		],
		"suppressedMessages": [
			{
				"ruleId": "svelte/require-store-reactive-access",
				"severity": 2,
				"message": "Use the $ prefix or the get function to access reactive values instead of accessing the raw store.",
				"line": 24,
				"column": 33,
				"nodeType": "Identifier",
				"messageId": "usingRawStoreInText",
				"endLine": 24,
				"endColumn": 41,
				"fix": { "range": [1011, 1011], "text": "$" },
				"suppressions": [{ "kind": "directive", "justification": "" }]
			}
		],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 4,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"source": "<script lang=\"ts\">\n\timport { expenses, isLoading as expensesLoading } from '$lib/stores/expenses';\n\timport { trips, isLoading as tripsLoading } from '$lib/stores/trips';\n\timport { userSettings } from '$lib/stores/userSettings';\n\timport { user } from '$lib/stores/auth';\n\timport { toasts } from '$lib/stores/toast';\n\timport Modal from '$lib/components/ui/Modal.svelte';\n\timport Skeleton from '$lib/components/ui/Skeleton.svelte';\n\timport { goto, invalidateAll } from '$app/navigation';\n\timport { page } from '$app/stores';\n\timport { onDestroy } from 'svelte';\n\timport { SvelteSet } from '$lib/utils/svelte-reactivity';\n\timport type { PageData } from './$types';\n\n\texport let data: PageData;\n\n\t// [!code fix] HYDRATION\n\t$: if (data.expenses) {\n\t\tconst normalize = (records: any[]) =>\n\t\t\trecords.map((r) => ({ ...r, syncStatus: (r as any).syncStatus ?? 'synced' }));\n\t\tconst normalized = normalize(data.expenses);\n\n\t\t// eslint-disable-next-line svelte/require-store-reactive-access\n\t\tif ($user?.id && 'hydrate' in expenses) {\n\t\t\texpenses.hydrate(normalized, $user.id);\n\t\t} else {\n\t\t\texpenses.set(normalized);\n\t\t}\n\t}\n\n\t// --- STATE ---\n\tlet searchQuery = '';\n\tlet sortBy = 'date';\n\tlet sortOrder = 'desc';\n\tlet filterCategory = 'all';\n\n\timport { SvelteDate } from '$lib/utils/svelte-reactivity';\n\tconst _now = SvelteDate.now();\n\tfunction _fmtInput(d: SvelteDate) {\n\t\treturn d.toInput();\n\t}\n\tlet startDate = _fmtInput(SvelteDate.from(new Date(_now.getFullYear(), _now.getMonth(), 1)));\n\tlet endDate = _fmtInput(SvelteDate.from(new Date(_now.getFullYear(), _now.getMonth() + 1, 0)));\n\n\tlet lastHadSelections = false;\n\n\t// Pagination\n\tlet currentPage = 1;\n\tconst itemsPerPage = 20;\n\n\t// Selection State\n\tlet selectedExpenses = new SvelteSet<string>();\n\n\t// Pagination state\n\tlet visibleExpenses: any[] = [];\n\t$: totalPages = Math.ceil(filteredExpenses.length / itemsPerPage);\n\t$: visibleExpenses = filteredExpenses.slice(\n\t\t(currentPage - 1) * itemsPerPage,\n\t\tcurrentPage * itemsPerPage\n\t);\n\n\t$: if (typeof document !== 'undefined') {\n\t\tconst hasSelections = selectedExpenses.size > 0;\n\t\tif (hasSelections !== lastHadSelections) {\n\t\t\tif (hasSelections) {\n\t\t\t\tdocument.body.classList.add('has-selections');\n\t\t\t} else {\n\t\t\t\tdocument.body.classList.remove('has-selections');\n\t\t\t}\n\t\t\tlastHadSelections = hasSelections;\n\t\t}\n\t}\n\n\t// Clean up body class when component is destroyed\n\tonDestroy(() => {\n\t\tif (typeof document !== 'undefined') {\n\t\t\tdocument.body.classList.remove('has-selections');\n\t\t}\n\t});\n\n\t// Use categories from settings, default to basic if empty\n\t$: categories =\n\t\t$userSettings.expenseCategories?.length > 0\n\t\t\t? $userSettings.expenseCategories\n\t\t\t: ['maintenance', 'insurance', 'supplies', 'other'];\n\n\t// Which sub-category tab is active in the modal\n\tlet activeCategoryType: 'maintenance' | 'supplies' | 'expenses' = 'expenses';\n\n\t// Derive the active list depending on the selected tab\n\t$: activeCategories =\n\t\tactiveCategoryType === 'maintenance'\n\t\t\t? $userSettings.maintenanceCategories || ['oil change', 'repair']\n\t\t\t: activeCategoryType === 'supplies'\n\t\t\t\t? $userSettings.supplyCategories || ['water', 'snacks']\n\t\t\t\t: $userSettings.expenseCategories || ['maintenance', 'insurance', 'supplies', 'other'];\n\n\t// --- MODAL STATE (Only for Categories now) ---\n\tlet isManageCategoriesOpen = false;\n\tlet newCategoryName = '';\n\n\t// --- DERIVE TRIP EXPENSES ---\n\t$: tripExpenses = $trips.flatMap((trip) => {\n\t\tconst items = [];\n\t\tconst date =\n\t\t\ttrip.date || (typeof trip.createdAt === 'string' ? trip.createdAt.split('T')[0] : '');\n\n\t\t// 1. Fuel\n\t\tif (trip.fuelCost && trip.fuelCost > 0) {\n\t\t\titems.push({\n\t\t\t\tid: `trip-fuel-${trip.id}`,\n\t\t\t\tdate: date,\n\t\t\t\tcategory: 'fuel',\n\t\t\t\tamount: trip.fuelCost,\n\t\t\t\tdescription: 'Fuel',\n\t\t\t\ttaxDeductible: !!(trip as any).fuelTaxDeductible,\n\t\t\t\tsource: 'trip',\n\t\t\t\ttripId: trip.id\n\t\t\t});\n\t\t}\n\n\t\t// 2. Maintenance Items\n\t\tconst maint = (trip as any).maintenanceItems || [];\n\t\tif (maint.length) {\n\t\t\tmaint.forEach((item: any, i: number) => {\n\t\t\t\titems.push({\n\t\t\t\t\tid: `trip-maint-${trip.id}-${i}`,\n\t\t\t\t\tdate: date,\n\t\t\t\t\tcategory: 'maintenance',\n\t\t\t\t\tamount: item.cost,\n\t\t\t\t\tdescription: `${item.type}`,\n\t\t\t\t\ttaxDeductible: !!item.taxDeductible,\n\t\t\t\t\tsource: 'trip',\n\t\t\t\t\ttripId: trip.id\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\n\t\t// 3. Supply Items\n\t\tconst supplies = (trip as any).supplyItems || (trip as any).suppliesItems || [];\n\t\tif (supplies.length) {\n\t\t\tsupplies.forEach((item: any, i: number) => {\n\t\t\t\titems.push({\n\t\t\t\t\tid: `trip-supply-${trip.id}-${i}`,\n\t\t\t\t\tdate: date,\n\t\t\t\t\tcategory: 'supplies',\n\t\t\t\t\tamount: item.cost,\n\t\t\t\t\tdescription: `${item.type}`,\n\t\t\t\t\ttaxDeductible: !!item.taxDeductible,\n\t\t\t\t\tsource: 'trip',\n\t\t\t\t\ttripId: trip.id\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\n\t\treturn items;\n\t});\n\n\t// --- COMBINE & FILTER ---\n\t$: allExpenses = [...$expenses, ...tripExpenses];\n\n\t// Reset selection when filters change\n\t$: if (searchQuery || sortBy || sortOrder || filterCategory || startDate || endDate) {\n\t\tselectedExpenses = new SvelteSet();\n\t\tcurrentPage = 1;\n\t}\n\n\t$: filteredExpenses = allExpenses\n\t\t.filter((item) => {\n\t\t\t// Search\n\t\t\tconst query = searchQuery.toLowerCase();\n\t\t\tconst matchesSearch =\n\t\t\t\t!query ||\n\t\t\t\t(item.description && item.description.toLowerCase().includes(query)) ||\n\t\t\t\titem.amount.toString().includes(query) ||\n\t\t\t\t((item as any).source === 'trip' && 'trip'.includes(query)) ||\n\t\t\t\t(item.category && item.category.toLowerCase().includes(query)) ||\n\t\t\t\t((item as any).tags &&\n\t\t\t\t\tArray.isArray((item as any).tags) &&\n\t\t\t\t\t(item as any).tags.some((tag: string) => tag.toLowerCase().includes(query))) ||\n\t\t\t\t((item as any).taxDeductible &&\n\t\t\t\t\t('tax deductible'.includes(query) ||\n\t\t\t\t\t\t'deductible'.includes(query) ||\n\t\t\t\t\t\t'tax'.includes(query)));\n\n\t\t\tif (!matchesSearch) return false;\n\n\t\t\t// Category\n\t\t\tif (filterCategory !== 'all' && item.category !== filterCategory) return false;\n\n\t\t\t// Date Range\n\t\t\tif (item.date) {\n\t\t\t\tconst itemDate = SvelteDate.from(item.date).startOfDay();\n\n\t\t\t\tif (startDate) {\n\t\t\t\t\tconst start = SvelteDate.from(startDate).startOfDay();\n\t\t\t\t\tif (itemDate.getTime() < start.getTime()) return false;\n\t\t\t\t}\n\t\t\t\tif (endDate) {\n\t\t\t\t\tconst end = SvelteDate.from(endDate).startOfDay();\n\t\t\t\t\tif (itemDate.getTime() > end.getTime()) return false;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn true;\n\t\t})\n\t\t.sort((a, b) => {\n\t\t\tlet aVal, bVal;\n\t\t\tif (sortBy === 'date') {\n\t\t\t\taVal = SvelteDate.from(a.date || 0).getTime();\n\t\t\t\tbVal = SvelteDate.from(b.date || 0).getTime();\n\t\t\t} else {\n\t\t\t\taVal = a.amount;\n\t\t\t\tbVal = b.amount;\n\t\t\t}\n\t\t\treturn sortOrder === 'asc' ? aVal - bVal : bVal - aVal;\n\t\t});\n\n\t$: totalAmount = filteredExpenses.reduce((sum, item) => sum + (item.amount || 0), 0);\n\t$: loading = $expensesLoading || $tripsLoading;\n\t$: allSelected = filteredExpenses.length > 0 && selectedExpenses.size === filteredExpenses.length;\n\n\t// --- ACTIONS ---\n\tfunction goToAdd() {\n\t\tgoto('/dashboard/expenses/new');\n\t}\n\n\tfunction editExpense(expense: any) {\n\t\tif ((expense as any).source === 'trip') {\n\t\t\tgoto(`/dashboard/trips?id=${expense.tripId}`);\n\t\t} else {\n\t\t\tgoto(`/dashboard/expenses/edit/${expense.id}`);\n\t\t}\n\t}\n\n\tasync function deleteExpense(id: string, e?: MouseEvent) {\n\t\tif (e) e.stopPropagation();\n\t\tif (!confirm('Move this expense to trash? You can restore it later.')) return;\n\n\t\t// Check if it's a trip log\n\t\tif (id.startsWith('trip-')) {\n\t\t\ttoasts.error('Cannot delete Trips here. Delete the Trip instead.');\n\t\t\treturn;\n\t\t}\n\n\t\tconst currentUser = $page.data['user'] || $user;\n\t\t// [!code fix] Strictly use ID.\n\t\tconst userId = currentUser?.id || localStorage.getItem('offline_user_id');\n\n\t\tif (userId) {\n\t\t\ttry {\n\t\t\t\tawait expenses.deleteExpense(id, userId);\n\t\t\t\ttoasts.success('Expense moved to trash');\n\t\t\t\tif (selectedExpenses.has(id)) {\n\t\t\t\t\tselectedExpenses = selectedExpenses.delete(id);\n\t\t\t\t}\n\t\t\t\t// [!code fix] Refresh page data to ensure server sync\n\t\t\t\tawait invalidateAll();\n\t\t\t} catch (err) {\n\t\t\t\tconsole.error(err);\n\t\t\t\ttoasts.error('Failed to move to trash');\n\t\t\t}\n\t\t}\n\t}\n\n\t// --- SELECTION LOGIC ---\n\tfunction toggleSelection(id: string) {\n\t\tselectedExpenses = selectedExpenses.has(id)\n\t\t\t? selectedExpenses.delete(id)\n\t\t\t: selectedExpenses.add(id);\n\t}\n\n\tfunction toggleSelectAll() {\n\t\tif (allSelected) selectedExpenses = new SvelteSet();\n\t\telse selectedExpenses = new SvelteSet(filteredExpenses.map((e) => e.id));\n\t}\n\n\tfunction changePage(newPage: number) {\n\t\tif (newPage >= 1 && newPage <= totalPages) {\n\t\t\tcurrentPage = newPage;\n\t\t}\n\t}\n\n\tasync function deleteSelected() {\n\t\tconst ids = Array.from(selectedExpenses);\n\t\tconst manualExpenses = ids.filter((id) => !id.startsWith('trip-'));\n\t\tconst tripLogs = ids.length - manualExpenses.length;\n\n\t\tif (manualExpenses.length === 0 && tripLogs > 0) {\n\t\t\ttoasts.error(`Cannot delete ${tripLogs} Trip Logs. Edit them in Trips.`);\n\t\t\treturn;\n\t\t}\n\n\t\tif (\n\t\t\t!confirm(\n\t\t\t\t`Move ${manualExpenses.length} expenses to trash? ${tripLogs > 0 ? `(${tripLogs} trips will be skipped)` : ''}`\n\t\t\t)\n\t\t)\n\t\t\treturn;\n\n\t\tconst currentUser = $page.data['user'] || $user;\n\t\t// [!code fix] Strictly use ID.\n\t\tconst userId = currentUser?.id || localStorage.getItem('offline_user_id');\n\n\t\tif (!userId) return;\n\n\t\tlet successCount = 0;\n\t\tfor (const id of manualExpenses) {\n\t\t\ttry {\n\t\t\t\tawait expenses.deleteExpense(id, userId);\n\t\t\t\tsuccessCount++;\n\t\t\t} catch (err) {\n\t\t\t\tconsole.error(`Failed to delete ${id}`, err);\n\t\t\t}\n\t\t}\n\n\t\ttoasts.success(`Moved ${successCount} expenses to trash.`);\n\t\tselectedExpenses = new SvelteSet();\n\t\t// [!code fix] Refresh page data to ensure server sync\n\t\tawait invalidateAll();\n\t}\n\n\tfunction isTripSource(item: any): boolean {\n\t\treturn (item as any)?.source === 'trip';\n\t}\n\n\tfunction exportSelected() {\n\t\tconst selectedData = filteredExpenses.filter((e) => selectedExpenses.has(e.id));\n\t\tif (selectedData.length === 0) return;\n\n\t\tconst headers = ['Date', 'Category', 'Amount', 'Description', 'Source'];\n\t\tconst rows = selectedData.map((e) =>\n\t\t\t[\n\t\t\t\te.date,\n\t\t\t\te.category,\n\t\t\t\te.amount,\n\t\t\t\t`\"${(e.description || '').replace(/\"/g, '\"\"')}\"`,\n\t\t\t\tisTripSource(e) ? 'Trip' : 'Manual'\n\t\t\t].join(',')\n\t\t);\n\n\t\tconst csvContent = [headers.join(','), ...rows].join('\\n');\n\t\tconst blob = new Blob([csvContent], { type: 'text/csv' });\n\t\tconst url = window.URL.createObjectURL(blob);\n\t\tconst a = document.createElement('a');\n\t\ta.href = url;\n\t\ta.download = `expenses_export_${new Date().toISOString().split('T')[0]}.csv`;\n\t\ta.click();\n\n\t\ttoasts.success(`Exported ${selectedData.length} items.`);\n\t\tselectedExpenses = new SvelteSet();\n\t}\n\n\t// --- CATEGORY MANAGEMENT ---\n\tasync function updateCategories(newCategories: string[]) {\n\t\tconst updateData: any = {};\n\t\tif (activeCategoryType === 'maintenance') {\n\t\t\tuserSettings.update((s) => ({ ...s, maintenanceCategories: newCategories }));\n\t\t\tupdateData.maintenanceCategories = newCategories;\n\t\t} else if (activeCategoryType === 'supplies') {\n\t\t\tuserSettings.update((s) => ({ ...s, supplyCategories: newCategories }));\n\t\t\tupdateData.supplyCategories = newCategories;\n\t\t} else {\n\t\t\tuserSettings.update((s) => ({ ...s, expenseCategories: newCategories }));\n\t\t\tupdateData.expenseCategories = newCategories;\n\t\t}\n\n\t\ttry {\n\t\t\tconst { saveSettings } = await import('../settings/lib/save-settings');\n\t\t\tconst result = await saveSettings(updateData);\n\t\t\tif (!result.ok) throw new Error(result.error);\n\t\t} catch (e) {\n\t\t\tconsole.error('Failed to sync settings', e);\n\t\t\ttoasts.error('Saved locally, but sync failed');\n\t\t}\n\t}\n\n\tasync function addCategory() {\n\t\tif (!newCategoryName.trim()) return;\n\t\tconst val = newCategoryName.trim().toLowerCase();\n\t\tif (activeCategories.includes(val)) {\n\t\t\ttoasts.error('Category already exists');\n\t\t\treturn;\n\t\t}\n\t\tconst updated = [...activeCategories, val];\n\t\tawait updateCategories(updated);\n\t\tnewCategoryName = '';\n\t\ttoasts.success('Category added');\n\t}\n\n\tasync function removeCategory(cat: string) {\n\t\tif (!confirm(`Delete \"${cat}\" category? Existing expenses will keep this category.`)) return;\n\t\tconst updated = activeCategories.filter((c) => c !== cat);\n\t\tawait updateCategories(updated);\n\t\ttoasts.success('Category removed');\n\t}\n\n\t// --- HELPERS ---\n\tfunction formatCurrency(amount: number) {\n\t\treturn new Intl.NumberFormat('en-US', { style: 'currency', currency: 'USD' }).format(amount);\n\t}\n\n\tfunction formatDate(dateStr: string) {\n\t\tif (!dateStr) return '';\n\t\treturn new Date(dateStr).toLocaleDateString('en-US', {\n\t\t\tmonth: 'short',\n\t\t\tday: 'numeric',\n\t\t\tyear: 'numeric',\n\t\t\ttimeZone: 'UTC'\n\t\t});\n\t}\n\n\tfunction getCategoryLabel(cat: string) {\n\t\treturn cat.charAt(0).toUpperCase() + cat.slice(1);\n\t}\n\n\tfunction getCategoryColor(cat: string) {\n\t\tif (cat === 'fuel') return 'text-red-600 bg-red-50 border-red-200';\n\t\tconst colors = [\n\t\t\t'text-blue-600 bg-blue-50 border-blue-200',\n\t\t\t'text-purple-600 bg-purple-50 border-purple-200',\n\t\t\t'text-orange-600 bg-orange-50 border-orange-200',\n\t\t\t'text-green-600 bg-green-50 border-green-200',\n\t\t\t'text-pink-600 bg-pink-50 border-pink-200',\n\t\t\t'text-indigo-600 bg-indigo-50 border-indigo-200'\n\t\t];\n\t\tif (cat === 'maintenance') return colors[0];\n\t\tif (cat === 'insurance') return colors[1];\n\t\tif (cat === 'supplies') return colors[2];\n\t\tconst sum = cat.split('').reduce((acc, char) => acc + char.charCodeAt(0), 0);\n\t\treturn colors[sum % colors.length];\n\t}\n\n\t// When an expense description is empty, show a parent category label (Maintenance/Supplies/etc.)\n\tfunction getFallbackLabel(expense: any) {\n\t\tconst cat = (expense.category || '').toString().toLowerCase();\n\t\t// maintenance categories from settings or defaults\n\t\tconst maintenance = (\n\t\t\t$userSettings.maintenanceCategories || [\n\t\t\t\t'oil change',\n\t\t\t\t'tire rotation',\n\t\t\t\t'brake service',\n\t\t\t\t'filter replacement'\n\t\t\t]\n\t\t).map((s) => s.toLowerCase());\n\t\tif (maintenance.includes(cat)) return 'Maintenance';\n\n\t\tconst supplies = (\n\t\t\t$userSettings.supplyCategories || ['concrete', 'poles', 'wire', 'tools', 'equipment rental']\n\t\t).map((s) => s.toLowerCase());\n\t\tif (supplies.includes(cat)) return 'Supplies';\n\n\t\tif (cat === 'fuel') return 'Fuel';\n\n\t\t// If the category is one of the top-level expense categories, show it capitalized\n\t\tconst expCats = (\n\t\t\t$userSettings.expenseCategories || ['maintenance', 'insurance', 'supplies', 'other']\n\t\t).map((s) => s.toLowerCase());\n\t\tif (expCats.includes(cat)) return getCategoryLabel(cat);\n\n\t\t// default fallback: capitalized category (or 'Expenses')\n\t\treturn getCategoryLabel(expense.category || 'expenses');\n\t}\n\n\t// Swipe Action\n\tfunction swipeable(\n\t\tnode: HTMLElement,\n\t\t{\n\t\t\tonEdit,\n\t\t\tonDelete,\n\t\t\tisReadOnly\n\t\t}: { onEdit: () => void; onDelete: (e: any) => void; isReadOnly: boolean }\n\t) {\n\t\tif (isReadOnly) return;\n\t\tlet startX = 0;\n\t\tlet x = 0;\n\t\tlet swiping = false;\n\n\t\tfunction handleTouchStart(e: TouchEvent) {\n\t\t\tconst touch = e.touches?.[0];\n\t\t\tif (!touch) return;\n\t\t\tstartX = touch.clientX;\n\t\t\tx = 0;\n\t\t\tnode.style.transition = 'none';\n\t\t}\n\n\t\tfunction handleTouchMove(e: TouchEvent) {\n\t\t\tconst touch = e.touches?.[0];\n\t\t\tif (!touch) return;\n\t\t\tconst dx = touch.clientX - startX;\n\t\t\tswiping = true;\n\t\t\tif (dx < -120) x = -120;\n\t\t\telse if (dx > 120) x = 120;\n\t\t\telse x = dx;\n\t\t\tnode.style.transform = `translateX(${x}px)`;\n\t\t\tif (Math.abs(x) > 10) e.preventDefault();\n\t\t}\n\n\t\tfunction handleTouchEnd() {\n\t\t\tif (!swiping) return;\n\t\t\tswiping = false;\n\t\t\tnode.style.transition = 'transform 0.2s ease-out';\n\t\t\tif (x < -80) onDelete({ stopPropagation: () => {} });\n\t\t\telse if (x > 80) onEdit();\n\t\t\tnode.style.transform = 'translateX(0)';\n\t\t}\n\n\t\tnode.addEventListener('touchstart', handleTouchStart, { passive: false });\n\t\tnode.addEventListener('touchmove', handleTouchMove, { passive: false });\n\t\tnode.addEventListener('touchend', handleTouchEnd);\n\t\treturn {\n\t\t\tdestroy() {\n\t\t\t\tnode.removeEventListener('touchstart', handleTouchStart);\n\t\t\t\tnode.removeEventListener('touchmove', handleTouchMove);\n\t\t\t\tnode.removeEventListener('touchend', handleTouchEnd);\n\t\t\t}\n\t\t};\n\t}\n</script>\n\n<svelte:head>\n\t<title>Expenses - Go Route Yourself</title>\n</svelte:head>\n\n<div class=\"page-container\">\n\t<div class=\"page-header\">\n\t\t<div class=\"header-text\">\n\t\t\t<h1 class=\"page-title\">Expenses</h1>\n\t\t\t<p class=\"page-subtitle\">Track maintenance, supplies, and other costs</p>\n\t\t</div>\n\n\t\t<div class=\"header-actions\">\n\t\t\t<button\n\t\t\t\tclass=\"btn-secondary\"\n\t\t\t\ton:click={() => goto('/dashboard/trash?type=expenses')}\n\t\t\t\taria-label=\"View Trash\"\n\t\t\t>\n\t\t\t\t<svg\n\t\t\t\t\twidth=\"20\"\n\t\t\t\t\theight=\"20\"\n\t\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\t\tfill=\"none\"\n\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\t\tstroke-linejoin=\"round\"\n\t\t\t\t>\n\t\t\t\t\t<polyline points=\"3 6 5 6 21 6\"></polyline>\n\t\t\t\t\t<path d=\"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2\"\n\t\t\t\t\t></path>\n\t\t\t\t</svg>\n\t\t\t</button>\n\n\t\t\t<button\n\t\t\t\tclass=\"btn-secondary\"\n\t\t\t\ton:click={() => (isManageCategoriesOpen = true)}\n\t\t\t\taria-label=\"Expense Settings\"\n\t\t\t>\n\t\t\t\t<svg\n\t\t\t\t\twidth=\"20\"\n\t\t\t\t\theight=\"20\"\n\t\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\t\tfill=\"none\"\n\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\t\tstroke-linejoin=\"round\"\n\t\t\t\t\t><path\n\t\t\t\t\t\td=\"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.09a2 2 0 0 1-1-1.74v-.47a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.39a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z\"\n\t\t\t\t\t/><circle cx=\"12\" cy=\"12\" r=\"3\" /></svg\n\t\t\t\t>\n\t\t\t</button>\n\n\t\t\t<button class=\"btn-primary\" on:click={goToAdd}>\n\t\t\t\t<svg width=\"20\" height=\"20\" viewBox=\"0 0 20 20\" fill=\"none\">\n\t\t\t\t\t<path\n\t\t\t\t\t\td=\"M10 4V16M4 10H16\"\n\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\t\t\tstroke-linejoin=\"round\"\n\t\t\t\t\t/>\n\t\t\t\t</svg>\n\t\t\t\tNew Expense\n\t\t\t</button>\n\t\t</div>\n\t</div>\n\n\t<div class=\"stats-summary\">\n\t\t<div class=\"summary-card\">\n\t\t\t<div class=\"summary-label\">Total Expenses</div>\n\t\t\t<div class=\"summary-value\">{filteredExpenses.length}</div>\n\t\t</div>\n\n\t\t<div class=\"summary-card\">\n\t\t\t<div class=\"summary-label\">Total Cost</div>\n\t\t\t<div class=\"summary-value\">\n\t\t\t\t{formatCurrency(totalAmount)}\n\t\t\t</div>\n\t\t</div>\n\n\t\t<div class=\"summary-card\">\n\t\t\t<div class=\"summary-label\">Tax Deductions</div>\n\t\t\t<div class=\"summary-value\">\n\t\t\t\t{formatCurrency(\n\t\t\t\t\tfilteredExpenses.filter((e) => e.taxDeductible === true).reduce((s, e) => s + e.amount, 0)\n\t\t\t\t)}\n\t\t\t</div>\n\t\t</div>\n\n\t\t<div class=\"summary-card\">\n\t\t\t<div class=\"summary-label\">Non Tax Deductions</div>\n\t\t\t<div class=\"summary-value\">\n\t\t\t\t{formatCurrency(\n\t\t\t\t\tfilteredExpenses\n\t\t\t\t\t\t.filter((e) => !(e.taxDeductible === true))\n\t\t\t\t\t\t.reduce((s, e) => s + e.amount, 0)\n\t\t\t\t)}\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\n\t<div class=\"filters-bar\">\n\t\t<div class=\"search-box\">\n\t\t\t<svg class=\"search-icon\" width=\"20\" height=\"20\" viewBox=\"0 0 20 20\" fill=\"none\">\n\t\t\t\t<path\n\t\t\t\t\td=\"M9 17C13.4183 17 17 13.4183 17 9C17 4.58172 13.4183 1 9 1C4.58172 1 1 4.58172 1 9C1 13.4183 4.58172 17 9 17Z\"\n\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\t\tstroke-linejoin=\"round\"\n\t\t\t\t/>\n\t\t\t\t<path\n\t\t\t\t\td=\"M19 19L14.65 14.65\"\n\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\t\tstroke-linejoin=\"round\"\n\t\t\t\t/>\n\t\t\t</svg>\n\t\t\t<input\n\t\t\t\tid=\"search-expenses\"\n\t\t\t\tname=\"searchQuery\"\n\t\t\t\ttype=\"text\"\n\t\t\t\tplaceholder=\"Search expenses...\"\n\t\t\t\tbind:value={searchQuery}\n\t\t\t/>\n\t\t</div>\n\n\t\t<div class=\"filter-group date-group\">\n\t\t\t<input\n\t\t\t\tid=\"start-date\"\n\t\t\t\tname=\"startDate\"\n\t\t\t\ttype=\"date\"\n\t\t\t\tbind:value={startDate}\n\t\t\t\tclass=\"date-input\"\n\t\t\t\taria-label=\"Start Date\"\n\t\t\t/>\n\t\t\t<span class=\"date-sep\">-</span>\n\t\t\t<input\n\t\t\t\tid=\"end-date\"\n\t\t\t\tname=\"endDate\"\n\t\t\t\ttype=\"date\"\n\t\t\t\tbind:value={endDate}\n\t\t\t\tclass=\"date-input\"\n\t\t\t\taria-label=\"End Date\"\n\t\t\t/>\n\t\t</div>\n\n\t\t<div class=\"filter-group\">\n\t\t\t<select\n\t\t\t\tid=\"filter-category\"\n\t\t\t\tname=\"filterCategory\"\n\t\t\t\tbind:value={filterCategory}\n\t\t\t\tclass=\"filter-select\"\n\t\t\t\taria-label=\"Filter by category\"\n\t\t\t>\n\t\t\t\t<option value=\"all\">All Categories</option>\n\t\t\t\t{#each categories as cat (cat)}\n\t\t\t\t\t<option value={cat}>{getCategoryLabel(cat)}</option>\n\t\t\t\t{/each}\n\t\t\t\t<option value=\"fuel\">Fuel (Trips)</option>\n\t\t\t</select>\n\n\t\t\t<select\n\t\t\t\tid=\"sort-by\"\n\t\t\t\tname=\"sortBy\"\n\t\t\t\tbind:value={sortBy}\n\t\t\t\tclass=\"filter-select\"\n\t\t\t\taria-label=\"Sort results\"\n\t\t\t>\n\t\t\t\t<option value=\"date\">By Date</option>\n\t\t\t\t<option value=\"amount\">By Cost</option>\n\t\t\t</select>\n\n\t\t\t<button\n\t\t\t\tclass=\"sort-btn\"\n\t\t\t\taria-label=\"Toggle sort order\"\n\t\t\t\ton:click={() => (sortOrder = sortOrder === 'asc' ? 'desc' : 'asc')}\n\t\t\t>\n\t\t\t\t<svg\n\t\t\t\t\twidth=\"20\"\n\t\t\t\t\theight=\"20\"\n\t\t\t\t\tviewBox=\"0 0 20 20\"\n\t\t\t\t\tfill=\"none\"\n\t\t\t\t\tstyle=\"transform: rotate({sortOrder === 'asc' ? '180deg' : '0deg'})\"\n\t\t\t\t>\n\t\t\t\t\t<path\n\t\t\t\t\t\td=\"M10 3V17M10 17L4 11M10 17L16 11\"\n\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\t\t\tstroke-linejoin=\"round\"\n\t\t\t\t\t/>\n\t\t\t\t</svg>\n\t\t\t</button>\n\t\t</div>\n\t</div>\n\n\t{#if filteredExpenses.length > 0}\n\t\t<div class=\"batch-header\" class:visible={filteredExpenses.length > 0}>\n\t\t\t<label class=\"checkbox-container\">\n\t\t\t\t<input\n\t\t\t\t\tid=\"select-all\"\n\t\t\t\t\tname=\"selectAll\"\n\t\t\t\t\ttype=\"checkbox\"\n\t\t\t\t\tchecked={allSelected}\n\t\t\t\t\ton:change={toggleSelectAll}\n\t\t\t\t/>\n\t\t\t\t<span class=\"checkmark\"></span>\n\t\t\t\tSelect All ({filteredExpenses.length})\n\t\t\t</label>\n\n\t\t\t<span class=\"page-info\">Showing {visibleExpenses.length} of {filteredExpenses.length}</span>\n\t\t</div>\n\t{/if}\n\n\t{#if loading}\n\t\t<div class=\"expense-list-cards\">\n\t\t\t{#each Array(3) as _, i (i)}\n\t\t\t\t<div class=\"expense-card\">\n\t\t\t\t\t<div class=\"card-top\">\n\t\t\t\t\t\t<div style=\"flex: 1\">\n\t\t\t\t\t\t\t<Skeleton height=\"16px\" width=\"30%\" className=\"mb-2\" />\n\t\t\t\t\t\t\t<Skeleton height=\"20px\" width=\"60%\" />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<Skeleton height=\"24px\" width=\"60px\" />\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t{/each}\n\t\t</div>\n\t{:else if filteredExpenses.length > 0}\n\t\t<div class=\"expense-list-cards\">\n\t\t\t{#each visibleExpenses as expense (expense.id)}\n\t\t\t\t{@const isSelected = selectedExpenses.has(expense.id)}\n\t\t\t\t<div class=\"card-wrapper\">\n\t\t\t\t\t{#if !isTripSource(expense)}\n\t\t\t\t\t\t<div class=\"swipe-bg\">\n\t\t\t\t\t\t\t<div class=\"swipe-action edit\"><span>Edit</span></div>\n\t\t\t\t\t\t\t<div class=\"swipe-action delete\"><span>Trash</span></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t{/if}\n\n\t\t\t\t\t<div\n\t\t\t\t\t\tclass=\"expense-card\"\n\t\t\t\t\t\tclass:read-only={isTripSource(expense)}\n\t\t\t\t\t\tclass:selected={isSelected}\n\t\t\t\t\t\ton:click={() => editExpense(expense)}\n\t\t\t\t\t\trole=\"button\"\n\t\t\t\t\t\ttabindex=\"0\"\n\t\t\t\t\t\ton:keypress={(e) => e.key === 'Enter' && editExpense(expense)}\n\t\t\t\t\t\tuse:swipeable={{\n\t\t\t\t\t\t\tonEdit: () => editExpense(expense),\n\t\t\t\t\t\t\tonDelete: (e) => deleteExpense(expense.id, e),\n\t\t\t\t\t\t\tisReadOnly: isTripSource(expense)\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t<div class=\"card-top\">\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tclass=\"selection-box\"\n\t\t\t\t\t\t\t\ton:click|stopPropagation\n\t\t\t\t\t\t\t\ton:keydown|stopPropagation\n\t\t\t\t\t\t\t\trole=\"none\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<label class=\"checkbox-container\">\n\t\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\t\ttype=\"checkbox\"\n\t\t\t\t\t\t\t\t\t\tid={'expense-' + expense.id + '-checkbox'}\n\t\t\t\t\t\t\t\t\t\tname=\"selectedExpense\"\n\t\t\t\t\t\t\t\t\t\tvalue={expense.id}\n\t\t\t\t\t\t\t\t\t\taria-labelledby={'expense-' + expense.id + '-title'}\n\t\t\t\t\t\t\t\t\t\tchecked={isSelected}\n\t\t\t\t\t\t\t\t\t\ton:change={() => toggleSelection(expense.id)}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t<span class=\"checkmark\"></span>\n\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t<div class=\"expense-main-info\">\n\t\t\t\t\t\t\t\t<span class=\"expense-date-display\">\n\t\t\t\t\t\t\t\t\t{formatDate(expense.date || '')}\n\t\t\t\t\t\t\t\t</span>\n\n\t\t\t\t\t\t\t\t<h2 class=\"expense-desc-title\" id={'expense-' + expense.id + '-title'}>\n\t\t\t\t\t\t\t\t\t{expense.description || getFallbackLabel(expense)}\n\t\t\t\t\t\t\t\t</h2>\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\tclass=\"expense-amount-display\"\n\t\t\t\t\t\t\t\taria-label={`Amount: ${formatCurrency(expense.amount || 0)}`}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{formatCurrency(expense.amount || 0)}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t<svg class=\"nav-icon\" width=\"20\" height=\"20\" viewBox=\"0 0 20 20\" fill=\"none\">\n\t\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\t\td=\"M9 18L15 12L9 6\"\n\t\t\t\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\t\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\t\t\t\t\t\tstroke-linejoin=\"round\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class=\"card-stats\">\n\t\t\t\t\t\t\t<div class=\"stat-badge-container\">\n\t\t\t\t\t\t\t\t<span class={`category-badge ${getCategoryColor(expense.category)}`}>\n\t\t\t\t\t\t\t\t\t{getCategoryLabel(expense.category)}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t{#if isTripSource(expense)}\n\t\t\t\t\t\t\t\t\t<span class=\"source-badge\">Trip</span>\n\t\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t\t\t{#if expense.taxDeductible}\n\t\t\t\t\t\t\t\t\t<span class=\"category-badge tax-pill\" title=\"Tax deductible\">Tax Deductible</span>\n\t\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t{/each}\n\t\t</div>\n\n\t\t{#if totalPages > 1}\n\t\t\t<div class=\"pagination-container\">\n\t\t\t\t<div class=\"pagination\">\n\t\t\t\t\t<button\n\t\t\t\t\t\tclass=\"pagination-btn\"\n\t\t\t\t\t\tdisabled={currentPage === 1}\n\t\t\t\t\t\ton:click={() => changePage(currentPage - 1)}>ΓåÉ Prev</button\n\t\t\t\t\t>\n\t\t\t\t\t<span class=\"page-status\">Page {currentPage} of {totalPages}</span>\n\t\t\t\t\t<button\n\t\t\t\t\t\tclass=\"pagination-btn\"\n\t\t\t\t\t\tdisabled={currentPage === totalPages}\n\t\t\t\t\t\ton:click={() => changePage(currentPage + 1)}>Next ΓåÆ</button\n\t\t\t\t\t>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t{/if}\n\t{:else}\n\t\t<div class=\"empty-state\">\n\t\t\t<p>No expenses found matching your filters.</p>\n\t\t</div>\n\t{/if}\n</div>\n\n{#if selectedExpenses.size > 0}\n\t<div class=\"action-bar-container\" data-has-selections=\"true\">\n\t\t<div class=\"action-bar\">\n\t\t\t<div class=\"action-bar-left\">\n\t\t\t\t<div class=\"selection-indicator\">\n\t\t\t\t\t<svg\n\t\t\t\t\t\twidth=\"20\"\n\t\t\t\t\t\theight=\"20\"\n\t\t\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\t\t\tfill=\"none\"\n\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<polyline points=\"20 6 9 17 4 12\"></polyline>\n\t\t\t\t\t</svg>\n\t\t\t\t\t<span class=\"selected-count\"\n\t\t\t\t\t\t>{selectedExpenses.size}\n\t\t\t\t\t\t{selectedExpenses.size === 1 ? 'expense' : 'expenses'} selected</span\n\t\t\t\t\t>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div class=\"action-bar-right\">\n\t\t\t\t<button class=\"action-pill secondary\" on:click={() => (selectedExpenses = new SvelteSet())}>\n\t\t\t\t\t<svg\n\t\t\t\t\t\twidth=\"16\"\n\t\t\t\t\t\theight=\"16\"\n\t\t\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\t\t\tfill=\"none\"\n\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<line x1=\"18\" y1=\"6\" x2=\"6\" y2=\"18\"></line>\n\t\t\t\t\t\t<line x1=\"6\" y1=\"6\" x2=\"18\" y2=\"18\"></line>\n\t\t\t\t\t</svg>\n\t\t\t\t\t<span class=\"action-text\">Cancel</span>\n\t\t\t\t</button>\n\n\t\t\t\t<button class=\"action-pill export\" on:click={exportSelected}>\n\t\t\t\t\t<svg\n\t\t\t\t\t\twidth=\"16\"\n\t\t\t\t\t\theight=\"16\"\n\t\t\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\t\t\tfill=\"none\"\n\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<path d=\"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4\"></path>\n\t\t\t\t\t\t<polyline points=\"7 10 12 15 17 10\"></polyline>\n\t\t\t\t\t\t<line x1=\"12\" y1=\"15\" x2=\"12\" y2=\"3\"></line>\n\t\t\t\t\t</svg>\n\t\t\t\t\t<span class=\"action-text\">Export</span>\n\t\t\t\t</button>\n\n\t\t\t\t<button class=\"action-pill danger\" on:click={deleteSelected}>\n\t\t\t\t\t<svg\n\t\t\t\t\t\twidth=\"16\"\n\t\t\t\t\t\theight=\"16\"\n\t\t\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\t\t\tfill=\"none\"\n\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<polyline points=\"3 6 5 6 21 6\"></polyline>\n\t\t\t\t\t\t<path d=\"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2\"\n\t\t\t\t\t\t></path>\n\t\t\t\t\t</svg>\n\t\t\t\t\t<span class=\"action-text\">Delete</span>\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n{/if}\n\n<Modal bind:open={isManageCategoriesOpen} title=\"Expense Settings\">\n\t<div class=\"categories-manager\">\n\t\t<div class=\"tabs sub-tabs\">\n\t\t\t<button\n\t\t\t\tclass=\"tab-btn\"\n\t\t\t\tclass:active={activeCategoryType === 'maintenance'}\n\t\t\t\ton:click={() => (activeCategoryType = 'maintenance')}>Maintenance</button\n\t\t\t>\n\t\t\t<button\n\t\t\t\tclass=\"tab-btn\"\n\t\t\t\tclass:active={activeCategoryType === 'supplies'}\n\t\t\t\ton:click={() => (activeCategoryType = 'supplies')}>Supplies</button\n\t\t\t>\n\t\t\t<button\n\t\t\t\tclass=\"tab-btn\"\n\t\t\t\tclass:active={activeCategoryType === 'expenses'}\n\t\t\t\ton:click={() => (activeCategoryType = 'expenses')}>Expenses</button\n\t\t\t>\n\t\t</div>\n\n\t\t<p class=\"text-sm text-gray-500 mb-4\">\n\t\t\tManage {activeCategoryType} options.\n\t\t</p>\n\n\t\t<div class=\"cat-list\">\n\t\t\t{#each activeCategories as cat (cat)}\n\t\t\t\t<div class=\"cat-item\">\n\t\t\t\t\t<span class={`cat-badge ${getCategoryColor(cat)}`}>{getCategoryLabel(cat)}</span>\n\t\t\t\t\t<button\n\t\t\t\t\t\tclass=\"cat-delete\"\n\t\t\t\t\t\ton:click={() => removeCategory(cat)}\n\t\t\t\t\t\taria-label=\"Delete Category\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\twidth=\"16\"\n\t\t\t\t\t\t\theight=\"16\"\n\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\t\t\t\tfill=\"none\"\n\t\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\t\t\t\tstroke-linejoin=\"round\"\n\t\t\t\t\t\t\t><line x1=\"18\" y1=\"6\" x2=\"6\" y2=\"18\"></line><line x1=\"6\" y1=\"6\" x2=\"18\" y2=\"18\"\n\t\t\t\t\t\t\t></line></svg\n\t\t\t\t\t\t>\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t{:else}\n\t\t\t\t<div class=\"text-sm text-gray-400 italic text-center py-4\">No categories defined.</div>\n\t\t\t{/each}\n\t\t</div>\n\n\t\t<div class=\"add-cat-form\">\n\t\t\t<input\n\t\t\t\ttype=\"text\"\n\t\t\t\tbind:value={newCategoryName}\n\t\t\t\tplaceholder=\"New category...\"\n\t\t\t\tclass=\"input-field\"\n\t\t\t\ton:keydown={(e) => e.key === 'Enter' && addCategory()}\n\t\t\t/>\n\t\t\t<button class=\"btn-secondary\" on:click={addCategory}>Add</button>\n\t\t</div>\n\n\t\t<div class=\"modal-actions mt-6\">\n\t\t\t<button class=\"btn-cancel w-full\" on:click={() => (isManageCategoriesOpen = false)}\n\t\t\t\t>Done</button\n\t\t\t>\n\t\t</div>\n\t</div>\n</Modal>\n\n<style>\n\t* {\n\t\tbox-sizing: border-box;\n\t}\n\n\t:global(body) {\n\t\toverflow-x: hidden;\n\t}\n\n\t.page-container {\n\t\tmax-width: 1400px;\n\t\tmargin: 0 auto;\n\t\tpadding: 16px;\n\t\tpadding-bottom: 80px;\n\t\toverflow-x: hidden;\n\t}\n\n\t/* Page Headers & Actions */\n\t.page-header {\n\t\tdisplay: flex;\n\t\tjustify-content: space-between;\n\t\talign-items: center;\n\t\tmargin-bottom: 24px;\n\t}\n\t.page-title {\n\t\tfont-size: 24px;\n\t\tfont-weight: 800;\n\t\tcolor: #111827;\n\t\tmargin: 0;\n\t}\n\t.page-subtitle {\n\t\tfont-size: 14px;\n\t\tcolor: #6b7280;\n\t\tmargin: 0;\n\t}\n\t.header-actions {\n\t\tdisplay: flex;\n\t\tgap: 8px;\n\t\talign-items: center;\n\t}\n\n\t.btn-primary {\n\t\tdisplay: inline-flex;\n\t\talign-items: center;\n\t\tgap: 6px;\n\t\tpadding: 10px 16px;\n\t\tbackground: linear-gradient(135deg, #ff7f50 0%, #ff6a3d 100%);\n\t\tcolor: white;\n\t\tborder: none;\n\t\tborder-radius: 8px;\n\t\tfont-weight: 600;\n\t\tfont-size: 14px;\n\t\tcursor: pointer;\n\t\tbox-shadow: 0 2px 8px rgba(255, 127, 80, 0.3);\n\t\ttransition: transform 0.1s;\n\t\ttext-decoration: none;\n\t}\n\t.btn-primary:active {\n\t\ttransform: translateY(1px);\n\t}\n\n\t.btn-secondary {\n\t\tdisplay: inline-flex;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t\tpadding: 10px;\n\t\tbackground: white;\n\t\tborder: 1px solid #e5e7eb;\n\t\tcolor: #374151;\n\t\tborder-radius: 8px;\n\t\tfont-weight: 600;\n\t\tfont-size: 14px;\n\t\tcursor: pointer;\n\t\ttransition: background 0.2s;\n\t}\n\n\t@media (hover: hover) {\n\t\t.btn-secondary:hover {\n\t\t\tbackground: #f9fafb;\n\t\t}\n\t\t.cat-delete:hover {\n\t\t\tbackground: #ef4444;\n\t\t\tcolor: white;\n\t\t}\n\t}\n\n\t/* Stats Summary */\n\t.stats-summary {\n\t\tdisplay: grid;\n\t\tgrid-template-columns: repeat(2, 1fr);\n\t\tgap: 12px;\n\t\tmargin-bottom: 24px;\n\t}\n\t.summary-card {\n\t\tbackground: white;\n\t\tborder: 1px solid #e5e7eb;\n\t\tborder-radius: 12px;\n\t\tpadding: 16px;\n\t\ttext-align: center;\n\t}\n\t.summary-label {\n\t\tfont-size: 12px;\n\t\tcolor: #6b7280;\n\t\ttext-transform: uppercase;\n\t\tletter-spacing: 0.5px;\n\t\tmargin-bottom: 4px;\n\t}\n\t.summary-value {\n\t\tfont-size: 20px;\n\t\tfont-weight: 800;\n\t\tcolor: #111827;\n\t}\n\n\t/* Filter Bar */\n\t.filters-bar {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tgap: 12px;\n\t\tmargin-bottom: 20px;\n\t}\n\n\t.search-box {\n\t\tposition: relative;\n\t\twidth: 100%;\n\t}\n\t.search-icon {\n\t\tposition: absolute;\n\t\tleft: 14px;\n\t\ttop: 50%;\n\t\ttransform: translateY(-50%);\n\t\tcolor: #9ca3af;\n\t\tpointer-events: none;\n\t}\n\t.search-box input {\n\t\twidth: 100%;\n\t\tpadding: 12px 16px 12px 42px;\n\t\tborder: 1px solid #e5e7eb;\n\t\tborder-radius: 10px;\n\t\tfont-size: 15px;\n\t\tbackground: white;\n\t\tbox-sizing: border-box;\n\t}\n\t.date-group {\n\t\tdisplay: flex;\n\t\tgap: 8px;\n\t\talign-items: center;\n\t}\n\t.date-input {\n\t\tflex: 1;\n\t\tpadding: 12px;\n\t\tborder: 1px solid #e5e7eb;\n\t\tborder-radius: 10px;\n\t\tfont-size: 14px;\n\t\tbackground: white;\n\t\tmin-width: 0;\n\t}\n\t.date-sep {\n\t\tcolor: #9ca3af;\n\t\tfont-weight: bold;\n\t}\n\t.filter-group {\n\t\tdisplay: flex;\n\t\tflex-direction: row;\n\t\tgap: 8px;\n\t\twidth: 100%;\n\t}\n\t.filter-select {\n\t\tflex: 1;\n\t\tmin-width: 0;\n\t\tpadding: 12px;\n\t\tborder: 1px solid #e5e7eb;\n\t\tborder-radius: 10px;\n\t\tfont-size: 14px;\n\t\tbackground: white;\n\t\tcolor: #374151;\n\t}\n\t.sort-btn {\n\t\tflex: 0 0 48px;\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t\tborder: 1px solid #e5e7eb;\n\t\tborder-radius: 10px;\n\t\tbackground: white;\n\t\tcolor: #6b7280;\n\t\tcursor: pointer;\n\t}\n\n\t/* Batch Header */\n\t.batch-header {\n\t\tdisplay: flex;\n\t\tjustify-content: space-between;\n\t\talign-items: center;\n\t\tmargin-bottom: 12px;\n\t\tpadding: 0 4px;\n\t\tcolor: #6b7280;\n\t\tfont-size: 13px;\n\t\tfont-weight: 500;\n\t}\n\t.page-info {\n\t\tfont-size: 13px;\n\t}\n\n\t/* CHECKBOX STYLES */\n\t.checkbox-container {\n\t\tdisplay: inline-flex;\n\t\talign-items: center;\n\t\tgap: 8px;\n\t\tcursor: pointer;\n\t\tfont-size: 14px;\n\t\tfont-weight: 600;\n\t\tcolor: #4b5563;\n\t\tposition: relative;\n\t\tpadding-left: 28px;\n\t\tuser-select: none;\n\t}\n\t.checkbox-container input {\n\t\tposition: absolute;\n\t\topacity: 0;\n\t\tcursor: pointer;\n\t\theight: 0;\n\t\twidth: 0;\n\t}\n\t.checkmark {\n\t\tposition: absolute;\n\t\ttop: 0;\n\t\tleft: 0;\n\t\theight: 20px;\n\t\twidth: 20px;\n\t\tbackground-color: white;\n\t\tborder: 2px solid #d1d5db;\n\t\tborder-radius: 6px;\n\t\ttransition: all 0.2s;\n\t}\n\n\t@media (hover: hover) {\n\t\t.checkbox-container:hover input ~ .checkmark {\n\t\t\tborder-color: #9ca3af;\n\t\t}\n\t}\n\n\t.checkbox-container input:checked ~ .checkmark {\n\t\tbackground-color: #ff7f50;\n\t\tborder-color: #ff7f50;\n\t}\n\t.checkmark:after {\n\t\tcontent: '';\n\t\tposition: absolute;\n\t\tdisplay: none;\n\t}\n\t.checkbox-container input:checked ~ .checkmark:after {\n\t\tdisplay: block;\n\t}\n\t.checkbox-container .checkmark:after {\n\t\tleft: 6px;\n\t\ttop: 2px;\n\t\twidth: 5px;\n\t\theight: 10px;\n\t\tborder: solid white;\n\t\tborder-width: 0 2px 2px 0;\n\t\ttransform: rotate(45deg);\n\t}\n\n\t/* Expense List & Cards (Styled like Trips) */\n\t.expense-list-cards {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tgap: 12px;\n\t\tmax-width: 100%;\n\t}\n\t.card-wrapper {\n\t\tposition: relative;\n\t\toverflow: hidden;\n\t\tborder-radius: 12px;\n\t\tbackground: #f3f4f6;\n\t\tmax-width: 100%;\n\t}\n\n\t.swipe-bg {\n\t\tposition: absolute;\n\t\tinset: 0;\n\t\tdisplay: flex;\n\t\tjustify-content: space-between;\n\t\talign-items: center;\n\t\tpadding: 0 20px;\n\t\tz-index: 0;\n\t}\n\t.swipe-action {\n\t\tfont-weight: 700;\n\t\tfont-size: 14px;\n\t\ttext-transform: uppercase;\n\t\tletter-spacing: 1px;\n\t}\n\t.swipe-action.edit {\n\t\tcolor: #2563eb;\n\t}\n\t.swipe-action.delete {\n\t\tcolor: #dc2626;\n\t}\n\n\t.expense-card {\n\t\tbackground: white;\n\t\tborder: 1px solid #e5e7eb;\n\t\tborder-radius: 12px;\n\t\tpadding: 16px;\n\t\tposition: relative;\n\t\tz-index: 1;\n\t\tcursor: pointer;\n\t\ttransition: all 0.2s;\n\t\tmax-width: 100%;\n\t}\n\t.expense-card:active {\n\t\tbackground-color: #f9fafb;\n\t}\n\t.expense-card.read-only {\n\t\tborder-left: 4px solid #3b82f6;\n\t\tbackground: #fafafa;\n\t}\n\t.expense-card.selected {\n\t\tbackground-color: #fff7ed;\n\t\tborder-color: #ff7f50;\n\t}\n\n\t.card-top {\n\t\tdisplay: grid;\n\t\tgrid-template-columns: auto 1fr auto auto;\n\t\talign-items: center;\n\t\tgap: 12px;\n\t\tpadding-bottom: 12px;\n\t\tmargin-bottom: 12px;\n\t\tborder-bottom: 1px solid #f3f4f6;\n\t\tmax-width: 100%;\n\t}\n\n\t.selection-box {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t\tpadding-right: 4px;\n\t}\n\n\t.expense-main-info {\n\t\toverflow: hidden;\n\t\tmin-width: 0;\n\t}\n\t.expense-date-display {\n\t\tdisplay: block;\n\t\tfont-size: 12px;\n\t\tfont-weight: 600;\n\t\tcolor: #6b7280;\n\t\tmargin-bottom: 4px;\n\t}\n\t.expense-desc-title {\n\t\tfont-size: 16px;\n\t\tfont-weight: 700;\n\t\tcolor: #111827;\n\t\tmargin: 0;\n\t\twhite-space: nowrap;\n\t\toverflow: hidden;\n\t\ttext-overflow: ellipsis;\n\t}\n\n\t.expense-amount-display {\n\t\tfont-size: 18px;\n\t\tfont-weight: 800;\n\t\tcolor: #111827;\n\t\twhite-space: nowrap;\n\t\ttext-align: right;\n\t\tmin-width: 72px;\n\t}\n\n\t.nav-icon {\n\t\tcolor: #9ca3af;\n\t\tflex-shrink: 0;\n\t}\n\n\t.card-stats {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tmax-width: 100%;\n\t\toverflow-x: auto;\n\t}\n\t.stat-badge-container {\n\t\tdisplay: flex;\n\t\tgap: 8px;\n\t\tflex-wrap: wrap;\n\t}\n\n\t.category-badge {\n\t\tfont-size: 12px;\n\t\tfont-weight: 600;\n\t\tpadding: 4px 10px;\n\t\tborder-radius: 100px;\n\t\ttext-transform: capitalize;\n\t\tborder: 1px solid;\n\t\tdisplay: inline-flex;\n\t\talign-items: center;\n\t\twhite-space: nowrap;\n\t}\n\n\t.source-badge {\n\t\tfont-size: 11px;\n\t\tfont-weight: 700;\n\t\tcolor: #3b82f6;\n\t\tbackground: #eff6ff;\n\t\tpadding: 4px 8px;\n\t\tborder-radius: 6px;\n\t\ttext-transform: uppercase;\n\t\tletter-spacing: 0.5px;\n\t\twhite-space: nowrap;\n\t}\n\n\t/* Tax pill that visually matches category badges */\n\t.tax-pill {\n\t\tfont-size: 12px;\n\t\tfont-weight: 600;\n\t\tcolor: #166534;\n\t\tbackground: #ecfdf5;\n\t\tpadding: 4px 10px;\n\t\tborder-radius: 100px;\n\t\tborder: 1px solid #bbf7d0;\n\t\ttext-transform: capitalize;\n\t\twhite-space: nowrap;\n\t}\n\n\t.empty-state {\n\t\ttext-align: center;\n\t\tpadding: 40px;\n\t\tcolor: #6b7280;\n\t\tfont-size: 15px;\n\t}\n\n\t/* Hide footer when selections are active - using body class */\n\t:global(body.has-selections .mobile-footer),\n\t:global(body.has-selections footer),\n\t:global(body.has-selections nav[class*='mobile']),\n\t:global(body.has-selections .bottom-nav) {\n\t\tdisplay: none !important;\n\t}\n\n\t/* ACTION BAR STYLES - REPLACES FOOTER ON MOBILE */\n\t.action-bar-container {\n\t\tposition: fixed;\n\t\tbottom: 0;\n\t\tleft: 0;\n\t\tright: 0;\n\t\tdisplay: flex;\n\t\tjustify-content: center;\n\t\tz-index: 1000;\n\t\tpadding: 0;\n\t\tanimation: slideUpFade 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n\t\tpointer-events: none;\n\t}\n\n\t.action-bar {\n\t\tbackground: white;\n\t\tpadding: 12px 16px;\n\t\tborder-radius: 0;\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tgap: 8px;\n\t\tbox-shadow: 0 -2px 10px rgba(0, 0, 0, 0.1);\n\t\tmax-width: 100%;\n\t\twidth: 100%;\n\t\tpointer-events: auto;\n\t\tborder-top: 1px solid #e5e7eb;\n\t}\n\n\t.action-bar-left {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t}\n\n\t.selection-indicator {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tgap: 6px;\n\t\tcolor: #ff7f50;\n\t\tfont-weight: 700;\n\t\tfont-size: 13px;\n\t\tpadding: 6px 12px;\n\t\tbackground: linear-gradient(135deg, #fff7ed 0%, #ffedd5 100%);\n\t\tborder-radius: 10px;\n\t\tborder: 1px solid #fed7aa;\n\t}\n\n\t.selection-indicator svg {\n\t\tflex-shrink: 0;\n\t\twidth: 16px;\n\t\theight: 16px;\n\t}\n\n\t.selected-count {\n\t\tcolor: #c2410c;\n\t\twhite-space: nowrap;\n\t}\n\n\t.action-bar-right {\n\t\tdisplay: flex;\n\t\tgap: 6px;\n\t\tjustify-content: center;\n\t}\n\n\t.action-pill {\n\t\tborder: 2px solid transparent;\n\t\tpadding: 10px 12px;\n\t\tborder-radius: 10px;\n\t\tfont-size: 13px;\n\t\tfont-weight: 700;\n\t\tcursor: pointer;\n\t\tdisplay: inline-flex;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t\tgap: 6px;\n\t\ttransition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);\n\t\tfont-family: inherit;\n\t\twhite-space: nowrap;\n\t\tflex: 1;\n\t\tmin-width: 0;\n\t\tbox-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);\n\t}\n\n\t.action-pill svg {\n\t\tflex-shrink: 0;\n\t\twidth: 16px;\n\t\theight: 16px;\n\t}\n\n\t/* Hide text on very small screens */\n\t.action-text {\n\t\tdisplay: none;\n\t}\n\n\t.action-pill.secondary {\n\t\tbackground: white;\n\t\tcolor: #6b7280;\n\t\tborder-color: #e5e7eb;\n\t}\n\n\t.action-pill.export {\n\t\tbackground: linear-gradient(135deg, #fff7ed 0%, #ffedd5 100%);\n\t\tcolor: #c2410c;\n\t\tborder-color: #fed7aa;\n\t}\n\n\t.action-pill.danger {\n\t\tbackground: linear-gradient(135deg, #fee2e2 0%, #fecaca 100%);\n\t\tcolor: #dc2626;\n\t\tborder-color: #fca5a5;\n\t}\n\n\t.action-pill:active {\n\t\ttransform: scale(0.95);\n\t}\n\n\t@media (hover: hover) {\n\t\t.action-pill.secondary:hover {\n\t\t\tbackground: #f9fafb;\n\t\t\tborder-color: #d1d5db;\n\t\t\tbox-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\n\t\t}\n\n\t\t.action-pill.export:hover {\n\t\t\tbackground: linear-gradient(135deg, #ffedd5 0%, #fed7aa 100%);\n\t\t\tborder-color: #fdba74;\n\t\t\tbox-shadow: 0 2px 4px rgba(251, 146, 60, 0.15);\n\t\t}\n\n\t\t.action-pill.danger:hover {\n\t\t\tbackground: linear-gradient(135deg, #fecaca 0%, #fca5a5 100%);\n\t\t\tborder-color: #f87171;\n\t\t\tbox-shadow: 0 2px 4px rgba(220, 38, 38, 0.15);\n\t\t}\n\t}\n\n\t@keyframes slideUpFade {\n\t\tfrom {\n\t\t\ttransform: translateY(100%);\n\t\t\topacity: 0;\n\t\t}\n\t\tto {\n\t\t\ttransform: translateY(0);\n\t\t\topacity: 1;\n\t\t}\n\t}\n\n\t/* Show text on slightly larger mobile screens */\n\t@media (min-width: 380px) {\n\t\t.action-text {\n\t\t\tdisplay: inline;\n\t\t}\n\n\t\t.action-pill {\n\t\t\tpadding: 10px 14px;\n\t\t}\n\t}\n\n\t@media (min-width: 640px) {\n\t\t.action-bar-container {\n\t\t\tbottom: 30px;\n\t\t\tpadding: 0 16px;\n\t\t}\n\n\t\t.action-bar {\n\t\t\tflex-direction: row;\n\t\t\talign-items: center;\n\t\t\tjustify-content: space-between;\n\t\t\tpadding: 14px 20px;\n\t\t\tmax-width: 700px;\n\t\t\twidth: auto; /* CHANGED: from inheriting 100% to auto */\n\t\t\tgap: 16px;\n\t\t\tborder-radius: 16px;\n\t\t\tborder: 1px solid #e5e7eb;\n\t\t\tbox-shadow:\n\t\t\t\t0 0 0 1px rgba(0, 0, 0, 0.05),\n\t\t\t\t0 10px 25px -5px rgba(0, 0, 0, 0.1),\n\t\t\t\t0 8px 10px -6px rgba(0, 0, 0, 0.1);\n\t\t}\n\n\t\t.action-bar-left {\n\t\t\tjustify-content: flex-start;\n\t\t}\n\n\t\t.selection-indicator {\n\t\t\tfont-size: 14px;\n\t\t\tpadding: 8px 14px;\n\t\t}\n\n\t\t.action-bar-right {\n\t\t\tgap: 8px;\n\t\t}\n\n\t\t.action-pill {\n\t\t\tflex: 0 0 auto;\n\t\t\tmin-width: auto;\n\t\t\tpadding: 10px 18px;\n\t\t\tfont-size: 14px;\n\t\t}\n\n\t\t.action-text {\n\t\t\tdisplay: inline;\n\t\t}\n\t}\n\n\t/* Desktop */\n\t@media (min-width: 1024px) {\n\t\t.action-bar {\n\t\t\tmax-width: 800px;\n\t\t\tpadding: 16px 24px;\n\t\t}\n\n\t\t.selection-indicator {\n\t\t\tfont-size: 15px;\n\t\t\tpadding: 8px 16px;\n\t\t}\n\n\t\t.action-pill {\n\t\t\tpadding: 12px 24px;\n\t\t\tfont-size: 15px;\n\t\t}\n\t}\n\n\t/* Categories Manager Modal Styles */\n\t.categories-manager {\n\t\tpadding: 4px;\n\t}\n\t.sub-tabs {\n\t\tdisplay: flex;\n\t\tgap: 8px;\n\t\tmargin-bottom: 16px;\n\t\tborder-bottom: 1px solid #e5e7eb;\n\t}\n\t.tab-btn {\n\t\tpadding: 8px 16px;\n\t\tbackground: none;\n\t\tborder: none;\n\t\tborder-bottom: 2px solid transparent;\n\t\tfont-weight: 600;\n\t\tcolor: #6b7280;\n\t\tcursor: pointer;\n\t\ttransition: all 0.2s;\n\t}\n\t.tab-btn.active {\n\t\tcolor: #ff7f50;\n\t\tborder-bottom-color: #ff7f50;\n\t}\n\t.cat-list {\n\t\tdisplay: flex;\n\t\tflex-wrap: wrap;\n\t\tgap: 8px;\n\t\tmargin-bottom: 20px;\n\t\tmax-height: 200px;\n\t\toverflow-y: auto;\n\t}\n\t.cat-item {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tgap: 4px;\n\t\tbackground: #f3f4f6;\n\t\tpadding: 4px 4px 4px 10px;\n\t\tborder-radius: 20px;\n\t\tborder: 1px solid #e5e7eb;\n\t}\n\t.cat-badge {\n\t\tfont-size: 13px;\n\t\tfont-weight: 500;\n\t\ttext-transform: capitalize;\n\t\tpadding: 0 4px;\n\t\tborder: none;\n\t\tbackground: transparent;\n\t}\n\t.cat-delete {\n\t\tborder: none;\n\t\tbackground: #e5e7eb;\n\t\tcolor: #6b7280;\n\t\tborder-radius: 50%;\n\t\twidth: 24px;\n\t\theight: 24px;\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t\tcursor: pointer;\n\t\ttransition: all 0.2s;\n\t}\n\n\t.add-cat-form {\n\t\tdisplay: flex;\n\t\tgap: 8px;\n\t}\n\t.add-cat-form .input-field {\n\t\tflex: 1;\n\t\tpadding: 10px;\n\t\tborder: 1px solid #e5e7eb;\n\t\tborder-radius: 8px;\n\t}\n\t.add-cat-form .btn-secondary {\n\t\tpadding: 10px 16px;\n\t}\n\t.modal-actions .btn-cancel {\n\t\tbackground: white;\n\t\tborder: 1px solid #e5e7eb;\n\t\tcolor: #374151;\n\t\tpadding: 12px;\n\t\tborder-radius: 8px;\n\t\tfont-weight: 600;\n\t\tcursor: pointer;\n\t\twidth: 100%;\n\t}\n\n\t@media (min-width: 640px) {\n\t\t.filters-bar {\n\t\t\tflex-direction: row;\n\t\t\tjustify-content: space-between;\n\t\t\talign-items: center;\n\t\t}\n\t\t.search-box {\n\t\t\tmax-width: 300px;\n\t\t}\n\t\t.date-group {\n\t\t\twidth: auto;\n\t\t}\n\t\t.filter-group {\n\t\t\twidth: auto;\n\t\t\tflex-wrap: nowrap;\n\t\t}\n\t\t.filter-select {\n\t\t\twidth: 140px;\n\t\t\tflex: none;\n\t\t}\n\t\t.stats-summary {\n\t\t\tgrid-template-columns: repeat(4, 1fr);\n\t\t}\n\t\t.hidden-mobile {\n\t\t\tdisplay: block;\n\t\t}\n\t}\n\n\t@media (max-width: 640px) {\n\t\t.page-container {\n\t\t\tpadding-bottom: calc(env(safe-area-inset-bottom, 0px) + 1px);\n\t\t}\n\n\t\t.expense-list-cards {\n\t\t\tgap: 8px;\n\t\t}\n\n\t\t/* Reduce extra space above pagination on mobile */\n\t\t.pagination-controls {\n\t\t\tmargin-top: 16px;\n\t\t}\n\n\t\t/* Compact empty-state padding on mobile */\n\t\t.empty-state {\n\t\t\tpadding: 24px 12px;\n\t\t}\n\n\t\t.hidden-mobile {\n\t\t\tdisplay: none;\n\t\t}\n\t}\n\n\t/* Pagination Controls */\n\t.pagination-container {\n\t\tmargin-top: 32px;\n\t\tdisplay: flex;\n\t\tjustify-content: center;\n\t}\n\n\t.pagination {\n\t\tdisplay: flex;\n\t\tjustify-content: center;\n\t\talign-items: center;\n\t\tgap: 16px;\n\t}\n\n\t.pagination-btn {\n\t\tpadding: 8px 16px;\n\t\tbackground: white;\n\t\tborder: 1px solid #e5e7eb;\n\t\tborder-radius: 8px;\n\t\tfont-weight: 600;\n\t\tfont-size: 14px;\n\t\tcolor: #374151;\n\t\tcursor: pointer;\n\t\ttransition: all 0.2s;\n\t\tfont-family: inherit;\n\t}\n\n\t.pagination-btn:hover:not(:disabled) {\n\t\tborder-color: var(--orange);\n\t\tcolor: var(--orange);\n\t}\n\n\t.pagination-btn:disabled {\n\t\topacity: 0.5;\n\t\tcursor: not-allowed;\n\t}\n\n\t.page-status {\n\t\tfont-size: 14px;\n\t\tcolor: #4b5563;\n\t\tfont-weight: 500;\n\t}\n</style>\n",
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\dashboard\\expenses\\edit\\[id]\\+page.svelte",
		"messages": [
			{
				"ruleId": "svelte/no-navigation-without-resolve",
				"severity": 1,
				"message": "Unexpected goto() call without resolve().",
				"line": 103,
				"column": 9,
				"nodeType": null,
				"messageId": "gotoWithoutResolve",
				"endLine": 103,
				"endColumn": 30
			},
			{
				"ruleId": "svelte/no-navigation-without-resolve",
				"severity": 1,
				"message": "Unexpected goto() call without resolve().",
				"line": 128,
				"column": 9,
				"nodeType": null,
				"messageId": "gotoWithoutResolve",
				"endLine": 128,
				"endColumn": 30
			},
			{
				"ruleId": "svelte/no-navigation-without-resolve",
				"severity": 1,
				"message": "Unexpected href link without resolve().",
				"line": 142,
				"column": 12,
				"nodeType": null,
				"messageId": "linkWithoutResolve",
				"endLine": 142,
				"endColumn": 31
			},
			{
				"ruleId": "svelte/no-navigation-without-resolve",
				"severity": 1,
				"message": "Unexpected href link without resolve().",
				"line": 382,
				"column": 13,
				"nodeType": null,
				"messageId": "linkWithoutResolve",
				"endLine": 382,
				"endColumn": 32
			}
		],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 4,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"source": "<script lang=\"ts\">\n\timport { expenses } from '$lib/stores/expenses';\n\timport { userSettings } from '$lib/stores/userSettings';\n\timport { user } from '$lib/stores/auth';\n\timport { toasts } from '$lib/stores/toast';\n\timport { goto } from '$app/navigation';\n\timport { page } from '$app/stores';\n\timport { onMount } from 'svelte';\n\n\tconst expenseId = $page.params.id;\n\n\timport SettingsModal from '../../../trips/components/SettingsModal.svelte';\n\n\t// Category options derived from user settings (grouped)\n\t$: maintenanceOptions =\n\t\t$userSettings.maintenanceCategories?.length > 0\n\t\t\t? $userSettings.maintenanceCategories\n\t\t\t: ['Oil Change', 'Tire Rotation', 'Brake Service', 'Filter Replacement'];\n\t$: suppliesOptions =\n\t\t$userSettings.supplyCategories?.length > 0\n\t\t\t? $userSettings.supplyCategories\n\t\t\t: ['Concrete', 'Poles', 'Wire', 'Tools', 'Equipment Rental'];\n\t$: expenseOptions =\n\t\t$userSettings.expenseCategories?.length > 0\n\t\t\t? $userSettings.expenseCategories\n\t\t\t: ['maintenance', 'insurance', 'supplies', 'other'];\n\n\tlet selectedMaintenance = '';\n\tlet selectedSupply = '';\n\tlet selectedExpense = '';\n\n\tlet isManageCategoriesOpen = false;\n\tlet activeCategoryType: 'maintenance' | 'supplies' | 'expenses' = 'maintenance';\n\n\t// Keep selected values in sync with form data\n\t$: if (formData.category) {\n\t\tif (maintenanceOptions.includes(formData.category)) {\n\t\t\tselectedMaintenance = formData.category;\n\t\t\tselectedSupply = '';\n\t\t\tselectedExpense = '';\n\t\t} else if (suppliesOptions.includes(formData.category)) {\n\t\t\tselectedSupply = formData.category;\n\t\t\tselectedMaintenance = '';\n\t\t\tselectedExpense = '';\n\t\t} else if (expenseOptions.includes(formData.category)) {\n\t\t\tselectedExpense = formData.category;\n\t\t\tselectedMaintenance = '';\n\t\t\tselectedSupply = '';\n\t\t} else {\n\t\t\tselectedMaintenance = '';\n\t\t\tselectedSupply = '';\n\t\t\tselectedExpense = '';\n\t\t}\n\t}\n\n\tfunction openSettings(type: 'maintenance' | 'supplies' | 'expenses') {\n\t\tactiveCategoryType = type;\n\t\tisManageCategoriesOpen = true;\n\t}\n\n\tfunction selectMaintenance() {\n\t\tif (!selectedMaintenance) return;\n\t\tformData.category = selectedMaintenance;\n\t\tselectedSupply = '';\n\t\tselectedExpense = '';\n\t}\n\n\tfunction selectSupply() {\n\t\tif (!selectedSupply) return;\n\t\tformData.category = selectedSupply;\n\t\tselectedMaintenance = '';\n\t\tselectedExpense = '';\n\t}\n\n\tfunction selectExpense() {\n\t\tif (!selectedExpense) return;\n\t\tformData.category = selectedExpense;\n\t\tselectedMaintenance = '';\n\t\tselectedSupply = '';\n\t}\n\n\tlet formData = {\n\t\tdate: '',\n\t\tcategory: '',\n\t\tamount: '',\n\t\tdescription: '',\n\t\ttaxDeductible: false\n\t};\n\n\tonMount(() => {\n\t\t// Find expense in store\n\t\tconst expense = $expenses.find((e) => e.id === expenseId);\n\t\tif (expense) {\n\t\t\tformData = {\n\t\t\t\tdate: expense.date,\n\t\t\t\tcategory: expense.category,\n\t\t\t\tamount: expense.amount.toString(),\n\t\t\t\tdescription: expense.description || '',\n\t\t\t\ttaxDeductible: !!expense.taxDeductible\n\t\t\t};\n\t\t} else {\n\t\t\ttoasts.error('Expense not found.');\n\t\t\tgoto('/dashboard/expenses');\n\t\t}\n\t});\n\n\tasync function saveExpense() {\n\t\tif (!formData.amount || !formData.date || !formData.category) {\n\t\t\ttoasts.error('Please fill in required fields.');\n\t\t\treturn;\n\t\t}\n\n\t\tconst currentUser = ($page.data as any)['user'] || $user;\n\t\tconst userId = (currentUser as any)?.id || localStorage.getItem('offline_user_id');\n\t\tif (!userId) {\n\t\t\ttoasts.error('User not identified. Cannot save.');\n\t\t\treturn;\n\t\t}\n\n\t\ttry {\n\t\t\tconst payload = {\n\t\t\t\t...formData,\n\t\t\t\tamount: parseFloat(formData.amount)\n\t\t\t};\n\n\t\t\tawait expenses.updateExpense(String(expenseId), payload, String(userId));\n\t\t\ttoasts.success('Expense updated');\n\t\t\tgoto('/dashboard/expenses');\n\t\t} catch (err) {\n\t\t\tconsole.error(err);\n\t\t\ttoasts.error('Failed to update expense');\n\t\t}\n\t}\n</script>\n\n<div class=\"expense-form-page\">\n\t<div class=\"page-header\">\n\t\t<div>\n\t\t\t<h1 class=\"page-title\">Edit Expense</h1>\n\t\t\t<p class=\"page-subtitle\">Update cost details</p>\n\t\t</div>\n\t\t<a href=\"/dashboard/expenses\" class=\"btn-back\">\n\t\t\t<svg width=\"24\" height=\"24\" viewBox=\"0 0 20 20\" fill=\"none\"\n\t\t\t\t><path\n\t\t\t\t\td=\"M12 4L6 10L12 16\"\n\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\t\tstroke-linejoin=\"round\"\n\t\t\t\t/></svg\n\t\t\t> Back\n\t\t</a>\n\t</div>\n\n\t<div class=\"form-card\">\n\t\t<div class=\"card-header\">\n\t\t\t<h2 class=\"card-title\">Expense Details</h2>\n\t\t</div>\n\n\t\t<div class=\"form-grid\">\n\t\t\t<div class=\"form-group\">\n\t\t\t\t<label for=\"expense-date\">Date</label>\n\t\t\t\t<input id=\"expense-date\" type=\"date\" bind:value={formData.date} required />\n\t\t\t</div>\n\n\t\t\t<div class=\"form-row\">\n\t\t\t\t<div class=\"section-group\">\n\t\t\t\t\t<div class=\"section-top\">\n\t\t\t\t\t\t<h3>Maintenance</h3>\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tclass=\"btn-icon gear\"\n\t\t\t\t\t\t\ton:click={() => openSettings('maintenance')}\n\t\t\t\t\t\t\ttitle=\"Manage Options\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\t\twidth=\"20\"\n\t\t\t\t\t\t\t\theight=\"20\"\n\t\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\t\t\t\t\tfill=\"none\"\n\t\t\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\t\t\t\t\tstroke-linejoin=\"round\"\n\t\t\t\t\t\t\t\t><circle cx=\"12\" cy=\"12\" r=\"3\"></circle><path\n\t\t\t\t\t\t\t\t\td=\"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z\"\n\t\t\t\t\t\t\t\t></path></svg\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\"add-row\">\n\t\t\t\t\t\t<select\n\t\t\t\t\t\t\tid=\"maintenance-select\"\n\t\t\t\t\t\t\tname=\"maintenance\"\n\t\t\t\t\t\t\tbind:value={selectedMaintenance}\n\t\t\t\t\t\t\ton:change={selectMaintenance}\n\t\t\t\t\t\t\tclass=\"select-input\"\n\t\t\t\t\t\t\taria-label=\"Maintenance type\"\n\t\t\t\t\t\t\tdisabled={!!formData.category && !maintenanceOptions.includes(formData.category)}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<option value=\"\" disabled selected>Select Item...</option>\n\t\t\t\t\t\t\t{#each maintenanceOptions as option (option)}\n\t\t\t\t\t\t\t\t<option value={option}>{option}</option>\n\t\t\t\t\t\t\t{/each}\n\t\t\t\t\t\t</select>\n\t\t\t\t\t\t{#if maintenanceOptions.includes(formData.category)}\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\tclass=\"btn-small neutral\"\n\t\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\t\tformData.category = '';\n\t\t\t\t\t\t\t\t\tselectedMaintenance = '';\n\t\t\t\t\t\t\t\t}}>Clear</button\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t{:else}\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\tclass=\"btn-small primary\"\n\t\t\t\t\t\t\t\ton:click={() => (formData.category = selectedMaintenance)}\n\t\t\t\t\t\t\t\tdisabled={!selectedMaintenance}>Choose</button\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t{/if}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<div class=\"section-group\">\n\t\t\t\t\t<div class=\"section-top\">\n\t\t\t\t\t\t<h3>Supplies</h3>\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tclass=\"btn-icon gear\"\n\t\t\t\t\t\t\ton:click={() => openSettings('supplies')}\n\t\t\t\t\t\t\ttitle=\"Manage Options\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\t\twidth=\"20\"\n\t\t\t\t\t\t\t\theight=\"20\"\n\t\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\t\t\t\t\tfill=\"none\"\n\t\t\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\t\t\t\t\tstroke-linejoin=\"round\"\n\t\t\t\t\t\t\t\t><circle cx=\"12\" cy=\"12\" r=\"3\"></circle><path\n\t\t\t\t\t\t\t\t\td=\"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z\"\n\t\t\t\t\t\t\t\t></path></svg\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\"add-row\">\n\t\t\t\t\t\t<select\n\t\t\t\t\t\t\tid=\"supplies-select\"\n\t\t\t\t\t\t\tname=\"supplies\"\n\t\t\t\t\t\t\tbind:value={selectedSupply}\n\t\t\t\t\t\t\ton:change={selectSupply}\n\t\t\t\t\t\t\tclass=\"select-input\"\n\t\t\t\t\t\t\taria-label=\"Supply type\"\n\t\t\t\t\t\t\tdisabled={!!formData.category && !suppliesOptions.includes(formData.category)}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<option value=\"\" disabled selected>Select Item...</option>\n\t\t\t\t\t\t\t{#each suppliesOptions as option (option)}\n\t\t\t\t\t\t\t\t<option value={option}>{option}</option>\n\t\t\t\t\t\t\t{/each}\n\t\t\t\t\t\t</select>\n\t\t\t\t\t\t{#if suppliesOptions.includes(formData.category)}\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\tclass=\"btn-small neutral\"\n\t\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\t\tformData.category = '';\n\t\t\t\t\t\t\t\t\tselectedSupply = '';\n\t\t\t\t\t\t\t\t}}>Clear</button\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t{:else}\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\tclass=\"btn-small primary\"\n\t\t\t\t\t\t\t\ton:click={() => (formData.category = selectedSupply)}\n\t\t\t\t\t\t\t\tdisabled={!selectedSupply}>Choose</button\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t{/if}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<div class=\"section-group\">\n\t\t\t\t\t<div class=\"section-top\">\n\t\t\t\t\t\t<h3>Expenses</h3>\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tclass=\"btn-icon gear\"\n\t\t\t\t\t\t\ton:click={() => openSettings('expenses')}\n\t\t\t\t\t\t\ttitle=\"Manage Options\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\t\twidth=\"20\"\n\t\t\t\t\t\t\t\theight=\"20\"\n\t\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\t\t\t\t\tfill=\"none\"\n\t\t\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\t\t\t\t\tstroke-linejoin=\"round\"\n\t\t\t\t\t\t\t\t><circle cx=\"12\" cy=\"12\" r=\"3\"></circle><path\n\t\t\t\t\t\t\t\t\td=\"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z\"\n\t\t\t\t\t\t\t\t></path></svg\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\"add-row\">\n\t\t\t\t\t\t<select\n\t\t\t\t\t\t\tid=\"expense-select\"\n\t\t\t\t\t\t\tname=\"expenseCategory\"\n\t\t\t\t\t\t\tbind:value={selectedExpense}\n\t\t\t\t\t\t\ton:change={selectExpense}\n\t\t\t\t\t\t\tclass=\"select-input\"\n\t\t\t\t\t\t\taria-label=\"Expense category\"\n\t\t\t\t\t\t\tdisabled={!!formData.category && !expenseOptions.includes(formData.category)}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<option value=\"\" disabled selected>Select Item...</option>\n\t\t\t\t\t\t\t{#each expenseOptions as option (option)}\n\t\t\t\t\t\t\t\t<option value={option}>{option}</option>\n\t\t\t\t\t\t\t{/each}\n\t\t\t\t\t\t</select>\n\t\t\t\t\t\t{#if expenseOptions.includes(formData.category)}\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\tclass=\"btn-small neutral\"\n\t\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\t\tformData.category = '';\n\t\t\t\t\t\t\t\t\tselectedExpense = '';\n\t\t\t\t\t\t\t\t}}>Clear</button\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t{:else}\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\tclass=\"btn-small primary\"\n\t\t\t\t\t\t\t\ton:click={() => (formData.category = selectedExpense)}\n\t\t\t\t\t\t\t\tdisabled={!selectedExpense}>Choose</button\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t{/if}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<div class=\"form-group\">\n\t\t\t\t\t<label for=\"amount\">Amount</label>\n\t\t\t\t\t<div class=\"input-money-wrapper\">\n\t\t\t\t\t\t<span class=\"symbol\">$</span>\n\t\t\t\t\t\t<input\n\t\t\t\t\t\t\tid=\"amount\"\n\t\t\t\t\t\t\tname=\"amount\"\n\t\t\t\t\t\t\ttype=\"number\"\n\t\t\t\t\t\t\tstep=\"0.01\"\n\t\t\t\t\t\t\tbind:value={formData.amount}\n\t\t\t\t\t\t\tplaceholder=\"0.00\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div class=\"form-group\">\n\t\t\t\t<label for=\"description\">Description</label>\n\t\t\t\t<textarea\n\t\t\t\t\tid=\"description\"\n\t\t\t\t\tname=\"description\"\n\t\t\t\t\tbind:value={formData.description}\n\t\t\t\t\trows=\"3\"\n\t\t\t\t\tplaceholder=\"e.g., Oil Change at Jiffy Lube\"\n\t\t\t\t></textarea>\n\t\t\t</div>\n\n\t\t\t<div class=\"form-group checkbox-group\">\n\t\t\t\t<label for=\"tax-deductible\" class=\"inline-label\">\n\t\t\t\t\t<input\n\t\t\t\t\t\tid=\"tax-deductible\"\n\t\t\t\t\t\tname=\"taxDeductible\"\n\t\t\t\t\t\ttype=\"checkbox\"\n\t\t\t\t\t\tbind:checked={formData.taxDeductible}\n\t\t\t\t\t/>\n\t\t\t\t\t<span>Tax deductible</span>\n\t\t\t\t</label>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<!-- Settings modal (manage maintenance/supplies/expenses categories) -->\n\t\t<SettingsModal bind:open={isManageCategoriesOpen} bind:activeCategoryType />\n\n\t\t<div class=\"form-actions\">\n\t\t\t<a href=\"/dashboard/expenses\" class=\"btn-secondary\">Cancel</a>\n\t\t\t<button class=\"btn-primary\" on:click={saveExpense}>Save Changes</button>\n\t\t</div>\n\t</div>\n</div>\n\n<style>\n\t/* MATCHING STYLES FROM TRIPS/NEW */\n\t.expense-form-page {\n\t\tmax-width: 800px;\n\t\tmargin: 0 auto;\n\t\tpadding: 4px;\n\t\tpadding-bottom: 90px;\n\t}\n\n\t@media (max-width: 640px) {\n\t\t.expense-form-page {\n\t\t\tpadding-bottom: calc(env(safe-area-inset-bottom, 0px) + 1px);\n\t\t}\n\t}\n\n\t.page-header {\n\t\tdisplay: flex;\n\t\tjustify-content: space-between;\n\t\talign-items: center;\n\t\tmargin-bottom: 26px;\n\t\tpadding: 0 8px;\n\t}\n\t.page-title {\n\t\tfont-size: 28px;\n\t\tfont-weight: 800;\n\t\tcolor: #111827;\n\t\tmargin: 0;\n\t}\n\t.page-subtitle {\n\t\tfont-size: 14px;\n\t\tcolor: #6b7280;\n\t\tdisplay: none;\n\t\tmargin: 0;\n\t}\n\n\t.btn-back {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tgap: 8px;\n\t\tfont-weight: 600;\n\t\tcolor: #6b7280;\n\t\ttext-decoration: none;\n\t\tfont-size: 14px;\n\t}\n\n\t.form-card {\n\t\tbackground: white;\n\t\tborder: 1px solid #e5e7eb;\n\t\tborder-radius: 18px;\n\t\tpadding: 16px;\n\t\tbox-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);\n\t}\n\t.card-header {\n\t\tmargin-bottom: 26px;\n\t}\n\t.card-title {\n\t\tfont-size: 22px;\n\t\tfont-weight: 700;\n\t\tcolor: #111827;\n\t\tmargin: 0;\n\t}\n\n\t.form-grid {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tgap: 24px;\n\t}\n\t.form-row {\n\t\tdisplay: grid;\n\t\tgrid-template-columns: 1fr 1fr;\n\t\tgap: 20px;\n\t}\n\t.form-group {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tgap: 8px;\n\t}\n\n\tlabel {\n\t\tfont-size: 16px;\n\t\tfont-weight: 600;\n\t\tcolor: #374151;\n\t}\n\n\tinput,\n\ttextarea,\n\tselect {\n\t\twidth: 100%;\n\t\tpadding: 16px;\n\t\tborder: 1px solid #e5e7eb;\n\t\tborder-radius: 12px;\n\t\tfont-size: 18px;\n\t\tbackground: white;\n\t\tbox-sizing: border-box;\n\t}\n\tinput:focus,\n\ttextarea:focus,\n\tselect:focus {\n\t\toutline: none;\n\t\tborder-color: #ff7f50;\n\t}\n\n\t.input-money-wrapper {\n\t\tposition: relative;\n\t\twidth: 100%;\n\t}\n\t.input-money-wrapper .symbol {\n\t\tposition: absolute;\n\t\tleft: 16px;\n\t\ttop: 50%;\n\t\ttransform: translateY(-50%);\n\t\tcolor: #6b7280;\n\t\tfont-weight: 600;\n\t\tfont-size: 18px;\n\t}\n\t.input-money-wrapper input {\n\t\tpadding-left: 36px;\n\t}\n\n\t.section-group {\n\t\tmargin-bottom: 24px;\n\t}\n\t.section-top {\n\t\tdisplay: flex;\n\t\tjustify-content: space-between;\n\t\tmargin-bottom: 12px;\n\t\talign-items: center;\n\t}\n\t.section-top h3 {\n\t\tfont-size: 16px;\n\t\tfont-weight: 700;\n\t\tmargin: 0;\n\t}\n\t.add-row {\n\t\tdisplay: flex;\n\t\tgap: 12px;\n\t\tmargin-bottom: 12px;\n\t}\n\t.select-input {\n\t\tflex: 1;\n\t\tpadding: 12px;\n\t\tborder: 1px solid #e5e7eb;\n\t\tborder-radius: 10px;\n\t\tfont-size: 16px;\n\t\tbackground: white;\n\t\tcolor: #374151;\n\t}\n\t.btn-icon.gear {\n\t\tbackground: none;\n\t\tborder: none;\n\t\tcursor: pointer;\n\t\tpadding: 6px;\n\t\tcolor: #6b7280;\n\t}\n\t.btn-small.primary {\n\t\tpadding: 8px 12px;\n\t\tbackground: linear-gradient(135deg, #ff7f50 0%, #ff6a3d 100%);\n\t\tcolor: white;\n\t\tborder-radius: 8px;\n\t\tborder: none;\n\t\tfont-weight: 600;\n\t}\n\t.btn-small.neutral {\n\t\tpadding: 8px 12px;\n\t\tbackground: white;\n\t\tborder-radius: 8px;\n\t\tborder: 1px solid #e5e7eb;\n\t\tcolor: #374151;\n\t\tfont-weight: 600;\n\t}\n\n\t.form-group.checkbox-group .inline-label {\n\t\tdisplay: inline-flex;\n\t\talign-items: center;\n\t\tgap: 12px;\n\t\tfont-weight: 600;\n\t\tcolor: #374151;\n\t}\n\t.form-group.checkbox-group input[type='checkbox'] {\n\t\twidth: 18px;\n\t\theight: 18px;\n\t\taccent-color: #ff7f50;\n\t}\n\n\t.form-actions {\n\t\tdisplay: flex;\n\t\tgap: 18px;\n\t\tmargin-top: 36px;\n\t\tpadding-top: 26px;\n\t\tborder-top: 1px solid #e5e7eb;\n\t}\n\t.btn-primary,\n\t.btn-secondary {\n\t\tflex: 1;\n\t\tpadding: 18px;\n\t\tborder-radius: 12px;\n\t\tfont-weight: 600;\n\t\tfont-size: 18px;\n\t\tcursor: pointer;\n\t\tborder: none;\n\t\ttext-align: center;\n\t\ttext-decoration: none;\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t}\n\t.btn-primary {\n\t\tbackground: linear-gradient(135deg, #ff7f50 0%, #ff6a3d 100%);\n\t\tcolor: white;\n\t}\n\t.btn-secondary {\n\t\tbackground: white;\n\t\tborder: 1px solid #e5e7eb;\n\t\tcolor: #374151;\n\t}\n\n\t@media (min-width: 768px) {\n\t\t.page-subtitle {\n\t\t\tdisplay: block;\n\t\t}\n\t\t.form-card {\n\t\t\tpadding: 48px;\n\t\t}\n\t\t.form-actions {\n\t\t\tjustify-content: flex-end;\n\t\t}\n\t\t.btn-primary,\n\t\t.btn-secondary {\n\t\t\tflex: 0 0 auto;\n\t\t\twidth: auto;\n\t\t\tmin-width: 160px;\n\t\t}\n\t}\n</style>\n",
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\dashboard\\expenses\\new\\+page.svelte",
		"messages": [
			{
				"ruleId": "svelte/no-navigation-without-resolve",
				"severity": 1,
				"message": "Unexpected goto() call without resolve().",
				"line": 139,
				"column": 9,
				"nodeType": null,
				"messageId": "gotoWithoutResolve",
				"endLine": 139,
				"endColumn": 30
			},
			{
				"ruleId": "svelte/no-navigation-without-resolve",
				"severity": 1,
				"message": "Unexpected href link without resolve().",
				"line": 153,
				"column": 12,
				"nodeType": null,
				"messageId": "linkWithoutResolve",
				"endLine": 153,
				"endColumn": 31
			},
			{
				"ruleId": "svelte/no-navigation-without-resolve",
				"severity": 1,
				"message": "Unexpected href link without resolve().",
				"line": 394,
				"column": 13,
				"nodeType": null,
				"messageId": "linkWithoutResolve",
				"endLine": 394,
				"endColumn": 32
			}
		],
		"suppressedMessages": [
			{
				"ruleId": "svelte/no-reactive-reassign",
				"severity": 2,
				"message": "Assignment to reactive value 'expenseOptions'.",
				"line": 107,
				"column": 5,
				"nodeType": "AssignmentExpression",
				"messageId": "assignmentToReactiveValue",
				"endLine": 107,
				"endColumn": 44,
				"suppressions": [{ "kind": "directive", "justification": "" }]
			}
		],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 3,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"source": "<script lang=\"ts\">\n\timport { expenses } from '$lib/stores/expenses';\n\timport { userSettings } from '$lib/stores/userSettings';\n\timport { user } from '$lib/stores/auth';\n\timport { toasts } from '$lib/stores/toast';\n\timport { goto } from '$app/navigation';\n\timport { page } from '$app/stores';\n\n\t// --- HELPER: Get Local Date (YYYY-MM-DD) ---\n\tfunction getLocalDate() {\n\t\tconst now = new Date();\n\t\treturn new Date(now.getTime() - now.getTimezoneOffset() * 60000).toISOString().split('T')[0];\n\t}\n\n\timport SettingsModal from '../../trips/components/SettingsModal.svelte';\n\n\t// Category options derived from user settings (grouped)\n\t$: maintenanceOptions =\n\t\t$userSettings.maintenanceCategories?.length > 0\n\t\t\t? $userSettings.maintenanceCategories\n\t\t\t: ['Oil Change', 'Tire Rotation', 'Brake Service', 'Filter Replacement'];\n\t$: suppliesOptions =\n\t\t$userSettings.supplyCategories?.length > 0\n\t\t\t? $userSettings.supplyCategories\n\t\t\t: ['Concrete', 'Poles', 'Wire', 'Tools', 'Equipment Rental'];\n\t$: expenseOptions =\n\t\t$userSettings.expenseCategories?.length > 0\n\t\t\t? $userSettings.expenseCategories\n\t\t\t: ['maintenance', 'insurance', 'supplies', 'other'];\n\n\tlet selectedMaintenance = '';\n\tlet selectedSupply = '';\n\tlet selectedExpense = '';\n\n\tlet isManageCategoriesOpen = false;\n\tlet activeCategoryType: 'maintenance' | 'supplies' | 'expenses' = 'maintenance';\n\n\t// Keep the selectedX in sync with formData.category\n\t$: if (formData.category) {\n\t\tif (maintenanceOptions.includes(formData.category)) {\n\t\t\tselectedMaintenance = formData.category;\n\t\t\tselectedSupply = '';\n\t\t\tselectedExpense = '';\n\t\t} else if (suppliesOptions.includes(formData.category)) {\n\t\t\tselectedSupply = formData.category;\n\t\t\tselectedMaintenance = '';\n\t\t\tselectedExpense = '';\n\t\t} else if (expenseOptions.includes(formData.category)) {\n\t\t\tselectedExpense = formData.category;\n\t\t\tselectedMaintenance = '';\n\t\t\tselectedSupply = '';\n\t\t} else {\n\t\t\tselectedMaintenance = '';\n\t\t\tselectedSupply = '';\n\t\t\tselectedExpense = '';\n\t\t}\n\t}\n\n\tfunction openSettings(type: 'maintenance' | 'supplies' | 'expenses') {\n\t\tactiveCategoryType = type;\n\t\tisManageCategoriesOpen = true;\n\t}\n\n\tfunction selectMaintenance() {\n\t\tif (!selectedMaintenance) return;\n\t\tformData.category = selectedMaintenance;\n\t\t// clear other selections\n\t\tselectedSupply = '';\n\t\tselectedExpense = '';\n\t}\n\n\tfunction selectSupply() {\n\t\tif (!selectedSupply) return;\n\t\tformData.category = selectedSupply;\n\t\tselectedMaintenance = '';\n\t\tselectedExpense = '';\n\t}\n\n\tfunction selectExpense() {\n\t\tif (!selectedExpense) return;\n\t\tformData.category = selectedExpense;\n\t\tselectedMaintenance = '';\n\t\tselectedSupply = '';\n\t}\n\n\tconst formData = {\n\t\tdate: getLocalDate(),\n\t\tcategory: '',\n\t\tamount: '',\n\t\tdescription: '',\n\t\ttaxDeductible: false\n\t};\n\n\t// Reference to amount input so quick-action can focus it\n\tlet amountInput: HTMLInputElement | null = null;\n\t// Prefill category from the URL query parameter (e.g., ?category=fuel)\n\t$: {\n\t\tconst q = $page.url.searchParams.get('category');\n\t\tif (q) {\n\t\t\t// ensure the queried category appears in the available options (preferring expenseOptions)\n\t\t\tif (\n\t\t\t\t!maintenanceOptions.includes(q) &&\n\t\t\t\t!suppliesOptions.includes(q) &&\n\t\t\t\t!expenseOptions.includes(q)\n\t\t\t) {\n\t\t\t\t// eslint-disable-next-line svelte/no-reactive-reassign\n\t\t\t\texpenseOptions = [q, ...expenseOptions];\n\t\t\t}\n\t\t\tformData.category = q;\n\t\t\t// if arrived via quick action, focus the amount input for quick logging\n\t\t\tif (typeof window !== 'undefined') {\n\t\t\t\tsetTimeout(() => amountInput?.focus(), 60);\n\t\t\t}\n\t\t}\n\t}\n\n\tasync function saveExpense() {\n\t\tif (!formData.amount || !formData.date || !formData.category) {\n\t\t\ttoasts.error('Please fill in required fields.');\n\t\t\treturn;\n\t\t}\n\n\t\tconst currentUser = $page.data['user'] || $user;\n\t\tconst userId = currentUser?.id || localStorage.getItem('offline_user_id');\n\n\t\tif (!userId) {\n\t\t\ttoasts.error('User not identified. Cannot save.');\n\t\t\treturn;\n\t\t}\n\n\t\ttry {\n\t\t\tconst payload = {\n\t\t\t\t...formData,\n\t\t\t\tamount: parseFloat(formData.amount)\n\t\t\t};\n\n\t\t\tawait expenses.create(payload, userId);\n\t\t\ttoasts.success('Expense created');\n\t\t\tgoto('/dashboard/expenses');\n\t\t} catch (err) {\n\t\t\tconsole.error(err);\n\t\t\ttoasts.error('Failed to save expense');\n\t\t}\n\t}\n</script>\n\n<div class=\"expense-form-page\">\n\t<div class=\"page-header\">\n\t\t<div>\n\t\t\t<h1 class=\"page-title\">New Expense</h1>\n\t\t\t<p class=\"page-subtitle\">Log a new cost</p>\n\t\t</div>\n\t\t<a href=\"/dashboard/expenses\" class=\"btn-back\">\n\t\t\t<svg width=\"24\" height=\"24\" viewBox=\"0 0 20 20\" fill=\"none\"\n\t\t\t\t><path\n\t\t\t\t\td=\"M12 4L6 10L12 16\"\n\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\t\tstroke-linejoin=\"round\"\n\t\t\t\t/></svg\n\t\t\t> Back\n\t\t</a>\n\t</div>\n\n\t<div class=\"form-card\">\n\t\t<div class=\"card-header\">\n\t\t\t<h2 class=\"card-title\">Expense Details</h2>\n\t\t</div>\n\n\t\t<div class=\"form-grid\">\n\t\t\t<div class=\"form-group\">\n\t\t\t\t<label for=\"expense-date\">Date</label>\n\t\t\t\t<input id=\"expense-date\" type=\"date\" bind:value={formData.date} required />\n\t\t\t</div>\n\n\t\t\t<div class=\"form-row\">\n\t\t\t\t<div class=\"section-group\">\n\t\t\t\t\t<div class=\"section-top\">\n\t\t\t\t\t\t<h3>Maintenance</h3>\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tclass=\"btn-icon gear\"\n\t\t\t\t\t\t\ton:click={() => openSettings('maintenance')}\n\t\t\t\t\t\t\ttitle=\"Manage Options\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\t\twidth=\"20\"\n\t\t\t\t\t\t\t\theight=\"20\"\n\t\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\t\t\t\t\tfill=\"none\"\n\t\t\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\t\t\t\t\tstroke-linejoin=\"round\"\n\t\t\t\t\t\t\t\t><circle cx=\"12\" cy=\"12\" r=\"3\"></circle><path\n\t\t\t\t\t\t\t\t\td=\"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z\"\n\t\t\t\t\t\t\t\t></path></svg\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\"add-row\">\n\t\t\t\t\t\t<select\n\t\t\t\t\t\t\tid=\"maintenance-select\"\n\t\t\t\t\t\t\tname=\"maintenance\"\n\t\t\t\t\t\t\tbind:value={selectedMaintenance}\n\t\t\t\t\t\t\ton:change={selectMaintenance}\n\t\t\t\t\t\t\tclass=\"select-input\"\n\t\t\t\t\t\t\taria-label=\"Maintenance type\"\n\t\t\t\t\t\t\tdisabled={!!formData.category && !maintenanceOptions.includes(formData.category)}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<option value=\"\" disabled selected>Select Item...</option>\n\t\t\t\t\t\t\t{#each maintenanceOptions as option (option)}\n\t\t\t\t\t\t\t\t<option value={option}>{option}</option>\n\t\t\t\t\t\t\t{/each}\n\t\t\t\t\t\t</select>\n\t\t\t\t\t\t{#if maintenanceOptions.includes(formData.category)}\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\tclass=\"btn-small neutral\"\n\t\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\t\tformData.category = '';\n\t\t\t\t\t\t\t\t\tselectedMaintenance = '';\n\t\t\t\t\t\t\t\t}}>Clear</button\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t{:else}\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\tclass=\"btn-small primary\"\n\t\t\t\t\t\t\t\ton:click={() => (formData.category = selectedMaintenance)}\n\t\t\t\t\t\t\t\tdisabled={!selectedMaintenance}>Choose</button\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t{/if}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<div class=\"section-group\">\n\t\t\t\t\t<div class=\"section-top\">\n\t\t\t\t\t\t<h3>Supplies</h3>\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tclass=\"btn-icon gear\"\n\t\t\t\t\t\t\ton:click={() => openSettings('supplies')}\n\t\t\t\t\t\t\ttitle=\"Manage Options\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\t\twidth=\"20\"\n\t\t\t\t\t\t\t\theight=\"20\"\n\t\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\t\t\t\t\tfill=\"none\"\n\t\t\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\t\t\t\t\tstroke-linejoin=\"round\"\n\t\t\t\t\t\t\t\t><circle cx=\"12\" cy=\"12\" r=\"3\"></circle><path\n\t\t\t\t\t\t\t\t\td=\"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z\"\n\t\t\t\t\t\t\t\t></path></svg\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\"add-row\">\n\t\t\t\t\t\t<select\n\t\t\t\t\t\t\tid=\"supplies-select\"\n\t\t\t\t\t\t\tname=\"supplies\"\n\t\t\t\t\t\t\tbind:value={selectedSupply}\n\t\t\t\t\t\t\ton:change={selectSupply}\n\t\t\t\t\t\t\tclass=\"select-input\"\n\t\t\t\t\t\t\taria-label=\"Supply type\"\n\t\t\t\t\t\t\tdisabled={!!formData.category && !suppliesOptions.includes(formData.category)}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<option value=\"\" disabled selected>Select Item...</option>\n\t\t\t\t\t\t\t{#each suppliesOptions as option (option)}\n\t\t\t\t\t\t\t\t<option value={option}>{option}</option>\n\t\t\t\t\t\t\t{/each}\n\t\t\t\t\t\t</select>\n\t\t\t\t\t\t{#if suppliesOptions.includes(formData.category)}\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\tclass=\"btn-small neutral\"\n\t\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\t\tformData.category = '';\n\t\t\t\t\t\t\t\t\tselectedSupply = '';\n\t\t\t\t\t\t\t\t}}>Clear</button\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t{:else}\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\tclass=\"btn-small primary\"\n\t\t\t\t\t\t\t\ton:click={() => (formData.category = selectedSupply)}\n\t\t\t\t\t\t\t\tdisabled={!selectedSupply}>Choose</button\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t{/if}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<div class=\"section-group\">\n\t\t\t\t\t<div class=\"section-top\">\n\t\t\t\t\t\t<h3>Expenses</h3>\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tclass=\"btn-icon gear\"\n\t\t\t\t\t\t\ton:click={() => openSettings('expenses')}\n\t\t\t\t\t\t\ttitle=\"Manage Options\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\t\twidth=\"20\"\n\t\t\t\t\t\t\t\theight=\"20\"\n\t\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\t\t\t\t\tfill=\"none\"\n\t\t\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\t\t\t\t\tstroke-linejoin=\"round\"\n\t\t\t\t\t\t\t\t><circle cx=\"12\" cy=\"12\" r=\"3\"></circle><path\n\t\t\t\t\t\t\t\t\td=\"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z\"\n\t\t\t\t\t\t\t\t></path></svg\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\"add-row\">\n\t\t\t\t\t\t<select\n\t\t\t\t\t\t\tid=\"expense-select\"\n\t\t\t\t\t\t\tname=\"expenseCategory\"\n\t\t\t\t\t\t\tbind:value={selectedExpense}\n\t\t\t\t\t\t\ton:change={selectExpense}\n\t\t\t\t\t\t\tclass=\"select-input\"\n\t\t\t\t\t\t\taria-label=\"Expense category\"\n\t\t\t\t\t\t\tdisabled={!!formData.category && !expenseOptions.includes(formData.category)}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<option value=\"\" disabled selected>Select Item...</option>\n\t\t\t\t\t\t\t{#each expenseOptions as option (option)}\n\t\t\t\t\t\t\t\t<option value={option}>{option}</option>\n\t\t\t\t\t\t\t{/each}\n\t\t\t\t\t\t</select>\n\t\t\t\t\t\t{#if expenseOptions.includes(formData.category)}\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\tclass=\"btn-small neutral\"\n\t\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\t\tformData.category = '';\n\t\t\t\t\t\t\t\t\tselectedExpense = '';\n\t\t\t\t\t\t\t\t}}>Clear</button\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t{:else}\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\tclass=\"btn-small primary\"\n\t\t\t\t\t\t\t\ton:click={() => (formData.category = selectedExpense)}\n\t\t\t\t\t\t\t\tdisabled={!selectedExpense}>Choose</button\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t{/if}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<div class=\"form-group\">\n\t\t\t\t\t<label for=\"amount\">Amount</label>\n\t\t\t\t\t<div class=\"input-money-wrapper\">\n\t\t\t\t\t\t<span class=\"symbol\">$</span>\n\t\t\t\t\t\t<input\n\t\t\t\t\t\t\tid=\"amount\"\n\t\t\t\t\t\t\tname=\"amount\"\n\t\t\t\t\t\t\ttype=\"number\"\n\t\t\t\t\t\t\tstep=\"0.01\"\n\t\t\t\t\t\t\tbind:value={formData.amount}\n\t\t\t\t\t\t\tbind:this={amountInput}\n\t\t\t\t\t\t\tplaceholder=\"0.00\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div class=\"form-group\">\n\t\t\t\t<label for=\"description\">Description</label>\n\t\t\t\t<textarea\n\t\t\t\t\tid=\"description\"\n\t\t\t\t\tname=\"description\"\n\t\t\t\t\tbind:value={formData.description}\n\t\t\t\t\trows=\"3\"\n\t\t\t\t\tplaceholder=\"e.g., Oil Change at Jiffy Lube\"\n\t\t\t\t></textarea>\n\t\t\t</div>\n\n\t\t\t<div class=\"form-group checkbox-group\">\n\t\t\t\t<label for=\"tax-deductible\" class=\"inline-label\">\n\t\t\t\t\t<input\n\t\t\t\t\t\tid=\"tax-deductible\"\n\t\t\t\t\t\tname=\"taxDeductible\"\n\t\t\t\t\t\ttype=\"checkbox\"\n\t\t\t\t\t\tbind:checked={formData.taxDeductible}\n\t\t\t\t\t/>\n\t\t\t\t\t<span>Tax Deductible</span>\n\t\t\t\t</label>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<!-- Settings modal (manage maintenance/supplies/expenses categories) -->\n\t\t<SettingsModal bind:open={isManageCategoriesOpen} bind:activeCategoryType />\n\n\t\t<div class=\"form-actions\">\n\t\t\t<a href=\"/dashboard/expenses\" class=\"btn-secondary\">Cancel</a>\n\t\t\t<button class=\"btn-primary\" on:click={saveExpense}>Save Expense</button>\n\t\t</div>\n\t</div>\n</div>\n\n<style>\n\t/* MATCHING STYLES FROM TRIPS/NEW */\n\t.expense-form-page {\n\t\tmax-width: 800px;\n\t\tmargin: 0 auto;\n\t\tpadding: 4px;\n\t\tpadding-bottom: 90px;\n\t}\n\n\t@media (max-width: 640px) {\n\t\t.expense-form-page {\n\t\t\tpadding-bottom: calc(env(safe-area-inset-bottom, 0px) + 1px);\n\t\t}\n\t}\n\n\t.page-header {\n\t\tdisplay: flex;\n\t\tjustify-content: space-between;\n\t\talign-items: center;\n\t\tmargin-bottom: 26px;\n\t\tpadding: 0 8px;\n\t}\n\t.page-title {\n\t\tfont-size: 28px;\n\t\tfont-weight: 800;\n\t\tcolor: #111827;\n\t\tmargin: 0;\n\t}\n\t.page-subtitle {\n\t\tfont-size: 14px;\n\t\tcolor: #6b7280;\n\t\tdisplay: none;\n\t\tmargin: 0;\n\t}\n\n\t.btn-back {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tgap: 8px;\n\t\tfont-weight: 600;\n\t\tcolor: #6b7280;\n\t\ttext-decoration: none;\n\t\tfont-size: 14px;\n\t}\n\n\t.form-card {\n\t\tbackground: white;\n\t\tborder: 1px solid #e5e7eb;\n\t\tborder-radius: 18px;\n\t\tpadding: 16px;\n\t\tbox-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);\n\t}\n\t.card-header {\n\t\tmargin-bottom: 26px;\n\t}\n\t.card-title {\n\t\tfont-size: 22px;\n\t\tfont-weight: 700;\n\t\tcolor: #111827;\n\t\tmargin: 0;\n\t}\n\n\t.form-grid {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tgap: 24px;\n\t}\n\t.form-row {\n\t\tdisplay: grid;\n\t\tgrid-template-columns: 1fr 1fr;\n\t\tgap: 20px;\n\t}\n\t.form-group {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tgap: 8px;\n\t}\n\n\tlabel {\n\t\tfont-size: 16px;\n\t\tfont-weight: 600;\n\t\tcolor: #374151;\n\t}\n\n\tinput,\n\ttextarea,\n\tselect {\n\t\twidth: 100%;\n\t\tpadding: 16px;\n\t\tborder: 1px solid #e5e7eb;\n\t\tborder-radius: 12px;\n\t\tfont-size: 18px;\n\t\tbackground: white;\n\t\tbox-sizing: border-box;\n\t}\n\tinput:focus,\n\ttextarea:focus,\n\tselect:focus {\n\t\toutline: none;\n\t\tborder-color: #ff7f50;\n\t}\n\n\t.input-money-wrapper {\n\t\tposition: relative;\n\t\twidth: 100%;\n\t}\n\t.input-money-wrapper .symbol {\n\t\tposition: absolute;\n\t\tleft: 16px;\n\t\ttop: 50%;\n\t\ttransform: translateY(-50%);\n\t\tcolor: #6b7280;\n\t\tfont-weight: 600;\n\t\tfont-size: 18px;\n\t}\n\t.input-money-wrapper input {\n\t\tpadding-left: 36px;\n\t}\n\n\t.section-group {\n\t\tmargin-bottom: 24px;\n\t}\n\t.section-top {\n\t\tdisplay: flex;\n\t\tjustify-content: space-between;\n\t\tmargin-bottom: 12px;\n\t\talign-items: center;\n\t}\n\t.section-top h3 {\n\t\tfont-size: 16px;\n\t\tfont-weight: 700;\n\t\tmargin: 0;\n\t}\n\t.add-row {\n\t\tdisplay: flex;\n\t\tgap: 12px;\n\t\tmargin-bottom: 12px;\n\t}\n\t.select-input {\n\t\tflex: 1;\n\t\tpadding: 12px;\n\t\tborder: 1px solid #e5e7eb;\n\t\tborder-radius: 10px;\n\t\tfont-size: 16px;\n\t\tbackground: white;\n\t\tcolor: #374151;\n\t}\n\t.btn-icon.gear {\n\t\tbackground: none;\n\t\tborder: none;\n\t\tcursor: pointer;\n\t\tpadding: 6px;\n\t\tcolor: #6b7280;\n\t}\n\t.btn-small.primary {\n\t\tpadding: 8px 12px;\n\t\tbackground: linear-gradient(135deg, #ff7f50 0%, #ff6a3d 100%);\n\t\tcolor: white;\n\t\tborder-radius: 8px;\n\t\tborder: none;\n\t\tfont-weight: 600;\n\t}\n\t.btn-small.neutral {\n\t\tpadding: 8px 12px;\n\t\tbackground: white;\n\t\tborder-radius: 8px;\n\t\tborder: 1px solid #e5e7eb;\n\t\tcolor: #374151;\n\t\tfont-weight: 600;\n\t}\n\n\t.form-group.checkbox-group .inline-label {\n\t\tdisplay: inline-flex;\n\t\talign-items: center;\n\t\tgap: 12px;\n\t\tfont-weight: 600;\n\t\tcolor: #374151;\n\t}\n\t.form-group.checkbox-group input[type='checkbox'] {\n\t\twidth: 18px;\n\t\theight: 18px;\n\t\taccent-color: #ff7f50;\n\t}\n\n\t.form-actions {\n\t\tdisplay: flex;\n\t\tgap: 18px;\n\t\tmargin-top: 36px;\n\t\tpadding-top: 26px;\n\t\tborder-top: 1px solid #e5e7eb;\n\t}\n\t.btn-primary,\n\t.btn-secondary {\n\t\tflex: 1;\n\t\tpadding: 18px;\n\t\tborder-radius: 12px;\n\t\tfont-weight: 600;\n\t\tfont-size: 18px;\n\t\tcursor: pointer;\n\t\tborder: none;\n\t\ttext-align: center;\n\t\ttext-decoration: none;\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t}\n\t.btn-primary {\n\t\tbackground: linear-gradient(135deg, #ff7f50 0%, #ff6a3d 100%);\n\t\tcolor: white;\n\t}\n\t.btn-secondary {\n\t\tbackground: white;\n\t\tborder: 1px solid #e5e7eb;\n\t\tcolor: #374151;\n\t}\n\n\t@media (min-width: 768px) {\n\t\t.page-subtitle {\n\t\t\tdisplay: block;\n\t\t}\n\t\t.form-card {\n\t\t\tpadding: 48px;\n\t\t}\n\t\t.form-actions {\n\t\t\tjustify-content: flex-end;\n\t\t}\n\t\t.btn-primary,\n\t\t.btn-secondary {\n\t\t\tflex: 0 0 auto;\n\t\t\twidth: auto;\n\t\t\tmin-width: 160px;\n\t\t}\n\t}\n</style>\n",
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\dashboard\\hughesnet\\+page.svelte",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\dashboard\\mileage\\+page.server.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\dashboard\\mileage\\+page.svelte",
		"messages": [
			{
				"ruleId": "svelte/no-navigation-without-resolve",
				"severity": 1,
				"message": "Unexpected goto() call without resolve().",
				"line": 198,
				"column": 8,
				"nodeType": null,
				"messageId": "gotoWithoutResolve",
				"endLine": 198,
				"endColumn": 32
			},
			{
				"ruleId": "svelte/no-navigation-without-resolve",
				"severity": 1,
				"message": "Unexpected goto() call without resolve().",
				"line": 203,
				"column": 9,
				"nodeType": null,
				"messageId": "gotoWithoutResolve",
				"endLine": 203,
				"endColumn": 48
			},
			{
				"ruleId": "svelte/no-navigation-without-resolve",
				"severity": 1,
				"message": "Unexpected goto() call without resolve().",
				"line": 205,
				"column": 9,
				"nodeType": null,
				"messageId": "gotoWithoutResolve",
				"endLine": 205,
				"endColumn": 48
			},
			{
				"ruleId": "svelte/no-navigation-without-resolve",
				"severity": 1,
				"message": "Unexpected goto() call without resolve().",
				"line": 457,
				"column": 26,
				"nodeType": null,
				"messageId": "gotoWithoutResolve",
				"endLine": 457,
				"endColumn": 57
			}
		],
		"suppressedMessages": [
			{
				"ruleId": "svelte/require-store-reactive-access",
				"severity": 2,
				"message": "Use the $ prefix or the get function to access reactive values instead of accessing the raw store.",
				"line": 27,
				"column": 33,
				"nodeType": "Identifier",
				"messageId": "usingRawStoreInText",
				"endLine": 27,
				"endColumn": 40,
				"fix": { "range": [1189, 1189], "text": "$" },
				"suppressions": [{ "kind": "directive", "justification": "" }]
			}
		],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 4,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"source": "<script lang=\"ts\">\n\timport { mileage, isLoading as mileageLoading } from '$lib/stores/mileage';\n\timport { userSettings } from '$lib/stores/userSettings';\n\timport { getVehicleDisplayName } from '$lib/utils/vehicle';\n\timport SettingsModal from './components/SettingsModal.svelte';\n\timport { user } from '$lib/stores/auth';\n\timport { toasts } from '$lib/stores/toast';\n\timport Modal from '$lib/components/ui/Modal.svelte';\n\timport Skeleton from '$lib/components/ui/Skeleton.svelte';\n\timport { goto, invalidateAll } from '$app/navigation';\n\timport { page } from '$app/stores';\n\timport { onDestroy } from 'svelte';\n\timport { SvelteSet, SvelteDate } from '$lib/utils/svelte-reactivity';\n\timport { browser } from '$app/environment'; // [!code fix] Import browser check\n\n\timport type { PageData } from './$types';\n\n\texport let data: PageData;\n\n\t// [!code fix] Only run hydration in the browser\n\t$: if (browser && data.mileage) {\n\t\tconst normalize = (records: any[]) =>\n\t\t\trecords.map((r) => ({ ...r, syncStatus: (r as any).syncStatus ?? 'synced' }));\n\t\tconst normalized = normalize(data.mileage);\n\n\t\t// eslint-disable-next-line svelte/require-store-reactive-access\n\t\tif ($user?.id && 'hydrate' in mileage) {\n\t\t\tmileage.hydrate(normalized, $user.id);\n\t\t} else {\n\t\t\tmileage.set(normalized);\n\t\t}\n\t}\n\n\tlet isMileageSettingsOpen = false;\n\n\t// Derived totals - use pre-computed values\n\t$: totalMiles = filteredExpenses.reduce((s, e) => s + (Number((e as any).miles) || 0), 0);\n\t// PERFORMANCE: Use pre-computed reimbursement\n\t$: totalMileageDeduction = filteredExpenses.reduce(\n\t\t(s, e) => s + ((e as any)._reimbursement || 0),\n\t\t0\n\t);\n\n\t// --- STATE ---\n\tlet searchQuery = '';\n\tlet sortBy = 'date';\n\tlet sortOrder = 'desc';\n\tlet filterCategory = 'all';\n\tlet allExpenses: any[] = [];\n\tlet filteredExpenses: any[] = [];\n\tconst _now = SvelteDate.now();\n\tfunction _fmtInput(d: SvelteDate) {\n\t\treturn d.toInput();\n\t}\n\tlet startDate = _fmtInput(SvelteDate.from(new Date(_now.getFullYear(), _now.getMonth(), 1)));\n\tlet endDate = _fmtInput(SvelteDate.from(new Date(_now.getFullYear(), _now.getMonth() + 1, 0)));\n\n\tlet lastHadSelections = false;\n\tlet selectedExpenses = new SvelteSet<string>();\n\n\t// Pagination\n\tlet currentPage = 1;\n\tconst itemsPerPage = 20;\n\tlet visibleExpenses: any[] = [];\n\n\t// Loading is only true when both store is loading AND we have no server data to show\n\t$: loading = $mileageLoading && (!data.mileage || data.mileage.length === 0);\n\n\t// REMOVED: automatic expansion to full list size was causing severe rendering hits\n\t// Instead, we just use a reasonable visible limit or implement a Load More button\n\n\t$: if (typeof document !== 'undefined') {\n\t\tconst hasSelections = selectedExpenses.size > 0;\n\t\tif (hasSelections !== lastHadSelections) {\n\t\t\tif (hasSelections) {\n\t\t\t\tdocument.body.classList.add('has-selections');\n\t\t\t} else {\n\t\t\t\tdocument.body.classList.remove('has-selections');\n\t\t\t}\n\t\t\tlastHadSelections = hasSelections;\n\t\t}\n\t}\n\n\tonDestroy(() => {\n\t\tif (typeof document !== 'undefined') {\n\t\t\tdocument.body.classList.remove('has-selections');\n\t\t}\n\t});\n\n\tconst categories: string[] = [];\n\tlet isManageCategoriesOpen = false;\n\tlet newCategoryName = '';\n\n\t// Use store data, but fallback to server data during initial hydration to prevent flicker\n\t$: {\n\t\tconst source = $mileage.length > 0 ? $mileage : data.mileage || [];\n\t\t// PERFORMANCE: Pre-calculate all values once to avoid repeated computations\n\t\tallExpenses = source\n\t\t\t.filter(\n\t\t\t\t(r: any) =>\n\t\t\t\t\ttypeof r.miles === 'number' ||\n\t\t\t\t\ttypeof r.startOdometer === 'number' ||\n\t\t\t\t\ttypeof r.endOdometer === 'number'\n\t\t\t)\n\t\t\t.map((r: any) => {\n\t\t\t\tconst dateVal = SvelteDate.from(r.date || 0).getTime();\n\t\t\t\tconst amtVal = Number(r.amount || 0);\n\t\t\t\t// Pre-compute reimbursement if not stored\n\t\t\t\tconst reimbursement =\n\t\t\t\t\ttypeof r.reimbursement === 'number'\n\t\t\t\t\t\t? r.reimbursement\n\t\t\t\t\t\t: Number(r.miles || 0) *\n\t\t\t\t\t\t\t(Number(r.mileageRate) || Number($userSettings?.mileageRate) || 0);\n\n\t\t\t\treturn {\n\t\t\t\t\t...r,\n\t\t\t\t\t_dateVal: dateVal,\n\t\t\t\t\t_amtVal: amtVal,\n\t\t\t\t\t_reimbursement: reimbursement\n\t\t\t\t};\n\t\t\t});\n\t}\n\n\t$: filteredExpenses = allExpenses\n\t\t.filter((item) => {\n\t\t\tconst query = searchQuery.toLowerCase();\n\t\t\tconst matchesSearch =\n\t\t\t\t!query ||\n\t\t\t\t((item as any).description && (item as any).description.toLowerCase().includes(query)) ||\n\t\t\t\tString((item as any).amount || '').includes(query) ||\n\t\t\t\tString((item as any).miles || '').includes(query) ||\n\t\t\t\t((item as any).vehicle &&\n\t\t\t\t\tString((item as any).vehicle)\n\t\t\t\t\t\t.toLowerCase()\n\t\t\t\t\t\t.includes(query)) ||\n\t\t\t\t((item as any).source === 'trip' && 'trip'.includes(query));\n\n\t\t\tif (!matchesSearch) return false;\n\n\t\t\t// Category filtering (manual vs auto vs specific category)\n\t\t\tif (filterCategory !== 'all') {\n\t\t\t\tif (filterCategory === 'manual') {\n\t\t\t\t\t// Show only mileage logs NOT created from trips (no tripId)\n\t\t\t\t\tif ((item as any).tripId) return false;\n\t\t\t\t} else if (filterCategory === 'auto') {\n\t\t\t\t\t// Show only mileage logs created from trips (has tripId)\n\t\t\t\t\tif (!(item as any).tripId) return false;\n\t\t\t\t} else if (item.category !== filterCategory) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Date filtering\n\t\t\tif (startDate || endDate) {\n\t\t\t\tconst itemDateValue = (item as any)._dateVal;\n\n\t\t\t\tif (startDate) {\n\t\t\t\t\tconst start = SvelteDate.from(startDate).startOfDay();\n\t\t\t\t\tif (itemDateValue < start.getTime()) return false;\n\t\t\t\t}\n\t\t\t\tif (endDate) {\n\t\t\t\t\tconst end = SvelteDate.from(endDate).startOfDay();\n\t\t\t\t\tif (itemDateValue > end.getTime()) return false;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn true;\n\t\t})\n\t\t.sort((a, b) => {\n\t\t\tlet aVal: number = 0,\n\t\t\t\tbVal: number = 0;\n\t\t\tif (sortBy === 'date') {\n\t\t\t\taVal = (a as any)._dateVal;\n\t\t\t\tbVal = (b as any)._dateVal;\n\t\t\t} else if (sortBy === 'amount') {\n\t\t\t\t// Sort by reimbursement/cost value\n\t\t\t\taVal = (a as any)._reimbursement || 0;\n\t\t\t\tbVal = (b as any)._reimbursement || 0;\n\t\t\t}\n\t\t\treturn sortOrder === 'asc' ? aVal - bVal : bVal - aVal;\n\t\t});\n\n\t$: totalPages = Math.ceil(filteredExpenses.length / itemsPerPage);\n\t$: visibleExpenses = filteredExpenses.slice(\n\t\t(currentPage - 1) * itemsPerPage,\n\t\tcurrentPage * itemsPerPage\n\t);\n\n\t// Reset selection and pagination when filters change\n\t$: if (searchQuery || sortBy || sortOrder || filterCategory || startDate || endDate) {\n\t\tselectedExpenses = new SvelteSet();\n\t\tcurrentPage = 1;\n\t}\n\n\t$: allSelected = filteredExpenses.length > 0 && selectedExpenses.size === filteredExpenses.length;\n\n\tfunction goToAdd() {\n\t\tgoto('/dashboard/mileage/new');\n\t}\n\n\tfunction editExpense(expense: any) {\n\t\tif ((expense as any).source === 'trip') {\n\t\t\tgoto(`/dashboard/trips?id=${expense.tripId}`);\n\t\t} else {\n\t\t\tgoto(`/dashboard/mileage/edit/${expense.id}`);\n\t\t}\n\t}\n\n\tasync function deleteExpense(id: string, e?: MouseEvent) {\n\t\tif (e) e.stopPropagation();\n\t\tif (!confirm('Move this mileage log to trash? You can restore it later.')) return;\n\t\tif (id.startsWith('trip-')) {\n\t\t\ttoasts.error('Cannot delete Trips here. Delete the Trip instead.');\n\t\t\treturn;\n\t\t}\n\n\t\tconst currentUser = $page.data['user'] || $user;\n\t\t// [!code fix] Strictly use ID.\n\t\tconst userId = currentUser?.id || localStorage.getItem('offline_user_id');\n\n\t\tif (userId) {\n\t\t\ttry {\n\t\t\t\tawait mileage.deleteMileage(id, String(userId));\n\t\t\t\ttoasts.success('Log moved to trash');\n\t\t\t\tif (selectedExpenses.has(id)) {\n\t\t\t\t\tselectedExpenses.delete(id);\n\t\t\t\t\tselectedExpenses = selectedExpenses;\n\t\t\t\t}\n\t\t\t\tawait invalidateAll();\n\t\t\t} catch (err) {\n\t\t\t\tconsole.error(err);\n\t\t\t\ttoasts.error('Failed to move to trash');\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction toggleSelection(id: string) {\n\t\tselectedExpenses = selectedExpenses.has(id)\n\t\t\t? selectedExpenses.delete(id)\n\t\t\t: selectedExpenses.add(id);\n\t}\n\n\tfunction toggleSelectAll() {\n\t\tif (allSelected) selectedExpenses = new SvelteSet();\n\t\telse selectedExpenses = new SvelteSet(filteredExpenses.map((e) => e.id));\n\t}\n\n\tfunction changePage(newPage: number) {\n\t\tif (newPage >= 1 && newPage <= totalPages) {\n\t\t\tcurrentPage = newPage;\n\t\t}\n\t}\n\n\tasync function deleteSelected() {\n\t\tconst ids = Array.from(selectedExpenses);\n\t\tconst manualExpenses = ids.filter((id) => !id.startsWith('trip-'));\n\t\tconst tripLogs = ids.length - manualExpenses.length;\n\t\tif (manualExpenses.length === 0 && tripLogs > 0) {\n\t\t\ttoasts.error(`Cannot delete ${tripLogs} Trip Logs. Edit them in Trips.`);\n\t\t\treturn;\n\t\t}\n\n\t\tif (\n\t\t\t!confirm(\n\t\t\t\t`Move ${manualExpenses.length} mileage logs to trash? ${tripLogs > 0 ? `(${tripLogs} trips will be skipped)` : ''}`\n\t\t\t)\n\t\t)\n\t\t\treturn;\n\t\tconst currentUser = $page.data['user'] || $user;\n\t\t// [!code fix] Strictly use ID.\n\t\tconst userId = currentUser?.id || localStorage.getItem('offline_user_id');\n\n\t\tif (!userId) return;\n\n\t\tlet successCount = 0;\n\t\tfor (const id of manualExpenses) {\n\t\t\ttry {\n\t\t\t\tawait mileage.deleteMileage(id, String(userId));\n\t\t\t\tsuccessCount++;\n\t\t\t} catch (err) {\n\t\t\t\tconsole.error(`Failed to delete ${id}`, err);\n\t\t\t}\n\t\t}\n\n\t\ttoasts.success(`Moved ${successCount} logs to trash.`);\n\t\tselectedExpenses = new SvelteSet();\n\t\tawait invalidateAll();\n\t}\n\n\tfunction isTripSource(item: any): boolean {\n\t\treturn (item as any)?.source === 'trip';\n\t}\n\n\tfunction exportSelected() {\n\t\tconst selectedData = filteredExpenses.filter((e) => selectedExpenses.has(e.id));\n\t\tif (selectedData.length === 0) return;\n\t\tconst headers = ['Date', 'Miles', 'Reimbursement', 'Notes', 'Source'];\n\t\tconst rows = selectedData.map((e) =>\n\t\t\t[\n\t\t\t\t(e as any).date || '',\n\t\t\t\t((e as any).miles ?? 0).toFixed(2),\n\t\t\t\t((e as any).reimbursement || '').toString(),\n\t\t\t\t`\"${(((e as any).notes || '') as string).replace(/\"/g, '\"\"')}\"`,\n\t\t\t\tisTripSource(e) ? 'Trip' : 'Manual'\n\t\t\t].join(',')\n\t\t);\n\n\t\tconst csvContent = [headers.join(','), ...rows].join('\\n');\n\t\tconst blob = new Blob([csvContent], { type: 'text/csv' });\n\t\tconst url = window.URL.createObjectURL(blob);\n\t\tconst a = document.createElement('a');\n\t\ta.href = url;\n\t\ta.download = `expenses_export_${new Date().toISOString().split('T')[0]}.csv`;\n\t\ta.click();\n\n\t\ttoasts.success(`Exported ${selectedData.length} items.`);\n\t\tselectedExpenses = new SvelteSet();\n\t}\n\n\tasync function updateCategories(newCategories: string[]) {\n\t\tuserSettings.update((s) => ({ ...s, expenseCategories: newCategories }));\n\t\ttry {\n\t\t\tconst { saveSettings } = await import('../settings/lib/save-settings');\n\t\t\tconst result = await saveSettings({ expenseCategories: newCategories });\n\t\t\tif (!result.ok) throw new Error(result.error);\n\t\t} catch (e) {\n\t\t\tconsole.error('Failed to sync settings', e);\n\t\t\ttoasts.error('Saved locally, but sync failed');\n\t\t}\n\t}\n\n\tasync function addCategory() {\n\t\tif (!newCategoryName.trim()) return;\n\t\tconst val = newCategoryName.trim().toLowerCase();\n\t\tif (categories.includes(val)) {\n\t\t\ttoasts.error('Category already exists');\n\t\t\treturn;\n\t\t}\n\t\tconst updated = [...categories, val];\n\t\tawait updateCategories(updated);\n\t\tnewCategoryName = '';\n\t\ttoasts.success('Category added');\n\t}\n\n\tasync function removeCategory(cat: string) {\n\t\tif (!confirm(`Delete \"${cat}\" category? Existing expenses will keep this category.`)) return;\n\t\tconst updated = categories.filter((c) => c !== cat);\n\t\tawait updateCategories(updated);\n\t\ttoasts.success('Category removed');\n\t}\n\n\tfunction formatCurrency(amount: number) {\n\t\treturn new Intl.NumberFormat('en-US', { style: 'currency', currency: 'USD' }).format(amount);\n\t}\n\n\tfunction formatDate(dateStr: string) {\n\t\tif (!dateStr) return '';\n\t\treturn new Date(dateStr).toLocaleDateString('en-US', {\n\t\t\tmonth: 'short',\n\t\t\tday: 'numeric',\n\t\t\tyear: 'numeric',\n\t\t\ttimeZone: 'UTC'\n\t\t});\n\t}\n\n\tfunction getCategoryLabel(cat: string) {\n\t\tif (!cat) return '';\n\t\treturn cat.charAt(0).toUpperCase() + cat.slice(1);\n\t}\n\n\tfunction getCategoryColor(cat?: string) {\n\t\tif (!cat) return 'text-gray-600 bg-gray-50 border-gray-200';\n\n\t\tif (cat === 'fuel') return 'text-red-600 bg-red-50 border-red-200';\n\t\tconst colors = [\n\t\t\t'text-blue-600 bg-blue-50 border-blue-200',\n\t\t\t'text-purple-600 bg-purple-50 border-purple-200',\n\t\t\t'text-orange-600 bg-orange-50 border-orange-200',\n\t\t\t'text-green-600 bg-green-50 border-green-200',\n\t\t\t'text-pink-600 bg-pink-50 border-pink-200',\n\t\t\t'text-indigo-600 bg-indigo-50 border-indigo-200'\n\t\t];\n\t\tif (cat === 'supplies') return colors[2];\n\t\tconst sum = cat.split('').reduce((acc, char) => acc + char.charCodeAt(0), 0);\n\t\treturn colors[sum % colors.length];\n\t}\n\n\tfunction swipeable(\n\t\tnode: HTMLElement,\n\t\t{\n\t\t\tonEdit,\n\t\t\tonDelete,\n\t\t\tisReadOnly\n\t\t}: { onEdit: () => void; onDelete: (e: any) => void; isReadOnly: boolean }\n\t) {\n\t\tif (isReadOnly) return;\n\t\tlet startX = 0;\n\t\tlet x = 0;\n\t\tlet swiping = false;\n\n\t\tfunction handleTouchStart(e: TouchEvent) {\n\t\t\tconst touch = e.touches?.[0];\n\t\t\tif (!touch) return;\n\t\t\tstartX = touch.clientX;\n\t\t\tx = 0;\n\t\t\tnode.style.transition = 'none';\n\t\t}\n\n\t\tfunction handleTouchMove(e: TouchEvent) {\n\t\t\tconst touch = e.touches?.[0];\n\t\t\tif (!touch) return;\n\t\t\tconst dx = touch.clientX - startX;\n\t\t\tswiping = true;\n\t\t\tif (dx < -120) x = -120;\n\t\t\telse if (dx > 120) x = 120;\n\t\t\telse x = dx;\n\t\t\tnode.style.transform = `translateX(${x}px)`;\n\t\t\tif (Math.abs(x) > 10) e.preventDefault();\n\t\t}\n\n\t\tfunction handleTouchEnd() {\n\t\t\tif (!swiping) return;\n\t\t\tswiping = false;\n\t\t\tnode.style.transition = 'transform 0.2s ease-out';\n\t\t\tif (x < -80) onDelete({ stopPropagation: () => {} });\n\t\t\telse if (x > 80) onEdit();\n\t\t\tnode.style.transform = 'translateX(0)';\n\t\t}\n\n\t\tnode.addEventListener('touchstart', handleTouchStart, { passive: false });\n\t\tnode.addEventListener('touchmove', handleTouchMove, { passive: false });\n\t\tnode.addEventListener('touchend', handleTouchEnd);\n\t\treturn {\n\t\t\tdestroy() {\n\t\t\t\tnode.removeEventListener('touchstart', handleTouchStart);\n\t\t\t\tnode.removeEventListener('touchmove', handleTouchMove);\n\t\t\t\tnode.removeEventListener('touchend', handleTouchEnd);\n\t\t\t}\n\t\t};\n\t}\n</script>\n\n<svelte:head>\n\t<title>Mileage - Go Route Yourself</title>\n</svelte:head>\n\n<div class=\"page-container\">\n\t<div class=\"page-header\">\n\t\t<div class=\"header-text\">\n\t\t\t<h1 class=\"page-title\">Mileage</h1>\n\t\t\t<p class=\"page-subtitle\">Log odometer readings and miles</p>\n\t\t</div>\n\n\t\t<div class=\"header-actions\">\n\t\t\t<button\n\t\t\t\tclass=\"btn-secondary\"\n\t\t\t\ton:click={() => goto('/dashboard/trash?type=mileage')}\n\t\t\t\taria-label=\"View Trash\"\n\t\t\t>\n\t\t\t\t<svg\n\t\t\t\t\twidth=\"20\"\n\t\t\t\t\theight=\"20\"\n\t\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\t\tfill=\"none\"\n\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\t\tstroke-linejoin=\"round\"\n\t\t\t\t>\n\t\t\t\t\t<polyline points=\"3 6 5 6 21 6\"></polyline>\n\t\t\t\t\t<path d=\"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2\"\n\t\t\t\t\t></path>\n\t\t\t\t</svg>\n\t\t\t</button>\n\t\t\t<button\n\t\t\t\tclass=\"btn-secondary\"\n\t\t\t\ton:click={() => (isMileageSettingsOpen = true)}\n\t\t\t\taria-label=\"Mileage Settings\"\n\t\t\t>\n\t\t\t\t<svg\n\t\t\t\t\twidth=\"20\"\n\t\t\t\t\theight=\"20\"\n\t\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\t\tfill=\"none\"\n\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\t\tstroke-linejoin=\"round\"\n\t\t\t\t>\n\t\t\t\t\t<path\n\t\t\t\t\t\td=\"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.09a2 2 0 0 1-1-1.74v-.47a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.39a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z\"\n\t\t\t\t\t></path>\n\t\t\t\t\t<circle cx=\"12\" cy=\"12\" r=\"3\"></circle>\n\t\t\t\t</svg>\n\t\t\t</button>\n\t\t\t<SettingsModal bind:open={isMileageSettingsOpen} />\n\n\t\t\t<button class=\"btn-primary\" on:click={goToAdd}>\n\t\t\t\t<svg width=\"20\" height=\"20\" viewBox=\"0 0 20 20\" fill=\"none\">\n\t\t\t\t\t<path\n\t\t\t\t\t\td=\"M10 4V16M4 10H16\"\n\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\t\t\tstroke-linejoin=\"round\"\n\t\t\t\t\t/>\n\t\t\t\t</svg>\n\t\t\t\tNew Mileage\n\t\t\t</button>\n\t\t</div>\n\t</div>\n\n\t<div class=\"stats-summary\">\n\t\t<div class=\"summary-card\">\n\t\t\t<div class=\"summary-label\">Total</div>\n\t\t\t<div class=\"summary-value\">{filteredExpenses.length}</div>\n\t\t</div>\n\n\t\t<div class=\"summary-card\">\n\t\t\t<div class=\"summary-label\">Total Miles</div>\n\t\t\t<div class=\"summary-value\">{totalMiles.toFixed(2)}</div>\n\t\t</div>\n\n\t\t<div class=\"summary-card\">\n\t\t\t<div class=\"summary-label\">Mileage Deduction</div>\n\t\t\t<div class=\"summary-value\">{formatCurrency(totalMileageDeduction)}</div>\n\t\t</div>\n\n\t\t{#if categories[0]}\n\t\t\t<div class=\"summary-card hidden-mobile\">\n\t\t\t\t<div class=\"summary-label\">{getCategoryLabel(categories[0])}</div>\n\t\t\t\t<div class=\"summary-value\">\n\t\t\t\t\t{formatCurrency(\n\t\t\t\t\t\tfilteredExpenses\n\t\t\t\t\t\t\t.filter((e) => e.category === categories[0])\n\t\t\t\t\t\t\t.reduce((s, e) => s + e.amount, 0)\n\t\t\t\t\t)}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t{/if}\n\t\t{#if categories[1]}\n\t\t\t<div class=\"summary-card hidden-mobile\">\n\t\t\t\t<div class=\"summary-label\">{getCategoryLabel(categories[1])}</div>\n\t\t\t\t<div class=\"summary-value\">\n\t\t\t\t\t{formatCurrency(\n\t\t\t\t\t\tfilteredExpenses\n\t\t\t\t\t\t\t.filter((e) => e.category === categories[1])\n\t\t\t\t\t\t\t.reduce((s, e) => s + e.amount, 0)\n\t\t\t\t\t)}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t{/if}\n\t</div>\n\n\t<div class=\"filters-bar\">\n\t\t<div class=\"search-box\">\n\t\t\t<svg class=\"search-icon\" width=\"20\" height=\"20\" viewBox=\"0 0 20 20\" fill=\"none\">\n\t\t\t\t<path\n\t\t\t\t\td=\"M9 17C13.4183 17 17 13.4183 17 9C17 4.58172 13.4183 1 9 1C4.58172 1 1 4.58172 1 9C1 13.4183 4.58172 17 9 17Z\"\n\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\t\tstroke-linejoin=\"round\"\n\t\t\t\t/>\n\t\t\t\t<path\n\t\t\t\t\td=\"M19 19L14.65 14.65\"\n\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\t\tstroke-linejoin=\"round\"\n\t\t\t\t/>\n\t\t\t</svg>\n\t\t\t<input\n\t\t\t\tid=\"search-expenses\"\n\t\t\t\tname=\"searchQuery\"\n\t\t\t\ttype=\"text\"\n\t\t\t\tplaceholder=\"Search mileage...\"\n\t\t\t\tbind:value={searchQuery}\n\t\t\t/>\n\t\t</div>\n\n\t\t<div class=\"filter-group date-group\">\n\t\t\t<input\n\t\t\t\tid=\"start-date\"\n\t\t\t\tname=\"startDate\"\n\t\t\t\ttype=\"date\"\n\t\t\t\tbind:value={startDate}\n\t\t\t\tclass=\"date-input\"\n\t\t\t\taria-label=\"Start Date\"\n\t\t\t/>\n\t\t\t<span class=\"date-sep\">-</span>\n\t\t\t<input\n\t\t\t\tid=\"end-date\"\n\t\t\t\tname=\"endDate\"\n\t\t\t\ttype=\"date\"\n\t\t\t\tbind:value={endDate}\n\t\t\t\tclass=\"date-input\"\n\t\t\t\taria-label=\"End Date\"\n\t\t\t/>\n\t\t</div>\n\n\t\t<div class=\"filter-group\">\n\t\t\t<select\n\t\t\t\tid=\"filter-category\"\n\t\t\t\tname=\"filterCategory\"\n\t\t\t\tbind:value={filterCategory}\n\t\t\t\tclass=\"filter-select\"\n\t\t\t\taria-label=\"Filter by category\"\n\t\t\t>\n\t\t\t\t<option value=\"all\">All Categories</option>\n\t\t\t\t{#each categories as cat (cat)}\n\t\t\t\t\t<option value={cat}>{getCategoryLabel(cat)}</option>\n\t\t\t\t{/each}\n\t\t\t\t<option value=\"manual\">Manual Trips</option>\n\t\t\t\t<option value=\"auto\">Auto Trips</option>\n\t\t\t</select>\n\n\t\t\t<select\n\t\t\t\tid=\"sort-by\"\n\t\t\t\tname=\"sortBy\"\n\t\t\t\tbind:value={sortBy}\n\t\t\t\tclass=\"filter-select\"\n\t\t\t\taria-label=\"Sort results\"\n\t\t\t>\n\t\t\t\t<option value=\"date\">By Date</option>\n\t\t\t\t<option value=\"amount\">By Cost</option>\n\t\t\t</select>\n\n\t\t\t<button\n\t\t\t\tclass=\"sort-btn\"\n\t\t\t\taria-label=\"Toggle sort order\"\n\t\t\t\ton:click={() => (sortOrder = sortOrder === 'asc' ? 'desc' : 'asc')}\n\t\t\t>\n\t\t\t\t<svg\n\t\t\t\t\twidth=\"20\"\n\t\t\t\t\theight=\"20\"\n\t\t\t\t\tviewBox=\"0 0 20 20\"\n\t\t\t\t\tfill=\"none\"\n\t\t\t\t\tstyle=\"transform: rotate({sortOrder === 'asc' ? '180deg' : '0deg'})\"\n\t\t\t\t>\n\t\t\t\t\t<path\n\t\t\t\t\t\td=\"M10 3V17M10 17L4 11M10 17L16 11\"\n\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\t\t\tstroke-linejoin=\"round\"\n\t\t\t\t\t/>\n\t\t\t\t</svg>\n\t\t\t</button>\n\t\t</div>\n\t</div>\n\n\t{#if filteredExpenses.length > 0}\n\t\t<div class=\"batch-header\" class:visible={filteredExpenses.length > 0}>\n\t\t\t<label class=\"checkbox-container\">\n\t\t\t\t<input\n\t\t\t\t\tid=\"select-all\"\n\t\t\t\t\tname=\"selectAll\"\n\t\t\t\t\ttype=\"checkbox\"\n\t\t\t\t\tchecked={allSelected}\n\t\t\t\t\ton:change={toggleSelectAll}\n\t\t\t\t/>\n\t\t\t\t<span class=\"checkmark\"></span>\n\t\t\t\tSelect All ({filteredExpenses.length})\n\t\t\t</label>\n\n\t\t\t<span class=\"page-info\">Showing {visibleExpenses.length} of {filteredExpenses.length}</span>\n\t\t</div>\n\t{/if}\n\n\t{#if loading}\n\t\t<div class=\"expense-list-cards\">\n\t\t\t{#each Array(3) as _, i (i)}\n\t\t\t\t<div class=\"expense-card\">\n\t\t\t\t\t<div class=\"card-top\">\n\t\t\t\t\t\t<div style=\"flex: 1\">\n\t\t\t\t\t\t\t<Skeleton height=\"16px\" width=\"30%\" className=\"mb-2\" />\n\t\t\t\t\t\t\t<Skeleton height=\"20px\" width=\"60%\" />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<Skeleton height=\"24px\" width=\"60px\" />\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t{/each}\n\t\t</div>\n\t{:else if filteredExpenses.length > 0}\n\t\t<div class=\"expense-list-cards\">\n\t\t\t{#each visibleExpenses as expense (expense.id)}\n\t\t\t\t{@const isSelected = selectedExpenses.has(expense.id)}\n\t\t\t\t<div class=\"card-wrapper\">\n\t\t\t\t\t{#if !isTripSource(expense)}\n\t\t\t\t\t\t<div class=\"swipe-bg\">\n\t\t\t\t\t\t\t<div class=\"swipe-action edit\"><span>Edit</span></div>\n\t\t\t\t\t\t\t<div class=\"swipe-action delete\"><span>Trash</span></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t{/if}\n\n\t\t\t\t\t<div\n\t\t\t\t\t\tclass=\"expense-card\"\n\t\t\t\t\t\tclass:read-only={isTripSource(expense)}\n\t\t\t\t\t\tclass:selected={isSelected}\n\t\t\t\t\t\ton:click={() => editExpense(expense)}\n\t\t\t\t\t\trole=\"button\"\n\t\t\t\t\t\ttabindex=\"0\"\n\t\t\t\t\t\ton:keypress={(e) => e.key === 'Enter' && editExpense(expense)}\n\t\t\t\t\t\tuse:swipeable={{\n\t\t\t\t\t\t\tonEdit: () => editExpense(expense),\n\t\t\t\t\t\t\tonDelete: (e) => deleteExpense(expense.id, e),\n\t\t\t\t\t\t\tisReadOnly: isTripSource(expense)\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t<div class=\"card-top\">\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tclass=\"selection-box\"\n\t\t\t\t\t\t\t\ton:click|stopPropagation\n\t\t\t\t\t\t\t\ton:keydown|stopPropagation\n\t\t\t\t\t\t\t\trole=\"none\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<label class=\"checkbox-container\">\n\t\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\t\ttype=\"checkbox\"\n\t\t\t\t\t\t\t\t\t\tid={'expense-' + expense.id + '-checkbox'}\n\t\t\t\t\t\t\t\t\t\tname=\"selectedExpense\"\n\t\t\t\t\t\t\t\t\t\tvalue={expense.id}\n\t\t\t\t\t\t\t\t\t\taria-labelledby={'expense-' + expense.id + '-title'}\n\t\t\t\t\t\t\t\t\t\tchecked={isSelected}\n\t\t\t\t\t\t\t\t\t\ton:change={() => toggleSelection(expense.id)}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t<span class=\"checkmark\"></span>\n\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t<div class=\"expense-main-info\">\n\t\t\t\t\t\t\t\t<span class=\"expense-date-display\">\n\t\t\t\t\t\t\t\t\t{formatDate(expense.date || '')}\n\t\t\t\t\t\t\t\t</span>\n\n\t\t\t\t\t\t\t\t<h2 class=\"expense-desc-title\" id={'expense-' + expense.id + '-title'}>\n\t\t\t\t\t\t\t\t\t{expense.notes ||\n\t\t\t\t\t\t\t\t\t\texpense.description ||\n\t\t\t\t\t\t\t\t\t\t`${expense.startOdometer} ΓåÆ ${expense.endOdometer}`}\n\t\t\t\t\t\t\t\t</h2>\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t{#if typeof expense.reimbursement === 'number' && expense.reimbursement > 0}\n\t\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\t\tclass=\"expense-amount-display\"\n\t\t\t\t\t\t\t\t\taria-label={`Reimbursement: ${formatCurrency(expense.reimbursement)}`}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{formatCurrency(expense.reimbursement)}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t\t<svg class=\"nav-icon\" width=\"20\" height=\"20\" viewBox=\"0 0 20 20\" fill=\"none\">\n\t\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\t\td=\"M9 18L15 12L9 6\"\n\t\t\t\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\t\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\t\t\t\t\t\tstroke-linejoin=\"round\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class=\"card-stats\">\n\t\t\t\t\t\t\t<div class=\"stat-item\">\n\t\t\t\t\t\t\t\t<span class=\"stat-label\">Miles</span>\n\t\t\t\t\t\t\t\t<span class=\"stat-value\">{(expense.miles ?? 0).toFixed(2)}</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"stat-item\">\n\t\t\t\t\t\t\t\t<span class=\"stat-label\">Vehicle</span>\n\t\t\t\t\t\t\t\t<span class=\"stat-value\"\n\t\t\t\t\t\t\t\t\t>{getVehicleDisplayName(expense.vehicle, $userSettings?.vehicles)}</span\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"stat-item\">\n\t\t\t\t\t\t\t\t<span class=\"stat-label\">Rate</span>\n\t\t\t\t\t\t\t\t<span class=\"stat-value\"\n\t\t\t\t\t\t\t\t\t>{expense.mileageRate != null\n\t\t\t\t\t\t\t\t\t\t? `$${Number(expense.mileageRate).toFixed(3)}/mi`\n\t\t\t\t\t\t\t\t\t\t: '-'}</span\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"stat-item\">\n\t\t\t\t\t\t\t\t<span class=\"stat-label\">Odometer</span>\n\t\t\t\t\t\t\t\t<span class=\"stat-value\"\n\t\t\t\t\t\t\t\t\t>{expense.startOdometer ?? '-'} ΓåÆ {expense.endOdometer ?? '-'}</span\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t{/each}\n\t\t</div>\n\n\t\t{#if totalPages > 1}\n\t\t\t<div class=\"pagination-container\">\n\t\t\t\t<div class=\"pagination\">\n\t\t\t\t\t<button\n\t\t\t\t\t\tclass=\"pagination-btn\"\n\t\t\t\t\t\tdisabled={currentPage === 1}\n\t\t\t\t\t\ton:click={() => changePage(currentPage - 1)}>ΓåÉ Prev</button\n\t\t\t\t\t>\n\t\t\t\t\t<span class=\"page-status\">Page {currentPage} of {totalPages}</span>\n\t\t\t\t\t<button\n\t\t\t\t\t\tclass=\"pagination-btn\"\n\t\t\t\t\t\tdisabled={currentPage === totalPages}\n\t\t\t\t\t\ton:click={() => changePage(currentPage + 1)}>Next ΓåÆ</button\n\t\t\t\t\t>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t{/if}\n\t{:else}\n\t\t<div class=\"empty-state\">\n\t\t\t<p>No mileage logs found matching your filters.</p>\n\t\t</div>\n\t{/if}\n</div>\n\n{#if selectedExpenses.size > 0}\n\t<div class=\"action-bar-container\" data-has-selections=\"true\">\n\t\t<div class=\"action-bar\">\n\t\t\t<div class=\"action-bar-left\">\n\t\t\t\t<div class=\"selection-indicator\">\n\t\t\t\t\t<svg\n\t\t\t\t\t\twidth=\"20\"\n\t\t\t\t\t\theight=\"20\"\n\t\t\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\t\t\tfill=\"none\"\n\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<polyline points=\"20 6 9 17 4 12\"></polyline>\n\t\t\t\t\t</svg>\n\t\t\t\t\t<span class=\"selected-count\"\n\t\t\t\t\t\t>{selectedExpenses.size}\n\t\t\t\t\t\t{selectedExpenses.size === 1 ? 'expense' : 'expenses'} selected</span\n\t\t\t\t\t>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div class=\"action-bar-right\">\n\t\t\t\t<button class=\"action-pill secondary\" on:click={() => (selectedExpenses = new SvelteSet())}>\n\t\t\t\t\t<svg\n\t\t\t\t\t\twidth=\"16\"\n\t\t\t\t\t\theight=\"16\"\n\t\t\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\t\t\tfill=\"none\"\n\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<line x1=\"18\" y1=\"6\" x2=\"6\" y2=\"18\"></line>\n\t\t\t\t\t\t<line x1=\"6\" y1=\"6\" x2=\"18\" y2=\"18\"></line>\n\t\t\t\t\t</svg>\n\t\t\t\t\t<span class=\"action-text\">Cancel</span>\n\t\t\t\t</button>\n\n\t\t\t\t<button class=\"action-pill export\" on:click={exportSelected}>\n\t\t\t\t\t<svg\n\t\t\t\t\t\twidth=\"16\"\n\t\t\t\t\t\theight=\"16\"\n\t\t\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\t\t\tfill=\"none\"\n\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<path d=\"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4\"></path>\n\t\t\t\t\t\t<polyline points=\"7 10 12 15 17 10\"></polyline>\n\t\t\t\t\t\t<line x1=\"12\" y1=\"15\" x2=\"12\" y2=\"3\"></line>\n\t\t\t\t\t</svg>\n\t\t\t\t\t<span class=\"action-text\">Export</span>\n\t\t\t\t</button>\n\n\t\t\t\t<button class=\"action-pill danger\" on:click={deleteSelected}>\n\t\t\t\t\t<svg\n\t\t\t\t\t\twidth=\"16\"\n\t\t\t\t\t\theight=\"16\"\n\t\t\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\t\t\tfill=\"none\"\n\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<polyline points=\"3 6 5 6 21 6\"></polyline>\n\t\t\t\t\t\t<path d=\"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2\"\n\t\t\t\t\t\t></path>\n\t\t\t\t\t</svg>\n\t\t\t\t\t<span class=\"action-text\">Delete</span>\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n{/if}\n\n<Modal bind:open={isManageCategoriesOpen} title=\"Manage Categories\">\n\t<div class=\"categories-manager\">\n\t\t<p class=\"text-sm text-gray-500 mb-4\">\n\t\t\tAdd or remove expense categories. These are saved to your settings.\n\t\t</p>\n\n\t\t<div class=\"cat-list\">\n\t\t\t{#each categories as cat (cat)}\n\t\t\t\t<div class=\"cat-item\">\n\t\t\t\t\t<span class={`cat-badge ${getCategoryColor(cat)}`}>{getCategoryLabel(cat)}</span>\n\t\t\t\t\t<button\n\t\t\t\t\t\tclass=\"cat-delete\"\n\t\t\t\t\t\ton:click={() => removeCategory(cat)}\n\t\t\t\t\t\taria-label=\"Delete Category\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\twidth=\"16\"\n\t\t\t\t\t\t\theight=\"16\"\n\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\t\t\t\tfill=\"none\"\n\t\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\t\t\t\tstroke-linejoin=\"round\"\n\t\t\t\t\t\t\t><line x1=\"18\" y1=\"6\" x2=\"6\" y2=\"18\"></line><line x1=\"6\" y1=\"6\" x2=\"18\" y2=\"18\"\n\t\t\t\t\t\t\t></line></svg\n\t\t\t\t\t\t>\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t{:else}\n\t\t\t\t<div class=\"text-sm text-gray-400 italic text-center py-4\">\n\t\t\t\t\tNo categories. Add one below.\n\t\t\t\t</div>\n\t\t\t{/each}\n\t\t</div>\n\n\t\t<div class=\"add-cat-form\">\n\t\t\t<input\n\t\t\t\ttype=\"text\"\n\t\t\t\tid=\"new-category-name\"\n\t\t\t\tname=\"newCategoryName\"\n\t\t\t\tclass=\"input-field\"\n\t\t\t\ton:keydown={(e) => e.key === 'Enter' && addCategory()}\n\t\t\t/>\n\t\t\t<button class=\"btn-secondary\" on:click={addCategory}>Add</button>\n\t\t</div>\n\n\t\t<div class=\"modal-actions mt-6\">\n\t\t\t<button class=\"btn-cancel w-full\" on:click={() => (isManageCategoriesOpen = false)}\n\t\t\t\t>Done</button\n\t\t\t>\n\t\t</div>\n\t</div>\n</Modal>\n\n<style>\n\t* {\n\t\tbox-sizing: border-box;\n\t}\n\n\t:global(body) {\n\t\toverflow-x: hidden;\n\t}\n\n\t.page-container {\n\t\tmax-width: 1400px;\n\t\tmargin: 0 auto;\n\t\tpadding: 16px;\n\t\tpadding-bottom: 80px;\n\t\toverflow-x: hidden;\n\t}\n\n\t/* Page Headers & Actions */\n\t.page-header {\n\t\tdisplay: flex;\n\t\tjustify-content: space-between;\n\t\talign-items: center;\n\t\tmargin-bottom: 24px;\n\t}\n\t.page-title {\n\t\tfont-size: 24px;\n\t\tfont-weight: 800;\n\t\tcolor: #111827;\n\t\tmargin: 0;\n\t}\n\t.page-subtitle {\n\t\tfont-size: 14px;\n\t\tcolor: #6b7280;\n\t\tmargin: 0;\n\t}\n\t.header-actions {\n\t\tdisplay: flex;\n\t\tgap: 8px;\n\t\talign-items: center;\n\t}\n\n\t.btn-primary {\n\t\tdisplay: inline-flex;\n\t\talign-items: center;\n\t\tgap: 6px;\n\t\tpadding: 10px 16px;\n\t\tbackground: linear-gradient(135deg, #ff7f50 0%, #ff6a3d 100%);\n\t\tcolor: white;\n\t\tborder: none;\n\t\tborder-radius: 8px;\n\t\tfont-weight: 600;\n\t\tfont-size: 14px;\n\t\tcursor: pointer;\n\t\tbox-shadow: 0 2px 8px rgba(255, 127, 80, 0.3);\n\t\ttransition: transform 0.1s;\n\t\ttext-decoration: none;\n\t}\n\t.btn-primary:active {\n\t\ttransform: translateY(1px);\n\t}\n\n\t.btn-secondary {\n\t\tdisplay: inline-flex;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t\tpadding: 10px;\n\t\tbackground: white;\n\t\tborder: 1px solid #e5e7eb;\n\t\tcolor: #374151;\n\t\tborder-radius: 8px;\n\t\tfont-weight: 600;\n\t\tfont-size: 14px;\n\t\tcursor: pointer;\n\t\ttransition: background 0.2s;\n\t}\n\n\t@media (hover: hover) {\n\t\t.btn-secondary:hover {\n\t\t\tbackground: #f9fafb;\n\t\t}\n\t\t.cat-delete:hover {\n\t\t\tbackground: #ef4444;\n\t\t\tcolor: white;\n\t\t}\n\t}\n\n\t/* Stats Summary */\n\t.stats-summary {\n\t\tdisplay: grid;\n\t\tgrid-template-columns: repeat(2, 1fr);\n\t\tgap: 12px;\n\t\tmargin-bottom: 24px;\n\t}\n\t.summary-card {\n\t\tbackground: white;\n\t\tborder: 1px solid #e5e7eb;\n\t\tborder-radius: 12px;\n\t\tpadding: 16px;\n\t\ttext-align: center;\n\t}\n\t.summary-label {\n\t\tfont-size: 12px;\n\t\tcolor: #6b7280;\n\t\ttext-transform: uppercase;\n\t\tletter-spacing: 0.5px;\n\t\tmargin-bottom: 4px;\n\t}\n\t.summary-value {\n\t\tfont-size: 20px;\n\t\tfont-weight: 800;\n\t\tcolor: #111827;\n\t}\n\n\t/* Filter Bar */\n\t.filters-bar {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tgap: 12px;\n\t\tmargin-bottom: 20px;\n\t}\n\n\t.search-box {\n\t\tposition: relative;\n\t\twidth: 100%;\n\t}\n\t.search-icon {\n\t\tposition: absolute;\n\t\tleft: 14px;\n\t\ttop: 50%;\n\t\ttransform: translateY(-50%);\n\t\tcolor: #9ca3af;\n\t\tpointer-events: none;\n\t}\n\t.search-box input {\n\t\twidth: 100%;\n\t\tpadding: 12px 16px 12px 42px;\n\t\tborder: 1px solid #e5e7eb;\n\t\tborder-radius: 10px;\n\t\tfont-size: 15px;\n\t\tbackground: white;\n\t\tbox-sizing: border-box;\n\t}\n\t.date-group {\n\t\tdisplay: flex;\n\t\tgap: 8px;\n\t\talign-items: center;\n\t}\n\t.date-input {\n\t\tflex: 1;\n\t\tpadding: 12px;\n\t\tborder: 1px solid #e5e7eb;\n\t\tborder-radius: 10px;\n\t\tfont-size: 14px;\n\t\tbackground: white;\n\t\tmin-width: 0;\n\t}\n\t.date-sep {\n\t\tcolor: #9ca3af;\n\t\tfont-weight: bold;\n\t}\n\t.filter-group {\n\t\tdisplay: flex;\n\t\tflex-direction: row;\n\t\tgap: 8px;\n\t\twidth: 100%;\n\t}\n\t.filter-select {\n\t\tflex: 1;\n\t\tmin-width: 0;\n\t\tpadding: 12px;\n\t\tborder: 1px solid #e5e7eb;\n\t\tborder-radius: 10px;\n\t\tfont-size: 14px;\n\t\tbackground: white;\n\t\tcolor: #374151;\n\t}\n\t.sort-btn {\n\t\tflex: 0 0 48px;\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t\tborder: 1px solid #e5e7eb;\n\t\tborder-radius: 10px;\n\t\tbackground: white;\n\t\tcolor: #6b7280;\n\t\tcursor: pointer;\n\t}\n\n\t/* Batch Header */\n\t.batch-header {\n\t\tdisplay: flex;\n\t\tjustify-content: space-between;\n\t\talign-items: center;\n\t\tmargin-bottom: 12px;\n\t\tpadding: 0 4px;\n\t\tcolor: #6b7280;\n\t\tfont-size: 13px;\n\t\tfont-weight: 500;\n\t}\n\t.page-info {\n\t\tfont-size: 13px;\n\t}\n\n\t/* CHECKBOX STYLES */\n\t.checkbox-container {\n\t\tdisplay: inline-flex;\n\t\talign-items: center;\n\t\tgap: 8px;\n\t\tcursor: pointer;\n\t\tfont-size: 14px;\n\t\tfont-weight: 600;\n\t\tcolor: #4b5563;\n\t\tposition: relative;\n\t\tpadding-left: 28px;\n\t\tuser-select: none;\n\t}\n\t.checkbox-container input {\n\t\tposition: absolute;\n\t\topacity: 0;\n\t\tcursor: pointer;\n\t\theight: 0;\n\t\twidth: 0;\n\t}\n\t.checkmark {\n\t\tposition: absolute;\n\t\ttop: 0;\n\t\tleft: 0;\n\t\theight: 20px;\n\t\twidth: 20px;\n\t\tbackground-color: white;\n\t\tborder: 2px solid #d1d5db;\n\t\tborder-radius: 6px;\n\t\ttransition: all 0.2s;\n\t}\n\n\t@media (hover: hover) {\n\t\t.checkbox-container:hover input ~ .checkmark {\n\t\t\tborder-color: #9ca3af;\n\t\t}\n\t}\n\n\t.checkbox-container input:checked ~ .checkmark {\n\t\tbackground-color: #ff7f50;\n\t\tborder-color: #ff7f50;\n\t}\n\t.checkmark:after {\n\t\tcontent: '';\n\t\tposition: absolute;\n\t\tdisplay: none;\n\t}\n\t.checkbox-container input:checked ~ .checkmark:after {\n\t\tdisplay: block;\n\t}\n\t.checkbox-container .checkmark:after {\n\t\tleft: 6px;\n\t\ttop: 2px;\n\t\twidth: 5px;\n\t\theight: 10px;\n\t\tborder: solid white;\n\t\tborder-width: 0 2px 2px 0;\n\t\ttransform: rotate(45deg);\n\t}\n\n\t/* Expense List & Cards (Styled like Trips) */\n\t.expense-list-cards {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tgap: 12px;\n\t\tmax-width: 100%;\n\t}\n\t.card-wrapper {\n\t\tposition: relative;\n\t\toverflow: hidden;\n\t\tborder-radius: 12px;\n\t\tbackground: #f3f4f6;\n\t\tmax-width: 100%;\n\t}\n\n\t.swipe-bg {\n\t\tposition: absolute;\n\t\tinset: 0;\n\t\tdisplay: flex;\n\t\tjustify-content: space-between;\n\t\talign-items: center;\n\t\tpadding: 0 20px;\n\t\tz-index: 0;\n\t}\n\t.swipe-action {\n\t\tfont-weight: 700;\n\t\tfont-size: 14px;\n\t\ttext-transform: uppercase;\n\t\tletter-spacing: 1px;\n\t}\n\t.swipe-action.edit {\n\t\tcolor: #2563eb;\n\t}\n\t.swipe-action.delete {\n\t\tcolor: #dc2626;\n\t}\n\n\t.expense-card {\n\t\tbackground: white;\n\t\tborder: 1px solid #e5e7eb;\n\t\tborder-radius: 12px;\n\t\tpadding: 16px;\n\t\tposition: relative;\n\t\tz-index: 1;\n\t\tcursor: pointer;\n\t\ttransition: all 0.2s;\n\t\tmax-width: 100%;\n\t}\n\t.expense-card:active {\n\t\tbackground-color: #f9fafb;\n\t}\n\t.expense-card.read-only {\n\t\tborder-left: 4px solid #3b82f6;\n\t\tbackground: #fafafa;\n\t}\n\t.expense-card.selected {\n\t\tbackground-color: #fff7ed;\n\t\tborder-color: #ff7f50;\n\t}\n\n\t.card-top {\n\t\tdisplay: grid;\n\t\tgrid-template-columns: auto 1fr auto auto;\n\t\talign-items: center;\n\t\tgap: 12px;\n\t\tpadding-bottom: 12px;\n\t\tmargin-bottom: 12px;\n\t\tborder-bottom: 1px solid #f3f4f6;\n\t\tmax-width: 100%;\n\t}\n\n\t.selection-box {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t\tpadding-right: 4px;\n\t}\n\n\t.expense-main-info {\n\t\toverflow: hidden;\n\t\tmin-width: 0;\n\t}\n\t.expense-date-display {\n\t\tdisplay: block;\n\t\tfont-size: 12px;\n\t\tfont-weight: 600;\n\t\tcolor: #6b7280;\n\t\tmargin-bottom: 4px;\n\t}\n\t.expense-desc-title {\n\t\tfont-size: 16px;\n\t\tfont-weight: 700;\n\t\tcolor: #111827;\n\t\tmargin: 0;\n\t\twhite-space: nowrap;\n\t\toverflow: hidden;\n\t\ttext-overflow: ellipsis;\n\t}\n\n\t.expense-amount-display {\n\t\tfont-size: 18px;\n\t\tfont-weight: 800;\n\t\tcolor: #111827;\n\t\twhite-space: nowrap;\n\t\ttext-align: right;\n\t\tmin-width: 72px;\n\t}\n\n\t.nav-icon {\n\t\tcolor: #9ca3af;\n\t\tflex-shrink: 0;\n\t}\n\n\t.card-stats {\n\t\tdisplay: grid;\n\t\tgrid-template-columns: repeat(2, 1fr);\n\t\tgap: 12px;\n\t}\n\t.stat-item {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\talign-items: center;\n\t}\n\t.stat-label {\n\t\tfont-size: 11px;\n\t\tcolor: #9ca3af;\n\t\ttext-transform: uppercase;\n\t}\n\t.stat-value {\n\t\tfont-size: 14px;\n\t\tfont-weight: 600;\n\t\tcolor: #4b5563;\n\t}\n\n\t.stat-badge-container {\n\t\tdisplay: flex;\n\t\tgap: 8px;\n\t\tflex-wrap: wrap;\n\t}\n\n\t.category-badge {\n\t\tfont-size: 12px;\n\t\tfont-weight: 600;\n\t\tpadding: 4px 10px;\n\t\tborder-radius: 100px;\n\t\ttext-transform: capitalize;\n\t\tborder: 1px solid;\n\t\tdisplay: inline-flex;\n\t\talign-items: center;\n\t\twhite-space: nowrap;\n\t}\n\n\t.source-badge {\n\t\tfont-size: 11px;\n\t\tfont-weight: 700;\n\t\tcolor: #3b82f6;\n\t\tbackground: #eff6ff;\n\t\tpadding: 4px 8px;\n\t\tborder-radius: 6px;\n\t\ttext-transform: uppercase;\n\t\tletter-spacing: 0.5px;\n\t\twhite-space: nowrap;\n\t}\n\n\t/* Tax pill that visually matches category badges */\n\t.tax-pill {\n\t\tfont-size: 12px;\n\t\tfont-weight: 600;\n\t\tcolor: #166534;\n\t\tbackground: #ecfdf5;\n\t\tpadding: 4px 10px;\n\t\tborder-radius: 100px;\n\t\tborder: 1px solid #bbf7d0;\n\t\ttext-transform: capitalize;\n\t\twhite-space: nowrap;\n\t}\n\n\t.empty-state {\n\t\ttext-align: center;\n\t\tpadding: 40px;\n\t\tcolor: #6b7280;\n\t\tfont-size: 15px;\n\t}\n\n\t/* Hide footer when selections are active - using body class */\n\t:global(body.has-selections .mobile-footer),\n\t:global(body.has-selections footer),\n\t:global(body.has-selections nav[class*='mobile']),\n\t:global(body.has-selections .bottom-nav) {\n\t\tdisplay: none !important;\n\t}\n\n\t/* ACTION BAR STYLES - REPLACES FOOTER ON MOBILE */\n\t.action-bar-container {\n\t\tposition: fixed;\n\t\tbottom: 0;\n\t\tleft: 0;\n\t\tright: 0;\n\t\tdisplay: flex;\n\t\tjustify-content: center;\n\t\tz-index: 1000;\n\t\tpadding: 0;\n\t\tanimation: slideUpFade 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n\t\tpointer-events: none;\n\t}\n\n\t.action-bar {\n\t\tbackground: white;\n\t\tpadding: 12px 16px;\n\t\tborder-radius: 0;\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tgap: 8px;\n\t\tbox-shadow: 0 -2px 10px rgba(0, 0, 0, 0.1);\n\t\tmax-width: 100%;\n\t\twidth: 100%;\n\t\tpointer-events: auto;\n\t\tborder-top: 1px solid #e5e7eb;\n\t}\n\n\t.action-bar-left {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t}\n\n\t.selection-indicator {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tgap: 6px;\n\t\tcolor: #ff7f50;\n\t\tfont-weight: 700;\n\t\tfont-size: 13px;\n\t\tpadding: 6px 12px;\n\t\tbackground: linear-gradient(135deg, #fff7ed 0%, #ffedd5 100%);\n\t\tborder-radius: 10px;\n\t\tborder: 1px solid #fed7aa;\n\t}\n\n\t.selection-indicator svg {\n\t\tflex-shrink: 0;\n\t\twidth: 16px;\n\t\theight: 16px;\n\t}\n\n\t.selected-count {\n\t\tcolor: #c2410c;\n\t\twhite-space: nowrap;\n\t}\n\n\t.action-bar-right {\n\t\tdisplay: flex;\n\t\tgap: 6px;\n\t\tjustify-content: center;\n\t}\n\n\t.action-pill {\n\t\tborder: 2px solid transparent;\n\t\tpadding: 10px 12px;\n\t\tborder-radius: 10px;\n\t\tfont-size: 13px;\n\t\tfont-weight: 700;\n\t\tcursor: pointer;\n\t\tdisplay: inline-flex;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t\tgap: 6px;\n\t\ttransition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);\n\t\tfont-family: inherit;\n\t\twhite-space: nowrap;\n\t\tflex: 1;\n\t\tmin-width: 0;\n\t\tbox-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);\n\t}\n\n\t.action-pill svg {\n\t\tflex-shrink: 0;\n\t\twidth: 16px;\n\t\theight: 16px;\n\t}\n\n\t/* Hide text on very small screens */\n\t.action-text {\n\t\tdisplay: none;\n\t}\n\n\t.action-pill.secondary {\n\t\tbackground: white;\n\t\tcolor: #6b7280;\n\t\tborder-color: #e5e7eb;\n\t}\n\n\t.action-pill.export {\n\t\tbackground: linear-gradient(135deg, #fff7ed 0%, #ffedd5 100%);\n\t\tcolor: #c2410c;\n\t\tborder-color: #fed7aa;\n\t}\n\n\t.action-pill.danger {\n\t\tbackground: linear-gradient(135deg, #fee2e2 0%, #fecaca 100%);\n\t\tcolor: #dc2626;\n\t\tborder-color: #fca5a5;\n\t}\n\n\t.action-pill:active {\n\t\ttransform: scale(0.95);\n\t}\n\n\t@media (hover: hover) {\n\t\t.action-pill.secondary:hover {\n\t\t\tbackground: #f9fafb;\n\t\t\tborder-color: #d1d5db;\n\t\t\tbox-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\n\t\t}\n\n\t\t.action-pill.export:hover {\n\t\t\tbackground: linear-gradient(135deg, #ffedd5 0%, #fed7aa 100%);\n\t\t\tborder-color: #fdba74;\n\t\t\tbox-shadow: 0 2px 4px rgba(251, 146, 60, 0.15);\n\t\t}\n\n\t\t.action-pill.danger:hover {\n\t\t\tbackground: linear-gradient(135deg, #fecaca 0%, #fca5a5 100%);\n\t\t\tborder-color: #f87171;\n\t\t\tbox-shadow: 0 2px 4px rgba(220, 38, 38, 0.15);\n\t\t}\n\t}\n\n\t@keyframes slideUpFade {\n\t\tfrom {\n\t\t\ttransform: translateY(100%);\n\t\t\topacity: 0;\n\t\t}\n\t\tto {\n\t\t\ttransform: translateY(0);\n\t\t\topacity: 1;\n\t\t}\n\t}\n\n\t/* Show text on slightly larger mobile screens */\n\t@media (min-width: 380px) {\n\t\t.action-text {\n\t\t\tdisplay: inline;\n\t\t}\n\n\t\t.action-pill {\n\t\t\tpadding: 10px 14px;\n\t\t}\n\t}\n\n\t@media (min-width: 640px) {\n\t\t.action-bar-container {\n\t\t\tbottom: 30px;\n\t\t\tpadding: 0 16px;\n\t\t}\n\n\t\t.action-bar {\n\t\t\tflex-direction: row;\n\t\t\talign-items: center;\n\t\t\tjustify-content: space-between;\n\t\t\tpadding: 14px 20px;\n\t\t\tmax-width: 700px;\n\t\t\twidth: auto; /* CHANGED: from inheriting 100% to auto */\n\t\t\tgap: 16px;\n\t\t\tborder-radius: 16px;\n\t\t\tborder: 1px solid #e5e7eb;\n\t\t\tbox-shadow:\n\t\t\t\t0 0 0 1px rgba(0, 0, 0, 0.05),\n\t\t\t\t0 10px 25px -5px rgba(0, 0, 0, 0.1),\n\t\t\t\t0 8px 10px -6px rgba(0, 0, 0, 0.1);\n\t\t}\n\n\t\t.action-bar-left {\n\t\t\tjustify-content: flex-start;\n\t\t}\n\n\t\t.selection-indicator {\n\t\t\tfont-size: 14px;\n\t\t\tpadding: 8px 14px;\n\t\t}\n\n\t\t.action-bar-right {\n\t\t\tgap: 8px;\n\t\t}\n\n\t\t.action-pill {\n\t\t\tflex: 0 0 auto;\n\t\t\tmin-width: auto;\n\t\t\tpadding: 10px 18px;\n\t\t\tfont-size: 14px;\n\t\t}\n\n\t\t.action-text {\n\t\t\tdisplay: inline;\n\t\t}\n\t}\n\n\t/* Desktop */\n\t@media (min-width: 1024px) {\n\t\t.action-bar {\n\t\t\tmax-width: 800px;\n\t\t\tpadding: 16px 24px;\n\t\t}\n\n\t\t.selection-indicator {\n\t\t\tfont-size: 15px;\n\t\t\tpadding: 8px 16px;\n\t\t}\n\n\t\t.action-pill {\n\t\t\tpadding: 12px 24px;\n\t\t\tfont-size: 15px;\n\t\t}\n\t}\n\n\t/* Categories Manager Modal Styles */\n\t.categories-manager {\n\t\tpadding: 4px;\n\t}\n\t.cat-list {\n\t\tdisplay: flex;\n\t\tflex-wrap: wrap;\n\t\tgap: 8px;\n\t\tmargin-bottom: 20px;\n\t\tmax-height: 200px;\n\t\toverflow-y: auto;\n\t}\n\t.cat-item {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tgap: 4px;\n\t\tbackground: #f3f4f6;\n\t\tpadding: 4px 4px 4px 10px;\n\t\tborder-radius: 20px;\n\t\tborder: 1px solid #e5e7eb;\n\t}\n\t.cat-badge {\n\t\tfont-size: 13px;\n\t\tfont-weight: 500;\n\t\ttext-transform: capitalize;\n\t\tpadding: 0 4px;\n\t\tborder: none;\n\t\tbackground: transparent;\n\t}\n\t.cat-delete {\n\t\tborder: none;\n\t\tbackground: #e5e7eb;\n\t\tcolor: #6b7280;\n\t\tborder-radius: 50%;\n\t\twidth: 24px;\n\t\theight: 24px;\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t\tcursor: pointer;\n\t\ttransition: all 0.2s;\n\t}\n\n\t.add-cat-form {\n\t\tdisplay: flex;\n\t\tgap: 8px;\n\t}\n\t.add-cat-form .input-field {\n\t\tflex: 1;\n\t\tpadding: 10px;\n\t\tborder: 1px solid #e5e7eb;\n\t\tborder-radius: 8px;\n\t}\n\t.add-cat-form .btn-secondary {\n\t\tpadding: 10px 16px;\n\t}\n\t.modal-actions .btn-cancel {\n\t\tbackground: white;\n\t\tborder: 1px solid #e5e7eb;\n\t\tcolor: #374151;\n\t\tpadding: 12px;\n\t\tborder-radius: 8px;\n\t\tfont-weight: 600;\n\t\tcursor: pointer;\n\t\twidth: 100%;\n\t}\n\n\t@media (min-width: 640px) {\n\t\t.filters-bar {\n\t\t\tflex-direction: row;\n\t\t\tjustify-content: space-between;\n\t\t\talign-items: center;\n\t\t}\n\t\t.search-box {\n\t\t\tmax-width: 300px;\n\t\t}\n\t\t.date-group {\n\t\t\twidth: auto;\n\t\t}\n\t\t.filter-group {\n\t\t\twidth: auto;\n\t\t\tflex-wrap: nowrap;\n\t\t}\n\t\t.filter-select {\n\t\t\twidth: 140px;\n\t\t\tflex: none;\n\t\t}\n\t\t.stats-summary {\n\t\t\tgrid-template-columns: repeat(4, 1fr);\n\t\t}\n\t\t.hidden-mobile {\n\t\t\tdisplay: block;\n\t\t}\n\t}\n\n\t@media (max-width: 640px) {\n\t\t.page-container {\n\t\t\tpadding-bottom: calc(env(safe-area-inset-bottom, 0px) + 1px);\n\t\t}\n\n\t\t.expense-list-cards,\n\t\t.mileage-list-cards {\n\t\t\tgap: 8px;\n\t\t}\n\n\t\t.pagination-controls,\n\t\t.pagination-container {\n\t\t\tmargin-top: 16px;\n\t\t}\n\n\t\t.empty-state {\n\t\t\tpadding: 24px 12px;\n\t\t}\n\n\t\t.hidden-mobile {\n\t\t\tdisplay: none;\n\t\t}\n\t}\n\n\t/* Pagination Controls */\n\t.pagination-container {\n\t\tmargin-top: 32px;\n\t\tdisplay: flex;\n\t\tjustify-content: center;\n\t}\n\n\t.pagination {\n\t\tdisplay: flex;\n\t\tjustify-content: center;\n\t\talign-items: center;\n\t\tgap: 16px;\n\t}\n\n\t.pagination-btn {\n\t\tpadding: 8px 16px;\n\t\tbackground: white;\n\t\tborder: 1px solid #e5e7eb;\n\t\tborder-radius: 8px;\n\t\tfont-weight: 600;\n\t\tfont-size: 14px;\n\t\tcolor: #374151;\n\t\tcursor: pointer;\n\t\ttransition: all 0.2s;\n\t\tfont-family: inherit;\n\t}\n\n\t.pagination-btn:hover:not(:disabled) {\n\t\tborder-color: var(--orange);\n\t\tcolor: var(--orange);\n\t}\n\n\t.pagination-btn:disabled {\n\t\topacity: 0.5;\n\t\tcursor: not-allowed;\n\t}\n\n\t.page-status {\n\t\tfont-size: 14px;\n\t\tcolor: #4b5563;\n\t\tfont-weight: 500;\n\t}\n</style>\n",
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\dashboard\\mileage\\components\\SettingsModal.svelte",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\dashboard\\mileage\\edit\\[id]\\+page.svelte",
		"messages": [
			{
				"ruleId": "svelte/no-navigation-without-resolve",
				"severity": 1,
				"message": "Unexpected goto() call without resolve().",
				"line": 64,
				"column": 9,
				"nodeType": null,
				"messageId": "gotoWithoutResolve",
				"endLine": 64,
				"endColumn": 29
			},
			{
				"ruleId": "svelte/no-navigation-without-resolve",
				"severity": 1,
				"message": "Unexpected goto() call without resolve().",
				"line": 120,
				"column": 9,
				"nodeType": null,
				"messageId": "gotoWithoutResolve",
				"endLine": 120,
				"endColumn": 29
			},
			{
				"ruleId": "svelte/no-navigation-without-resolve",
				"severity": 1,
				"message": "Unexpected href link without resolve().",
				"line": 134,
				"column": 12,
				"nodeType": null,
				"messageId": "linkWithoutResolve",
				"endLine": 134,
				"endColumn": 30
			},
			{
				"ruleId": "svelte/no-navigation-without-resolve",
				"severity": 1,
				"message": "Unexpected href link without resolve().",
				"line": 240,
				"column": 14,
				"nodeType": null,
				"messageId": "linkWithoutResolve",
				"endLine": 240,
				"endColumn": 32
			}
		],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 4,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"source": "<script lang=\"ts\">\n\timport { mileage } from '$lib/stores/mileage';\n\timport { user } from '$lib/stores/auth';\n\timport { userSettings } from '$lib/stores/userSettings';\n\timport { toasts } from '$lib/stores/toast';\n\timport { goto } from '$app/navigation';\n\timport { page } from '$app/stores';\n\timport SelectMobile from '$lib/components/ui/SelectMobile.svelte';\n\tconst expenseId = $page.params.id;\n\n\t// Settings modal removed for Mileage edit page\n\n\t// Category options are not applicable for Mileage edit\n\n\t// Category selection state removed for Mileage edit\n\n\t// Category sync removed for Mileage edit\n\n\t// Category helper functions removed for Mileage edit\n\n\tlet formData = {\n\t\tdate: '',\n\t\tstartOdometer: '',\n\t\tendOdometer: '',\n\t\tmiles: '',\n\t\tvehicle: '',\n\t\tmileageRate: '',\n\t\tnotes: '',\n\t\tcategory: ''\n\t};\n\n\t// Whether the user manually edited the miles input; when true we stop auto-updating miles from odometers\n\tlet milesManual = false;\n\n\t// default mileageRate from settings if editing and none present\n\t$: if ($userSettings && formData.mileageRate === '' && $userSettings.mileageRate != null) {\n\t\tformData.mileageRate = String($userSettings.mileageRate);\n\t}\n\n\t// Default vehicle selection if available and none selected\n\t$: if ($userSettings?.vehicles?.length > 0 && !formData.vehicle) {\n\t\tconst v0 = $userSettings.vehicles[0];\n\t\tformData.vehicle = v0?.id ?? v0?.name ?? '';\n\t}\n\n\t// Find and prefill mileage record when store or page params load\n\t$: {\n\t\tconst id = $page.params.id;\n\t\tconst rec = $mileage.find((e) => e.id === id);\n\t\tif (rec && !formData.date) {\n\t\t\tconst r: any = rec as any;\n\t\t\tformData = {\n\t\t\t\tdate: r.date || '',\n\t\t\t\tstartOdometer: String(r.startOdometer || ''),\n\t\t\t\tendOdometer: String(r.endOdometer || ''),\n\t\t\t\tmiles: typeof r.miles === 'number' ? String(r.miles) : '',\n\t\t\t\tvehicle: r.vehicle || '',\n\t\t\t\tmileageRate: typeof r.mileageRate === 'number' ? String(r.mileageRate) : '',\n\t\t\t\tnotes: r.notes || '',\n\t\t\t\tcategory: r.category || ''\n\t\t\t};\n\t\t} else if ($mileage && $mileage.length > 0 && !rec) {\n\t\t\ttoasts.error('Mileage log not found.');\n\t\t\tgoto('/dashboard/mileage');\n\t\t}\n\t}\n\n\t// Auto-calc miles from odometer readings unless the user has manually edited miles\n\t$: if (!milesManual) {\n\t\tif (formData.startOdometer !== '' && formData.endOdometer !== '') {\n\t\t\tconst s = Number(formData.startOdometer) || 0;\n\t\t\tconst e = Number(formData.endOdometer) || 0;\n\t\t\tformData.miles = Number(Math.max(0, e - s).toFixed(2)).toString();\n\t\t}\n\t}\n\n\tasync function saveExpense() {\n\t\tif (\n\t\t\tformData.startOdometer === '' || formData.endOdometer === ''\n\t\t\t\t? formData.miles !== ''\n\t\t\t\t: !formData.date\n\t\t) {\n\t\t\t// Ensure either start & end are present or miles is provided\n\t\t\tif (\n\t\t\t\t!formData.date ||\n\t\t\t\t((formData.startOdometer === '' || formData.endOdometer === '') && formData.miles === '')\n\t\t\t) {\n\t\t\t\ttoasts.error('Please fill in required fields (either start & end odometer or miles).');\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tconst currentUser = ($page.data as any)['user'] || $user;\n\t\tconst userId = (currentUser as any)?.id || localStorage.getItem('offline_user_id');\n\t\tif (!userId) {\n\t\t\ttoasts.error('User not identified. Cannot save.');\n\t\t\treturn;\n\t\t}\n\n\t\ttry {\n\t\t\tconst start = Number(formData.startOdometer) || 0;\n\t\t\tconst end = Number(formData.endOdometer) || 0;\n\t\t\tlet miles =\n\t\t\t\tformData.miles !== '' && !isNaN(Number(formData.miles))\n\t\t\t\t\t? Number(formData.miles)\n\t\t\t\t\t: Math.max(0, end - start);\n\t\t\tmiles = Number(miles.toFixed(2));\n\n\t\t\tconst payload = {\n\t\t\t\t...formData,\n\t\t\t\tstartOdometer: start,\n\t\t\t\tendOdometer: end,\n\t\t\t\tmiles,\n\t\t\t\tmileageRate: formData.mileageRate !== '' ? Number(formData.mileageRate) : undefined,\n\t\t\t\tvehicle: formData.vehicle || undefined\n\t\t\t};\n\n\t\t\tawait mileage.updateMileage(String(expenseId), payload as any, String(userId));\n\t\t\ttoasts.success('Mileage log updated');\n\t\t\tgoto('/dashboard/mileage');\n\t\t} catch (err) {\n\t\t\tconsole.error(err);\n\t\t\ttoasts.error('Failed to update mileage log');\n\t\t}\n\t}\n</script>\n\n<div class=\"expense-form-page\">\n\t<div class=\"page-header\">\n\t\t<div>\n\t\t\t<h1 class=\"page-title\">Edit Mileage Log</h1>\n\t\t\t<p class=\"page-subtitle\">Update odometer readings and miles</p>\n\t\t</div>\n\t\t<a href=\"/dashboard/mileage\" class=\"btn-back\">\n\t\t\t<svg width=\"24\" height=\"24\" viewBox=\"0 0 20 20\" fill=\"none\"\n\t\t\t\t><path\n\t\t\t\t\td=\"M12 4L6 10L12 16\"\n\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\t\tstroke-linejoin=\"round\"\n\t\t\t\t/></svg\n\t\t\t> Back\n\t\t</a>\n\t</div>\n\n\t<div class=\"form-card\">\n\t\t<div class=\"card-header\">\n\t\t\t<h2 class=\"card-title\">Mileage Details</h2>\n\t\t</div>\n\n\t\t<div class=\"form-grid\">\n\t\t\t<div class=\"form-group\">\n\t\t\t\t<label for=\"mileage-date\">Date</label>\n\t\t\t\t<input id=\"mileage-date\" type=\"date\" bind:value={formData.date} required />\n\t\t\t</div>\n\n\t\t\t<div class=\"form-row\">\n\t\t\t\t<!-- Maintenance, Supplies, and Expenses options removed for Mileage logs -->\n\t\t\t\t<div class=\"form-group grid-3\">\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<label for=\"start-odo\">Start Odometer</label>\n\t\t\t\t\t\t<input\n\t\t\t\t\t\t\tid=\"start-odo\"\n\t\t\t\t\t\t\ttype=\"number\"\n\t\t\t\t\t\t\tinputmode=\"decimal\"\n\t\t\t\t\t\t\tbind:value={formData.startOdometer}\n\t\t\t\t\t\t\tplaceholder=\"0\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<label for=\"end-odo\">End Odometer</label>\n\t\t\t\t\t\t<input\n\t\t\t\t\t\t\tid=\"end-odo\"\n\t\t\t\t\t\t\ttype=\"number\"\n\t\t\t\t\t\t\tinputmode=\"decimal\"\n\t\t\t\t\t\t\tbind:value={formData.endOdometer}\n\t\t\t\t\t\t\tplaceholder=\"0\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<label for=\"miles\">Miles</label>\n\t\t\t\t\t\t<input\n\t\t\t\t\t\t\tid=\"miles\"\n\t\t\t\t\t\t\ttype=\"number\"\n\t\t\t\t\t\t\tstep=\"0.01\"\n\t\t\t\t\t\t\tinputmode=\"decimal\"\n\t\t\t\t\t\t\tbind:value={formData.miles}\n\t\t\t\t\t\t\tplaceholder=\"0.0\"\n\t\t\t\t\t\t\ton:input={(e) => (milesManual = (e.target as HTMLInputElement).value !== '')}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div class=\"form-group\">\n\t\t\t\t<label for=\"notes\">Notes</label>\n\t\t\t\t<textarea\n\t\t\t\t\tid=\"notes\"\n\t\t\t\t\tname=\"notes\"\n\t\t\t\t\tbind:value={formData.notes}\n\t\t\t\t\trows=\"3\"\n\t\t\t\t\tplaceholder=\"e.g., Trip to client site\"\n\t\t\t\t></textarea>\n\n\t\t\t\t<!-- tax deductible removed -->\n\t\t\t</div>\n\n\t\t\t<!-- Settings modal removed for Mileage edit -->\n\n\t\t\t<div class=\"form-row vehicle-rate-row\">\n\t\t\t\t<div class=\"form-group\">\n\t\t\t\t\t<label for=\"vehicle-mobile\">Vehicle</label>\n\t\t\t\t\t<SelectMobile\n\t\t\t\t\t\tclassName=\"mobile-select\"\n\t\t\t\t\t\tid=\"vehicle-mobile\"\n\t\t\t\t\t\tplaceholder={$userSettings.vehicles && $userSettings.vehicles.length > 0\n\t\t\t\t\t\t\t? 'Select vehicle'\n\t\t\t\t\t\t\t: 'No vehicles (open Mileage Settings)'}\n\t\t\t\t\t\toptions={$userSettings.vehicles\n\t\t\t\t\t\t\t? $userSettings.vehicles.map((v) => ({ value: v.id || v.name, label: v.name }))\n\t\t\t\t\t\t\t: [{ value: '', label: 'No vehicles (open Mileage Settings)' }]}\n\t\t\t\t\t\tbind:value={formData.vehicle}\n\t\t\t\t\t\tonchange={(e) => (formData.vehicle = e.value)}\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"form-group\">\n\t\t\t\t\t<label for=\"mileage-rate\">Mileage Rate (per mile)</label>\n\t\t\t\t\t<input\n\t\t\t\t\t\tid=\"mileage-rate\"\n\t\t\t\t\t\ttype=\"number\"\n\t\t\t\t\t\tstep=\"0.001\"\n\t\t\t\t\t\tbind:value={formData.mileageRate}\n\t\t\t\t\t\tplaceholder=\"0.655\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div class=\"form-actions\">\n\t\t\t\t<a href=\"/dashboard/mileage\" class=\"btn-secondary\">Cancel</a>\n\t\t\t\t<button class=\"btn-primary\" on:click={saveExpense}>Save Log</button>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>\n\n<style>\n\t/* MATCHING STYLES FROM TRIPS/NEW */\n\t.expense-form-page {\n\t\tmax-width: 800px;\n\t\tmargin: 0 auto;\n\t\tpadding: 4px;\n\t\tpadding-bottom: 90px;\n\t}\n\n\t@media (max-width: 640px) {\n\t\t.expense-form-page {\n\t\t\tpadding-bottom: calc(env(safe-area-inset-bottom, 0px) + 1px);\n\t\t}\n\t}\n\n\t.page-header {\n\t\tdisplay: flex;\n\t\tjustify-content: space-between;\n\t\talign-items: center;\n\t\tmargin-bottom: 26px;\n\t\tpadding: 0 8px;\n\t}\n\t.page-title {\n\t\tfont-size: 28px;\n\t\tfont-weight: 800;\n\t\tcolor: #111827;\n\t\tmargin: 0;\n\t}\n\t.page-subtitle {\n\t\tfont-size: 14px;\n\t\tcolor: #6b7280;\n\t\tdisplay: none;\n\t\tmargin: 0;\n\t}\n\n\t.btn-back {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tgap: 8px;\n\t\tfont-weight: 600;\n\t\tcolor: #6b7280;\n\t\ttext-decoration: none;\n\t\tfont-size: 14px;\n\t}\n\n\t.form-card {\n\t\tbackground: white;\n\t\tborder: 1px solid #e5e7eb;\n\t\tborder-radius: 18px;\n\t\tpadding: 16px;\n\t\tbox-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);\n\t}\n\t.card-header {\n\t\tmargin-bottom: 26px;\n\t}\n\t.card-title {\n\t\tfont-size: 22px;\n\t\tfont-weight: 700;\n\t\tcolor: #111827;\n\t\tmargin: 0;\n\t}\n\n\t.form-grid {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tgap: 24px;\n\t}\n\t.form-row {\n\t\tdisplay: grid;\n\t\tgrid-template-columns: 1fr 1fr;\n\t\tgap: 20px;\n\t}\n\t/* Make the start/end/miles group span the full width (match Date input) */\n\t.form-row .grid-3 {\n\t\tgrid-column: 1 / -1;\n\t\tdisplay: grid;\n\t\tgrid-template-columns: repeat(3, 1fr);\n\t\tgap: 16px;\n\t}\n\t@media (max-width: 767px) {\n\t\t.form-row .grid-3 {\n\t\t\tgrid-template-columns: 1fr;\n\t\t}\n\t}\n\t.form-group {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tgap: 8px;\n\t}\n\n\tlabel {\n\t\tfont-size: 16px;\n\t\tfont-weight: 600;\n\t\tcolor: #374151;\n\t}\n\n\tinput,\n\ttextarea {\n\t\twidth: 100%;\n\t\tpadding: 16px;\n\t\tborder: 1px solid #e5e7eb;\n\t\tborder-radius: 12px;\n\t\tfont-size: 18px;\n\t\tbackground: white;\n\t\tbox-sizing: border-box;\n\t}\n\tinput:focus,\n\ttextarea:focus {\n\t\toutline: none;\n\t\tborder-color: #ff7f50;\n\t}\n\n\t.form-actions {\n\t\tdisplay: flex;\n\t\tgap: 18px;\n\t\tmargin-top: 36px;\n\t\tpadding-top: 26px;\n\t\tborder-top: 1px solid #e5e7eb;\n\t}\n\t.btn-primary,\n\t.btn-secondary {\n\t\tflex: 1;\n\t\tpadding: 18px;\n\t\tborder-radius: 12px;\n\t\tfont-weight: 600;\n\t\tfont-size: 18px;\n\t\tcursor: pointer;\n\t\tborder: none;\n\t\ttext-align: center;\n\t\ttext-decoration: none;\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t}\n\t.btn-primary {\n\t\tbackground: linear-gradient(135deg, #ff7f50 0%, #ff6a3d 100%);\n\t\tcolor: white;\n\t}\n\t.btn-secondary {\n\t\tbackground: white;\n\t\tborder: 1px solid #e5e7eb;\n\t\tcolor: #374151;\n\t}\n\n\t@media (min-width: 768px) {\n\t\t.page-subtitle {\n\t\t\tdisplay: block;\n\t\t}\n\t\t.form-card {\n\t\t\tpadding: 48px;\n\t\t}\n\t\t.form-actions {\n\t\t\tjustify-content: flex-end;\n\t\t}\n\t\t.btn-primary,\n\t\t.btn-secondary {\n\t\t\tflex: 0 0 auto;\n\t\t\twidth: auto;\n\t\t\tmin-width: 160px;\n\t\t}\n\t}\n</style>\n",
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\dashboard\\mileage\\new\\+page.svelte",
		"messages": [
			{
				"ruleId": "svelte/no-navigation-without-resolve",
				"severity": 1,
				"message": "Unexpected goto() call without resolve().",
				"line": 106,
				"column": 9,
				"nodeType": null,
				"messageId": "gotoWithoutResolve",
				"endLine": 106,
				"endColumn": 29
			},
			{
				"ruleId": "svelte/no-navigation-without-resolve",
				"severity": 1,
				"message": "Unexpected href link without resolve().",
				"line": 120,
				"column": 12,
				"nodeType": null,
				"messageId": "linkWithoutResolve",
				"endLine": 120,
				"endColumn": 30
			},
			{
				"ruleId": "svelte/no-navigation-without-resolve",
				"severity": 1,
				"message": "Unexpected href link without resolve().",
				"line": 228,
				"column": 14,
				"nodeType": null,
				"messageId": "linkWithoutResolve",
				"endLine": 228,
				"endColumn": 32
			}
		],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 3,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"source": "<script lang=\"ts\">\n\timport { mileage } from '$lib/stores/mileage';\n\n\timport { user } from '$lib/stores/auth';\n\timport { userSettings } from '$lib/stores/userSettings';\n\timport { toasts } from '$lib/stores/toast';\n\timport { goto, invalidateAll } from '$app/navigation';\n\timport { page } from '$app/stores';\n\timport SelectMobile from '$lib/components/ui/SelectMobile.svelte';\n\n\t// --- HELPER: Get Local Date (YYYY-MM-DD) ---\n\tfunction getLocalDate() {\n\t\tconst now = new Date();\n\t\treturn new Date(now.getTime() - now.getTimezoneOffset() * 60000).toISOString().split('T')[0];\n\t}\n\n\t// Settings modal removed for Mileage logs\n\n\tconst formData = {\n\t\tdate: getLocalDate(),\n\t\tstartOdometer: '',\n\t\tendOdometer: '',\n\t\tmiles: '',\n\t\tvehicle: '',\n\t\tmileageRate: '',\n\t\tnotes: '',\n\t\tcategory: ''\n\t};\n\n\t// Reference to miles input so quick-action can focus it\n\tlet amountInput: HTMLInputElement | null = null;\n\t// Whether the user manually edited the miles input; when true we stop auto-updating miles from odometers\n\tlet milesManual = false;\n\n\t// default mileageRate from user settings for new logs (only set if field empty)\n\t$: if ($userSettings && formData.mileageRate === '') {\n\t\tformData.mileageRate =\n\t\t\t$userSettings.mileageRate != null ? String($userSettings.mileageRate) : '';\n\t}\n\n\t// Default vehicle selection if available and none selected\n\t$: if ($userSettings?.vehicles?.length > 0 && !formData.vehicle) {\n\t\tconst v0 = $userSettings.vehicles[0];\n\t\tformData.vehicle = v0?.id ?? v0?.name ?? '';\n\t}\n\n\t// Prefill category from the URL query parameter (e.g., ?category=fuel)\n\t$: {\n\t\tconst q = $page.url.searchParams.get('category');\n\t\tif (q) {\n\t\t\tformData.category = q;\n\t\t\t// if arrived via quick action, focus the miles input for quick logging\n\t\t\tif (typeof window !== 'undefined') {\n\t\t\t\tsetTimeout(() => (amountInput as any)?.focus(), 60);\n\t\t\t}\n\t\t}\n\t}\n\n\t// Auto-calc miles from odometer readings unless the user has manually edited miles\n\t$: if (!milesManual) {\n\t\tif (formData.startOdometer !== '' && formData.endOdometer !== '') {\n\t\t\tconst s = Number(formData.startOdometer) || 0;\n\t\t\tconst e = Number(formData.endOdometer) || 0;\n\t\t\tformData.miles = Number(Math.max(0, e - s).toFixed(2)).toString();\n\t\t}\n\t}\n\n\tasync function saveExpense() {\n\t\tif (\n\t\t\t!formData.date ||\n\t\t\t((formData.startOdometer === '' || formData.endOdometer === '') && formData.miles === '')\n\t\t) {\n\t\t\ttoasts.error('Please fill in required fields (either start & end odometer or miles).');\n\t\t\treturn;\n\t\t}\n\n\t\tconst currentUser = $page.data['user'] || $user;\n\t\tconst userId = currentUser?.id || localStorage.getItem('offline_user_id');\n\n\t\tif (!userId) {\n\t\t\ttoasts.error('User not identified. Cannot save.');\n\t\t\treturn;\n\t\t}\n\n\t\ttry {\n\t\t\tconst start = Number(formData.startOdometer) || 0;\n\t\t\tconst end = Number(formData.endOdometer) || 0;\n\t\t\tlet miles =\n\t\t\t\tformData.miles !== '' && !isNaN(Number(formData.miles))\n\t\t\t\t\t? Number(formData.miles)\n\t\t\t\t\t: Math.max(0, end - start);\n\t\t\tmiles = Number(miles.toFixed(2));\n\n\t\t\tconst payload = {\n\t\t\t\t...formData,\n\t\t\t\tstartOdometer: start,\n\t\t\t\tendOdometer: end,\n\t\t\t\tmiles,\n\t\t\t\tmileageRate: formData.mileageRate !== '' ? Number(formData.mileageRate) : undefined,\n\t\t\t\tvehicle: formData.vehicle || undefined\n\t\t\t};\n\n\t\t\tawait mileage.create(payload as any, userId);\n\t\t\ttoasts.success('Mileage log created');\n\t\t\tawait invalidateAll();\n\t\t\tgoto('/dashboard/mileage');\n\t\t} catch (err) {\n\t\t\tconsole.error(err);\n\t\t\ttoasts.error('Failed to save mileage log');\n\t\t}\n\t}\n</script>\n\n<div class=\"expense-form-page\">\n\t<div class=\"page-header\">\n\t\t<div>\n\t\t\t<h1 class=\"page-title\">New Mileage Log</h1>\n\t\t\t<p class=\"page-subtitle\">Record start/end odometer and miles</p>\n\t\t</div>\n\t\t<a href=\"/dashboard/mileage\" class=\"btn-back\">\n\t\t\t<svg width=\"24\" height=\"24\" viewBox=\"0 0 20 20\" fill=\"none\"\n\t\t\t\t><path\n\t\t\t\t\td=\"M12 4L6 10L12 16\"\n\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\t\tstroke-linejoin=\"round\"\n\t\t\t\t/></svg\n\t\t\t> Back\n\t\t</a>\n\t</div>\n\n\t<div class=\"form-card\">\n\t\t<div class=\"card-header\">\n\t\t\t<h2 class=\"card-title\">Mileage Details</h2>\n\t\t</div>\n\n\t\t<div class=\"form-grid\">\n\t\t\t<div class=\"form-group\">\n\t\t\t\t<label for=\"mileage-date\">Date</label>\n\t\t\t\t<input id=\"mileage-date\" type=\"date\" bind:value={formData.date} required />\n\t\t\t</div>\n\n\t\t\t<div class=\"form-row\">\n\t\t\t\t<!-- Maintenance, Supplies, and Expenses options removed for Mileage logs -->\n\n\t\t\t\t<div class=\"form-group grid-3\">\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<label for=\"start-odo\">Start Odometer</label>\n\t\t\t\t\t\t<input\n\t\t\t\t\t\t\tid=\"start-odo\"\n\t\t\t\t\t\t\ttype=\"number\"\n\t\t\t\t\t\t\tinputmode=\"decimal\"\n\t\t\t\t\t\t\tbind:value={formData.startOdometer}\n\t\t\t\t\t\t\tplaceholder=\"0\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<label for=\"end-odo\">End Odometer</label>\n\t\t\t\t\t\t<input\n\t\t\t\t\t\t\tid=\"end-odo\"\n\t\t\t\t\t\t\ttype=\"number\"\n\t\t\t\t\t\t\tinputmode=\"decimal\"\n\t\t\t\t\t\t\tbind:value={formData.endOdometer}\n\t\t\t\t\t\t\tplaceholder=\"0\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<label for=\"miles\">Miles</label>\n\t\t\t\t\t\t<input\n\t\t\t\t\t\t\tid=\"miles\"\n\t\t\t\t\t\t\ttype=\"number\"\n\t\t\t\t\t\t\tstep=\"0.01\"\n\t\t\t\t\t\t\tinputmode=\"decimal\"\n\t\t\t\t\t\t\tbind:this={amountInput}\n\t\t\t\t\t\t\tbind:value={formData.miles}\n\t\t\t\t\t\t\tplaceholder=\"0.0\"\n\t\t\t\t\t\t\ton:input={(e) => (milesManual = (e.target as HTMLInputElement).value !== '')}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div class=\"form-group\">\n\t\t\t\t<label for=\"notes\">Notes</label>\n\t\t\t\t<textarea\n\t\t\t\t\tid=\"notes\"\n\t\t\t\t\tname=\"notes\"\n\t\t\t\t\tbind:value={formData.notes}\n\t\t\t\t\trows=\"3\"\n\t\t\t\t\tplaceholder=\"e.g., Trip to client site\"\n\t\t\t\t></textarea>\n\n\t\t\t\t<!-- tax deductible removed -->\n\t\t\t</div>\n\n\t\t\t<!-- Settings modal removed for Mileage logs -->\n\n\t\t\t<div class=\"form-row vehicle-rate-row\">\n\t\t\t\t<div class=\"form-group\">\n\t\t\t\t\t<label for=\"vehicle-mobile\">Vehicle</label>\n\t\t\t\t\t<SelectMobile\n\t\t\t\t\t\tclassName=\"mobile-select\"\n\t\t\t\t\t\tid=\"vehicle-mobile\"\n\t\t\t\t\t\tplaceholder={$userSettings.vehicles && $userSettings.vehicles.length > 0\n\t\t\t\t\t\t\t? 'Select vehicle'\n\t\t\t\t\t\t\t: 'No vehicles (open Mileage Settings)'}\n\t\t\t\t\t\toptions={$userSettings.vehicles\n\t\t\t\t\t\t\t? $userSettings.vehicles.map((v) => ({ value: v.id || v.name, label: v.name }))\n\t\t\t\t\t\t\t: [{ value: '', label: 'No vehicles (open Mileage Settings)' }]}\n\t\t\t\t\t\tbind:value={formData.vehicle}\n\t\t\t\t\t\tonchange={(e) => (formData.vehicle = e.value)}\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"form-group\">\n\t\t\t\t\t<label for=\"mileage-rate\">Mileage Rate (per mile)</label>\n\t\t\t\t\t<input\n\t\t\t\t\t\tid=\"mileage-rate\"\n\t\t\t\t\t\ttype=\"number\"\n\t\t\t\t\t\tstep=\"0.001\"\n\t\t\t\t\t\tbind:value={formData.mileageRate}\n\t\t\t\t\t\tplaceholder=\"0.655\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div class=\"form-actions\">\n\t\t\t\t<a href=\"/dashboard/mileage\" class=\"btn-secondary\">Cancel</a>\n\t\t\t\t<button class=\"btn-primary\" on:click={saveExpense}>Save Log</button>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>\n\n<style>\n\t/* MATCHING STYLES FROM TRIPS/NEW */\n\t.expense-form-page {\n\t\tmax-width: 800px;\n\t\tmargin: 0 auto;\n\t\tpadding: 4px;\n\t\tpadding-bottom: 90px;\n\t}\n\n\t@media (max-width: 640px) {\n\t\t.expense-form-page {\n\t\t\tpadding-bottom: calc(env(safe-area-inset-bottom, 0px) + 1px);\n\t\t}\n\t}\n\n\t.page-header {\n\t\tdisplay: flex;\n\t\tjustify-content: space-between;\n\t\talign-items: center;\n\t\tmargin-bottom: 26px;\n\t\tpadding: 0 8px;\n\t}\n\t.page-title {\n\t\tfont-size: 28px;\n\t\tfont-weight: 800;\n\t\tcolor: #111827;\n\t\tmargin: 0;\n\t}\n\t.page-subtitle {\n\t\tfont-size: 14px;\n\t\tcolor: #6b7280;\n\t\tdisplay: none;\n\t\tmargin: 0;\n\t}\n\n\t.btn-back {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tgap: 8px;\n\t\tfont-weight: 600;\n\t\tcolor: #6b7280;\n\t\ttext-decoration: none;\n\t\tfont-size: 14px;\n\t}\n\n\t.form-card {\n\t\tbackground: white;\n\t\tborder: 1px solid #e5e7eb;\n\t\tborder-radius: 18px;\n\t\tpadding: 16px;\n\t\tbox-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);\n\t}\n\t.card-header {\n\t\tmargin-bottom: 26px;\n\t}\n\t.card-title {\n\t\tfont-size: 22px;\n\t\tfont-weight: 700;\n\t\tcolor: #111827;\n\t\tmargin: 0;\n\t}\n\n\t.form-grid {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tgap: 24px;\n\t}\n\t.form-row {\n\t\tdisplay: grid;\n\t\tgrid-template-columns: 1fr 1fr;\n\t\tgap: 20px;\n\t}\n\t/* Make the start/end/miles group span the full width (match Date input) */\n\t.form-row .grid-3 {\n\t\tgrid-column: 1 / -1;\n\t\tdisplay: grid;\n\t\tgrid-template-columns: repeat(3, 1fr);\n\t\tgap: 16px;\n\t}\n\t@media (max-width: 767px) {\n\t\t.form-row .grid-3 {\n\t\t\tgrid-template-columns: 1fr;\n\t\t}\n\t}\n\n\t/* Force mileage rate below vehicle on small screens <= 711px */\n\t@media (max-width: 711px) {\n\t\t.vehicle-rate-row {\n\t\t\tgrid-template-columns: 1fr;\n\t\t}\n\t}\n\n\t.form-group {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tgap: 8px;\n\t}\n\n\tlabel {\n\t\tfont-size: 16px;\n\t\tfont-weight: 600;\n\t\tcolor: #374151;\n\t}\n\n\tinput,\n\ttextarea {\n\t\twidth: 100%;\n\t\tpadding: 16px;\n\t\tborder: 1px solid #e5e7eb;\n\t\tborder-radius: 12px;\n\t\tfont-size: 18px;\n\t\tbackground: white;\n\t\tbox-sizing: border-box;\n\t}\n\n\tinput:focus,\n\ttextarea:focus {\n\t\toutline: none;\n\t\tborder-color: #ff7f50;\n\t}\n\n\t.form-actions {\n\t\tdisplay: flex;\n\t\tgap: 18px;\n\t\tmargin-top: 36px;\n\t\tpadding-top: 26px;\n\t\tborder-top: 1px solid #e5e7eb;\n\t}\n\t.btn-primary,\n\t.btn-secondary {\n\t\tflex: 1;\n\t\tpadding: 18px;\n\t\tborder-radius: 12px;\n\t\tfont-weight: 600;\n\t\tfont-size: 18px;\n\t\tcursor: pointer;\n\t\tborder: none;\n\t\ttext-align: center;\n\t\ttext-decoration: none;\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t}\n\t.btn-primary {\n\t\tbackground: linear-gradient(135deg, #ff7f50 0%, #ff6a3d 100%);\n\t\tcolor: white;\n\t}\n\t.btn-secondary {\n\t\tbackground: white;\n\t\tborder: 1px solid #e5e7eb;\n\t\tcolor: #374151;\n\t}\n\n\t@media (min-width: 768px) {\n\t\t.page-subtitle {\n\t\t\tdisplay: block;\n\t\t}\n\t\t.form-card {\n\t\t\tpadding: 48px;\n\t\t}\n\t\t.form-actions {\n\t\t\tjustify-content: flex-end;\n\t\t}\n\t\t.btn-primary,\n\t\t.btn-secondary {\n\t\t\tflex: 0 0 auto;\n\t\t\twidth: auto;\n\t\t\tmin-width: 160px;\n\t\t}\n\t}\n</style>\n",
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\dashboard\\profile\\+page.server.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\dashboard\\profile\\+page.svelte",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\dashboard\\settings\\+page.server.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\dashboard\\settings\\+page.svelte",
		"messages": [
			{
				"ruleId": "svelte/no-navigation-without-resolve",
				"severity": 1,
				"message": "Unexpected href link without resolve().",
				"line": 202,
				"column": 13,
				"nodeType": null,
				"messageId": "linkWithoutResolve",
				"endLine": 202,
				"endColumn": 33
			}
		],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 1,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"source": "<script lang=\"ts\">\n\timport { userSettings } from '$lib/stores/userSettings';\n\timport { auth, user } from '$lib/stores/auth';\n\timport { trips } from '$lib/stores/trips';\n\timport Modal from '$lib/components/ui/Modal.svelte';\n\timport Button from '$lib/components/ui/Button.svelte';\n\timport ProfileCard from './components/ProfileCard.svelte';\n\timport SecurityCard from './components/SecurityCard.svelte';\n\timport ExportModal from './components/ExportModal.svelte';\n\timport MaintenanceCard from './components/MaintenanceCard.svelte';\n\timport SettingsLayout from './SettingsLayout.svelte';\n\timport CollapsibleCard from '$lib/components/ui/CollapsibleCard.svelte';\n\timport { csrfFetch } from '$lib/utils/csrf';\n\timport { SvelteDate } from '$lib/utils/svelte-reactivity';\n\n\texport let data: any;\n\n\t// --- REMOTE SYNC LOGIC ---\n\t$: if (data?.remoteSettings?.settings) {\n\t\tconst merged = { ...$userSettings, ...data.remoteSettings.settings };\n\t\tuserSettings.set(merged);\n\t}\n\n\tlet profile = { name: '', email: '' };\n\t$: if ($user || data.remoteSettings?.profile) {\n\t\tconst remote = data.remoteSettings?.profile || {};\n\t\tif (!profile.name) profile.name = remote.name || $user?.id || '';\n\t\tif (!profile.email) profile.email = remote.email || $user?.email || '';\n\t}\n\n\t$: monthlyUsage = $trips.filter((t) => {\n\t\tif (!t.date) return false;\n\t\tconst tripDate = SvelteDate.from(t.date).toDate();\n\t\tconst now = SvelteDate.now().toDate();\n\t\treturn tripDate.getMonth() === now.getMonth() && tripDate.getFullYear() === now.getFullYear();\n\t}).length;\n\n\tlet showSuccess = false;\n\tlet successMessage = '';\n\n\tfunction showSuccessMsg(msg: string) {\n\t\tsuccessMessage = msg;\n\t\tshowSuccess = true;\n\t\tsetTimeout(() => (showSuccess = false), 3000);\n\t}\n\n\t// Upgrade/Pro Logic\n\t$: isPro = ['pro', 'business', 'premium', 'enterprise'].includes($auth.user?.plan || '');\n\tlet isUpgradeModalOpen = false;\n\tlet upgradeSource: 'generic' | 'export' | 'advanced-export' = 'generic';\n\tlet isCheckingOut = false;\n\tlet isOpeningPortal = false;\n\n\tasync function handleCheckout() {\n\t\tif (isCheckingOut) return;\n\t\tisCheckingOut = true;\n\t\ttry {\n\t\t\tconst res = await csrfFetch('/api/stripe/checkout', { method: 'POST' });\n\t\t\tconst json: any = await res.json();\n\t\t\tif (!res.ok) throw new Error(json?.message || 'Checkout failed');\n\t\t\tif (json?.url) window.location.href = json.url;\n\t\t} catch (e) {\n\t\t\tconsole.error('Checkout error:', e);\n\t\t\talert('Failed to start checkout. Please try again.');\n\t\t\tisCheckingOut = false;\n\t\t}\n\t}\n\n\tasync function handlePortal() {\n\t\tif (isOpeningPortal) return;\n\t\tisOpeningPortal = true;\n\t\ttry {\n\t\t\tconst res = await csrfFetch('/api/stripe/portal', { method: 'POST' });\n\t\t\tconst json: any = await res.json();\n\t\t\tif (!res.ok) throw new Error(json?.message || 'Failed to open portal');\n\t\t\tif (json?.url) window.location.href = json.url;\n\t\t} catch (e) {\n\t\t\tconsole.error(e);\n\t\t\talert('Could not open billing portal. If you recently upgraded, try refreshing the page.');\n\t\t\tisOpeningPortal = false;\n\t\t}\n\t}\n\n\tlet showAdvancedExport = false;\n\n\t// Handle events from child components\n\tfunction handleExportTaxBundle(e: CustomEvent) {\n\t\t// Because tax bundle logic is complex (CSV generation + PDF text),\n\t\t// you can implement it here or import `exportTaxBundle` from export-utils if refactored there.\n\t\t// For this refactor, I assume the logic resides in the modal or utility.\n\t\t// If the logic was kept here, call it.\n\t\tconsole.log('Export tax bundle requested', e.detail);\n\t\tshowSuccessMsg('Tax bundle exported!');\n\t}\n</script>\n\n<svelte:head>\n\t<title>Settings - Go Route Yourself</title>\n\t<style>\n\t\t.pac-container {\n\t\t\tz-index: 10000 !important;\n\t\t\tpointer-events: auto !important;\n\t\t}\n\t\t:root {\n\t\t\t--orange: #ff6a3d;\n\t\t\t--green: #22c55e;\n\t\t\t--navy: #1a3a5c;\n\t\t\t--purple: #764a89;\n\t\t}\n\t</style>\n</svelte:head>\n\n<div class=\"settings\">\n\t<div class=\"page-header\">\n\t\t<div>\n\t\t\t<h1 class=\"page-title\">Settings</h1>\n\t\t\t<p class=\"page-subtitle\">Manage your account and preferences</p>\n\t\t</div>\n\t</div>\n\n\t{#if showSuccess}\n\t\t<div class=\"alert success\">\n\t\t\t<svg width=\"20\" height=\"20\" viewBox=\"0 0 20 20\" fill=\"none\">\n\t\t\t\t<path\n\t\t\t\t\td=\"M16.6 5L7.5 14L3.4 10\"\n\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\tstroke-width=\"2.5\"\n\t\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\t\tstroke-linejoin=\"round\"\n\t\t\t\t/>\n\t\t\t</svg>\n\t\t\t{successMessage}\n\t\t</div>\n\t{/if}\n\n\t<SettingsLayout>\n\t\t<section id=\"profile\" class=\"settings-section\">\n\t\t\t<ProfileCard\n\t\t\t\tbind:profile\n\t\t\t\t{monthlyUsage}\n\t\t\t\t{isPro}\n\t\t\t\t{isCheckingOut}\n\t\t\t\t{isOpeningPortal}\n\t\t\t\ton:success={(e) => showSuccessMsg(e.detail)}\n\t\t\t\ton:portal={handlePortal}\n\t\t\t\ton:upgrade={(e) => {\n\t\t\t\t\tupgradeSource = e.detail;\n\t\t\t\t\tisUpgradeModalOpen = true;\n\t\t\t\t}}\n\t\t\t/>\n\t\t</section>\n\n\t\t<section id=\"maintenance\" class=\"settings-section\">\n\t\t\t<MaintenanceCard on:success={(e) => showSuccessMsg(e.detail)} />\n\t\t</section>\n\n\t\t<section id=\"integrations\" class=\"settings-section\">\n\t\t\t<CollapsibleCard\n\t\t\t\ttitle=\"Integrations\"\n\t\t\t\tsubtitle=\"Connect external services\"\n\t\t\t\tstorageKey=\"settings:integrations\"\n\t\t\t>\n\t\t\t\t{#snippet icon()}\n\t\t\t\t\t<span>\n\t\t\t\t\t\t<svg width=\"20\" height=\"20\" viewBox=\"0 0 20 20\" fill=\"none\">\n\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\td=\"M10 12C11.1046 12 12 11.1046 12 10C12 8.89543 11.1046 8 10 8C8.89543 8 8 8.89543 8 10C8 11.1046 8.89543 12 10 12Z\"\n\t\t\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\td=\"M16.2 12C16.1 12.5 16.3 13 16.7 13.3L16.8 13.4C17.1 13.7 17.3 14.1 17.3 14.5C17.3 14.9 17.1 15.3 16.8 15.6C16.5 15.9 16.1 16.1 15.7 16.1C15.3 16.1 14.9 15.9 14.6 15.6L14.5 15.5C14.2 15.1 13.7 14.9 13.2 15C12.7 15.1 12.4 15.5 12.3 16V16.2C12.3 17.1 11.6 17.8 10.7 17.8C9.8 17.8 9.1 17.1 9.1 16.2V16.1C9 15.5 8.6 15.1 8 15C7.5 15 7 15.2 6.7 15.6L6.6 15.7C6.3 16 5.9 16.2 5.5 16.2C5.1 16.2 4.7 16 4.4 15.7C4.1 15.4 3.9 15 3.9 14.6C3.9 14.2 4.1 13.8 4.4 13.5L4.5 13.4C4.9 13.1 5.1 12.6 5 12.1C4.9 11.6 4.5 11.3 4 11.2H3.8C2.9 11.2 2.2 10.5 2.2 9.6C2.2 8.7 2.9 8 3.8 8H3.9C4.5 7.9 4.9 7.5 5 6.9C5 6.4 4.8 5.9 4.4 5.6L4.3 5.5C4 5.2 3.8 4.8 3.8 4.4C3.8 4 4 3.6 4.3 3.3C4.6 3 5 2.8 5.4 2.8C5.8 2.8 6.2 3 6.5 3.3L6.6 3.4C7 3.8 7.5 4 8 3.9C8.5 3.9 8.8 3.4 8.9 2.9V2.7C8.9 1.8 9.6 1.1 10.5 1.1C11.4 1.1 12.1 1.8 12.1 2.7V2.8C12.1 3.4 12.5 3.8 13.1 3.9C13.6 4 14.1 3.8 14.4 3.4L14.5 3.3C14.8 3 15.2 2.8 15.6 2.8C16 2.8 16.4 3 16.7 3.3C17 3.6 17.2 4 17.2 4.4C17.2 4.8 17 5.2 16.7 5.5L16.6 5.6C16.2 5.9 16 6.4 16.1 6.9C16.2 7.4 16.6 7.7 17.1 7.8H17.3C18.2 7.8 18.9 8.5 18.9 9.4C18.9 10.3 18.2 11 17.3 11H17.2C16.6 11.1 16.2 11.5 16.1 12.1L16.2 12Z\"\n\t\t\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</svg>\n\t\t\t\t\t</span>\n\t\t\t\t{/snippet}\n\t\t\t\t<div class=\"card-header\">\n\t\t\t\t\t<div class=\"card-icon green\">\n\t\t\t\t\t\t<svg width=\"20\" height=\"20\" viewBox=\"0 0 20 20\" fill=\"none\">\n\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\td=\"M10 12C11.1046 12 12 11.1046 12 10C12 8.89543 11.1046 8 10 8C8.89543 8 8 8.89543 8 10C8 11.1046 8.89543 12 10 12Z\"\n\t\t\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\td=\"M16.2 12C16.1 12.5 16.3 13 16.7 13.3L16.8 13.4C17.1 13.7 17.3 14.1 17.3 14.5C17.3 14.9 17.1 15.3 16.8 15.6C16.5 15.9 16.1 16.1 15.7 16.1C15.3 16.1 14.9 15.9 14.6 15.6L14.5 15.5C14.2 15.1 13.7 14.9 13.2 15C12.7 15.1 12.4 15.5 12.3 16V16.2C12.3 17.1 11.6 17.8 10.7 17.8C9.8 17.8 9.1 17.1 9.1 16.2V16.1C9 15.5 8.6 15.1 8 15C7.5 15 7 15.2 6.7 15.6L6.6 15.7C6.3 16 5.9 16.2 5.5 16.2C5.1 16.2 4.7 16 4.4 15.7C4.1 15.4 3.9 15 3.9 14.6C3.9 14.2 4.1 13.8 4.4 13.5L4.5 13.4C4.9 13.1 5.1 12.6 5 12.1C4.9 11.6 4.5 11.3 4 11.2H3.8C2.9 11.2 2.2 10.5 2.2 9.6C2.2 8.7 2.9 8 3.8 8H3.9C4.5 7.9 4.9 7.5 5 6.9C5 6.4 4.8 5.9 4.4 5.6L4.3 5.5C4 5.2 3.8 4.8 3.8 4.4C3.8 4 4 3.6 4.3 3.3C4.6 3 5 2.8 5.4 2.8C5.8 2.8 6.2 3 6.5 3.3L6.6 3.4C7 3.8 7.5 4 8 3.9C8.5 3.9 8.8 3.4 8.9 2.9V2.7C8.9 1.8 9.6 1.1 10.5 1.1C11.4 1.1 12.1 1.8 12.1 2.7V2.8C12.1 3.4 12.5 3.8 13.1 3.9C13.6 4 14.1 3.8 14.4 3.4L14.5 3.3C14.8 3 15.2 2.8 15.6 2.8C16 2.8 16.4 3 16.7 3.3C17 3.6 17.2 4 17.2 4.4C17.2 4.8 17 5.2 16.7 5.5L16.6 5.6C16.2 5.9 16 6.4 16.1 6.9C16.2 7.4 16.6 7.7 17.1 7.8H17.3C18.2 7.8 18.9 8.5 18.9 9.4C18.9 10.3 18.2 11 17.3 11H17.2C16.6 11.1 16.2 11.5 16.1 12.1L16.2 12Z\"\n\t\t\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</svg>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<h2 class=\"card-title\">Integrations</h2>\n\t\t\t\t\t\t<p class=\"card-subtitle\">Connect external services</p>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<div class=\"data-actions\">\n\t\t\t\t\t<a\n\t\t\t\t\t\thref=\"/dashboard/hughesnet\"\n\t\t\t\t\t\tclass=\"action-btn\"\n\t\t\t\t\t\tstyle=\"text-decoration: none; color: inherit; display:flex; align-items:center; gap:16px; padding:16px; background:#F9FAFB; border:2px solid #E5E7EB; border-radius:12px;\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<div style=\"display: flex; align-items: center; gap: 12px; width: 100%;\">\n\t\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\t\twidth=\"24\"\n\t\t\t\t\t\t\t\theight=\"24\"\n\t\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\t\t\t\t\tfill=\"none\"\n\t\t\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\t\t\t\t\tstroke-linejoin=\"round\"\n\t\t\t\t\t\t\t\tstyle=\"color: #0D9488;\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<circle cx=\"12\" cy=\"12\" r=\"10\"></circle>\n\t\t\t\t\t\t\t\t<path d=\"M2 12h20\"></path>\n\t\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\t\td=\"M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z\"\n\t\t\t\t\t\t\t\t></path>\n\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t<div class=\"action-title\" style=\"font-weight:600; font-size:15px;\">HughesNet</div>\n\t\t\t\t\t\t\t\t<div class=\"action-subtitle\" style=\"color:#6B7280; font-size:13px;\">\n\t\t\t\t\t\t\t\t\tConfigure satellite integration\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div style=\"margin-left: auto;\">\n\t\t\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\t\t\twidth=\"20\"\n\t\t\t\t\t\t\t\t\theight=\"20\"\n\t\t\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\t\t\t\t\t\tfill=\"none\"\n\t\t\t\t\t\t\t\t\tstroke=\"#9CA3AF\"\n\t\t\t\t\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\t\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\t\t\t\t\t\tstroke-linejoin=\"round\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<polyline points=\"9 18 15 12 9 6\"></polyline>\n\t\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</a>\n\t\t\t\t</div>\n\t\t\t</CollapsibleCard>\n\t\t</section>\n\n\t\t<section id=\"security\" class=\"settings-section\">\n\t\t\t<SecurityCard on:success={(e) => showSuccessMsg(e.detail)} />\n\t\t</section>\n\t</SettingsLayout>\n</div>\n\n<ExportModal\n\tbind:showAdvancedExport\n\ton:success={(e) => showSuccessMsg(e.detail)}\n\ton:exportTaxBundle={handleExportTaxBundle}\n/>\n\n<Modal bind:open={isUpgradeModalOpen} title=\"Upgrade to Pro\">\n\t<div class=\"space-y-6 text-center py-4\">\n\t\t<div class=\"mx-auto w-16 h-16 bg-orange-100 rounded-full flex items-center justify-center mb-4\">\n\t\t\t<span class=\"text-3xl\">≡ƒÜÇ</span>\n\t\t</div>\n\n\t\t<h3 class=\"text-xl font-bold text-gray-900\">\n\t\t\t{#if upgradeSource === 'export' || upgradeSource === 'advanced-export'}\n\t\t\t\tUnlock Advanced Exports\n\t\t\t{:else}\n\t\t\t\tUnlock Pro Features\n\t\t\t{/if}\n\t\t</h3>\n\n\t\t<p class=\"text-gray-600 text-base leading-relaxed\">\n\t\t\t{#if upgradeSource === 'export' || upgradeSource === 'advanced-export'}\n\t\t\t\tAdvanced export features including tax bundles, PDF exports, and comprehensive expense\n\t\t\t\ttracking are Pro features. Upgrade now to unlock professional-grade data exports!\n\t\t\t{:else}\n\t\t\t\tTake your business to the next level. Get unlimited trips, powerful route optimization, and\n\t\t\t\ttax-ready data exports.\n\t\t\t{/if}\n\t\t</p>\n\n\t\t<div class=\"bg-gray-50 p-4 rounded-lg text-left text-sm space-y-2 border border-gray-100\">\n\t\t\t<div class=\"flex items-center gap-2\">\n\t\t\t\t<span class=\"text-green-500 text-lg\">Γ£ô</span>\n\t\t\t\t<span class=\"text-gray-700\">Unlimited Stops per Trip</span>\n\t\t\t</div>\n\t\t\t<div class=\"flex items-center gap-2\">\n\t\t\t\t<span class=\"text-green-500 text-lg\">Γ£ô</span>\n\t\t\t\t<span class=\"text-gray-700\">One-Click Route Optimization</span>\n\t\t\t</div>\n\t\t\t<div class=\"flex items-center gap-2\">\n\t\t\t\t<span class=\"text-green-500 text-lg\">Γ£ô</span>\n\t\t\t\t<span class=\"text-gray-700\">Unlimited Monthly Trips</span>\n\t\t\t</div>\n\t\t\t<div class=\"flex items-center gap-2\">\n\t\t\t\t<span class=\"text-green-500 text-lg\">Γ£ô</span>\n\t\t\t\t<span class=\"text-gray-700\">Advanced Exports (CSV/PDF)</span>\n\t\t\t</div>\n\t\t\t<div class=\"flex items-center gap-2\">\n\t\t\t\t<span class=\"text-green-500 text-lg\">Γ£ô</span>\n\t\t\t\t<span class=\"text-gray-700\">Tax Bundle Generation</span>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<div class=\"flex gap-3 justify-center pt-2\">\n\t\t\t<Button variant=\"outline\" on:click={() => (isUpgradeModalOpen = false)}>Maybe Later</Button>\n\t\t\t<Button\n\t\t\t\tvariant=\"primary\"\n\t\t\t\tclassName=\"px-6 py-2.5 text-sm\"\n\t\t\t\ton:click={handleCheckout}\n\t\t\t\tdisabled={isCheckingOut}>{isCheckingOut ? 'Loading...' : 'Upgrade Now'}</Button\n\t\t\t>\n\t\t</div>\n\t</div>\n</Modal>\n\n<style>\n\t.settings {\n\t\tmax-width: 1400px;\n\t\tmargin: 0 auto;\n\t\tpadding: 16px;\n\t\tpadding-bottom: 80px;\n\t}\n\t.page-header {\n\t\tmargin-bottom: 32px;\n\t}\n\t.page-title {\n\t\tfont-size: 32px;\n\t\tfont-weight: 800;\n\t\tcolor: #111827;\n\t\tmargin-bottom: 4px;\n\t}\n\t.page-subtitle {\n\t\tfont-size: 16px;\n\t\tcolor: #6b7280;\n\t}\n\n\t.alert {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tgap: 12px;\n\t\tpadding: 14px 20px;\n\t\tborder-radius: 12px;\n\t\tfont-size: 14px;\n\t\tfont-weight: 500;\n\t\tmargin-bottom: 24px;\n\t}\n\t.alert.success {\n\t\tbackground: #f0fdf4;\n\t\tcolor: #166534;\n\t\tborder: 1px solid #bbf7d0;\n\t}\n\n\t/* Section spacing when using the SettingsLayout */\n\t.settings-section {\n\t\tmargin-bottom: 24px;\n\t}\n\n\t@media (max-width: 1024px) {\n\t\t/* On narrow screens, sections stack naturally and nav becomes horizontal */\n\t\t.settings-section {\n\t\t\tmargin-bottom: 18px;\n\t\t}\n\t}\n\n\t@media (max-width: 640px) {\n\t\t.settings {\n\t\t\tpadding-bottom: calc(env(safe-area-inset-bottom, 0px) + 1px);\n\t\t}\n\t}\n</style>\n",
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\dashboard\\settings\\SettingsLayout.svelte",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\dashboard\\settings\\components\\DataCard.svelte",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\dashboard\\settings\\components\\ExportModal.svelte",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\dashboard\\settings\\components\\MaintenanceCard.svelte",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\dashboard\\settings\\components\\ProfileCard.svelte",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\dashboard\\settings\\components\\SecurityCard.svelte",
		"messages": [
			{
				"ruleId": "svelte/no-navigation-without-resolve",
				"severity": 1,
				"message": "Unexpected goto() call without resolve().",
				"line": 98,
				"column": 10,
				"nodeType": null,
				"messageId": "gotoWithoutResolve",
				"endLine": 98,
				"endColumn": 13
			},
			{
				"ruleId": "@typescript-eslint/no-unused-vars",
				"severity": 2,
				"message": "'err' is defined but never used. Allowed unused caught errors must match /^_/u.",
				"line": 103,
				"column": 12,
				"nodeType": null,
				"messageId": "unusedVar",
				"endLine": 103,
				"endColumn": 15
			},
			{
				"ruleId": "svelte/no-navigation-without-resolve",
				"severity": 1,
				"message": "Unexpected goto() call without resolve().",
				"line": 113,
				"column": 9,
				"nodeType": null,
				"messageId": "gotoWithoutResolve",
				"endLine": 113,
				"endColumn": 17
			},
			{
				"ruleId": "@typescript-eslint/no-unused-vars",
				"severity": 2,
				"message": "'e' is defined but never used. Allowed unused caught errors must match /^_/u.",
				"line": 155,
				"column": 16,
				"nodeType": null,
				"messageId": "unusedVar",
				"endLine": 155,
				"endColumn": 17
			},
			{
				"ruleId": "no-empty",
				"severity": 2,
				"message": "Empty block statement.",
				"line": 171,
				"column": 19,
				"nodeType": "BlockStatement",
				"messageId": "unexpected",
				"endLine": 171,
				"endColumn": 21,
				"suggestions": [
					{
						"messageId": "suggestComment",
						"data": { "type": "block" },
						"fix": { "range": [4855, 4855], "text": " /* empty */ " },
						"desc": "Add comment inside empty block statement."
					}
				]
			},
			{
				"ruleId": "@typescript-eslint/no-unused-vars",
				"severity": 2,
				"message": "'e' is defined but never used. Allowed unused caught errors must match /^_/u.",
				"line": 185,
				"column": 13,
				"nodeType": null,
				"messageId": "unusedVar",
				"endLine": 185,
				"endColumn": 14
			},
			{
				"ruleId": "@typescript-eslint/no-unused-vars",
				"severity": 2,
				"message": "'e' is defined but never used. Allowed unused caught errors must match /^_/u.",
				"line": 260,
				"column": 13,
				"nodeType": null,
				"messageId": "unusedVar",
				"endLine": 260,
				"endColumn": 14
			},
			{
				"ruleId": "no-empty",
				"severity": 2,
				"message": "Empty block statement.",
				"line": 260,
				"column": 16,
				"nodeType": "BlockStatement",
				"messageId": "unexpected",
				"endLine": 260,
				"endColumn": 18,
				"suggestions": [
					{
						"messageId": "suggestComment",
						"data": { "type": "block" },
						"fix": { "range": [7442, 7442], "text": " /* empty */ " },
						"desc": "Add comment inside empty block statement."
					}
				]
			},
			{
				"ruleId": "@typescript-eslint/no-unused-vars",
				"severity": 2,
				"message": "'e' is defined but never used. Allowed unused caught errors must match /^_/u.",
				"line": 298,
				"column": 13,
				"nodeType": null,
				"messageId": "unusedVar",
				"endLine": 298,
				"endColumn": 14
			},
			{
				"ruleId": "@typescript-eslint/no-unused-vars",
				"severity": 2,
				"message": "'e' is defined but never used. Allowed unused caught errors must match /^_/u.",
				"line": 357,
				"column": 12,
				"nodeType": null,
				"messageId": "unusedVar",
				"endLine": 357,
				"endColumn": 13
			},
			{
				"ruleId": "svelte/no-navigation-without-resolve",
				"severity": 1,
				"message": "Unexpected href link without resolve().",
				"line": 436,
				"column": 19,
				"nodeType": null,
				"messageId": "linkWithoutResolve",
				"endLine": 436,
				"endColumn": 26
			}
		],
		"suppressedMessages": [],
		"errorCount": 8,
		"fatalErrorCount": 0,
		"warningCount": 3,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"source": "<script lang=\"ts\">\n\timport CollapsibleCard from '$lib/components/ui/CollapsibleCard.svelte';\n\timport { auth, user } from '$lib/stores/auth';\n\timport { goto } from '$app/navigation';\n\timport { toasts } from '$lib/stores/toast';\n\timport { startRegistration } from '@simplewebauthn/browser';\n\timport { onMount, createEventDispatcher } from 'svelte';\n\timport { csrfFetch } from '$lib/utils/csrf';\n\n\tconst dispatch = createEventDispatcher();\n\n\t// Password State\n\tlet showPasswordChange = false;\n\tlet passwordData = { current: '', new: '', confirm: '' };\n\tlet passwordError = '';\n\n\t// Delete State\n\tlet showDeleteConfirm = false;\n\tlet deletePassword = '';\n\tlet deleteError = '';\n\tlet isDeleting = false;\n\n\t// WebAuthn State\n\tlet registering = false;\n\tlet authenticatorsList: Array<any> = [];\n\tlet deviceRegistered = false;\n\tlet deviceCredentialID: string | null = null;\n\tlet deviceName = '';\n\tlet unregistering = false;\n\tlet sessionExpired = false;\n\tlet rememberThisDevice = false;\n\n\t// Passkey Removal State (Sudo Mode)\n\tlet showPasskeyRemoveConfirm = false;\n\tlet passkeyRemovePassword = '';\n\tlet passkeyRemoveError = '';\n\tlet pendingRemoveCredentialID: string | null = null;\n\n\tasync function changePassword() {\n\t\tif (passwordData.new !== passwordData.confirm) {\n\t\t\tpasswordError = 'Passwords do not match';\n\t\t\treturn;\n\t\t}\n\t\tif (passwordData.new.length < 8) {\n\t\t\tpasswordError = 'Password must be at least 8 characters';\n\t\t\treturn;\n\t\t}\n\n\t\ttry {\n\t\t\tconst response = await csrfFetch('/api/change-password', {\n\t\t\t\tmethod: 'POST',\n\t\t\t\theaders: { 'Content-Type': 'application/json' },\n\t\t\t\tbody: JSON.stringify({\n\t\t\t\t\tcurrentPassword: passwordData.current,\n\t\t\t\t\tnewPassword: passwordData.new\n\t\t\t\t})\n\t\t\t});\n\t\t\tlet result: any = {};\n\t\t\ttry {\n\t\t\t\tresult = await response.json();\n\t\t\t} catch (_e) {\n\t\t\t\tresult = {};\n\t\t\t}\n\n\t\t\tif (!response.ok) {\n\t\t\t\tpasswordError = result?.message || 'Failed to update password';\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tpasswordError = '';\n\t\t\tshowPasswordChange = false;\n\t\t\tpasswordData = { current: '', new: '', confirm: '' };\n\t\t\tdispatch('success', 'Password changed successfully');\n\t\t} catch (e) {\n\t\t\tconsole.error(e);\n\t\t\tpasswordError = 'An unexpected network error occurred.';\n\t\t}\n\t}\n\n\tasync function handleDeleteAccount() {\n\t\tif (!deletePassword) {\n\t\t\tdeleteError = 'Please enter your password to confirm.';\n\t\t\treturn;\n\t\t}\n\n\t\tif (\n\t\t\t!confirm(\n\t\t\t\t'FINAL WARNING: This will permanently delete your account and all data. This cannot be undone.'\n\t\t\t)\n\t\t) {\n\t\t\treturn;\n\t\t}\n\n\t\tisDeleting = true;\n\t\ttry {\n\t\t\tconst result = await auth.deleteAccount($user?.id || '', deletePassword);\n\t\t\tif (result.success) {\n\t\t\t\tgoto('/');\n\t\t\t} else {\n\t\t\t\tdeleteError = result.error || 'Failed to delete account';\n\t\t\t\tisDeleting = false;\n\t\t\t}\n\t\t} catch (err) {\n\t\t\tdeleteError = 'An unexpected error occurred';\n\t\t\tisDeleting = false;\n\t\t}\n\t}\n\n\tasync function handleLogout() {\n\t\tif (confirm('Are you sure you want to logout?')) {\n\t\t\tawait csrfFetch('/api/logout', { method: 'POST' });\n\t\t\tauth.logout();\n\t\t\tgoto('/login');\n\t\t}\n\t}\n\n\t// --- WebAuthn Logic ---\n\n\tfunction getDeviceName() {\n\t\tconst uaData = (navigator as any).userAgentData;\n\t\tif (uaData && uaData.platform) {\n\t\t\tconst brand = (uaData.brands && uaData.brands[0] && uaData.brands[0].brand) || 'Browser';\n\t\t\treturn `${brand} on ${uaData.platform}`;\n\t\t}\n\t\tconst ua = navigator.userAgent || '';\n\t\tif (/Android/i.test(ua)) return 'Android device';\n\t\tif (/Windows/i.test(ua)) return 'Windows device';\n\t\tif (/Mac|Macintosh/i.test(ua)) return 'Mac device';\n\t\tif (/iPhone|iPad/i.test(ua)) return 'iOS device';\n\t\treturn 'Unknown device';\n\t}\n\n\tasync function loadAuthenticators(opts: { silent?: boolean } = { silent: false }) {\n\t\tconst silent = !!opts.silent;\n\t\tconst maxAttempts = 5;\n\t\tlet attempt = 0;\n\n\t\tconst attemptFetch = async (): Promise<boolean> => {\n\t\t\tattempt += 1;\n\t\t\ttry {\n\t\t\t\tconst res = await fetch('/api/auth/webauthn/list', { credentials: 'same-origin' });\n\t\t\t\tif (res.ok) {\n\t\t\t\t\tconst json: any = await res.json();\n\t\t\t\t\tconst auths = json?.authenticators || [];\n\t\t\t\t\tauthenticatorsList = auths;\n\t\t\t\t\tconst match = auths.find((a: any) => a.name === deviceName);\n\t\t\t\t\tif (match) {\n\t\t\t\t\t\tdeviceRegistered = true;\n\t\t\t\t\t\tdeviceCredentialID = match.credentialID;\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tconst raw = localStorage.getItem('passkey:preferred');\n\t\t\t\t\t\t\trememberThisDevice = raw\n\t\t\t\t\t\t\t\t? JSON.parse(raw).credentialID === deviceCredentialID\n\t\t\t\t\t\t\t\t: false;\n\t\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\t\trememberThisDevice = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdeviceRegistered = false;\n\t\t\t\t\t\tdeviceCredentialID = null;\n\t\t\t\t\t\trememberThisDevice = false;\n\t\t\t\t\t}\n\t\t\t\t\tsessionExpired = false;\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t\tif (res.status === 401) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tconst s = await fetch('/api/auth/session', { credentials: 'same-origin' });\n\t\t\t\t\t\tif (s.ok) console.debug('[Passkey] Session endpoint OK; will retry list fetch');\n\t\t\t\t\t} catch (_e) {}\n\n\t\t\t\t\tif (attempt < maxAttempts) {\n\t\t\t\t\t\tawait new Promise((r) => setTimeout(r, 200 * attempt));\n\t\t\t\t\t\treturn attemptFetch();\n\t\t\t\t\t}\n\n\t\t\t\t\tauthenticatorsList = [];\n\t\t\t\t\tdeviceRegistered = false;\n\t\t\t\t\tdeviceCredentialID = null;\n\t\t\t\t\tif (!silent) sessionExpired = true;\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t} catch (e) {\n\t\t\t\tif (attempt < maxAttempts) {\n\t\t\t\t\tawait new Promise((r) => setTimeout(r, 200 * attempt));\n\t\t\t\t\treturn attemptFetch();\n\t\t\t\t}\n\t\t\t\tauthenticatorsList = [];\n\t\t\t\tdeviceRegistered = false;\n\t\t\t\tdeviceCredentialID = null;\n\t\t\t\tif (!silent) sessionExpired = true;\n\t\t\t\treturn false;\n\t\t\t}\n\t\t};\n\t\tawait attemptFetch();\n\t}\n\n\tasync function unregisterThisDevice() {\n\t\tif (!deviceCredentialID) return;\n\t\t// Show sudo mode confirmation dialog instead of browser confirm\n\t\tpendingRemoveCredentialID = deviceCredentialID;\n\t\tpasskeyRemovePassword = '';\n\t\tpasskeyRemoveError = '';\n\t\tshowPasskeyRemoveConfirm = true;\n\t}\n\n\tasync function confirmPasskeyRemoval() {\n\t\tif (!pendingRemoveCredentialID) return;\n\t\tif (!passkeyRemovePassword) {\n\t\t\tpasskeyRemoveError = 'Please enter your password to confirm.';\n\t\t\treturn;\n\t\t}\n\n\t\tunregistering = true;\n\t\tpasskeyRemoveError = '';\n\t\ttry {\n\t\t\tconst res = await csrfFetch('/api/auth/webauthn/delete', {\n\t\t\t\tmethod: 'POST',\n\t\t\t\tcredentials: 'same-origin',\n\t\t\t\theaders: { 'Content-Type': 'application/json' },\n\t\t\t\tbody: JSON.stringify({\n\t\t\t\t\tcredentialID: pendingRemoveCredentialID,\n\t\t\t\t\tpassword: passkeyRemovePassword\n\t\t\t\t})\n\t\t\t});\n\t\t\tconst json: any = await res.json();\n\t\t\tif (!res.ok) {\n\t\t\t\tif (res.status === 401) {\n\t\t\t\t\tif (json?.error === 'Invalid password') {\n\t\t\t\t\t\tpasskeyRemoveError = 'Incorrect password. Please try again.';\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tsessionExpired = true;\n\t\t\t\t\ttoasts.error('Session expired. Please reload or sign in again.');\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (res.status === 403 && json?.requiresPassword) {\n\t\t\t\t\tpasskeyRemoveError = 'Password is required to remove passkeys.';\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthrow new Error(json?.error || 'Failed to unregister');\n\t\t\t}\n\n\t\t\tsessionExpired = false;\n\t\t\tshowPasskeyRemoveConfirm = false;\n\t\t\tpasskeyRemovePassword = '';\n\t\t\tpendingRemoveCredentialID = null;\n\t\t\tdispatch('success', 'This device was unregistered');\n\t\t\ttoasts.success('This device was unregistered');\n\n\t\t\ttry {\n\t\t\t\tconst raw = localStorage.getItem('passkey:preferred');\n\t\t\t\tif (raw && JSON.parse(raw).credentialID === deviceCredentialID) {\n\t\t\t\t\tlocalStorage.removeItem('passkey:preferred');\n\t\t\t\t\trememberThisDevice = false;\n\t\t\t\t\ttoasts.info('Quick sign-in preference removed for this device');\n\t\t\t\t}\n\t\t\t} catch (e) {}\n\n\t\t\tdeviceRegistered = false;\n\t\t\tdeviceCredentialID = null;\n\t\t\tawait loadAuthenticators();\n\t\t} catch (err) {\n\t\t\tconsole.error('[Passkey] Unregister failed', err);\n\t\t\tpasskeyRemoveError = 'Failed to unregister this device.';\n\t\t} finally {\n\t\t\tunregistering = false;\n\t\t}\n\t}\n\n\tfunction cancelPasskeyRemoval() {\n\t\tshowPasskeyRemoveConfirm = false;\n\t\tpasskeyRemovePassword = '';\n\t\tpasskeyRemoveError = '';\n\t\tpendingRemoveCredentialID = null;\n\t}\n\n\tasync function registerPasskey() {\n\t\tregistering = true;\n\t\ttry {\n\t\t\tawait loadAuthenticators({ silent: true });\n\t\t\tconst optionsRes = await fetch('/api/auth/webauthn?type=register', {\n\t\t\t\tcredentials: 'same-origin'\n\t\t\t});\n\t\t\tif (optionsRes.status === 401) {\n\t\t\t\tsessionExpired = true;\n\t\t\t\tthrow new Error('Session expired while fetching registration options');\n\t\t\t} else {\n\t\t\t\tsessionExpired = false;\n\t\t\t}\n\n\t\t\tconst rawText = await optionsRes.text();\n\t\t\tlet optionsJson: any;\n\t\t\ttry {\n\t\t\t\toptionsJson = JSON.parse(rawText);\n\t\t\t} catch (e) {\n\t\t\t\tthrow new Error('Invalid registration options response');\n\t\t\t}\n\t\t\tif (!optionsRes.ok)\n\t\t\t\tthrow new Error(optionsJson?.error || 'Failed to get registration options');\n\n\t\t\tconst options: any = optionsJson;\n\t\t\tif (options.user && options.user.id && typeof options.user.id !== 'string') {\n\t\t\t\t// Convert buffer to base64url if needed (logic simplified for brevity as modern browsers handle this well,\n\t\t\t\t// but keeping structure from original)\n\t\t\t}\n\n\t\t\tconst credential = await startRegistration({ optionsJSON: options as any });\n\n\t\t\tconst verifyRes = await csrfFetch('/api/auth/webauthn?type=register', {\n\t\t\t\tmethod: 'POST',\n\t\t\t\tcredentials: 'same-origin',\n\t\t\t\theaders: { 'Content-Type': 'application/json' },\n\t\t\t\tbody: JSON.stringify({ credential, deviceName })\n\t\t\t});\n\n\t\t\tconst verifyResult: any = await verifyRes.json();\n\t\t\tif (!verifyRes.ok) throw new Error(verifyResult.error || 'Registration failed');\n\n\t\t\tdispatch(\n\t\t\t\t'success',\n\t\t\t\t'Passkey registered successfully! You can now sign in with your fingerprint or face.'\n\t\t\t);\n\t\t\ttoasts.success('Passkey registered successfully!');\n\n\t\t\tif (verifyResult?.authenticator) {\n\t\t\t\tauthenticatorsList = [...(authenticatorsList || []), verifyResult.authenticator];\n\t\t\t\tif (verifyResult.authenticator.name === deviceName) {\n\t\t\t\t\tdeviceRegistered = true;\n\t\t\t\t\tdeviceCredentialID = verifyResult.authenticator.credentialID;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tawait loadAuthenticators();\n\t\t\t}\n\t\t} catch (error: any) {\n\t\t\tconsole.error('[Passkey] Registration error:', error);\n\t\t\tlet message = 'Failed to register passkey';\n\t\t\tif (error.name === 'NotAllowedError') message = 'Registration was cancelled or timed out';\n\t\t\telse if (error.name === 'NotSupportedError')\n\t\t\t\tmessage = 'Your device does not support passkeys';\n\t\t\telse if (error.message) message = error.message;\n\t\t\ttoasts.error(message);\n\t\t} finally {\n\t\t\tregistering = false;\n\t\t}\n\t}\n\n\tonMount(async () => {\n\t\tdeviceName = getDeviceName();\n\t\t// Simple session check before loading\n\t\ttry {\n\t\t\tconst s = await fetch('/api/auth/session', { credentials: 'same-origin' });\n\t\t\tif (s.ok) await loadAuthenticators();\n\t\t\telse sessionExpired = true;\n\t\t} catch (e) {\n\t\t\tsessionExpired = true;\n\t\t}\n\t});\n</script>\n\n<div class=\"card-stack\">\n\t<CollapsibleCard\n\t\ttitle=\"Security\"\n\t\tsubtitle=\"Password and authentication\"\n\t\tstorageKey=\"settings:security\"\n\t>\n\t\t{#snippet icon()}\n\t\t\t<span>\n\t\t\t\t<svg width=\"20\" height=\"20\" viewBox=\"0 0 20 20\" fill=\"none\">\n\t\t\t\t\t<path\n\t\t\t\t\t\td=\"M15 7H14V5C14 3.67392 13.4732 2.40215 12.5355 1.46447C11.5979 0.526784 10.3261 0 9 0C7.67392 0 6.40215 0.526784 5.46447 1.46447C4.52678 2.40215 4 3.67392 4 5V7H3C2.46957 7 1.96086 7.21071 1.58579 7.58579C1.21071 7.96086 1 8.46957 1 9V17C1 17.5304 1.21071 18.0391 1.58579 18.4142C1.96086 18.7893 2.46957 19 3 19H15C15.5304 19 16.0391 18.7893 16.4142 18.4142C16.7893 18.0391 17 17.5304 17 17V9C17 8.46957 16.7893 7.96086 16.4142 7.58579C16.0391 7.21071 15.5304 7 15 7ZM6 5C6 4.20435 6.31607 3.44129 6.87868 2.87868C7.44129 2.31607 8.20435 2 9 2C9.79565 2 10.5587 2.31607 11.1213 2.87868C11.6839 3.44129 12 4.20435 12 5V7H6V5Z\"\n\t\t\t\t\t\tfill=\"currentColor\"\n\t\t\t\t\t/>\n\t\t\t\t</svg>\n\t\t\t</span>\n\t\t{/snippet}\n\n\t\t{#if !showPasswordChange}\n\t\t\t<button class=\"btn-secondary\" on:click={() => (showPasswordChange = true)}\n\t\t\t\t>Change Password</button\n\t\t\t>\n\t\t{:else}\n\t\t\t<div class=\"password-change\">\n\t\t\t\t{#if passwordError}<div class=\"alert error\">{passwordError}</div>{/if}\n\t\t\t\t<div class=\"form-group\">\n\t\t\t\t\t<label for=\"curr-pass\">Current Password</label><input\n\t\t\t\t\t\tid=\"curr-pass\"\n\t\t\t\t\t\ttype=\"password\"\n\t\t\t\t\t\tbind:value={passwordData.current}\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"form-group\">\n\t\t\t\t\t<label for=\"new-pass\">New Password</label><input\n\t\t\t\t\t\tid=\"new-pass\"\n\t\t\t\t\t\ttype=\"password\"\n\t\t\t\t\t\tbind:value={passwordData.new}\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"form-group\">\n\t\t\t\t\t<label for=\"confirm-pass\">Confirm New Password</label><input\n\t\t\t\t\t\tid=\"confirm-pass\"\n\t\t\t\t\t\ttype=\"password\"\n\t\t\t\t\t\tbind:value={passwordData.confirm}\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"button-group\">\n\t\t\t\t\t<button class=\"btn-primary\" on:click={changePassword}>Update</button>\n\t\t\t\t\t<button class=\"btn-secondary\" on:click={() => (showPasswordChange = false)}>Cancel</button\n\t\t\t\t\t>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t{/if}\n\n\t\t<div class=\"divider\"></div>\n\n\t\t<div class=\"passkey-section\">\n\t\t\t<div>\n\t\t\t\t<h3 style=\"font-size: 15px; font-weight: 600; color: #111827; margin-bottom: 4px;\">\n\t\t\t\t\tBiometric Login\n\t\t\t\t</h3>\n\t\t\t\t<p style=\"font-size: 13px; color: #6B7280; margin-bottom: 12px;\">\n\t\t\t\t\tEnable Face ID or Touch ID for faster login.\n\t\t\t\t</p>\n\t\t\t\t<p style=\"font-size: 12px; color: #6B7280; margin-top: 6px;\">\n\t\t\t\t\tThis device: <strong>{deviceName}</strong>{#if deviceRegistered}\n\t\t\t\t\t\tΓÇö <em>Registered</em>{/if}\n\t\t\t\t</p>\n\t\t\t\t{#if sessionExpired}\n\t\t\t\t\t<div class=\"alert warning\" style=\"margin-top:8px;\">\n\t\t\t\t\t\tYour session may have expired. <button\n\t\t\t\t\t\t\tclass=\"linkish\"\n\t\t\t\t\t\t\ton:click={() => location.reload()}>Reload</button\n\t\t\t\t\t\t>\n\t\t\t\t\t\tor <a href=\"/logout\">sign in</a> again to manage passkeys.\n\t\t\t\t\t</div>\n\t\t\t\t{/if}\n\t\t\t</div>\n\n\t\t\t{#if deviceRegistered}\n\t\t\t\t<button\n\t\t\t\t\tclass=\"btn-secondary\"\n\t\t\t\t\ton:click={unregisterThisDevice}\n\t\t\t\t\tdisabled={unregistering || showPasskeyRemoveConfirm}\n\t\t\t\t>\n\t\t\t\t\t<svg\n\t\t\t\t\t\twidth=\"16\"\n\t\t\t\t\t\theight=\"16\"\n\t\t\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\t\t\tfill=\"none\"\n\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\t\tstyle=\"margin-right: 8px;\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<path d=\"M3 6h18M8 6v12a2 2 0 0 0 2 2h4a2 2 0 0 0 2-2V6M10 11v6M14 11v6M9 6V4h6v2\" />\n\t\t\t\t\t</svg>\n\t\t\t\t\t{unregistering ? 'Unregistering...' : 'Unregister This Device'}\n\t\t\t\t</button>\n\n\t\t\t\t{#if showPasskeyRemoveConfirm}\n\t\t\t\t\t<div class=\"delete-confirmation\" style=\"margin-top: 12px;\">\n\t\t\t\t\t\t<p class=\"delete-warning\">To confirm passkey removal, please enter your password:</p>\n\t\t\t\t\t\t<input\n\t\t\t\t\t\t\ttype=\"password\"\n\t\t\t\t\t\t\tbind:value={passkeyRemovePassword}\n\t\t\t\t\t\t\tplaceholder=\"Enter your password\"\n\t\t\t\t\t\t\tclass=\"delete-input\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t{#if passkeyRemoveError}<p class=\"error-text\">{passkeyRemoveError}</p>{/if}\n\n\t\t\t\t\t\t<div class=\"button-group\">\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\tclass=\"btn-delete-confirm\"\n\t\t\t\t\t\t\t\ton:click={confirmPasskeyRemoval}\n\t\t\t\t\t\t\t\tdisabled={unregistering}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{unregistering ? 'Removing...' : 'Confirm Removal'}\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t<button class=\"btn-secondary\" on:click={cancelPasskeyRemoval} disabled={unregistering}\n\t\t\t\t\t\t\t\t>Cancel</button\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t{/if}\n\n\t\t\t\t<div style=\"margin-top: 8px; display:flex; align-items:center; gap:10px;\">\n\t\t\t\t\t<label style=\"display:flex; align-items:center; gap:8px; font-size:13px; color:#374151;\">\n\t\t\t\t\t\t<input\n\t\t\t\t\t\t\ttype=\"checkbox\"\n\t\t\t\t\t\t\tbind:checked={rememberThisDevice}\n\t\t\t\t\t\t\ton:change={() => {\n\t\t\t\t\t\t\t\tif (rememberThisDevice && deviceCredentialID) {\n\t\t\t\t\t\t\t\t\tlocalStorage.setItem(\n\t\t\t\t\t\t\t\t\t\t'passkey:preferred',\n\t\t\t\t\t\t\t\t\t\tJSON.stringify({ credentialID: deviceCredentialID, name: deviceName })\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\ttoasts.success('Quick sign-in enabled on this device');\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tlocalStorage.removeItem('passkey:preferred');\n\t\t\t\t\t\t\t\t\ttoasts.success('Quick sign-in disabled on this device');\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\tRemember this device for quick sign-in\n\t\t\t\t\t</label>\n\t\t\t\t</div>\n\t\t\t{:else}\n\t\t\t\t<button class=\"btn-secondary\" on:click={registerPasskey} disabled={registering}>\n\t\t\t\t\t<svg\n\t\t\t\t\t\twidth=\"16\"\n\t\t\t\t\t\theight=\"16\"\n\t\t\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\t\t\tfill=\"none\"\n\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\t\tstyle=\"margin-right: 8px;\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<path\n\t\t\t\t\t\t\td=\"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</svg>\n\t\t\t\t\t{registering ? 'Registering...' : 'Register Device'}\n\t\t\t\t</button>\n\t\t\t{/if}\n\t\t</div>\n\t</CollapsibleCard>\n\n\t<CollapsibleCard\n\t\ttitle=\"Account Actions\"\n\t\tsubtitle=\"Sign out or delete account\"\n\t\tstorageKey=\"settings:account-actions\"\n\t>\n\t\t{#snippet icon()}\n\t\t\t<span>\n\t\t\t\t<svg width=\"20\" height=\"20\" viewBox=\"0 0 20 20\" fill=\"none\">\n\t\t\t\t\t<path\n\t\t\t\t\t\td=\"M7 17H3C2.46957 17 1.96086 16.7893 1.58579 16.4142C1.21071 16.0391 1 15.5304 1 15V3C1 2.46957 1.21071 1.96086 1.58579 1.58579C1.96086 1.21071 2.46957 1 3 1H7M13 13L17 9M17 9L13 5M17 9H7\"\n\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\t\t\tstroke-linejoin=\"round\"\n\t\t\t\t\t/>\n\t\t\t\t</svg>\n\t\t\t</span>\n\t\t{/snippet}\n\t\t<div>\n\t\t\t<h2 class=\"card-title\">Account Actions</h2>\n\t\t\t<p class=\"card-subtitle\">Sign out or delete account</p>\n\t\t</div>\n\n\t\t<div class=\"danger-actions\">\n\t\t\t<button class=\"btn-logout\" on:click={handleLogout}>Logout</button>\n\n\t\t\t{#if !showDeleteConfirm}\n\t\t\t\t<button class=\"btn-delete\" on:click={() => (showDeleteConfirm = true)}\n\t\t\t\t\t>Delete Account</button\n\t\t\t\t>\n\t\t\t{:else}\n\t\t\t\t<div class=\"delete-confirmation\">\n\t\t\t\t\t<p class=\"delete-warning\">To verify, please enter your password:</p>\n\t\t\t\t\t<input\n\t\t\t\t\t\ttype=\"password\"\n\t\t\t\t\t\tbind:value={deletePassword}\n\t\t\t\t\t\tplaceholder=\"Enter your password\"\n\t\t\t\t\t\tclass=\"delete-input\"\n\t\t\t\t\t/>\n\t\t\t\t\t{#if deleteError}<p class=\"error-text\">{deleteError}</p>{/if}\n\n\t\t\t\t\t<div class=\"button-group\">\n\t\t\t\t\t\t<button class=\"btn-delete-confirm\" on:click={handleDeleteAccount} disabled={isDeleting}>\n\t\t\t\t\t\t\t{isDeleting ? 'Deleting...' : 'Permanently Delete Account'}\n\t\t\t\t\t\t</button>\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tclass=\"btn-secondary\"\n\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\tshowDeleteConfirm = false;\n\t\t\t\t\t\t\t\tdeletePassword = '';\n\t\t\t\t\t\t\t\tdeleteError = '';\n\t\t\t\t\t\t\t}}>Cancel</button\n\t\t\t\t\t\t>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t{/if}\n\t\t</div>\n\t</CollapsibleCard>\n</div>\n\n<style>\n\t.card-title {\n\t\tfont-size: 18px;\n\t\tfont-weight: 700;\n\t\tcolor: #111827;\n\t\tmargin-bottom: 4px;\n\t}\n\t.card-subtitle {\n\t\tfont-size: 14px;\n\t\tcolor: #6b7280;\n\t}\n\t.form-group {\n\t\tmargin-bottom: 20px;\n\t}\n\t.form-group label {\n\t\tdisplay: block;\n\t\tfont-size: 14px;\n\t\tfont-weight: 600;\n\t\tcolor: #374151;\n\t\tmargin-bottom: 8px;\n\t}\n\t.form-group input {\n\t\twidth: 100%;\n\t\tmax-width: 450px;\n\t\tpadding: 12px 16px;\n\t\tborder: 2px solid #e5e7eb;\n\t\tborder-radius: 10px;\n\t\tfont-size: 16px;\n\t\tdisplay: block;\n\t\tbox-sizing: border-box;\n\t}\n\t.btn-primary {\n\t\tbackground: linear-gradient(135deg, var(--orange, #ff6a3d) 0%, #ff6a3d 100%);\n\t\tcolor: white;\n\t\tborder: none;\n\t\twidth: 100%;\n\t\tpadding: 14px;\n\t\tborder-radius: 10px;\n\t\tfont-weight: 600;\n\t\tcursor: pointer;\n\t}\n\t.btn-secondary {\n\t\tbackground: white;\n\t\tcolor: #374151;\n\t\tborder: 2px solid #e5e7eb;\n\t\twidth: 100%;\n\t\tpadding: 14px;\n\t\tborder-radius: 10px;\n\t\tfont-weight: 600;\n\t\tcursor: pointer;\n\t}\n\t.btn-logout {\n\t\tbackground: white;\n\t\tcolor: #dc2626;\n\t\tborder: 2px solid #fee2e2;\n\t\twidth: 100%;\n\t\tpadding: 14px;\n\t\tborder-radius: 10px;\n\t\tfont-weight: 600;\n\t\tcursor: pointer;\n\t}\n\t.btn-delete {\n\t\tbackground: transparent;\n\t\tcolor: #dc2626;\n\t\tborder: none;\n\t\tmargin-top: 12px;\n\t\tfont-size: 14px;\n\t\ttext-decoration: underline;\n\t\tcursor: pointer;\n\t}\n\t.delete-confirmation {\n\t\tmargin-top: 16px;\n\t\tpadding: 16px;\n\t\tbackground: white;\n\t\tborder-radius: 10px;\n\t\tborder: 1px solid #fecaca;\n\t}\n\t.delete-input {\n\t\twidth: 100%;\n\t\tpadding: 10px;\n\t\tborder: 1px solid #e5e7eb;\n\t\tborder-radius: 8px;\n\t\tmargin-bottom: 12px;\n\t}\n\t.btn-delete-confirm {\n\t\tbackground: #dc2626;\n\t\tcolor: white;\n\t\tborder: none;\n\t\tmargin-bottom: 8px;\n\t\twidth: 100%;\n\t\tpadding: 14px;\n\t\tborder-radius: 10px;\n\t\tfont-weight: 600;\n\t}\n\t.alert {\n\t\tpadding: 14px 20px;\n\t\tborder-radius: 12px;\n\t\tfont-size: 14px;\n\t\tfont-weight: 500;\n\t\tmargin-bottom: 24px;\n\t}\n\t.alert.error {\n\t\tbackground: #fef2f2;\n\t\tcolor: #991b1b;\n\t\tborder: 1px solid #fecaca;\n\t}\n\t.alert.warning {\n\t\tbackground: #fff7ed;\n\t\tcolor: #c2410c;\n\t\tborder: 1px solid #fed7aa;\n\t}\n\t.card-stack {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tgap: 24px;\n\t}\n\n\t.divider {\n\t\theight: 1px;\n\t\tbackground: #e5e7eb;\n\t\tmargin: 24px 0;\n\t}\n\t.button-group {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tgap: 8px;\n\t}\n\t.linkish {\n\t\tbackground: none;\n\t\tborder: none;\n\t\tcolor: var(--orange, #ff6a3d);\n\t\ttext-decoration: underline;\n\t\tcursor: pointer;\n\t\tpadding: 0;\n\t\tfont: inherit;\n\t}\n</style>\n",
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\dashboard\\settings\\lib\\export-utils-pdf.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\dashboard\\settings\\lib\\export-utils.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\dashboard\\settings\\lib\\save-settings.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\dashboard\\trash\\+page.svelte",
		"messages": [
			{
				"ruleId": "svelte/no-navigation-without-resolve",
				"severity": 1,
				"message": "Unexpected goto() call without resolve().",
				"line": 303,
				"column": 56,
				"nodeType": null,
				"messageId": "gotoWithoutResolve",
				"endLine": 303,
				"endColumn": 86
			},
			{
				"ruleId": "svelte/no-navigation-without-resolve",
				"severity": 1,
				"message": "Unexpected goto() call without resolve().",
				"line": 307,
				"column": 56,
				"nodeType": null,
				"messageId": "gotoWithoutResolve",
				"endLine": 307,
				"endColumn": 85
			},
			{
				"ruleId": "svelte/no-navigation-without-resolve",
				"severity": 1,
				"message": "Unexpected goto() call without resolve().",
				"line": 311,
				"column": 56,
				"nodeType": null,
				"messageId": "gotoWithoutResolve",
				"endLine": 311,
				"endColumn": 83
			}
		],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 3,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"source": "<script lang=\"ts\">\n\timport { onMount, onDestroy } from 'svelte';\n\timport { page } from '$app/stores';\n\timport { trash } from '$lib/stores/trash';\n\timport { goto } from '$app/navigation';\n\timport { base } from '$app/paths';\n\timport { user } from '$lib/stores/auth';\n\timport { getDB } from '$lib/db/indexedDB';\n\timport type { TrashRecord } from '$lib/db/types';\n\timport { get } from 'svelte/store';\n\timport { userSettings } from '$lib/stores/userSettings';\n\timport { getVehicleDisplayName } from '$lib/utils/vehicle';\n\timport { SvelteSet, SvelteDate } from '$lib/utils/svelte-reactivity';\n\n\tconst resolve = (href: string) => `${base}${href}`;\n\n\t// Known user-friendly error messages that are safe to display\n\tconst KNOWN_RESTORE_ERROR_MESSAGES = [\n\t\t'Item not found in trash',\n\t\t'Unauthorized',\n\t\t'The parent Trip is currently in the Trash. Please restore the Trip first.',\n\t\t'This mileage log belongs to a trip that has been permanently deleted. It cannot be restored.'\n\t];\n\n\tlet trashedTrips: TrashRecord[] = [];\n\tlet loading = true;\n\tlet restoring = new SvelteSet<string>();\n\tlet deleting = new SvelteSet<string>();\n\tlet currentTypeParam: string | null = null;\n\tlet _pageUnsub: (() => void) | null = null;\n\n\tonMount(() => {\n\t\tconst params = new URLSearchParams(window.location.search);\n\t\tconst typeParam = params.get('type');\n\t\tconst type =\n\t\t\ttypeParam === 'expenses' ? 'expense' : typeParam === 'mileage' ? 'mileage' : undefined;\n\n\t\t// 1. Load Local\n\t\tloadTrash(type).catch(console.error);\n\n\t\t// 2. [!code fix] Force Cloud Sync on Mount\n\t\tconst userState = get(user);\n\t\t// [!code fix] Strictly use ID.\n\t\tconst userId =\n\t\t\tuserState?.id ||\n\t\t\t(typeof localStorage !== 'undefined' ? localStorage.getItem('offline_user_id') : null);\n\n\t\tif (userId) {\n\t\t\ttrash.syncFromCloud(userId, typeParam || undefined).then(() => loadTrash(type));\n\t\t}\n\n\t\t// Subscribe to page changes\n\t\t_pageUnsub = page.subscribe(async ($p) => {\n\t\t\tconst param = $p.url.searchParams.get('type');\n\t\t\tif (param !== currentTypeParam) {\n\t\t\t\tcurrentTypeParam = param;\n\t\t\t\tconst type = param === 'expenses' ? 'expense' : param === 'mileage' ? 'mileage' : undefined;\n\t\t\t\tloading = true;\n\t\t\t\ttry {\n\t\t\t\t\tawait loadTrash(type);\n\t\t\t\t\tconst userState = get(user);\n\t\t\t\t\t// [!code fix] Strictly use ID.\n\t\t\t\t\tconst userId =\n\t\t\t\t\t\tuserState?.id ||\n\t\t\t\t\t\t(typeof localStorage !== 'undefined' ? localStorage.getItem('offline_user_id') : null);\n\n\t\t\t\t\tif (userId) {\n\t\t\t\t\t\tawait trash.syncFromCloud(userId, param || undefined);\n\t\t\t\t\t\tawait loadTrash(type);\n\t\t\t\t\t}\n\t\t\t\t} catch (err) {\n\t\t\t\t\tconsole.error('Failed to refresh trash for type change', err);\n\t\t\t\t} finally {\n\t\t\t\t\tloading = false;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t});\n\n\tonDestroy(() => {\n\t\tif (typeof _pageUnsub === 'function') _pageUnsub();\n\t});\n\n\tasync function loadTrash(type?: string) {\n\t\tloading = true;\n\t\ttry {\n\t\t\tlet potentialIds = new SvelteSet<string>();\n\t\t\t// [!code fix] Strictly use ID.\n\t\t\tif ($user?.id) potentialIds = potentialIds.add($user.id);\n\n\t\t\tconst offlineId =\n\t\t\t\ttypeof localStorage !== 'undefined' ? localStorage.getItem('offline_user_id') : null;\n\t\t\tif (offlineId) potentialIds = potentialIds.add(offlineId);\n\n\t\t\tconst db = await getDB();\n\t\t\tconst tx = db.transaction('trash', 'readonly');\n\t\t\tconst index = tx.objectStore('trash').index('userId');\n\n\t\t\tlet allItems: any[] = [];\n\t\t\tfor (const id of potentialIds) {\n\t\t\t\tconst items = await index.getAll(id);\n\t\t\t\tallItems = [...allItems, ...items];\n\t\t\t}\n\n\t\t\t// Normalize/Flatten\n\t\t\tconst uniqueItems = Array.from(\n\t\t\t\tnew Map(\n\t\t\t\t\tallItems.map((item) => {\n\t\t\t\t\t\tlet flat = { ...item };\n\t\t\t\t\t\tif (flat.data && typeof flat.data === 'object') {\n\t\t\t\t\t\t\tflat = { ...flat.data, ...flat };\n\t\t\t\t\t\t\tdelete flat.data;\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn [flat.id, flat];\n\t\t\t\t\t})\n\t\t\t\t).values()\n\t\t\t);\n\n\t\t\tconst effectiveType =\n\t\t\t\ttype ??\n\t\t\t\t(currentTypeParam === 'expenses'\n\t\t\t\t\t? 'expense'\n\t\t\t\t\t: currentTypeParam === 'mileage'\n\t\t\t\t\t\t? 'mileage'\n\t\t\t\t\t\t: undefined);\n\n\t\t\tconst filtered = uniqueItems.filter((it: any) => {\n\t\t\t\tconst recordTypes = Array.isArray(it.recordTypes)\n\t\t\t\t\t? it.recordTypes\n\t\t\t\t\t: it.recordType\n\t\t\t\t\t\t? [it.recordType]\n\t\t\t\t\t\t: [];\n\n\t\t\t\tif (recordTypes.length > 0) {\n\t\t\t\t\t// If viewing 'all', show everything; otherwise include items whose recordTypes include the view\n\t\t\t\t\tif (!type && !currentTypeParam) return true;\n\t\t\t\t\treturn recordTypes.includes(effectiveType as any);\n\t\t\t\t}\n\n\t\t\t\t// Fallback: infer from key or shape\n\t\t\t\tconst inferredFromKey =\n\t\t\t\t\tit.recordType ||\n\t\t\t\t\tit.type ||\n\t\t\t\t\t(it.originalKey &&\n\t\t\t\t\t\t(it.originalKey.startsWith('expense:')\n\t\t\t\t\t\t\t? 'expense'\n\t\t\t\t\t\t\t: it.originalKey.startsWith('mileage:')\n\t\t\t\t\t\t\t\t? 'mileage'\n\t\t\t\t\t\t\t\t: 'trip')) ||\n\t\t\t\t\t'trip';\n\t\t\t\tconst hasMileageShape = typeof it.miles === 'number' || Boolean(it.vehicle);\n\t\t\t\tconst inferred = hasMileageShape ? 'mileage' : inferredFromKey;\n\t\t\t\treturn inferred === effectiveType;\n\t\t\t});\n\t\t\tfiltered.sort(\n\t\t\t\t(a, b) =>\n\t\t\t\t\tSvelteDate.from(b.deletedAt || 0).getTime() - SvelteDate.from(a.deletedAt || 0).getTime()\n\t\t\t);\n\t\t\ttrashedTrips = filtered;\n\t\t} catch (err) {\n\t\t\tconsole.error('Error loading trash:', err);\n\t\t} finally {\n\t\t\tloading = false;\n\t\t}\n\t}\n\n\tasync function restoreTrip(id: string) {\n\t\tif (restoring.has(id)) return;\n\t\tconst item = trashedTrips.find((t) => t.id === id);\n\t\tif (!item) return;\n\n\t\trestoring = restoring.add(id);\n\n\t\ttry {\n\t\t\t// Prefer current view when restoring ambiguous/merged tombstones\n\t\t\tconst displayType =\n\t\t\t\tcurrentTypeParam === 'expenses'\n\t\t\t\t\t? 'expense'\n\t\t\t\t\t: currentTypeParam === 'mileage'\n\t\t\t\t\t\t? 'mileage'\n\t\t\t\t\t\t: Array.isArray((item as any).recordTypes) && (item as any).recordTypes.length\n\t\t\t\t\t\t\t? (item as any).recordTypes[0]\n\t\t\t\t\t\t\t: (item as any).recordType ||\n\t\t\t\t\t\t\t\t(item as any).type ||\n\t\t\t\t\t\t\t\t(typeof (item as any).miles === 'number' ? 'mileage' : 'trip');\n\n\t\t\t// Actually restore the item from trash (this calls updateLocal internally)\n\t\t\tawait trash.restore(id, item.userId, displayType);\n\n\t\t\t// PERFORMANCE: No need to reload stores - updateLocal already updated them optimistically\n\t\t\t// Just reload trash to remove the restored item from trash view\n\t\t\tawait loadTrash();\n\t\t} catch (err) {\n\t\t\t// Only show known user-friendly error messages, fallback to generic for unknown errors\n\t\t\tconst errorMessage = err instanceof Error ? err.message : '';\n\t\t\tconst message = KNOWN_RESTORE_ERROR_MESSAGES.includes(errorMessage)\n\t\t\t\t? errorMessage\n\t\t\t\t: 'Failed to restore item.';\n\t\t\talert(message);\n\t\t} finally {\n\t\t\trestoring = restoring.delete(id);\n\t\t}\n\t}\n\n\tasync function restoreAll() {\n\t\tif (trashedTrips.length === 0) return;\n\t\tif (!confirm(`Are you sure you want to restore all ${trashedTrips.length} items?`)) return;\n\n\t\tloading = true;\n\t\ttry {\n\t\t\tfor (const trip of trashedTrips) {\n\t\t\t\tconst displayType =\n\t\t\t\t\tcurrentTypeParam === 'expenses'\n\t\t\t\t\t\t? 'expense'\n\t\t\t\t\t\t: currentTypeParam === 'mileage'\n\t\t\t\t\t\t\t? 'mileage'\n\t\t\t\t\t\t\t: Array.isArray((trip as any).recordTypes) && (trip as any).recordTypes.length\n\t\t\t\t\t\t\t\t? (trip as any).recordTypes[0]\n\t\t\t\t\t\t\t\t: (trip as any).recordType ||\n\t\t\t\t\t\t\t\t\t(trip as any).type ||\n\t\t\t\t\t\t\t\t\t(typeof (trip as any).miles === 'number' ? 'mileage' : 'trip');\n\t\t\t\tawait trash.restore(trip.id, trip.userId, displayType);\n\t\t\t}\n\t\t\t// PERFORMANCE: No need to reload stores - updateLocal already updated them\n\t\t\tawait loadTrash();\n\t\t} catch (err) {\n\t\t\t// Only show known user-friendly error messages, fallback to generic for unknown errors\n\t\t\tconst errorMessage = err instanceof Error ? err.message : '';\n\t\t\tconst message = KNOWN_RESTORE_ERROR_MESSAGES.includes(errorMessage)\n\t\t\t\t? errorMessage\n\t\t\t\t: 'Failed to restore some items.';\n\t\t\talert(message);\n\t\t} finally {\n\t\t\tloading = false;\n\t\t}\n\t}\n\n\tasync function permanentDelete(id: string) {\n\t\tif (!confirm('Permanently delete this item? Cannot be undone.')) return;\n\n\t\tif (deleting.has(id)) return;\n\t\tdeleting = deleting.add(id);\n\n\t\ttry {\n\t\t\tawait trash.permanentDelete(id);\n\t\t\tawait loadTrash();\n\t\t} catch {\n\t\t\talert('Failed to delete item.');\n\t\t} finally {\n\t\t\tdeleting = deleting.delete(id);\n\t\t}\n\t}\n\n\tasync function emptyTrash() {\n\t\tif (!confirm('Permanently delete ALL items? Cannot be undone.')) return;\n\t\ttry {\n\t\t\tconst uniqueUserIds = new Set(trashedTrips.map((t) => t.userId));\n\t\t\tfor (const uid of uniqueUserIds) {\n\t\t\t\tawait trash.emptyTrash(uid);\n\t\t\t}\n\t\t\tawait loadTrash();\n\t\t} catch {\n\t\t\talert('Failed to empty trash.');\n\t\t}\n\t}\n\n\tfunction formatDate(dateString: string | undefined): string {\n\t\tif (!dateString) return 'Unknown';\n\t\treturn SvelteDate.from(dateString).toLocaleDateString('en-US', {\n\t\t\tmonth: 'short',\n\t\t\tday: 'numeric',\n\t\t\tyear: 'numeric'\n\t\t});\n\t}\n\n\tfunction getDaysUntilExpiration(expiresAt: string | undefined): number {\n\t\tif (!expiresAt) return 0;\n\t\tconst nowMs = SvelteDate.now().getTime();\n\t\tconst expiresMs = SvelteDate.from(expiresAt).getTime();\n\t\tconst diff = expiresMs - nowMs;\n\t\treturn Math.ceil(diff / (1000 * 60 * 60 * 24));\n\t}\n</script>\n\n<svelte:head>\n\t<title>Trash - Go Route Yourself</title>\n</svelte:head>\n\n<div class=\"trash-page\">\n\t<div class=\"page-header\">\n\t\t<div>\n\t\t\t<h1 class=\"page-title\">Trash</h1>\n\t\t\t<p class=\"page-subtitle\">Items deleted > 30 days ago are removed automatically</p>\n\t\t</div>\n\n\t\t<div class=\"header-actions\">\n\t\t\t{#if trashedTrips.length > 0}\n\t\t\t\t<button class=\"btn-success\" on:click={restoreAll}> Restore All </button>\n\t\t\t\t<button class=\"btn-danger\" on:click={emptyTrash}> Empty Trash </button>\n\t\t\t{/if}\n\n\t\t\t{#if currentTypeParam === 'expenses'}\n\t\t\t\t<button class=\"btn-secondary\" on:click={() => goto(resolve('/dashboard/expenses'))}>\n\t\t\t\t\tBack to Expenses\n\t\t\t\t</button>\n\t\t\t{:else if currentTypeParam === 'mileage'}\n\t\t\t\t<button class=\"btn-secondary\" on:click={() => goto(resolve('/dashboard/mileage'))}>\n\t\t\t\t\tBack to Mileage\n\t\t\t\t</button>\n\t\t\t{:else}\n\t\t\t\t<button class=\"btn-secondary\" on:click={() => goto(resolve('/dashboard/trips'))}>\n\t\t\t\t\tBack to Trips\n\t\t\t\t</button>\n\t\t\t{/if}\n\t\t</div>\n\t</div>\n\n\t{#if loading}\n\t\t<div class=\"loading\">Loading trash...</div>\n\t{:else if trashedTrips.length === 0}\n\t\t<div class=\"empty-state\">\n\t\t\t<h2>Trash is empty</h2>\n\t\t</div>\n\t{:else}\n\t\t<div class=\"trash-list\">\n\t\t\t{#each trashedTrips as trip (trip.id)}\n\t\t\t\t{@const t = trip as TrashRecord}\n\t\t\t\t{@const expiresAt =\n\t\t\t\t\t(t['expiresAt'] as string | undefined) ||\n\t\t\t\t\t((t['metadata'] as any)?.expiresAt as string | undefined)}\n\t\t\t\t{@const deletedAt =\n\t\t\t\t\t(t['deletedAt'] as string | undefined) ||\n\t\t\t\t\t((t['metadata'] as any)?.deletedAt as string | undefined)}\n\t\t\t\t{@const daysLeft = getDaysUntilExpiration(expiresAt)}\n\n\t\t\t\t{@const displayType =\n\t\t\t\t\tcurrentTypeParam === 'expenses'\n\t\t\t\t\t\t? 'expense'\n\t\t\t\t\t\t: currentTypeParam === 'mileage'\n\t\t\t\t\t\t\t? 'mileage'\n\t\t\t\t\t\t\t: Array.isArray(t['recordTypes']) && t['recordTypes'].length\n\t\t\t\t\t\t\t\t? t['recordTypes'][0]\n\t\t\t\t\t\t\t\t: t['recordType'] ||\n\t\t\t\t\t\t\t\t\tt['type'] ||\n\t\t\t\t\t\t\t\t\t(typeof t['miles'] === 'number' ? 'mileage' : 'trip')}\n\n\t\t\t\t{@const isExpense = displayType === 'expense'}\n\t\t\t\t{@const isMileage = displayType === 'mileage'}\n\t\t\t\t{@const rawVehicleName = getVehicleDisplayName(\n\t\t\t\t\ttrip['vehicle'] as string | undefined,\n\t\t\t\t\t$userSettings?.vehicles\n\t\t\t\t)}\n\t\t\t\t{@const vehicleDisplay =\n\t\t\t\t\trawVehicleName && rawVehicleName !== '-' && rawVehicleName !== 'Unknown vehicle'\n\t\t\t\t\t\t? rawVehicleName\n\t\t\t\t\t\t: null}\n\t\t\t\t{@const mileageLogDate = trip.date || trip.createdAt}\n\n\t\t\t\t<div class=\"trash-item\">\n\t\t\t\t\t<div class=\"trip-info\">\n\t\t\t\t\t\t<div class=\"trip-header\">\n\t\t\t\t\t\t\t<h3 class=\"trip-title\">\n\t\t\t\t\t\t\t\t{#if isExpense}\n\t\t\t\t\t\t\t\t\t<span class=\"badge-expense\">Expense</span>\n\t\t\t\t\t\t\t\t\t<span class=\"expense-category\">{trip.category || 'Uncategorized'}</span>\n\t\t\t\t\t\t\t\t{:else if isMileage}\n\t\t\t\t\t\t\t\t\t<span class=\"badge-mileage\">Mileage</span>\n\t\t\t\t\t\t\t\t\t{vehicleDisplay\n\t\t\t\t\t\t\t\t\t\t? vehicleDisplay\n\t\t\t\t\t\t\t\t\t\t: mileageLogDate\n\t\t\t\t\t\t\t\t\t\t\t? formatDate(mileageLogDate)\n\t\t\t\t\t\t\t\t\t\t\t: 'Mileage Log'}\n\t\t\t\t\t\t\t\t{:else}\n\t\t\t\t\t\t\t\t\t<span class=\"badge-trip\">Trip</span>\n\t\t\t\t\t\t\t\t\t{typeof trip.startAddress === 'string'\n\t\t\t\t\t\t\t\t\t\t? trip.startAddress.split(',')[0]\n\t\t\t\t\t\t\t\t\t\t: 'Unknown Trip'}\n\t\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t\t</h3>\n\t\t\t\t\t\t\t<div class=\"trip-meta\">\n\t\t\t\t\t\t\t\t<span class=\"deleted-date\">Deleted {formatDate(deletedAt)}</span>\n\t\t\t\t\t\t\t\t<span class=\"expiration\" class:warning={daysLeft <= 7}>\n\t\t\t\t\t\t\t\t\t{daysLeft} days left\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class=\"trip-details\">\n\t\t\t\t\t\t\t{#if isExpense}\n\t\t\t\t\t\t\t\t<span class=\"detail amount\">${Number(trip.amount || 0).toFixed(2)}</span>\n\t\t\t\t\t\t\t\t{#if trip.description}<span class=\"detail\">{trip.description}</span>{/if}\n\t\t\t\t\t\t\t\t<span class=\"detail\"\n\t\t\t\t\t\t\t\t\t>{new Date(trip.date || trip.createdAt || '').toLocaleDateString()}</span\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{:else if isMileage}\n\t\t\t\t\t\t\t\t<span class=\"detail\"\n\t\t\t\t\t\t\t\t\t>{new Date(trip.date || trip.createdAt || '').toLocaleDateString()}</span\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<span class=\"detail amount\">{Number(trip['miles'] || 0).toFixed(2)} mi</span>\n\t\t\t\t\t\t\t\t{#if trip.notes}<span class=\"detail\">{trip.notes}</span>{/if}\n\t\t\t\t\t\t\t{:else}\n\t\t\t\t\t\t\t\t<span class=\"detail\"\n\t\t\t\t\t\t\t\t\t>{new Date(trip.date || trip.createdAt || '').toLocaleDateString()}</span\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<span class=\"detail\">{trip.stops?.length || 0} stops</span>\n\t\t\t\t\t\t\t\t{#if trip.totalMiles}<span class=\"detail\"\n\t\t\t\t\t\t\t\t\t\t>{Number(trip.totalMiles).toFixed(1)} mi</span\n\t\t\t\t\t\t\t\t\t>{/if}\n\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\"trip-actions\">\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tclass=\"btn-restore-item\"\n\t\t\t\t\t\t\ton:click={() => restoreTrip(trip.id)}\n\t\t\t\t\t\t\tdisabled={restoring.has(trip.id)}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{restoring.has(trip.id) ? 'Restoring...' : 'Restore'}\n\t\t\t\t\t\t</button>\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tclass=\"btn-delete-item\"\n\t\t\t\t\t\t\ton:click={() => permanentDelete(trip.id)}\n\t\t\t\t\t\t\tdisabled={deleting.has(trip.id)}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\tDelete\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t{/each}\n\t\t</div>\n\t{/if}\n</div>\n\n<style>\n\t/* Add this new style for mileage badges */\n\t.badge-mileage {\n\t\tbackground-color: #d1fae5;\n\t\tcolor: #065f46;\n\t\tfont-size: 0.8em;\n\t\tpadding: 2px 6px;\n\t\tborder-radius: 4px;\n\t\tmargin-right: 6px;\n\t\tvertical-align: middle;\n\t\tfont-weight: 600;\n\t}\n\t.badge-trip {\n\t\tbackground-color: #dbeafe;\n\t\tcolor: #1e40af;\n\t\tfont-size: 0.8em;\n\t\tpadding: 2px 6px;\n\t\tborder-radius: 4px;\n\t\tmargin-right: 6px;\n\t\tvertical-align: middle;\n\t\tfont-weight: 600;\n\t}\n\t/* Keep existing styles */\n\t.trash-page {\n\t\tpadding: 16px;\n\t\tmax-width: 1200px;\n\t\tmargin: 0 auto;\n\t}\n\t.page-header {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tgap: 16px;\n\t\tmargin-bottom: 24px;\n\t}\n\t.page-title {\n\t\tfont-size: 24px;\n\t\tfont-weight: 800;\n\t\tcolor: #111827;\n\t\tmargin: 0 0 4px 0;\n\t}\n\t.page-subtitle {\n\t\tfont-size: 14px;\n\t\tcolor: #6b7280;\n\t\tmargin: 0;\n\t\tline-height: 1.4;\n\t}\n\t.header-actions {\n\t\tdisplay: flex;\n\t\tgap: 12px;\n\t\twidth: 100%;\n\t}\n\n\t.btn-danger,\n\t.btn-success,\n\t.btn-secondary {\n\t\tdisplay: inline-flex;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t\tgap: 6px;\n\t\tpadding: 10px 16px;\n\t\tborder: none;\n\t\tborder-radius: 8px;\n\t\tfont-weight: 600;\n\t\tfont-size: 14px;\n\t\tcursor: pointer;\n\t\ttransition: all 0.2s;\n\t\tflex: 1;\n\t\ttext-decoration: none;\n\t}\n\t.btn-danger {\n\t\tbackground: #dc2626;\n\t\tcolor: white;\n\t\tbox-shadow: 0 2px 8px rgba(220, 38, 38, 0.3);\n\t}\n\t.btn-danger:hover {\n\t\tbackground: #b91c1c;\n\t}\n\t.btn-success {\n\t\tbackground: linear-gradient(135deg, #10b981 0%, #059669 100%);\n\t\tcolor: white;\n\t\tbox-shadow: 0 2px 8px rgba(16, 185, 129, 0.3);\n\t}\n\t.btn-success:hover {\n\t\tfilter: brightness(1.1);\n\t}\n\t.btn-secondary {\n\t\tbackground: white;\n\t\tcolor: #374151;\n\t\tborder: 1px solid #e5e7eb;\n\t\tbox-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);\n\t}\n\t.btn-secondary:hover {\n\t\tbackground: #f9fafb;\n\t\tborder-color: #d1d5db;\n\t}\n\n\t.trash-list {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tgap: 16px;\n\t}\n\t.trash-item {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tgap: 16px;\n\t\tpadding: 16px;\n\t\tbackground: white;\n\t\tborder: 1px solid #e5e7eb;\n\t\tborder-radius: 12px;\n\t\ttransition: all 0.2s;\n\t}\n\t.trip-info {\n\t\tflex: 1;\n\t}\n\t.trip-title {\n\t\tfont-size: 16px;\n\t\tfont-weight: 700;\n\t\tcolor: #111827;\n\t\tmargin: 0 0 8px 0;\n\t\tline-height: 1.3;\n\t}\n\t.trip-meta {\n\t\tdisplay: flex;\n\t\tgap: 12px;\n\t\tfont-size: 12px;\n\t\tflex-wrap: wrap;\n\t}\n\t.deleted-date {\n\t\tcolor: #6b7280;\n\t}\n\t.expiration {\n\t\tcolor: #10b981;\n\t\tfont-weight: 600;\n\t}\n\t.expiration.warning {\n\t\tcolor: #f59e0b;\n\t}\n\n\t.trip-details {\n\t\tdisplay: flex;\n\t\tgap: 12px;\n\t\tmargin-top: 8px;\n\t\tfont-size: 13px;\n\t\tcolor: #6b7280;\n\t\tflex-wrap: wrap;\n\t}\n\t.detail {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tbackground: #f3f4f6;\n\t\tpadding: 2px 8px;\n\t\tborder-radius: 4px;\n\t}\n\n\t.trip-actions {\n\t\tdisplay: grid;\n\t\tgrid-template-columns: 1fr 1fr;\n\t\tgap: 12px;\n\t\twidth: 100%;\n\t}\n\t.btn-restore-item,\n\t.btn-delete-item {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t\tgap: 6px;\n\t\tpadding: 10px 16px;\n\t\tborder-radius: 8px;\n\t\tfont-size: 14px;\n\t\tfont-weight: 600;\n\t\tcursor: pointer;\n\t\tborder: none;\n\t\ttransition: all 0.2s;\n\t}\n\t.btn-restore-item {\n\t\tbackground: #dcfce7;\n\t\tcolor: #166534;\n\t}\n\t.btn-delete-item {\n\t\tbackground: #fef2f2;\n\t\tcolor: #dc2626;\n\t}\n\n\t.empty-state {\n\t\ttext-align: center;\n\t\tpadding: 40px 20px;\n\t}\n\n\t.badge-expense {\n\t\tbackground-color: #dbeafe;\n\t\tcolor: #1e40af;\n\t\tfont-size: 0.8em;\n\t\tpadding: 2px 6px;\n\t\tborder-radius: 4px;\n\t\tmargin-right: 6px;\n\t\tvertical-align: middle;\n\t\tfont-weight: 600;\n\t}\n\t.expense-category {\n\t\ttext-transform: capitalize;\n\t}\n\t.amount {\n\t\tcolor: #111827;\n\t\tfont-weight: 700;\n\t}\n\n\t@media (min-width: 640px) {\n\t\t.page-header {\n\t\t\tflex-direction: row;\n\t\t\talign-items: flex-start;\n\t\t\tjustify-content: space-between;\n\t\t}\n\t\t.header-actions {\n\t\t\twidth: auto;\n\t\t}\n\t\t.trash-item {\n\t\t\tflex-direction: row;\n\t\t\talign-items: center;\n\t\t}\n\t\t.trip-actions {\n\t\t\twidth: auto;\n\t\t\tdisplay: flex;\n\t\t}\n\t\t.btn-danger,\n\t\t.btn-success,\n\t\t.btn-secondary {\n\t\t\twidth: auto;\n\t\t\tflex: none;\n\t\t}\n\t}\n</style>\n",
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\dashboard\\trips\\+page.svelte",
		"messages": [
			{
				"ruleId": "svelte/no-navigation-without-resolve",
				"severity": 1,
				"message": "Unexpected goto() call without resolve().",
				"line": 319,
				"column": 27,
				"nodeType": null,
				"messageId": "gotoWithoutResolve",
				"endLine": 319,
				"endColumn": 54
			},
			{
				"ruleId": "svelte/no-navigation-without-resolve",
				"severity": 1,
				"message": "Unexpected href link without resolve().",
				"line": 355,
				"column": 13,
				"nodeType": null,
				"messageId": "linkWithoutResolve",
				"endLine": 355,
				"endColumn": 46
			},
			{
				"ruleId": "svelte/no-navigation-without-resolve",
				"severity": 1,
				"message": "Unexpected goto() call without resolve().",
				"line": 399,
				"column": 27,
				"nodeType": null,
				"messageId": "gotoWithoutResolve",
				"endLine": 399,
				"endColumn": 70
			},
			{
				"ruleId": "svelte/no-navigation-without-resolve",
				"severity": 1,
				"message": "Unexpected href link without resolve().",
				"line": 500,
				"column": 48,
				"nodeType": null,
				"messageId": "linkWithoutResolve",
				"endLine": 500,
				"endColumn": 67
			},
			{
				"ruleId": "svelte/no-navigation-without-resolve",
				"severity": 1,
				"message": "Unexpected href link without resolve().",
				"line": 523,
				"column": 14,
				"nodeType": null,
				"messageId": "linkWithoutResolve",
				"endLine": 523,
				"endColumn": 37
			}
		],
		"suppressedMessages": [
			{
				"ruleId": "svelte/prefer-svelte-reactivity",
				"severity": 2,
				"message": "Found a mutable instance of the built-in Set class. Use SvelteSet instead.",
				"line": 267,
				"column": 22,
				"nodeType": "NewExpression",
				"messageId": "mutableSetUsed",
				"endLine": 267,
				"endColumn": 39,
				"suppressions": [{ "kind": "directive", "justification": "" }]
			}
		],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 5,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"source": "<script lang=\"ts\">\n\timport { trips } from '$lib/stores/trips';\n\timport AsyncErrorBoundary from '$lib/components/AsyncErrorBoundary.svelte';\n\timport { goto } from '$app/navigation';\n\timport { base } from '$app/paths';\n\timport { user } from '$lib/stores/auth';\n\n\tconst resolve = (href: string) => `${base}${href}`;\n\timport { page } from '$app/stores';\n\timport { toasts } from '$lib/stores/toast';\n\timport { onMount, onDestroy } from 'svelte';\n\timport { calculateNetProfit } from '$lib/utils/trip-helpers';\n\timport type { Trip, Stop, SupplyCost, MaintenanceCost } from '$lib/types';\n\n\t// Import Components\n\timport TripStats from './components/TripStats.svelte';\n\timport TripFilters from './components/TripFilters.svelte';\n\timport TripCard from './components/TripCard.svelte';\n\timport ActionBar from './components/ActionBar.svelte';\n\timport SettingsModal from './components/SettingsModal.svelte';\n\timport UpgradeModal from './components/UpgradeModal.svelte';\n\timport { SvelteSet, SvelteDate } from '$lib/utils/svelte-reactivity';\n\n\tlet tripsBoundary: {\n\t\tsetSuccess?: () => void;\n\t\tsetLoading?: () => void;\n\t\tsetError?: (e: Error) => void;\n\t} | null = null;\n\tlet hasLoadedOnce = false;\n\tlet isMounted = false;\n\tlet lastHadSelections = false;\n\n\t// Filter State\n\tlet searchQuery: string = '';\n\tlet sortBy: 'date' | 'profit' | 'miles' = 'date';\n\tlet sortOrder: 'asc' | 'desc' = 'desc';\n\tlet filterProfit: 'all' | 'positive' | 'negative' = 'all';\n\t// Default to current month (first day to last day)\n\tconst _now = SvelteDate.now();\n\tfunction _fmtInput(d: SvelteDate) {\n\t\treturn d.toInput();\n\t}\n\tlet startDate = _fmtInput(SvelteDate.from(new Date(_now.getFullYear(), _now.getMonth(), 1)));\n\tlet endDate = _fmtInput(SvelteDate.from(new Date(_now.getFullYear(), _now.getMonth() + 1, 0)));\n\n\t// Pagination\n\tlet currentPage = 1;\n\tconst itemsPerPage = 20;\n\n\t// Selection\n\tlet selectedTrips = new SvelteSet<string>();\n\n\t// Modals\n\tlet isSettingsOpen = false;\n\tlet isUpgradeModalOpen = false;\n\n\t$: isPro = ['pro', 'business', 'premium', 'enterprise'].includes($user?.plan || '');\n\t$: API_KEY = $page.data['googleMapsApiKey'];\n\n\t// Reset page when filters change\n\t$: if (searchQuery || sortBy || sortOrder || filterProfit || startDate || endDate) {\n\t\tcurrentPage = 1;\n\t}\n\n\tasync function loadTrips() {\n\t\ttry {\n\t\t\tif ($trips.length > 0) {\n\t\t\t\ttripsBoundary?.setSuccess?.();\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (!hasLoadedOnce) tripsBoundary?.setLoading?.();\n\t\t\tawait trips.load();\n\t\t\thasLoadedOnce = true;\n\t\t\ttripsBoundary?.setSuccess?.();\n\t\t} catch (error) {\n\t\t\tconsole.error('Failed to load trips:', error);\n\t\t\ttripsBoundary?.setError?.(error as Error);\n\t\t\ttoasts.error('Failed to load trips. Click retry to try again.');\n\t\t\tthrow error;\n\t\t}\n\t}\n\n\t// Handle body class for selection bar\n\t$: if (typeof document !== 'undefined' && isMounted) {\n\t\tconst hasSelections = selectedTrips.size > 0;\n\t\tif (hasSelections !== lastHadSelections) {\n\t\t\tif (hasSelections) document.body.classList.add('has-selections');\n\t\t\telse document.body.classList.remove('has-selections');\n\t\t\tlastHadSelections = hasSelections;\n\t\t}\n\t}\n\n\tonMount(() => {\n\t\tdocument.body.classList.remove('has-selections');\n\t\tisMounted = true;\n\t\tloadTrips();\n\t});\n\n\tonDestroy(() => {\n\t\tif (typeof document !== 'undefined') document.body.classList.remove('has-selections');\n\t\tisMounted = false;\n\t});\n\n\t// --- Filtering Logic ---\n\t$: allFilteredTrips = $trips\n\t\t.filter((trip: Trip) => {\n\t\t\tconst query = searchQuery.toLowerCase();\n\t\t\tconst supplies: SupplyCost[] = (trip.supplyItems ?? trip.suppliesItems) || [];\n\t\t\tconst matchesSearch =\n\t\t\t\t!query ||\n\t\t\t\t(trip.date && trip.date.includes(query)) ||\n\t\t\t\t(trip.startAddress && trip.startAddress.toLowerCase().includes(query)) ||\n\t\t\t\t(trip.endAddress && trip.endAddress.toLowerCase().includes(query)) ||\n\t\t\t\t(trip.notes && trip.notes.toLowerCase().includes(query)) ||\n\t\t\t\t(trip.totalMiles != null && trip.totalMiles.toString().includes(query)) ||\n\t\t\t\t(trip.fuelCost != null && trip.fuelCost.toString().includes(query)) ||\n\t\t\t\ttrip.stops?.some(\n\t\t\t\t\t(stop: Stop) =>\n\t\t\t\t\t\t(!!stop.address && stop.address.toLowerCase().includes(query)) ||\n\t\t\t\t\t\t(stop.earnings != null && stop.earnings.toString().includes(query))\n\t\t\t\t) ||\n\t\t\t\ttrip.maintenanceItems?.some(\n\t\t\t\t\t(item: MaintenanceCost) =>\n\t\t\t\t\t\t(!!item.type && item.type.toLowerCase().includes(query)) ||\n\t\t\t\t\t\t(item.cost != null && item.cost.toString().includes(query))\n\t\t\t\t) ||\n\t\t\t\tsupplies.some(\n\t\t\t\t\t(item: SupplyCost) =>\n\t\t\t\t\t\t(!!item.type && item.type.toLowerCase().includes(query)) ||\n\t\t\t\t\t\t(item.cost != null && item.cost.toString().includes(query))\n\t\t\t\t);\n\n\t\t\tif (!matchesSearch) return false;\n\n\t\t\tif (filterProfit !== 'all') {\n\t\t\t\tconst profit = calculateNetProfit(trip);\n\t\t\t\tif (filterProfit === 'positive' && profit <= 0) return false;\n\t\t\t\tif (filterProfit === 'negative' && profit >= 0) return false;\n\t\t\t}\n\n\t\t\tif (trip.date) {\n\t\t\t\tconst tripDate = SvelteDate.from(trip.date).startOfDay();\n\t\t\t\tif (startDate) {\n\t\t\t\t\tconst start = SvelteDate.from(startDate).startOfDay();\n\t\t\t\t\tif (tripDate.getTime() < start.getTime()) return false;\n\t\t\t\t}\n\t\t\t\tif (endDate) {\n\t\t\t\t\tconst end = SvelteDate.from(endDate).startOfDay();\n\t\t\t\t\tif (tripDate.getTime() > end.getTime()) return false;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn true;\n\t\t})\n\t\t.sort((a, b) => {\n\t\t\tlet aVal, bVal;\n\t\t\tswitch (sortBy) {\n\t\t\t\tcase 'date':\n\t\t\t\t\taVal = SvelteDate.from(a.date || 0).getTime();\n\t\t\t\t\tbVal = SvelteDate.from(b.date || 0).getTime();\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'profit':\n\t\t\t\t\taVal = calculateNetProfit(a);\n\t\t\t\t\tbVal = calculateNetProfit(b);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'miles':\n\t\t\t\t\taVal = a.totalMiles || 0;\n\t\t\t\t\tbVal = b.totalMiles || 0;\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\treturn 0;\n\t\t\t}\n\t\t\treturn sortOrder === 'asc' ? aVal - bVal : bVal - aVal;\n\t\t});\n\n\t$: totalPages = Math.ceil(allFilteredTrips.length / itemsPerPage);\n\t$: visibleTrips = allFilteredTrips.slice(\n\t\t(currentPage - 1) * itemsPerPage,\n\t\tcurrentPage * itemsPerPage\n\t);\n\t$: allSelected = allFilteredTrips.length > 0 && selectedTrips.size === allFilteredTrips.length;\n\n\tfunction toggleSelection(id: string) {\n\t\tselectedTrips = selectedTrips.has(id) ? selectedTrips.delete(id) : selectedTrips.add(id);\n\t}\n\n\tfunction toggleSelectAll() {\n\t\tif (allSelected) selectedTrips = new SvelteSet();\n\t\telse selectedTrips = new SvelteSet(allFilteredTrips.map((t) => t.id));\n\t}\n\n\tfunction changePage(newPage: number) {\n\t\tif (newPage >= 1 && newPage <= totalPages) {\n\t\t\tcurrentPage = newPage;\n\t\t\twindow.scrollTo({ top: 0, behavior: 'smooth' });\n\t\t}\n\t}\n\n\tasync function deleteTrip(id: string) {\n\t\tif (!confirm('Move trip to trash?')) return;\n\t\ttry {\n\t\t\tconst currentUser = $page.data['user'] || $user;\n\n\t\t\t// [!code fix] Strictly use ID. Removed fallback to name/token and legacy legacy checks.\n\t\t\tconst userId = currentUser?.id || localStorage.getItem('offline_user_id') || '';\n\n\t\t\tif (userId) await trips.deleteTrip(id, userId as string);\n\t\t} catch (_err) {\n\t\t\ttoasts.error('Failed to delete trip. Changes reverted.');\n\t\t}\n\t}\n\n\tasync function deleteSelected() {\n\t\tconst count = selectedTrips.size;\n\t\tif (!confirm(`Are you sure you want to delete ${count} trip(s)?`)) return;\n\t\tconst currentUser = $page.data['user'] || $user;\n\n\t\t// [!code fix] Strictly use ID.\n\t\tconst userId = currentUser?.id || localStorage.getItem('offline_user_id') || '';\n\n\t\tif (!userId) {\n\t\t\ttoasts.error('User identity missing.');\n\t\t\treturn;\n\t\t}\n\n\t\tlet successCount = 0;\n\t\tconst ids = Array.from(selectedTrips);\n\t\tfor (const id of ids) {\n\t\t\ttry {\n\t\t\t\tawait trips.deleteTrip(id, userId);\n\t\t\t\tsuccessCount++;\n\t\t\t} catch (_err) {\n\t\t\t\tconsole.error(`Failed to delete trip ${id}`, _err);\n\t\t\t}\n\t\t}\n\t\ttoasts.success(`Moved ${successCount} trips to trash.`);\n\t\tselectedTrips = new SvelteSet();\n\t}\n\n\tfunction exportSelected() {\n\t\tif (typeof document === 'undefined' || typeof window === 'undefined') return;\n\t\tconst selectedData = allFilteredTrips.filter((t) => selectedTrips.has(t.id));\n\t\tif (selectedData.length === 0) return;\n\t\tconst headers = ['Date', 'Start', 'End', 'Miles', 'Profit', 'Notes'];\n\t\tconst rows = selectedData.map((t) => {\n\t\t\tconst profit = calculateNetProfit(t);\n\t\t\treturn [\n\t\t\t\tt.date,\n\t\t\t\t`\"${t.startAddress}\"`,\n\t\t\t\t`\"${t.endAddress}\"`,\n\t\t\t\tt.totalMiles,\n\t\t\t\tprofit.toFixed(2),\n\t\t\t\t`\"${(t.notes || '').replace(/\"/g, '\"\"')}\"`\n\t\t\t].join(',');\n\t\t});\n\t\tconst csvContent = [headers.join(','), ...rows].join('\\n');\n\t\tconst blob = new Blob([csvContent], { type: 'text/csv' });\n\t\tconst url = window.URL.createObjectURL(blob);\n\t\tconst a = document.createElement('a');\n\t\ta.href = url;\n\t\ta.download = `trips_export_${SvelteDate.now().toInput()}.csv`;\n\t\ta.click();\n\t\ttoasts.success(`Exported ${selectedData.length} trips.`);\n\t\tselectedTrips = new SvelteSet();\n\t}\n\n\t// eslint-disable-next-line svelte/prefer-svelte-reactivity\n\tlet expandedTrips = new Set<string>();\n\tfunction toggleExpand(id: string) {\n\t\tif (expandedTrips.has(id)) expandedTrips.delete(id);\n\t\telse expandedTrips.add(id);\n\t\texpandedTrips = expandedTrips;\n\t}\n\n\t// Auto-expand a trip when `?id=<tripId>` is present in URL ΓÇö used when navigating from expenses\n\tlet lastQueryExpandId = '';\n\t$: {\n\t\tconst qId = $page?.url?.searchParams.get('id');\n\t\tif (qId && qId !== lastQueryExpandId && allFilteredTrips?.length > 0) {\n\t\t\tconst idx = allFilteredTrips.findIndex((t) => t.id === qId);\n\t\t\tif (idx !== -1) {\n\t\t\t\tconst newPage = Math.floor(idx / itemsPerPage) + 1;\n\t\t\t\tif (currentPage !== newPage) currentPage = newPage;\n\t\t\t\texpandedTrips = new Set([qId]);\n\t\t\t\tif (typeof document !== 'undefined') {\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\tconst el = document.getElementById('trip-' + qId);\n\t\t\t\t\t\tif (el) el.scrollIntoView({ behavior: 'smooth', block: 'start' });\n\t\t\t\t\t}, 60);\n\t\t\t\t}\n\t\t\t}\n\t\t\tlastQueryExpandId = qId;\n\t\t}\n\t}\n</script>\n\n<svelte:head>\n\t<title>Trips - Go Route Yourself</title>\n\t<style>\n\t\t/* FORCE OVERRIDE: Google Maps Autocomplete z-index */\n\t\t.pac-container {\n\t\t\tz-index: 2147483647 !important;\n\t\t\t/* Positioning removed to allow the action to control absolute/fixed placement */\n\t\t\tpointer-events: auto !important;\n\t\t}\n\t</style>\n</svelte:head>\n\n<AsyncErrorBoundary bind:this={tripsBoundary} onRetry={loadTrips}>\n\t<div class=\"trip-history\">\n\t\t<div class=\"page-header\">\n\t\t\t<div class=\"header-text\">\n\t\t\t\t<h1 class=\"page-title\">Trips</h1>\n\t\t\t\t<p class=\"page-subtitle\">View and manage all your trips</p>\n\t\t\t</div>\n\n\t\t\t<div class=\"header-actions\">\n\t\t\t\t<button\n\t\t\t\t\tclass=\"btn-secondary\"\n\t\t\t\t\ton:click={() => goto(resolve('/dashboard/trash'))}\n\t\t\t\t\taria-label=\"View Trash\"\n\t\t\t\t>\n\t\t\t\t\t<svg\n\t\t\t\t\t\twidth=\"20\"\n\t\t\t\t\t\theight=\"20\"\n\t\t\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\t\t\tfill=\"none\"\n\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\t\t\tstroke-linejoin=\"round\"\n\t\t\t\t\t\t><polyline points=\"3 6 5 6 21 6\"></polyline><path\n\t\t\t\t\t\t\td=\"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2\"\n\t\t\t\t\t\t></path></svg\n\t\t\t\t\t>\n\t\t\t\t</button>\n\t\t\t\t<button\n\t\t\t\t\tclass=\"btn-secondary\"\n\t\t\t\t\ton:click={() => (isSettingsOpen = true)}\n\t\t\t\t\taria-label=\"Trip Settings\"\n\t\t\t\t>\n\t\t\t\t\t<svg\n\t\t\t\t\t\twidth=\"20\"\n\t\t\t\t\t\theight=\"20\"\n\t\t\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\t\t\tfill=\"none\"\n\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\t\t\tstroke-linejoin=\"round\"\n\t\t\t\t\t\t><path\n\t\t\t\t\t\t\td=\"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.09a2 2 0 0 1-1-1.74v-.47a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.39a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z\"\n\t\t\t\t\t\t></path><circle cx=\"12\" cy=\"12\" r=\"3\"></circle></svg\n\t\t\t\t\t>\n\t\t\t\t</button>\n\t\t\t\t<a href={resolve('/dashboard/trips/new')} class=\"btn-primary\" aria-label=\"Create New Trip\">\n\t\t\t\t\t<svg width=\"20\" height=\"20\" viewBox=\"0 0 20 20\" fill=\"none\" aria-hidden=\"true\"\n\t\t\t\t\t\t><path\n\t\t\t\t\t\t\td=\"M10 4V16M4 10H16\"\n\t\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\t\t\t\tstroke-linejoin=\"round\"\n\t\t\t\t\t\t/></svg\n\t\t\t\t\t>\n\t\t\t\t\tNew Trip\n\t\t\t\t</a>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<TripStats trips={allFilteredTrips} />\n\n\t\t<TripFilters\n\t\t\tbind:searchQuery\n\t\t\tbind:startDate\n\t\t\tbind:endDate\n\t\t\tbind:filterProfit\n\t\t\tbind:sortBy\n\t\t\tbind:sortOrder\n\t\t/>\n\n\t\t{#if visibleTrips.length > 0}\n\t\t\t<div class=\"batch-header\" class:visible={allFilteredTrips.length > 0}>\n\t\t\t\t<label class=\"checkbox-container\">\n\t\t\t\t\t<input type=\"checkbox\" checked={allSelected} on:change={toggleSelectAll} />\n\t\t\t\t\t<span class=\"checkmark\"></span>\n\t\t\t\t\tSelect All ({allFilteredTrips.length})\n\t\t\t\t</label>\n\t\t\t\t<span class=\"page-info\">Showing {visibleTrips.length} of {allFilteredTrips.length}</span>\n\t\t\t</div>\n\n\t\t\t<div class=\"trip-list-cards\">\n\t\t\t\t{#each visibleTrips as trip (trip.id)}\n\t\t\t\t\t<TripCard\n\t\t\t\t\t\t{trip}\n\t\t\t\t\t\tisExpanded={expandedTrips.has(trip.id)}\n\t\t\t\t\t\tisSelected={selectedTrips.has(trip.id)}\n\t\t\t\t\t\ton:toggleExpand={() => toggleExpand(trip.id)}\n\t\t\t\t\t\ton:toggleSelection={() => toggleSelection(trip.id)}\n\t\t\t\t\t\ton:edit={() => goto(resolve(`/dashboard/trips/edit/${trip.id}`))}\n\t\t\t\t\t\ton:delete={() => deleteTrip(trip.id)}\n\t\t\t\t\t/>\n\t\t\t\t{/each}\n\t\t\t</div>\n\n\t\t\t{#if totalPages > 1}\n\t\t\t\t<div class=\"pagination-controls\">\n\t\t\t\t\t<button\n\t\t\t\t\t\tclass=\"page-btn\"\n\t\t\t\t\t\tdisabled={currentPage === 1}\n\t\t\t\t\t\ton:click={() => changePage(currentPage - 1)}>ΓåÉ Prev</button\n\t\t\t\t\t>\n\t\t\t\t\t<span class=\"page-status\">Page {currentPage} of {totalPages}</span>\n\t\t\t\t\t<button\n\t\t\t\t\t\tclass=\"page-btn\"\n\t\t\t\t\t\tdisabled={currentPage === totalPages}\n\t\t\t\t\t\ton:click={() => changePage(currentPage + 1)}>Next ΓåÆ</button\n\t\t\t\t\t>\n\t\t\t\t</div>\n\t\t\t{/if}\n\t\t{:else}\n\t\t\t<div class=\"empty-state\">\n\t\t\t\t<p>No trips found matching your filters.</p>\n\t\t\t</div>\n\t\t{/if}\n\t</div>\n\n\t{#if selectedTrips.size > 0}\n\t\t<ActionBar\n\t\t\tselectedCount={selectedTrips.size}\n\t\t\t{isPro}\n\t\t\ton:cancel={() => (selectedTrips = new SvelteSet())}\n\t\t\ton:export={exportSelected}\n\t\t\ton:delete={deleteSelected}\n\t\t/>\n\t{/if}\n\n\t<SettingsModal bind:open={isSettingsOpen} {API_KEY} />\n\t<UpgradeModal bind:open={isUpgradeModalOpen} />\n\n\t{#snippet loading()}\n\t\t<div class=\"trips-loading\">\n\t\t\t<div class=\"loading-header\">\n\t\t\t\t<div class=\"skeleton skeleton-title\"></div>\n\t\t\t\t<div class=\"skeleton skeleton-button\"></div>\n\t\t\t</div>\n\t\t\t<div class=\"loading-stats\">\n\t\t\t\t{#each Array(4) as _, i (i)}<div class=\"skeleton skeleton-stat\"></div>{/each}\n\t\t\t</div>\n\t\t\t<div class=\"loading-filters\">\n\t\t\t\t<div class=\"skeleton skeleton-input\"></div>\n\t\t\t\t<div class=\"skeleton skeleton-select\"></div>\n\t\t\t</div>\n\t\t\t<div class=\"trip-list-cards\">\n\t\t\t\t{#each Array(6) as _, i (i)}<div class=\"trip-skeleton\">\n\t\t\t\t\t\t<div class=\"skeleton-top\">\n\t\t\t\t\t\t\t<div class=\"skeleton skeleton-text\" style=\"width: 30%; height: 14px;\"></div>\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tclass=\"skeleton skeleton-text\"\n\t\t\t\t\t\t\t\tstyle=\"width: 60%; height: 18px; margin-top: 8px;\"\n\t\t\t\t\t\t\t></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"skeleton-stats-grid\">\n\t\t\t\t\t\t\t{#each Array(5) as _, j (j)}<div>\n\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\tclass=\"skeleton skeleton-text\"\n\t\t\t\t\t\t\t\t\t\tstyle=\"width: 80%; height: 10px; margin-bottom: 4px;\"\n\t\t\t\t\t\t\t\t\t></div>\n\t\t\t\t\t\t\t\t\t<div class=\"skeleton skeleton-text\" style=\"width: 50%; height: 14px;\"></div>\n\t\t\t\t\t\t\t\t</div>{/each}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>{/each}\n\t\t\t</div>\n\t\t</div>\n\t{/snippet}\n\n\t{#snippet error({ error, retry })}\n\t\t<div class=\"trips-error\">\n\t\t\t<div class=\"error-content\">\n\t\t\t\t<div class=\"error-icon\">\n\t\t\t\t\t<svg\n\t\t\t\t\t\twidth=\"64\"\n\t\t\t\t\t\theight=\"64\"\n\t\t\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\t\t\tfill=\"none\"\n\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\t\t><circle cx=\"12\" cy=\"12\" r=\"10\" /><line x1=\"12\" y1=\"8\" x2=\"12\" y2=\"12\" /><line\n\t\t\t\t\t\t\tx1=\"12\"\n\t\t\t\t\t\t\ty1=\"16\"\n\t\t\t\t\t\t\tx2=\"12.01\"\n\t\t\t\t\t\t\ty2=\"16\"\n\t\t\t\t\t\t/></svg\n\t\t\t\t\t>\n\t\t\t\t</div>\n\t\t\t\t<h2>Failed to Load Trips</h2>\n\t\t\t\t<p class=\"error-message\">\n\t\t\t\t\t{#if error.message.includes('fetch') || error.message.includes('Failed to fetch')}\n\t\t\t\t\t\tUnable to connect to the server. Please check your internet connection and try again.\n\t\t\t\t\t{:else if error.message.includes('401') || error.message.includes('Unauthorized')}\n\t\t\t\t\t\tYour session has expired. Please <a href={resolve('/login')}>log in again</a>.\n\t\t\t\t\t{:else if error.message.includes('403') || error.message.includes('Forbidden')}\n\t\t\t\t\t\tYou don't have permission to view trips. Please contact support if this persists.\n\t\t\t\t\t{:else if error.message.includes('500')}\n\t\t\t\t\t\tA server error occurred. Our team has been notified. Please try again in a few moments.\n\t\t\t\t\t{:else}\n\t\t\t\t\t\t{error.message}\n\t\t\t\t\t{/if}\n\t\t\t\t</p>\n\t\t\t\t<div class=\"error-actions\">\n\t\t\t\t\t<button on:click={retry} class=\"btn-primary\"\n\t\t\t\t\t\t><svg\n\t\t\t\t\t\t\twidth=\"20\"\n\t\t\t\t\t\t\theight=\"20\"\n\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\t\t\t\tfill=\"none\"\n\t\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\t\t\t><polyline points=\"23 4 23 10 17 10\" /><path\n\t\t\t\t\t\t\t\td=\"M20.49 15a9 9 0 1 1-2.12-9.36L23 10\"\n\t\t\t\t\t\t\t/></svg\n\t\t\t\t\t\t> Try Again</button\n\t\t\t\t\t>\n\t\t\t\t\t<a href={resolve('/dashboard')} class=\"btn-secondary\">Go to Dashboard</a>\n\t\t\t\t</div>\n\t\t\t\t<details class=\"error-details\">\n\t\t\t\t\t<summary>Technical Details</summary>\n\t\t\t\t\t<pre><code\n\t\t\t\t\t\t\t>{JSON.stringify(\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tmessage: error.message,\n\t\t\t\t\t\t\t\t\ttime: SvelteDate.now().toISOString(),\n\t\t\t\t\t\t\t\t\tpath: $page.url.pathname,\n\t\t\t\t\t\t\t\t\tuserAgent: navigator.userAgent\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tnull,\n\t\t\t\t\t\t\t\t2\n\t\t\t\t\t\t\t)}</code\n\t\t\t\t\t\t></pre>\n\t\t\t\t</details>\n\t\t\t</div>\n\t\t</div>\n\t{/snippet}\n</AsyncErrorBoundary>\n\n<style>\n\t.trip-history {\n\t\tmax-width: 1400px;\n\t\tmargin: 0 auto;\n\t\tpadding: 16px;\n\t\tpadding-bottom: 80px;\n\t}\n\t.page-header {\n\t\tdisplay: flex;\n\t\tjustify-content: space-between;\n\t\talign-items: center;\n\t\tmargin-bottom: 24px;\n\t}\n\t.page-title {\n\t\tfont-size: 24px;\n\t\tfont-weight: 800;\n\t\tcolor: #111827;\n\t\tmargin: 0;\n\t}\n\t.page-subtitle {\n\t\tfont-size: 14px;\n\t\tcolor: #6b7280;\n\t\tmargin: 0;\n\t}\n\t.header-actions {\n\t\tdisplay: flex;\n\t\tgap: 8px;\n\t\talign-items: center;\n\t}\n\t.btn-primary {\n\t\tdisplay: inline-flex;\n\t\talign-items: center;\n\t\tgap: 6px;\n\t\tpadding: 10px 16px;\n\t\tbackground: linear-gradient(135deg, #ff7f50 0%, #ff6a3d 100%);\n\t\tcolor: white;\n\t\tborder: none;\n\t\tborder-radius: 8px;\n\t\tfont-weight: 600;\n\t\tfont-size: 14px;\n\t\ttext-decoration: none;\n\t\tbox-shadow: 0 2px 8px rgba(255, 127, 80, 0.3);\n\t\ttransition: transform 0.1s;\n\t\tcursor: pointer;\n\t}\n\t.btn-primary:active {\n\t\ttransform: translateY(1px);\n\t}\n\t.btn-secondary {\n\t\tdisplay: inline-flex;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t\tpadding: 10px;\n\t\tbackground: white;\n\t\tborder: 1px solid #e5e7eb;\n\t\tcolor: #374151;\n\t\tborder-radius: 8px;\n\t\tfont-weight: 600;\n\t\tfont-size: 14px;\n\t\tcursor: pointer;\n\t\ttransition: background 0.2s;\n\t\ttext-decoration: none;\n\t}\n\t.batch-header {\n\t\tdisplay: flex;\n\t\tjustify-content: space-between;\n\t\talign-items: center;\n\t\tmargin-bottom: 12px;\n\t\tpadding: 0 4px;\n\t\tcolor: #6b7280;\n\t\tfont-size: 13px;\n\t\tfont-weight: 500;\n\t}\n\t.checkbox-container {\n\t\tdisplay: inline-flex;\n\t\talign-items: center;\n\t\tgap: 8px;\n\t\tcursor: pointer;\n\t\tfont-size: 14px;\n\t\tfont-weight: 600;\n\t\tcolor: #4b5563;\n\t\tposition: relative;\n\t\tpadding-left: 28px;\n\t\tuser-select: none;\n\t}\n\t.checkbox-container input {\n\t\tposition: absolute;\n\t\topacity: 0;\n\t\tcursor: pointer;\n\t\theight: 0;\n\t\twidth: 0;\n\t}\n\t.checkmark {\n\t\tposition: absolute;\n\t\ttop: 0;\n\t\tleft: 0;\n\t\theight: 20px;\n\t\twidth: 20px;\n\t\tbackground-color: white;\n\t\tborder: 2px solid #d1d5db;\n\t\tborder-radius: 6px;\n\t\ttransition: all 0.2s;\n\t}\n\t.checkbox-container:hover input ~ .checkmark {\n\t\tborder-color: #9ca3af;\n\t}\n\t.checkbox-container input:checked ~ .checkmark {\n\t\tbackground-color: #ff7f50;\n\t\tborder-color: #ff7f50;\n\t}\n\t.checkmark:after {\n\t\tcontent: '';\n\t\tposition: absolute;\n\t\tdisplay: none;\n\t}\n\t.checkbox-container input:checked ~ .checkmark:after {\n\t\tdisplay: block;\n\t}\n\t.checkbox-container .checkmark:after {\n\t\tleft: 6px;\n\t\ttop: 2px;\n\t\twidth: 5px;\n\t\theight: 10px;\n\t\tborder: solid white;\n\t\tborder-width: 0 2px 2px 0;\n\t\ttransform: rotate(45deg);\n\t}\n\t.trip-list-cards {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tgap: 12px;\n\t}\n\t.pagination-controls {\n\t\tdisplay: flex;\n\t\tjustify-content: center;\n\t\talign-items: center;\n\t\tgap: 16px;\n\t\tmargin-top: 32px;\n\t}\n\t.page-btn {\n\t\tpadding: 8px 16px;\n\t\tbackground: white;\n\t\tborder: 1px solid #e5e7eb;\n\t\tborder-radius: 8px;\n\t\tfont-weight: 600;\n\t\tfont-size: 14px;\n\t\tcolor: #374151;\n\t\tcursor: pointer;\n\t\ttransition: all 0.2s;\n\t}\n\t.page-btn:disabled {\n\t\topacity: 0.5;\n\t\tcursor: not-allowed;\n\t}\n\t.page-status {\n\t\tfont-size: 14px;\n\t\tcolor: #4b5563;\n\t\tfont-weight: 500;\n\t}\n\t.empty-state {\n\t\ttext-align: center;\n\t\tpadding: 40px 20px;\n\t\tcolor: #6b7280;\n\t\tfont-size: 15px;\n\t}\n\n\t/* Loading state styles */\n\t.trips-loading {\n\t\tpadding: 2rem;\n\t\tanimation: fadeIn 0.3s ease-out;\n\t}\n\t@keyframes fadeIn {\n\t\tfrom {\n\t\t\topacity: 0;\n\t\t}\n\t\tto {\n\t\t\topacity: 1;\n\t\t}\n\t}\n\t.loading-header {\n\t\tdisplay: flex;\n\t\tjustify-content: space-between;\n\t\talign-items: center;\n\t\tmargin-bottom: 24px;\n\t}\n\t.loading-stats {\n\t\tdisplay: grid;\n\t\tgrid-template-columns: repeat(2, 1fr);\n\t\tgap: 12px;\n\t\tmargin-bottom: 24px;\n\t}\n\t.loading-filters {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tgap: 12px;\n\t\tmargin-bottom: 20px;\n\t}\n\t.skeleton {\n\t\tbackground: linear-gradient(90deg, #f3f4f6 25%, #e5e7eb 50%, #f3f4f6 75%);\n\t\tbackground-size: 200% 100%;\n\t\tanimation: shimmer 1.5s infinite;\n\t\tborder-radius: 0.5rem;\n\t}\n\t.skeleton-title {\n\t\twidth: 200px;\n\t\theight: 2rem;\n\t}\n\t.skeleton-button {\n\t\twidth: 120px;\n\t\theight: 2.5rem;\n\t}\n\t.skeleton-stat {\n\t\theight: 80px;\n\t\tborder-radius: 12px;\n\t}\n\t.skeleton-input {\n\t\tflex: 1;\n\t\theight: 2.5rem;\n\t}\n\t.skeleton-select {\n\t\twidth: 150px;\n\t\theight: 2.5rem;\n\t}\n\t.trip-skeleton {\n\t\tbackground: white;\n\t\tpadding: 1.5rem;\n\t\tborder-radius: 12px;\n\t\tborder: 1px solid #e5e7eb;\n\t}\n\t.skeleton-top {\n\t\tmargin-bottom: 1rem;\n\t}\n\t.skeleton-text {\n\t\theight: 1rem;\n\t\tmargin-bottom: 0.5rem;\n\t\tbackground: linear-gradient(90deg, #f3f4f6 25%, #e5e7eb 50%, #f3f4f6 75%);\n\t\tbackground-size: 200% 100%;\n\t\tanimation: shimmer 1.5s infinite;\n\t\tborder-radius: 0.25rem;\n\t}\n\t.skeleton-stats-grid {\n\t\tdisplay: grid;\n\t\tgrid-template-columns: repeat(2, 1fr);\n\t\tgap: 12px;\n\t}\n\t@keyframes shimmer {\n\t\t0% {\n\t\t\tbackground-position: 200% 0;\n\t\t}\n\t\t100% {\n\t\t\tbackground-position: -200% 0;\n\t\t}\n\t}\n\n\t/* Error state styles */\n\t.trips-error {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t\tmin-height: 60vh;\n\t\tpadding: 2rem;\n\t\tanimation: fadeIn 0.3s ease-out;\n\t}\n\t.error-content {\n\t\ttext-align: center;\n\t\tmax-width: 500px;\n\t}\n\t.error-icon {\n\t\tdisplay: inline-flex;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t\twidth: 80px;\n\t\theight: 80px;\n\t\tbackground: #fee2e2;\n\t\tborder-radius: 50%;\n\t\tcolor: #dc2626;\n\t\tmargin-bottom: 1.5rem;\n\t}\n\t.trips-error h2 {\n\t\tfont-size: 1.5rem;\n\t\tfont-weight: 600;\n\t\tcolor: #111827;\n\t\tmargin: 0 0 0.5rem;\n\t}\n\t.error-message {\n\t\tcolor: #6b7280;\n\t\tmargin: 0 0 2rem;\n\t\tline-height: 1.6;\n\t}\n\t.error-message a {\n\t\tcolor: #ff7f50;\n\t\ttext-decoration: underline;\n\t\tfont-weight: 600;\n\t}\n\t.error-actions {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tgap: 0.75rem;\n\t\tmargin-bottom: 2rem;\n\t}\n\t.error-details {\n\t\tmargin-top: 2rem;\n\t\tpadding: 1rem;\n\t\tbackground: #f9fafb;\n\t\tborder-radius: 0.5rem;\n\t\ttext-align: left;\n\t}\n\t.error-details summary {\n\t\tcursor: pointer;\n\t\tcolor: #6b7280;\n\t\tfont-size: 0.875rem;\n\t\tfont-weight: 500;\n\t\tuser-select: none;\n\t}\n\t.error-details summary:hover {\n\t\tcolor: #374151;\n\t}\n\t.error-details pre {\n\t\tmargin-top: 0.5rem;\n\t\tpadding: 0.75rem;\n\t\tbackground: #1f2937;\n\t\tcolor: #f3f4f6;\n\t\tborder-radius: 0.375rem;\n\t\toverflow-x: auto;\n\t\tfont-size: 0.75rem;\n\t\tline-height: 1.5;\n\t}\n\n\t@media (hover: hover) {\n\t\t.btn-secondary:hover {\n\t\t\tbackground: #f9fafb;\n\t\t}\n\t\t.page-btn:hover:not(:disabled) {\n\t\t\tborder-color: #ff7f50;\n\t\t\tcolor: #ff7f50;\n\t\t}\n\t}\n\t@media (min-width: 640px) {\n\t\t.loading-stats {\n\t\t\tgrid-template-columns: repeat(4, 1fr);\n\t\t}\n\t\t.loading-filters {\n\t\t\tflex-direction: row;\n\t\t}\n\t\t.skeleton-stats-grid {\n\t\t\tgrid-template-columns: repeat(5, 1fr);\n\t\t}\n\t\t.error-actions {\n\t\t\tflex-direction: row;\n\t\t\tjustify-content: center;\n\t\t}\n\t}\n\n\t:global(body.has-selections .mobile-footer),\n\t:global(body.has-selections footer),\n\t:global(body.has-selections nav[class*='mobile']),\n\t:global(body.has-selections .bottom-nav) {\n\t\tdisplay: none !important;\n\t}\n\n\t@media (max-width: 640px) {\n\t\t/* Keep only the safe-area inset plus a small buffer so content sits close to the bottom nav */\n\t\t.trip-history {\n\t\t\tpadding-bottom: calc(env(safe-area-inset-bottom, 0px) + 1px);\n\t\t}\n\n\t\t/* Slightly compact card spacing on small screens */\n\t\t.trip-list-cards {\n\t\t\tgap: 8px;\n\t\t}\n\n\t\t/* Reduce extra space above pagination on mobile */\n\t\t.pagination-controls {\n\t\t\tmargin-top: 16px;\n\t\t}\n\n\t\t/* Compact empty-state padding on mobile */\n\t\t.empty-state {\n\t\t\tpadding: 24px 12px;\n\t\t}\n\t}\n</style>\n",
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\dashboard\\trips\\components\\ActionBar.svelte",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\dashboard\\trips\\components\\SettingsModal.svelte",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\dashboard\\trips\\components\\TripCard.svelte",
		"messages": [],
		"suppressedMessages": [
			{
				"ruleId": "svelte/prefer-svelte-reactivity",
				"severity": 2,
				"message": "Found a mutable instance of the built-in URLSearchParams class. Use SvelteURLSearchParams instead.",
				"line": 98,
				"column": 18,
				"nodeType": "NewExpression",
				"messageId": "mutableURLSearchParamsUsed",
				"endLine": 98,
				"endColumn": 64,
				"suppressions": [{ "kind": "directive", "justification": "" }]
			}
		],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\dashboard\\trips\\components\\TripFilters.svelte",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\dashboard\\trips\\components\\TripStats.svelte",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\dashboard\\trips\\components\\UpgradeModal.svelte",
		"messages": [
			{
				"ruleId": "svelte/no-navigation-without-resolve",
				"severity": 1,
				"message": "Unexpected href link without resolve().",
				"line": 42,
				"column": 11,
				"nodeType": null,
				"messageId": "linkWithoutResolve",
				"endLine": 42,
				"endColumn": 30
			}
		],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 1,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"source": "<script lang=\"ts\">\n\timport Modal from '$lib/components/ui/Modal.svelte';\n\timport Button from '$lib/components/ui/Button.svelte';\n\n\texport let open = false;\n</script>\n\n<Modal bind:open title=\"Upgrade to Pro\">\n\t<div class=\"space-y-6 text-center py-4\">\n\t\t<div class=\"mx-auto w-16 h-16 bg-orange-100 rounded-full flex items-center justify-center mb-4\">\n\t\t\t<span class=\"text-3xl\">≡ƒÜÇ</span>\n\t\t</div>\n\n\t\t<h3 class=\"text-xl font-bold text-gray-900\">Unlock Pro Features</h3>\n\n\t\t<p class=\"text-gray-600 text-base leading-relaxed\">\n\t\t\tData Export is a Pro feature. Upgrade now to download your trip history for taxes!\n\t\t</p>\n\n\t\t<div class=\"bg-gray-50 p-4 rounded-lg text-left text-sm space-y-2 border border-gray-100\">\n\t\t\t<div class=\"flex items-center gap-2\">\n\t\t\t\t<span class=\"text-green-500 text-lg\">Γ£ô</span>\n\t\t\t\t<span class=\"text-gray-700\">Unlimited Stops per Trip</span>\n\t\t\t</div>\n\t\t\t<div class=\"flex items-center gap-2\">\n\t\t\t\t<span class=\"text-green-500 text-lg\">Γ£ô</span>\n\t\t\t\t<span class=\"text-gray-700\">One-Click Route Optimization</span>\n\t\t\t</div>\n\t\t\t<div class=\"flex items-center gap-2\">\n\t\t\t\t<span class=\"text-green-500 text-lg\">Γ£ô</span>\n\t\t\t\t<span class=\"text-gray-700\">Unlimited Monthly Trips</span>\n\t\t\t</div>\n\t\t\t<div class=\"flex items-center gap-2\">\n\t\t\t\t<span class=\"text-green-500 text-lg\">Γ£ô</span>\n\t\t\t\t<span class=\"text-gray-700\">Data Export</span>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<div class=\"flex gap-3 justify-center pt-2\">\n\t\t\t<Button variant=\"outline\" on:click={() => (open = false)}>Maybe Later</Button>\n\t\t\t<a\n\t\t\t\thref=\"/dashboard/settings\"\n\t\t\t\tclass=\"inline-flex items-center justify-center rounded-lg bg-orange-600 px-6 py-2.5 text-sm font-semibold text-white shadow-sm hover:bg-orange-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-orange-600 transition-all\"\n\t\t\t>\n\t\t\t\tUpgrade Now\n\t\t\t</a>\n\t\t</div>\n\t</div>\n</Modal>\n",
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\dashboard\\trips\\components\\actionbar.spec.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\dashboard\\trips\\edit\\[id]\\+page.svelte",
		"messages": [
			{
				"ruleId": "svelte/no-navigation-without-resolve",
				"severity": 1,
				"message": "Unexpected goto() call without resolve().",
				"line": 116,
				"column": 9,
				"nodeType": null,
				"messageId": "gotoWithoutResolve",
				"endLine": 116,
				"endColumn": 36
			},
			{
				"ruleId": "svelte/no-navigation-without-resolve",
				"severity": 1,
				"message": "Unexpected goto() call without resolve().",
				"line": 793,
				"column": 9,
				"nodeType": null,
				"messageId": "gotoWithoutResolve",
				"endLine": 793,
				"endColumn": 36
			},
			{
				"ruleId": "svelte/no-navigation-without-resolve",
				"severity": 1,
				"message": "Unexpected href link without resolve().",
				"line": 828,
				"column": 11,
				"nodeType": null,
				"messageId": "linkWithoutResolve",
				"endLine": 828,
				"endColumn": 40
			},
			{
				"ruleId": "svelte/no-navigation-without-resolve",
				"severity": 1,
				"message": "Unexpected href link without resolve().",
				"line": 1350,
				"column": 10,
				"nodeType": null,
				"messageId": "linkWithoutResolve",
				"endLine": 1350,
				"endColumn": 42
			}
		],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 4,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"source": "<script lang=\"ts\">\n\timport { trips } from '$lib/stores/trips';\n\timport { userSettings } from '$lib/stores/userSettings';\n\timport { goto } from '$app/navigation';\n\timport { base } from '$app/paths';\n\n\tconst resolve = (href: string) => `${base}${href}`;\n\timport { user } from '$lib/stores/auth';\n\timport { mileage } from '$lib/stores/mileage';\n\timport { page } from '$app/stores';\n\timport { autocomplete } from '$lib/utils/autocomplete';\n\timport { optimizeRoute } from '$lib/services/maps';\n\timport Modal from '$lib/components/ui/Modal.svelte';\n\timport { toasts } from '$lib/stores/toast';\n\timport Button from '$lib/components/ui/Button.svelte';\n\timport { PLAN_LIMITS } from '$lib/constants';\n\n\texport let data;\n\t$: API_KEY = String(data.googleMapsApiKey ?? '');\n\tconst tripId = $page.params.id;\n\n\tlet isCalculating = false;\n\tlet dragItemIndex: number | null = null;\n\n\t$: maintenanceOptions =\n\t\t$userSettings.maintenanceCategories?.length > 0\n\t\t\t? $userSettings.maintenanceCategories\n\t\t\t: ['Oil Change', 'Tire Rotation', 'Brake Service', 'Filter Replacement'];\n\n\t$: suppliesOptions =\n\t\t$userSettings.supplyCategories?.length > 0\n\t\t\t? $userSettings.supplyCategories\n\t\t\t: ['Concrete', 'Poles', 'Wire', 'Tools', 'Equipment Rental'];\n\n\tlet selectedMaintenance = '';\n\tlet selectedSupply = '';\n\n\tlet isManageCategoriesOpen = false;\n\tlet activeCategoryType: 'maintenance' | 'supplies' = 'maintenance';\n\tlet newCategoryName = '';\n\t$: activeCategories = activeCategoryType === 'maintenance' ? maintenanceOptions : suppliesOptions;\n\n\tlet showUpgradeModal = false;\n\tlet upgradeMessage = '';\n\n\tfunction getLocalDate(): string {\n\t\tconst now = new Date();\n\t\tconst isoStr = new Date(now.getTime() - now.getTimezoneOffset() * 60000).toISOString();\n\t\treturn isoStr.split('T')[0] ?? '';\n\t}\n\n\t/**\n\t * Normalize any date format to YYYY-MM-DD for HTML date inputs.\n\t * Handles: YYYY-MM-DD, MM/DD/YYYY, ISO timestamp strings\n\t */\n\tfunction normalizeDate(dateStr: string | undefined | null): string {\n\t\tconst fallback = getLocalDate();\n\t\tif (!dateStr) return fallback;\n\n\t\t// If already in YYYY-MM-DD format, return as-is\n\t\tif (/^\\d{4}-\\d{2}-\\d{2}$/.test(dateStr)) {\n\t\t\treturn dateStr;\n\t\t}\n\n\t\t// Try MM/DD/YYYY format (from HughesNet)\n\t\tconst slashMatch = dateStr.match(/^(\\d{1,2})\\/(\\d{1,2})\\/(\\d{2,4})$/);\n\t\tif (slashMatch) {\n\t\t\tlet y = slashMatch[3] ?? '1970';\n\t\t\tif (y.length === 2) y = '20' + y;\n\t\t\tconst m = (slashMatch[1] ?? '1').padStart(2, '0');\n\t\t\tconst d = (slashMatch[2] ?? '1').padStart(2, '0');\n\t\t\treturn `${y}-${m}-${d}`;\n\t\t}\n\n\t\t// Try parsing as a Date object (handles ISO timestamps, etc.)\n\t\ttry {\n\t\t\tconst parsed = new Date(dateStr);\n\t\t\tif (!isNaN(parsed.getTime())) {\n\t\t\t\tconst isoStr = parsed.toISOString();\n\t\t\t\treturn isoStr.split('T')[0] ?? fallback;\n\t\t\t}\n\t\t} catch {\n\t\t\t// Fall through\n\t\t}\n\n\t\treturn fallback;\n\t}\n\n\tfunction formatDuration(minutes: number): string {\n\t\tif (!minutes) return '0 min';\n\t\tconst h = Math.floor(minutes / 60);\n\t\tconst m = Math.round(minutes % 60);\n\t\tif (h > 0) return `${h} hr ${m} min`;\n\t\treturn `${m} min`;\n\t}\n\n\timport { onMount } from 'svelte';\n\n\tonMount(() => {\n\t\tloadTripData();\n\t});\n\n\tasync function loadTripData() {\n\t\tconst currentUser = $page.data['user'] || $user;\n\t\tconst userId = currentUser?.id || localStorage.getItem('offline_user_id');\n\t\tif (!$trips || $trips.length === 0) {\n\t\t\tif (userId) await trips.load(userId);\n\t\t}\n\t\t// Ensure mileage store is loaded to get accurate totalMiles\n\t\tif (!$mileage || $mileage.length === 0) {\n\t\t\tif (userId) await mileage.load(userId);\n\t\t}\n\t\tconst found = $trips.find((t) => t.id === tripId);\n\t\tif (!found) {\n\t\t\ttoasts.error('Trip not found');\n\t\t\tgoto(resolve('/dashboard/trips'));\n\t\t\treturn;\n\t\t}\n\t\tconst safeStops = (found.stops || []).map((s: any) => ({\n\t\t\t...s,\n\t\t\tid: s.id || crypto.randomUUID(),\n\t\t\taddress: s.address || '',\n\t\t\tdistanceFromPrev: s.distanceFromPrev || 0,\n\t\t\ttimeFromPrev: s.timeFromPrev || 0\n\t\t}));\n\t\tconst safeMaintenance = ((found as any)['maintenanceItems'] || []).map((m: any) => ({\n\t\t\t...m,\n\t\t\tid: m.id || crypto.randomUUID(),\n\t\t\ttaxDeductible: !!m.taxDeductible\n\t\t}));\n\t\tconst rawSupplies = (found as any)['supplyItems'] || (found as any)['suppliesItems'] || [];\n\t\tconst safeSupplies = (rawSupplies || []).map((s: any) => ({\n\t\t\t...s,\n\t\t\tid: s.id || crypto.randomUUID(),\n\t\t\ttaxDeductible: !!s.taxDeductible\n\t\t}));\n\t\tconst to24h = (timeStr?: string): string => {\n\t\t\tif (!timeStr) return '';\n\t\t\t// If already in 24h format (no AM/PM), return as-is\n\t\t\tif (!/AM|PM/i.test(timeStr)) return timeStr;\n\t\t\tconst [time = '', modifier = ''] = timeStr.split(' ');\n\t\t\tconst [hours = '0', minutes = '00'] = (time || '').split(':');\n\t\t\tlet h = parseInt(hours, 10) || 0;\n\t\t\tif (h === 12) h = 0;\n\t\t\tif (modifier && modifier.toUpperCase() === 'PM') h += 12;\n\t\t\treturn `${h.toString().padStart(2, '0')}:${minutes}`;\n\t\t};\n\t\t// Mutating the existing `tripData` preserves the narrow LocalTrip type for the template\n\t\tconst src = JSON.parse(JSON.stringify(found)) as any;\n\t\ttripData.id = String(src.id || tripData.id);\n\t\ttripData.date = normalizeDate(src.date);\n\t\ttripData.payDate = src.payDate ? normalizeDate(src.payDate) : '';\n\t\ttripData.startAddress = String(src.startAddress || '');\n\t\ttripData.endAddress = String(src.endAddress || '');\n\t\ttripData.stops = safeStops as any as LocalStop[];\n\t\ttripData.maintenanceItems = safeMaintenance as any;\n\t\ttripData.suppliesItems = safeSupplies as any;\n\t\t// Use trip's totalMiles as source of truth, mileage store is for display on mileage page\n\t\tconst milesFromMileage = $mileage.find((m: any) => m.id === tripId)?.miles;\n\t\tconst milesValue = Number(milesFromMileage ?? src.totalMiles) || 0;\n\t\ttripData.totalMiles = milesValue;\n\t\ttripData.mpg = Number.isFinite(Number(src.mpg))\n\t\t\t? Number(src.mpg)\n\t\t\t: ($userSettings.defaultMPG ?? 25);\n\t\ttripData.gasPrice = Number.isFinite(Number(src.gasPrice))\n\t\t\t? Number(src.gasPrice)\n\t\t\t: ($userSettings.defaultGasPrice ?? 3.5);\n\t\ttripData.fuelCost = Number(src.fuelCost) || 0;\n\t\ttripData.taxDeductible = !!src.taxDeductible;\n\t\ttripData.hoursWorked = Number(src.hoursWorked) || 0;\n\t\ttripData.estimatedTime = Number(src.estimatedTime) || 0;\n\t\ttripData.startTime = to24h(src.startTime as string | undefined);\n\t\ttripData.endTime = to24h(src.endTime as string | undefined);\n\t\ttripData.notes = String(src.notes || '');\n\n\t\t// Sync local form-bound variables to prevent reactive statements from overwriting\n\t\tstartAddressLocal = tripData.startAddress;\n\t\tendAddressLocal = tripData.endAddress;\n\t\tdateLocal = tripData.date;\n\t\tpayDateLocal = tripData.payDate;\n\t\tstartTimeLocal = tripData.startTime;\n\t\tendTimeLocal = tripData.endTime;\n\t\tmpgLocal = tripData.mpg;\n\t\tgasPriceLocal = tripData.gasPrice;\n\t\ttotalMilesLocal = milesValue;\n\t\tnotesLocal = tripData.notes;\n\t}\n\n\t// Local narrowed types for component-internal safety (NO index-signature inheritance)\n\ttype LocalStop = {\n\t\tid: string;\n\t\taddress: string;\n\t\tearnings: number;\n\t\tnotes: string;\n\t\tdistanceFromPrev: number;\n\t\ttimeFromPrev: number;\n\t\torder: number;\n\t};\n\ttype LocalTrip = {\n\t\tid: string;\n\t\tdate: string;\n\t\tpayDate: string;\n\t\tstartTime: string;\n\t\tendTime: string;\n\t\thoursWorked: number;\n\t\tstartAddress: string;\n\t\tendAddress: string;\n\t\tstops: LocalStop[];\n\t\ttotalMiles: number;\n\t\tmpg: number;\n\t\tgasPrice: number;\n\t\tfuelCost: number;\n\t\testimatedTime: number;\n\t\troundTripMiles: number;\n\t\troundTripTime: number;\n\t\tmaintenanceItems: import('$lib/types').CostItem[];\n\t\tsuppliesItems: import('$lib/types').CostItem[];\n\t\tnotes: string;\n\t\ttaxDeductible: boolean;\n\t};\n\n\t// Fix async narrowing: capture index and re-check after await in loops\n\tasync function recalculateAllLegs() {\n\t\tisCalculating = true;\n\t\ttry {\n\t\t\tlet prevAddress = tripData.startAddress;\n\t\t\tfor (let i = 0; i < tripData.stops.length; i++) {\n\t\t\t\tconst idx = i;\n\t\t\t\tconst currentStop = tripData.stops[idx];\n\t\t\t\tif (!currentStop) continue;\n\t\t\t\tconst addr = currentStop.address;\n\t\t\t\tif (!addr) {\n\t\t\t\t\tprevAddress = addr;\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tif (prevAddress) {\n\t\t\t\t\tconst leg = await fetchRouteSegment(prevAddress, addr);\n\t\t\t\t\tif (leg) {\n\t\t\t\t\t\tconst s = tripData.stops[idx];\n\t\t\t\t\t\tif (s) {\n\t\t\t\t\t\t\ts.distanceFromPrev = leg.distance;\n\t\t\t\t\t\t\ts.timeFromPrev = leg.duration;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tprevAddress = addr;\n\t\t\t}\n\t\t\tawait recalculateTotals();\n\t\t} finally {\n\t\t\tisCalculating = false;\n\t\t}\n\t}\n\n\t// Remove duplicate reactive `totalSuppliesCost` if present later in file (kept only one occurrence)\n\tlet tripData: LocalTrip = {\n\t\tid: String(crypto.randomUUID()),\n\t\tdate: String(getLocalDate()),\n\t\tpayDate: String(''),\n\t\tstartTime: String('09:00'),\n\t\tendTime: String('17:00'),\n\t\thoursWorked: 0,\n\t\tstartAddress: '',\n\t\tendAddress: '',\n\t\tstops: [] as LocalStop[],\n\t\ttotalMiles: 0,\n\t\testimatedTime: 0,\n\t\troundTripMiles: 0,\n\t\troundTripTime: 0,\n\t\tmpg: 25,\n\t\tgasPrice: 3.5,\n\t\tfuelCost: 0,\n\t\tmaintenanceItems: [] as import('$lib/types').CostItem[],\n\t\tsuppliesItems: [] as import('$lib/types').CostItem[],\n\t\ttaxDeductible: false,\n\n\t\tnotes: ''\n\t};\n\t// Local form-bound copies ΓÇö ensure template bindings are primitive-typed for the compiler\n\tlet startAddressLocal: string = tripData.startAddress ?? '';\n\tlet endAddressLocal: string = tripData.endAddress ?? '';\n\tlet dateLocal: string = tripData.date ?? getLocalDate();\n\tlet payDateLocal: string = tripData.payDate ?? '';\n\tlet startTimeLocal: string = tripData.startTime ?? '09:00';\n\tlet endTimeLocal: string = tripData.endTime ?? '17:00';\n\tlet mpgLocal: number = Number(tripData.mpg ?? 25);\n\tlet gasPriceLocal: number = Number(tripData.gasPrice ?? 3.5);\n\tlet totalMilesLocal: number = Number(tripData.totalMiles ?? 0);\n\tlet notesLocal: string = tripData.notes ?? '';\n\t$: tripData.startAddress = startAddressLocal;\n\t$: tripData.endAddress = endAddressLocal;\n\t$: tripData.date = dateLocal;\n\t$: tripData.payDate = payDateLocal;\n\t$: tripData.startTime = startTimeLocal;\n\t$: tripData.endTime = endTimeLocal;\n\t$: tripData.mpg = mpgLocal;\n\t$: tripData.gasPrice = gasPriceLocal;\n\t$: tripData.totalMiles = totalMilesLocal;\n\t// Keep the form-local value in sync when the app recalculates totals (e.g. route API results).\n\t// Guarded assignment prevents an unnecessary reactive cycle when the user edits the input.\n\t$: if (Number(tripData.totalMiles || 0) !== Number(totalMilesLocal || 0))\n\t\ttotalMilesLocal = Number(tripData.totalMiles || 0);\n\t$: tripData.notes = notesLocal;\n\n\tlet newStop = { address: '', earnings: 0, notes: '' };\n\n\tfunction generateRouteKey(start: string, end: string) {\n\t\tconst s = start\n\t\t\t.toLowerCase()\n\t\t\t.trim()\n\t\t\t.replace(/[^a-z0-9]/g, '');\n\t\tconst e = end\n\t\t\t.toLowerCase()\n\t\t\t.trim()\n\t\t\t.replace(/[^a-z0-9]/g, '');\n\t\treturn `kv_route_${s}_to_${e}`;\n\t}\n\tasync function fetchRouteSegment(start: string, end: string) {\n\t\tif (!start || !end) return null;\n\t\tconst localKey = generateRouteKey(start, end);\n\n\t\t// If the addresses are identical, short-circuit and return 0 (cache locally)\n\t\tconst sameAddress = start.toLowerCase().trim() === end.toLowerCase().trim();\n\t\tif (sameAddress) {\n\t\t\tconst mappedResult = { distance: 0, duration: 0 };\n\t\t\tconsole.info('[route] same-address', localKey);\n\t\t\ttry {\n\t\t\t\tlocalStorage.setItem(localKey, JSON.stringify({ ...mappedResult, cachedAt: Date.now() }));\n\t\t\t} catch (e) {\n\t\t\t\tconsole.warn('[route] localStorage write failed', e);\n\t\t\t}\n\t\t\treturn mappedResult;\n\t\t}\n\n\t\t// Prefer server-side KV/cache first\n\t\ttry {\n\t\t\tconst res = await fetch(\n\t\t\t\t`/api/directions/cache?start=${encodeURIComponent(start)}&end=${encodeURIComponent(end)}`\n\t\t\t);\n\t\t\tconst result: any = await res.json().catch(() => null);\n\t\t\tif (res.ok && result && result.data) {\n\t\t\t\tconst mappedResult = {\n\t\t\t\t\tdistance: result.data.distance * 0.000621371,\n\t\t\t\t\tduration: result.data.duration / 60\n\t\t\t\t};\n\n\t\t\t\t// Only cache valid responses (non-zero)\n\t\t\t\tif ((mappedResult.distance || 0) > 0 && (mappedResult.duration || 0) > 0) {\n\t\t\t\t\tconsole.info('[route] server hit', localKey, { source: result.source });\n\t\t\t\t\ttry {\n\t\t\t\t\t\tlocalStorage.setItem(\n\t\t\t\t\t\t\tlocalKey,\n\t\t\t\t\t\t\tJSON.stringify({ ...mappedResult, cachedAt: Date.now() })\n\t\t\t\t\t\t);\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\tconsole.warn('[route] localStorage write failed', e);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tconsole.info('[route] server returned invalid metrics; not caching', localKey);\n\t\t\t\t}\n\t\t\t\treturn mappedResult;\n\t\t\t} else {\n\t\t\t\tconsole.info('[route] server miss or error', localKey);\n\t\t\t}\n\t\t} catch (err) {\n\t\t\tconsole.info('[route] server fetch failed, falling back to local cache', localKey, err);\n\t\t}\n\n\t\t// Fallback to local cache\n\t\ttry {\n\t\t\tconst cached = localStorage.getItem(localKey);\n\t\t\tif (cached) {\n\t\t\t\tconst parsed = JSON.parse(cached);\n\t\t\t\tif ((parsed.distance || 0) > 0 && (parsed.duration || 0) > 0) {\n\t\t\t\t\tconsole.info('[route] cache hit', localKey);\n\t\t\t\t\treturn { distance: parsed.distance, duration: parsed.duration };\n\t\t\t\t} else {\n\t\t\t\t\tconsole.info('[route] cache contained invalid data; ignoring', localKey);\n\t\t\t\t\tlocalStorage.removeItem(localKey);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tconsole.info('[route] cache miss', localKey);\n\t\t\t}\n\t\t} catch (e) {\n\t\t\tconsole.warn('[route] cache read failed', e);\n\t\t}\n\n\t\treturn null;\n\t}\n\t/* duplicate (older) implementation removed ΓÇö use the stable-index implementation declared earlier */\n\tasync function recalculateTotals() {\n\t\tlet miles = tripData.stops.reduce((acc, s) => acc + (s.distanceFromPrev || 0), 0);\n\t\tlet mins = tripData.stops.reduce((acc, s) => acc + (s.timeFromPrev || 0), 0);\n\t\tlet returnMiles = 0;\n\t\tlet returnMins = 0;\n\n\t\tif (tripData.stops.length > 0) {\n\t\t\tconst lastStop = tripData.stops[tripData.stops.length - 1];\n\t\t\tconst startPoint = lastStop ? lastStop.address : tripData.startAddress;\n\t\t\tconst endPoint = tripData.endAddress || tripData.startAddress;\n\t\t\tif (startPoint && endPoint && endPoint !== startPoint) {\n\t\t\t\tconst finalLeg = await fetchRouteSegment(startPoint, endPoint);\n\t\t\t\tif (finalLeg) {\n\t\t\t\t\tmiles += finalLeg.distance;\n\t\t\t\t\tmins += finalLeg.duration;\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tconst startPoint = tripData.startAddress;\n\t\t\tconst endPoint = tripData.endAddress || tripData.startAddress;\n\t\t\tif (startPoint && endPoint) {\n\t\t\t\tconst finalLeg = await fetchRouteSegment(startPoint, endPoint);\n\t\t\t\tif (finalLeg) {\n\t\t\t\t\tmiles += finalLeg.distance;\n\t\t\t\t\tmins += finalLeg.duration;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (\n\t\t\ttripData.endAddress &&\n\t\t\ttripData.startAddress &&\n\t\t\ttripData.endAddress.trim() !== tripData.startAddress.trim()\n\t\t) {\n\t\t\tconst backLeg = await fetchRouteSegment(tripData.endAddress, tripData.startAddress);\n\t\t\tif (backLeg) {\n\t\t\t\treturnMiles = backLeg.distance;\n\t\t\t\treturnMins = backLeg.duration;\n\t\t\t}\n\t\t}\n\n\t\ttripData.totalMiles = parseFloat(miles.toFixed(1));\n\t\ttripData.estimatedTime = Math.round(mins);\n\t\ttripData.roundTripMiles = parseFloat((miles + returnMiles).toFixed(1));\n\t\ttripData.roundTripTime = Math.round(mins + returnMins);\n\t\ttripData = { ...tripData } as LocalTrip;\n\t}\n\n\tasync function handleOptimize() {\n\t\tif (!tripData.startAddress) {\n\t\t\ttoasts.error('Please enter a start address first.');\n\t\t\treturn;\n\t\t}\n\t\tif (tripData.stops.length < 2) {\n\t\t\ttoasts.error('Add at least 2 stops to optimize.');\n\t\t\treturn;\n\t\t}\n\t\tisCalculating = true;\n\t\ttry {\n\t\t\tconst result: any = await optimizeRoute(\n\t\t\t\ttripData.startAddress,\n\t\t\t\ttripData.endAddress,\n\t\t\t\ttripData.stops\n\t\t\t);\n\t\t\tif (result && result.optimizedOrder) {\n\t\t\t\tconst currentStops = [...tripData.stops];\n\t\t\t\tlet orderedStops = [];\n\t\t\t\tif (!tripData.endAddress) {\n\t\t\t\t\tconst movingStops = currentStops.slice(0, -1);\n\t\t\t\t\tconst fixedLast = currentStops[currentStops.length - 1];\n\t\t\t\t\torderedStops = result.optimizedOrder.map((i: number) => movingStops[i]);\n\t\t\t\t\torderedStops.push(fixedLast);\n\t\t\t\t} else {\n\t\t\t\t\torderedStops = result.optimizedOrder.map((i: number) => currentStops[i]);\n\t\t\t\t}\n\t\t\t\ttripData.stops = orderedStops.map((s: any, i: number) => ({\n\t\t\t\t\t...s,\n\t\t\t\t\torder: i\n\t\t\t\t})) as LocalStop[];\n\t\t\t\tif (result.legs) {\n\t\t\t\t\ttripData.stops.forEach((stop, i) => {\n\t\t\t\t\t\tif (result.legs[i]) {\n\t\t\t\t\t\t\tstop.distanceFromPrev = result.legs[i].distance.value * 0.000621371;\n\t\t\t\t\t\t\tstop.timeFromPrev = result.legs[i].duration.value / 60;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tawait recalculateTotals();\n\t\t\t\ttoasts.success('Route optimized!');\n\t\t\t}\n\t\t} catch (e: any) {\n\t\t\tconsole.error(e);\n\t\t\tconst msg = (e.message || '').toLowerCase();\n\t\t\tif (e.code === 'PLAN_LIMIT' || msg.includes('plan limit') || msg.includes('pro feature')) {\n\t\t\t\tupgradeMessage = e.message || 'Route Optimization is a Pro feature.';\n\t\t\t\tshowUpgradeModal = true;\n\t\t\t} else {\n\t\t\t\ttoasts.error('Optimization failed: ' + e.message);\n\t\t\t}\n\t\t} finally {\n\t\t\tisCalculating = false;\n\t\t}\n\t}\n\n\tasync function handleStopChange(index: number, placeOrEvent: any) {\n\t\tconst idx = index;\n\t\tconst current = tripData.stops[idx];\n\t\tif (!current) return;\n\t\tconst val = placeOrEvent?.formatted_address || placeOrEvent?.name || current.address;\n\t\tif (!val) return;\n\t\tcurrent.address = val;\n\t\tconsole.info('[route] handleStopChange', { index: idx, val });\n\t\tisCalculating = true;\n\t\ttry {\n\t\t\tconst prevLoc = idx === 0 ? tripData.startAddress : tripData.stops[idx - 1]?.address;\n\t\t\tif (prevLoc) {\n\t\t\t\tconst legIn = await fetchRouteSegment(prevLoc, val);\n\t\t\t\tif (legIn) {\n\t\t\t\t\tconst s = tripData.stops[idx];\n\t\t\t\t\tif (s) {\n\t\t\t\t\t\ts.distanceFromPrev = legIn.distance;\n\t\t\t\t\t\ts.timeFromPrev = legIn.duration;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tconst isSame = prevLoc.toLowerCase().trim() === (val || '').toLowerCase().trim();\n\t\t\t\t\tif (isSame) {\n\t\t\t\t\t\tconsole.info('[route] handleStopChange same-address', { index: idx, val });\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\ttoasts.info('Stop address matches the previous point (0 miles)');\n\t\t\t\t\t\t} catch (_e) {\n\t\t\t\t\t\t\tvoid _e;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tconst nextIdx = idx + 1;\n\t\t\tconst nextStop = tripData.stops[nextIdx];\n\t\t\tif (nextStop) {\n\t\t\t\tconst legOut = await fetchRouteSegment(val, nextStop.address);\n\t\t\t\tif (legOut) {\n\t\t\t\t\tconst s2 = tripData.stops[nextIdx];\n\t\t\t\t\tif (s2) {\n\t\t\t\t\t\ts2.distanceFromPrev = legOut.distance;\n\t\t\t\t\t\ts2.timeFromPrev = legOut.duration;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tawait recalculateTotals();\n\t\t} finally {\n\t\t\tisCalculating = false;\n\t\t}\n\t}\n\tasync function handleMainAddressChange(type: 'start' | 'end', placeOrEvent: any) {\n\t\tconst val =\n\t\t\tplaceOrEvent?.formatted_address ||\n\t\t\tplaceOrEvent?.name ||\n\t\t\t(type === 'start' ? tripData.startAddress : tripData.endAddress);\n\t\tif (type === 'start') tripData.startAddress = val;\n\t\telse tripData.endAddress = val;\n\t\tisCalculating = true;\n\t\ttry {\n\t\t\tif (type === 'start' && tripData.stops.length > 0) {\n\t\t\t\tconst firstCandidate = tripData.stops[0];\n\t\t\t\tif (!firstCandidate || !val) {\n\t\t\t\t\t/* no-op: nothing to calculate */\n\t\t\t\t} else {\n\t\t\t\t\tconst leg = await fetchRouteSegment(val, firstCandidate.address);\n\t\t\t\t\tif (leg) {\n\t\t\t\t\t\tfirstCandidate.distanceFromPrev = leg.distance;\n\t\t\t\t\t\tfirstCandidate.timeFromPrev = leg.duration;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tawait recalculateTotals();\n\t\t} finally {\n\t\t\tisCalculating = false;\n\t\t}\n\t}\n\tasync function handleNewStopSelect(e: CustomEvent) {\n\t\tconst place = e.detail;\n\t\tif (place?.formatted_address || place?.name) {\n\t\t\tnewStop.address = place.formatted_address || place.name;\n\t\t\tawait addStop();\n\t\t}\n\t}\n\n\tasync function addStop() {\n\t\tif (!newStop.address) return;\n\t\tif (\n\t\t\ttripData.stops.length >= (PLAN_LIMITS.FREE.MAX_STOPS || 5) &&\n\t\t\t($user?.plan === 'free' || !$user?.plan)\n\t\t) {\n\t\t\ttoasts.error(\n\t\t\t\t`The Free plan is limited to ${PLAN_LIMITS.FREE.MAX_STOPS || 5} stops per trip.`\n\t\t\t);\n\t\t\treturn;\n\t\t}\n\n\t\tconst lastStop = tripData.stops[tripData.stops.length - 1];\n\t\tconst segmentStart = lastStop && lastStop.address ? lastStop.address : tripData.startAddress;\n\t\tif (!segmentStart) {\n\t\t\ttoasts.error('Please enter a Starting Address first.');\n\t\t\treturn;\n\t\t}\n\n\t\tisCalculating = true;\n\t\ttry {\n\t\t\tconst segmentData: any = await fetchRouteSegment(segmentStart, newStop.address);\n\t\t\tif (!segmentData) throw new Error('Could not calculate route.');\n\n\t\t\ttripData.stops = [\n\t\t\t\t...tripData.stops,\n\t\t\t\t{\n\t\t\t\t\t...newStop,\n\t\t\t\t\tid: crypto.randomUUID(),\n\t\t\t\t\torder: tripData.stops.length,\n\t\t\t\t\tdistanceFromPrev: segmentData.distance,\n\t\t\t\t\ttimeFromPrev: segmentData.duration\n\t\t\t\t} as LocalStop\n\t\t\t];\n\n\t\t\tawait recalculateTotals();\n\t\t\tnewStop = { address: '', earnings: 0, notes: '' };\n\t\t\t// Ensure `order` is present and typed\n\t\t\ttripData.stops = tripData.stops.map((s: LocalStop | any, i: number) => ({\n\t\t\t\t...s,\n\t\t\t\torder: i\n\t\t\t})) as LocalStop[];\n\t\t} catch (err: any) {\n\t\t\tconsole.error('addStop failed', err);\n\t\t\ttoasts.error(err?.message ? String(err.message) : 'Error calculating route segment.');\n\t\t} finally {\n\t\t\tisCalculating = false;\n\t\t}\n\t}\n\n\tfunction removeStop(id: string) {\n\t\ttripData.stops = tripData.stops.filter((s) => s.id !== id);\n\t\trecalculateAllLegs();\n\t}\n\tfunction handleDragStart(event: DragEvent, index: number) {\n\t\tdragItemIndex = index;\n\t\tif (event.dataTransfer) {\n\t\t\tevent.dataTransfer.effectAllowed = 'move';\n\t\t\tevent.dataTransfer.dropEffect = 'move';\n\t\t\tevent.dataTransfer.setData('text/plain', index.toString());\n\t\t}\n\t}\n\tfunction handleDragOver(event: DragEvent) {\n\t\tevent.preventDefault();\n\t\treturn false;\n\t}\n\tasync function handleDrop(event: DragEvent, dropIndex: number) {\n\t\tevent.preventDefault();\n\t\tif (dragItemIndex === null) return;\n\t\tconst item = tripData.stops[dragItemIndex];\n\t\tif (!item) return;\n\t\tconst newStops = tripData.stops.filter((_, i) => i !== dragItemIndex);\n\t\tnewStops.splice(dropIndex, 0, item);\n\t\ttripData.stops = newStops;\n\t\tdragItemIndex = null;\n\t\tawait recalculateAllLegs();\n\t}\n\tfunction addMaintenanceItem() {\n\t\tif (!selectedMaintenance) return;\n\t\ttripData.maintenanceItems = [\n\t\t\t...tripData.maintenanceItems,\n\t\t\t{ id: crypto.randomUUID(), type: selectedMaintenance, cost: 0, taxDeductible: false }\n\t\t];\n\t\tselectedMaintenance = '';\n\t}\n\tfunction removeMaintenanceItem(id: string) {\n\t\ttripData.maintenanceItems = tripData.maintenanceItems.filter((m) => m.id !== id);\n\t}\n\tfunction addSupplyItem() {\n\t\tif (!selectedSupply) return;\n\t\ttripData.suppliesItems = [\n\t\t\t...tripData.suppliesItems,\n\t\t\t{ id: crypto.randomUUID(), type: selectedSupply, cost: 0, taxDeductible: false }\n\t\t];\n\t\tselectedSupply = '';\n\t}\n\tfunction removeSupplyItem(id: string) {\n\t\ttripData.suppliesItems = tripData.suppliesItems.filter((s) => s.id !== id);\n\t}\n\tfunction openSettings(type: 'maintenance' | 'supplies') {\n\t\tactiveCategoryType = type;\n\t\tisManageCategoriesOpen = true;\n\t}\n\tasync function updateCategories(newCategories: string[]) {\n\t\tconst updateData: any = {};\n\t\tif (activeCategoryType === 'maintenance') {\n\t\t\tuserSettings.update((s) => ({ ...s, maintenanceCategories: newCategories }));\n\t\t\tupdateData.maintenanceCategories = newCategories;\n\t\t} else {\n\t\t\tuserSettings.update((s) => ({ ...s, supplyCategories: newCategories }));\n\t\t\tupdateData.supplyCategories = newCategories;\n\t\t}\n\t\ttry {\n\t\t\tconst { saveSettings } = await import('../../../settings/lib/save-settings');\n\t\t\tconst result = await saveSettings(updateData);\n\t\t\tif (!result.ok) throw new Error(result.error);\n\t\t} catch (e) {\n\t\t\tconsole.error('Failed to sync settings', e);\n\t\t\ttoasts.error('Saved locally, but sync failed');\n\t\t}\n\t}\n\tasync function addCategory() {\n\t\tif (!newCategoryName.trim()) return;\n\t\tconst val = newCategoryName.trim();\n\t\tif (activeCategories.some((c) => c.toLowerCase() === val.toLowerCase())) {\n\t\t\ttoasts.error('Category already exists');\n\t\t\treturn;\n\t\t}\n\t\tconst updated = [...activeCategories, val];\n\t\tawait updateCategories(updated);\n\t\tnewCategoryName = '';\n\t\ttoasts.success('Category added');\n\t}\n\tasync function removeCategory(cat: string) {\n\t\tif (!confirm(`Delete \"${cat}\" category?`)) return;\n\t\tconst updated = activeCategories.filter((c) => c !== cat);\n\t\tawait updateCategories(updated);\n\t\ttoasts.success('Category removed');\n\t}\n\n\t$: {\n\t\tif (tripData.totalMiles && tripData.mpg && tripData.gasPrice) {\n\t\t\tconst gallons = tripData.totalMiles / tripData.mpg;\n\t\t\ttripData.fuelCost = Math.round(gallons * tripData.gasPrice * 100) / 100;\n\t\t} else {\n\t\t\ttripData.fuelCost = 0;\n\t\t}\n\t}\n\tlet totalEarnings = 0;\n\tlet totalMaintenanceCost = 0;\n\tlet totalSuppliesCost = 0;\n\tlet totalCosts = 0;\n\tlet totalProfit = 0;\n\t$: totalEarnings = tripData.stops.reduce(\n\t\t(sum, stop) => sum + (parseFloat(String(stop.earnings || 0)) || 0),\n\t\t0\n\t);\n\t$: totalMaintenanceCost = (tripData.maintenanceItems || []).reduce(\n\t\t(sum, item) => sum + (item.cost || 0),\n\t\t0\n\t);\n\t$: totalSuppliesCost = (tripData.suppliesItems || []).reduce(\n\t\t(sum, item) => sum + (item.cost || 0),\n\t\t0\n\t);\n\t$: totalCosts = (tripData.fuelCost || 0) + totalMaintenanceCost + totalSuppliesCost;\n\t$: totalProfit = totalEarnings - totalCosts;\n\t$: {\n\t\tif (tripData.startTime && tripData.endTime) {\n\t\t\tconst [startHour, startMin] = tripData.startTime.split(':').map(Number) as [number, number];\n\t\t\tconst [endHour, endMin] = tripData.endTime.split(':').map(Number) as [number, number];\n\t\t\tlet diff = endHour * 60 + endMin - (startHour * 60 + startMin);\n\t\t\tif (diff < 0) diff += 24 * 60;\n\t\t\ttripData.hoursWorked = Math.round((diff / 60) * 10) / 10;\n\t\t}\n\t}\n\n\tasync function saveTrip() {\n\t\tconst currentUser = $page.data['user'] || $user;\n\t\tconst userId = currentUser?.id || localStorage.getItem('offline_user_id');\n\t\tif (!userId) {\n\t\t\ttoasts.error('Authentication error. Please login.');\n\t\t\treturn;\n\t\t}\n\n\t\tconst tripToSave = {\n\t\t\t...tripData,\n\t\t\tid: tripId,\n\t\t\tmaintenanceCost: totalMaintenanceCost,\n\t\t\tsuppliesCost: totalSuppliesCost,\n\t\t\tnetProfit: totalProfit,\n\t\t\t// Ensure `totalMiles` is always present for analytics\n\t\t\ttotalMiles: tripData.totalMiles,\n\t\t\ttotalMileage: tripData.totalMiles,\n\t\t\tfuelCost: tripData.fuelCost,\n\t\t\troundTripMiles: tripData.roundTripMiles,\n\t\t\troundTripTime: tripData.roundTripTime,\n\t\t\tstops: tripData.stops.map((stop, index) => ({\n\t\t\t\t...stop,\n\t\t\t\tid: String(stop.id || crypto.randomUUID()),\n\t\t\t\tearnings: Number(stop.earnings) || 0,\n\t\t\t\torder: index\n\t\t\t})),\n\t\t\tdestinations: tripData.stops.map((stop) => ({\n\t\t\t\taddress: stop.address,\n\t\t\t\tearnings: stop.earnings,\n\t\t\t\tnotes: stop.notes || ''\n\t\t\t})),\n\t\t\tsupplyItems: tripData.suppliesItems,\n\t\t\tsuppliesItems: tripData.suppliesItems,\n\t\t\tupdatedAt: new Date().toISOString()\n\t\t};\n\t\ttry {\n\t\t\t// userId is checked above; coerce to string to satisfy TS\n\t\t\tconst uid = String(userId);\n\t\t\tawait trips.updateTrip(String(tripId), tripToSave, uid);\n\t\t\ttoasts.success('Trip updated successfully!');\n\t\t\tgoto(resolve('/dashboard/trips'));\n\t\t} catch (err: any) {\n\t\t\tconsole.error('Update failed:', err);\n\t\t\tconst message = err?.message || 'Failed to update trip.';\n\t\t\ttoasts.error(message);\n\t\t}\n\t}\n\n\tfunction formatCurrency(amount: number) {\n\t\treturn new Intl.NumberFormat('en-US', {\n\t\t\tstyle: 'currency',\n\t\t\tcurrency: 'USD',\n\t\t\tminimumFractionDigits: 2\n\t\t}).format(amount);\n\t}\n\tfunction formatDateLocal(dateString?: string) {\n\t\tif (!dateString) return '';\n\t\tconst [y, m, d] = dateString.split('-').map(Number);\n\t\tconst yy = y || 0;\n\t\tconst mm = m || 1;\n\t\tconst dd = d || 1;\n\t\treturn new Date(yy, mm - 1, dd).toLocaleDateString('en-US', {\n\t\t\tmonth: 'numeric',\n\t\t\tday: 'numeric',\n\t\t\tyear: 'numeric'\n\t\t});\n\t}\n</script>\n\n<div class=\"trip-form\">\n\t<div class=\"page-header\">\n\t\t<div>\n\t\t\t<h1 class=\"page-title\">Edit Trip</h1>\n\t\t\t<p class=\"page-subtitle\">Update route and expenses</p>\n\t\t</div>\n\t\t<a href={resolve('/dashboard/trips')} class=\"btn-back\"\n\t\t\t><svg width=\"24\" height=\"24\" viewBox=\"0 0 20 20\" fill=\"none\"\n\t\t\t\t><path\n\t\t\t\t\td=\"M12 4L6 10L12 16\"\n\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\t\tstroke-linejoin=\"round\"\n\t\t\t\t/></svg\n\t\t\t> Back</a\n\t\t>\n\t</div>\n\n\t<div class=\"form-content\">\n\t\t<!-- Basic Information Section -->\n\t\t<div class=\"form-card\">\n\t\t\t<div class=\"card-header\"><h2 class=\"card-title\">Basic Information</h2></div>\n\t\t\t<div class=\"form-grid\">\n\t\t\t\t<div class=\"form-group\">\n\t\t\t\t\t<label for=\"trip-date\">Date</label><input\n\t\t\t\t\t\tid=\"trip-date\"\n\t\t\t\t\t\ttype=\"date\"\n\t\t\t\t\t\tbind:value={dateLocal}\n\t\t\t\t\t\trequired\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"form-group\">\n\t\t\t\t\t<label for=\"trip-pay-date\">Pay Date <span class=\"hint\">(Optional)</span></label><input\n\t\t\t\t\t\tid=\"trip-pay-date\"\n\t\t\t\t\t\ttype=\"date\"\n\t\t\t\t\t\tbind:value={payDateLocal}\n\t\t\t\t\t/>\n\t\t\t\t\t<div class=\"hint\">Tax purposes</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"form-row\">\n\t\t\t\t\t<div class=\"form-group\">\n\t\t\t\t\t\t<label for=\"start-time\">Start Time</label><input\n\t\t\t\t\t\t\tid=\"start-time\"\n\t\t\t\t\t\t\ttype=\"time\"\n\t\t\t\t\t\t\tbind:value={startTimeLocal}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"form-group\">\n\t\t\t\t\t\t<label for=\"end-time\">End Time</label><input\n\t\t\t\t\t\t\tid=\"end-time\"\n\t\t\t\t\t\t\ttype=\"time\"\n\t\t\t\t\t\t\tbind:value={endTimeLocal}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"form-group\">\n\t\t\t\t\t<label for=\"hours-display\">Hours Worked</label>\n\t\t\t\t\t<div id=\"hours-display\" class=\"readonly-field\">\n\t\t\t\t\t\t{tripData.hoursWorked.toFixed(1)} hours\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<!-- Route & Stops Section -->\n\t\t<div class=\"form-card\">\n\t\t\t<div class=\"card-header\">\n\t\t\t\t<h2 class=\"card-title\">Route & Stops</h2>\n\t\t\t\t<button\n\t\t\t\t\tclass=\"btn-small primary\"\n\t\t\t\t\ton:click={handleOptimize}\n\t\t\t\t\ttype=\"button\"\n\t\t\t\t\tdisabled={isCalculating}\n\t\t\t\t\ttitle=\"Reorder stops efficiently\">{isCalculating ? 'Optimizing...' : 'Optimize'}</button\n\t\t\t\t>\n\t\t\t</div>\n\t\t\t<div class=\"form-group\">\n\t\t\t\t<label for=\"start-address\">Starting Address</label><input\n\t\t\t\t\tid=\"start-address\"\n\t\t\t\t\ttype=\"text\"\n\t\t\t\t\tvalue={startAddressLocal}\n\t\t\t\t\ton:input={(e) => (startAddressLocal = String((e.target as HTMLInputElement).value || ''))}\n\t\t\t\t\tuse:autocomplete={{ apiKey: API_KEY }}\n\t\t\t\t\ton:place-selected={(e) => handleMainAddressChange('start', e.detail)}\n\t\t\t\t\ton:blur={() =>\n\t\t\t\t\t\thandleMainAddressChange('start', { formatted_address: tripData.startAddress })}\n\t\t\t\t\tclass=\"address-input\"\n\t\t\t\t\tplaceholder=\"Enter start address...\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<div class=\"stops-container\">\n\t\t\t\t<div class=\"stops-header\">\n\t\t\t\t\t<h3>Stops</h3>\n\t\t\t\t\t<span class=\"count\">{tripData.stops.length} added</span>\n\t\t\t\t</div>\n\t\t\t\t{#if tripData.stops.length > 0}\n\t\t\t\t\t<div class=\"stops-list\">\n\t\t\t\t\t\t{#each tripData.stops as stop, i (stop.id)}\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tclass=\"stop-card\"\n\t\t\t\t\t\t\t\trole=\"button\"\n\t\t\t\t\t\t\t\ttabindex=\"0\"\n\t\t\t\t\t\t\t\tdraggable=\"true\"\n\t\t\t\t\t\t\t\ton:dragstart={(e) => handleDragStart(e, i)}\n\t\t\t\t\t\t\t\ton:drop={(e) => handleDrop(e, i)}\n\t\t\t\t\t\t\t\ton:dragover={handleDragOver}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<div class=\"stop-header\">\n\t\t\t\t\t\t\t\t\t<div class=\"stop-number\">{i + 1}</div>\n\t\t\t\t\t\t\t\t\t<div class=\"stop-actions\">\n\t\t\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\t\t\tclass=\"btn-icon delete\"\n\t\t\t\t\t\t\t\t\t\t\ton:click={() => removeStop(String(stop.id ?? ''))}>Γ£ò</button\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<div class=\"drag-handle\">Γÿ░</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class=\"stop-inputs\">\n\t\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\t\t\tvalue={String(stop.address ?? '')}\n\t\t\t\t\t\t\t\t\t\ton:input={(e) => (stop.address = (e.target as HTMLInputElement).value || '')}\n\t\t\t\t\t\t\t\t\t\tuse:autocomplete={{ apiKey: API_KEY }}\n\t\t\t\t\t\t\t\t\t\ton:place-selected={(e) => handleStopChange(i, e.detail)}\n\t\t\t\t\t\t\t\t\t\ton:blur={() => handleStopChange(i, { formatted_address: stop.address })}\n\t\t\t\t\t\t\t\t\t\tclass=\"address-input\"\n\t\t\t\t\t\t\t\t\t\tplaceholder=\"Address\"\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t<div class=\"input-money-wrapper\">\n\t\t\t\t\t\t\t\t\t\t<span class=\"symbol\">$</span><input\n\t\t\t\t\t\t\t\t\t\t\ttype=\"number\"\n\t\t\t\t\t\t\t\t\t\t\tclass=\"input-money\"\n\t\t\t\t\t\t\t\t\t\t\tvalue={String(stop.earnings ?? 0)}\n\t\t\t\t\t\t\t\t\t\t\ton:input={(e) =>\n\t\t\t\t\t\t\t\t\t\t\t\t(stop.earnings = Number((e.target as HTMLInputElement).value) || 0)}\n\t\t\t\t\t\t\t\t\t\t\tstep=\"0.01\"\n\t\t\t\t\t\t\t\t\t\t\tplaceholder=\"Earnings\"\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t{/each}\n\t\t\t\t\t</div>\n\t\t\t\t{/if}\n\t\t\t\t<div class=\"add-stop-form\">\n\t\t\t\t\t<div class=\"stop-inputs new\">\n\t\t\t\t\t\t<input\n\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\tbind:value={newStop.address}\n\t\t\t\t\t\t\tplaceholder=\"New stop address...\"\n\t\t\t\t\t\t\tuse:autocomplete={{ apiKey: API_KEY }}\n\t\t\t\t\t\t\ton:place-selected={handleNewStopSelect}\n\t\t\t\t\t\t\tclass=\"address-input\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<div class=\"input-money-wrapper\">\n\t\t\t\t\t\t\t<span class=\"symbol\">$</span><input\n\t\t\t\t\t\t\t\ttype=\"number\"\n\t\t\t\t\t\t\t\tclass=\"input-money\"\n\t\t\t\t\t\t\t\tplaceholder=\"0.00\"\n\t\t\t\t\t\t\t\tbind:value={newStop.earnings}\n\t\t\t\t\t\t\t\tstep=\"0.01\"\n\t\t\t\t\t\t\t\tmin=\"0\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class=\"form-group\">\n\t\t\t\t<label for=\"end-address\">End Address (Optional)</label><input\n\t\t\t\t\tid=\"end-address\"\n\t\t\t\t\ttype=\"text\"\n\t\t\t\t\tvalue={endAddressLocal}\n\t\t\t\t\ton:input={(e) => (endAddressLocal = (e.target as HTMLInputElement).value || '')}\n\t\t\t\t\tuse:autocomplete={{ apiKey: API_KEY }}\n\t\t\t\t\ton:place-selected={(e) => handleMainAddressChange('end', e.detail)}\n\t\t\t\t\ton:blur={() => handleMainAddressChange('end', { formatted_address: endAddressLocal })}\n\t\t\t\t\tclass=\"address-input\"\n\t\t\t\t\tplaceholder=\"Same as start if empty\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<div class=\"form-row\">\n\t\t\t\t<div class=\"form-group\">\n\t\t\t\t\t<label for=\"total-miles\">Total Miles</label><input\n\t\t\t\t\t\tid=\"total-miles\"\n\t\t\t\t\t\ttype=\"number\"\n\t\t\t\t\t\tbind:value={totalMilesLocal}\n\t\t\t\t\t\tstep=\"0.1\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"form-group\">\n\t\t\t\t\t<label for=\"drive-time\">Drive Time <span class=\"hint\">(Est)</span></label>\n\t\t\t\t\t<div id=\"drive-time\" class=\"readonly-field\">\n\t\t\t\t\t\t{formatDuration(tripData.estimatedTime)}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<!-- Costs Section -->\n\t\t<div class=\"form-card\">\n\t\t\t<div class=\"card-header\"><h2 class=\"card-title\">Costs</h2></div>\n\t\t\t<div class=\"form-row\">\n\t\t\t\t<div class=\"form-group\">\n\t\t\t\t\t<label for=\"mpg\">MPG</label><input\n\t\t\t\t\t\tid=\"mpg\"\n\t\t\t\t\t\ttype=\"number\"\n\t\t\t\t\t\tbind:value={mpgLocal}\n\t\t\t\t\t\tstep=\"0.1\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"form-group\">\n\t\t\t\t\t<label for=\"gas-price\">Gas Price</label>\n\t\t\t\t\t<div class=\"input-money-wrapper\">\n\t\t\t\t\t\t<span class=\"symbol\">$</span><input\n\t\t\t\t\t\t\tid=\"gas-price\"\n\t\t\t\t\t\t\ttype=\"number\"\n\t\t\t\t\t\t\tbind:value={gasPriceLocal}\n\t\t\t\t\t\t\tstep=\"0.01\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class=\"summary-box\" style=\"margin: 40px 0;\">\n\t\t\t\t<span>Estimated Fuel Cost</span><strong>{formatCurrency(tripData.fuelCost)}</strong>\n\t\t\t</div>\n\n\t\t\t<div class=\"info-note\">\n\t\t\t\t<span\n\t\t\t\t\t><strong>Note:</strong> Use the checkboxes next to each Maintenance or Supplies item to mark\n\t\t\t\t\tthat individual item as tax-deductible.</span\n\t\t\t\t>\n\t\t\t</div>\n\t\t\t<div class=\"section-group\">\n\t\t\t\t<div class=\"section-top\">\n\t\t\t\t\t<h3>Maintenance</h3>\n\t\t\t\t\t<button\n\t\t\t\t\t\tclass=\"btn-icon gear\"\n\t\t\t\t\t\ton:click={() => openSettings('maintenance')}\n\t\t\t\t\t\ttitle=\"Manage Options\"\n\t\t\t\t\t\t><svg\n\t\t\t\t\t\t\twidth=\"20\"\n\t\t\t\t\t\t\theight=\"20\"\n\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\t\t\t\tfill=\"none\"\n\t\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\t\t\t\tstroke-linejoin=\"round\"\n\t\t\t\t\t\t\t><circle cx=\"12\" cy=\"12\" r=\"3\"></circle><path\n\t\t\t\t\t\t\t\td=\"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z\"\n\t\t\t\t\t\t\t></path></svg\n\t\t\t\t\t\t></button\n\t\t\t\t\t>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"add-row\">\n\t\t\t\t\t<select\n\t\t\t\t\t\tbind:value={selectedMaintenance}\n\t\t\t\t\t\tclass=\"select-input\"\n\t\t\t\t\t\taria-label=\"Maintenance type\"\n\t\t\t\t\t\t><option value=\"\" disabled selected>Select Item...</option\n\t\t\t\t\t\t>{#each maintenanceOptions as option (option)}<option value={option}>{option}</option\n\t\t\t\t\t\t\t>{/each}</select\n\t\t\t\t\t><button\n\t\t\t\t\t\tclass=\"btn-small primary\"\n\t\t\t\t\t\ton:click={addMaintenanceItem}\n\t\t\t\t\t\tdisabled={!selectedMaintenance}>Add</button\n\t\t\t\t\t>\n\t\t\t\t</div>\n\t\t\t\t{#each tripData.maintenanceItems as item, i (item.id ?? i)}<div class=\"expense-row\">\n\t\t\t\t\t\t<span class=\"name\">{item.type}</span>\n\t\t\t\t\t\t<div class=\"input-money-wrapper small\">\n\t\t\t\t\t\t\t<span class=\"symbol\">$</span><input\n\t\t\t\t\t\t\t\ttype=\"number\"\n\t\t\t\t\t\t\t\tbind:value={item.cost}\n\t\t\t\t\t\t\t\tplaceholder=\"0.00\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"item-controls\">\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\tclass=\"tax-pill\"\n\t\t\t\t\t\t\t\ton:click={() => (item.taxDeductible = !item.taxDeductible)}\n\t\t\t\t\t\t\t\taria-pressed={item.taxDeductible}\n\t\t\t\t\t\t\t\ttitle=\"Mark this item as tax deductible\"\n\t\t\t\t\t\t\t\t>{item.taxDeductible ? 'Tax' : 'No Tax'}</button\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<label class=\"inline-label sr-only\"\n\t\t\t\t\t\t\t\t><input type=\"checkbox\" bind:checked={item.taxDeductible} /></label\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tclass=\"btn-icon delete\"\n\t\t\t\t\t\t\ton:click={() => removeMaintenanceItem(String(item.id ?? ''))}>Γ£ò</button\n\t\t\t\t\t\t>\n\t\t\t\t\t</div>{/each}\n\t\t\t</div>\n\t\t\t<div class=\"section-group\">\n\t\t\t\t<div class=\"section-top\">\n\t\t\t\t\t<h3>Supplies</h3>\n\t\t\t\t\t<button\n\t\t\t\t\t\tclass=\"btn-icon gear\"\n\t\t\t\t\t\ton:click={() => openSettings('supplies')}\n\t\t\t\t\t\ttitle=\"Manage Options\"\n\t\t\t\t\t\t><svg\n\t\t\t\t\t\t\twidth=\"20\"\n\t\t\t\t\t\t\theight=\"20\"\n\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\t\t\t\tfill=\"none\"\n\t\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\t\t\t\tstroke-linejoin=\"round\"\n\t\t\t\t\t\t\t><circle cx=\"12\" cy=\"12\" r=\"3\"></circle><path\n\t\t\t\t\t\t\t\td=\"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z\"\n\t\t\t\t\t\t\t></path></svg\n\t\t\t\t\t\t></button\n\t\t\t\t\t>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"add-row\">\n\t\t\t\t\t<select bind:value={selectedSupply} class=\"select-input\" aria-label=\"Supply type\"\n\t\t\t\t\t\t><option value=\"\" disabled selected>Select Item...</option\n\t\t\t\t\t\t>{#each suppliesOptions as option (option)}<option value={option}>{option}</option\n\t\t\t\t\t\t\t>{/each}</select\n\t\t\t\t\t><button class=\"btn-small primary\" on:click={addSupplyItem} disabled={!selectedSupply}\n\t\t\t\t\t\t>Add</button\n\t\t\t\t\t>\n\t\t\t\t</div>\n\t\t\t\t{#each tripData.suppliesItems as item, i (item.id ?? i)}<div class=\"expense-row\">\n\t\t\t\t\t\t<span class=\"name\">{item.type}</span>\n\t\t\t\t\t\t<div class=\"input-money-wrapper small\">\n\t\t\t\t\t\t\t<span class=\"symbol\">$</span><input\n\t\t\t\t\t\t\t\ttype=\"number\"\n\t\t\t\t\t\t\t\tbind:value={item.cost}\n\t\t\t\t\t\t\t\tplaceholder=\"0.00\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"item-controls\">\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\tclass=\"tax-pill\"\n\t\t\t\t\t\t\t\ton:click={() => (item.taxDeductible = !item.taxDeductible)}\n\t\t\t\t\t\t\t\taria-pressed={item.taxDeductible}\n\t\t\t\t\t\t\t\ttitle=\"Mark this item as tax deductible\"\n\t\t\t\t\t\t\t\t>{item.taxDeductible ? 'Tax' : 'No Tax'}</button\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<label class=\"inline-label sr-only\"\n\t\t\t\t\t\t\t\t><input type=\"checkbox\" bind:checked={item.taxDeductible} /></label\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<button class=\"btn-icon delete\" on:click={() => removeSupplyItem(String(item.id ?? ''))}\n\t\t\t\t\t\t\t>Γ£ò</button\n\t\t\t\t\t\t>\n\t\t\t\t\t</div>{/each}\n\t\t\t</div>\n\t\t\t<div class=\"form-group\">\n\t\t\t\t<label for=\"notes\">Notes</label><textarea\n\t\t\t\t\tid=\"notes\"\n\t\t\t\t\tbind:value={notesLocal}\n\t\t\t\t\trows=\"3\"\n\t\t\t\t\tplaceholder=\"Trip details...\"\n\t\t\t\t></textarea>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<!-- Review Section -->\n\t\t<div class=\"form-card\">\n\t\t\t<div class=\"card-header\"><h2 class=\"card-title\">Review</h2></div>\n\t\t\t<div class=\"review-grid\">\n\t\t\t\t<div class=\"review-tile\">\n\t\t\t\t\t<span class=\"review-label\">Date</span>\n\t\t\t\t\t<div>{formatDateLocal(String(tripData.date || ''))}</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"review-tile\">\n\t\t\t\t\t<span class=\"review-label\">Total Time</span>\n\t\t\t\t\t<div>{tripData.hoursWorked.toFixed(1)} hrs</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"review-tile\">\n\t\t\t\t\t<span class=\"review-label\">Drive Time</span>\n\t\t\t\t\t<div>{formatDuration(tripData.estimatedTime)}</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"review-tile\">\n\t\t\t\t\t<span class=\"review-label\">Hours Worked</span>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t{Math.max(0, tripData.hoursWorked - tripData.estimatedTime / 60).toFixed(1)} hrs\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"review-tile\">\n\t\t\t\t\t<span class=\"review-label\">Distance</span>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t{tripData.totalMiles} mi\n\t\t\t\t\t\t{#if tripData.roundTripMiles && tripData.roundTripMiles !== tripData.totalMiles}\n\t\t\t\t\t\t\tΓÇó Round trip: {tripData.roundTripMiles} mi ΓÇó {tripData.roundTripTime} min\n\t\t\t\t\t\t{/if}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"review-tile\">\n\t\t\t\t\t<span class=\"review-label\">Stops</span>\n\t\t\t\t\t<div>{tripData.stops.length}</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class=\"financial-summary\">\n\t\t\t\t<div class=\"row\">\n\t\t\t\t\t<span>Earnings</span> <span class=\"val positive\">{formatCurrency(totalEarnings)}</span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"row subheader\"><span>Expenses Breakdown</span></div>\n\t\t\t\t{#if tripData.fuelCost > 0}<div class=\"row detail\">\n\t\t\t\t\t\t<span>Fuel</span> <span class=\"val\">{formatCurrency(tripData.fuelCost)}</span>\n\t\t\t\t\t</div>{/if}{#each tripData.maintenanceItems as item, i (item.id ?? i)}<div\n\t\t\t\t\t\tclass=\"row detail\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<span>{item.type}</span> <span class=\"val\">{formatCurrency(item.cost)}</span>\n\t\t\t\t\t</div>{/each}{#each tripData.suppliesItems as item, i (item.id ?? i)}<div\n\t\t\t\t\t\tclass=\"row detail\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<span>{item.type}</span> <span class=\"val\">{formatCurrency(item.cost)}</span>\n\t\t\t\t\t</div>{/each}\n\t\t\t\t<div class=\"row total-expenses\">\n\t\t\t\t\t<span>Total Expenses</span>\n\t\t\t\t\t<span class=\"val negative\">-{formatCurrency(totalCosts)}</span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"row total\">\n\t\t\t\t\t<span>Net Profit</span>\n\t\t\t\t\t<span class=\"val\" class:positive={totalProfit >= 0}>{formatCurrency(totalProfit)}</span>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<!-- Save Button -->\n\t\t\t<div class=\"form-actions\">\n\t\t\t\t<button class=\"btn-primary full-width\" on:click={saveTrip}>Update Trip</button>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>\n\n<Modal bind:open={isManageCategoriesOpen} title=\"Manage Options\">\n\t<div class=\"categories-manager\">\n\t\t<div class=\"tabs\">\n\t\t\t<button\n\t\t\t\tclass=\"tab-btn\"\n\t\t\t\tclass:active={activeCategoryType === 'maintenance'}\n\t\t\t\ton:click={() => (activeCategoryType = 'maintenance')}>Maintenance</button\n\t\t\t>\n\t\t\t<button\n\t\t\t\tclass=\"tab-btn\"\n\t\t\t\tclass:active={activeCategoryType === 'supplies'}\n\t\t\t\ton:click={() => (activeCategoryType = 'supplies')}>Supplies</button\n\t\t\t>\n\t\t</div>\n\t\t<div class=\"cat-list\">\n\t\t\t{#each activeCategories as cat (cat)}\n\t\t\t\t<div class=\"cat-item\">\n\t\t\t\t\t<span class=\"cat-badge\">{cat}</span>\n\t\t\t\t\t<button\n\t\t\t\t\t\tclass=\"cat-delete\"\n\t\t\t\t\t\ton:click={() => removeCategory(cat)}\n\t\t\t\t\t\taria-label=\"Delete Category\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\twidth=\"16\"\n\t\t\t\t\t\t\theight=\"16\"\n\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\t\t\t\tfill=\"none\"\n\t\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\t\t\t\tstroke-linejoin=\"round\"\n\t\t\t\t\t\t\t><line x1=\"18\" y1=\"6\" x2=\"6\" y2=\"18\"></line><line x1=\"6\" y1=\"6\" x2=\"18\" y2=\"18\"\n\t\t\t\t\t\t\t></line></svg\n\t\t\t\t\t\t>\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t{:else}\n\t\t\t\t<div class=\"text-sm text-gray-400 italic text-center py-4\">No categories defined.</div>\n\t\t\t{/each}\n\t\t</div>\n\t\t<div class=\"add-cat-form\">\n\t\t\t<input\n\t\t\t\ttype=\"text\"\n\t\t\t\tbind:value={newCategoryName}\n\t\t\t\tplaceholder=\"New Item Name...\"\n\t\t\t\tclass=\"input-field\"\n\t\t\t\ton:keydown={(e) => e.key === 'Enter' && addCategory()}\n\t\t\t/>\n\t\t\t<button class=\"btn-secondary\" on:click={addCategory}>Add</button>\n\t\t</div>\n\t\t<div class=\"modal-actions mt-6\">\n\t\t\t<button class=\"btn-cancel w-full\" on:click={() => (isManageCategoriesOpen = false)}\n\t\t\t\t>Done</button\n\t\t\t>\n\t\t</div>\n\t</div>\n</Modal>\n\n<Modal bind:open={showUpgradeModal} title=\"Upgrade to Pro\">\n\t<div class=\"space-y-6 text-center py-4\">\n\t\t<div class=\"mx-auto w-16 h-16 bg-orange-100 rounded-full flex items-center justify-center mb-4\">\n\t\t\t<span class=\"text-3xl\">≡ƒÜÇ</span>\n\t\t</div>\n\n\t\t<h3 class=\"text-xl font-bold text-gray-900\">Unlock Pro Features</h3>\n\n\t\t<p class=\"text-gray-600\">\n\t\t\t{upgradeMessage || \"You've hit the limits of the Free plan.\"}\n\t\t</p>\n\n\t\t<div class=\"bg-gray-50 p-4 rounded-lg text-left text-sm space-y-2 border border-gray-100\">\n\t\t\t<div class=\"flex items-center gap-2\">\n\t\t\t\t<span class=\"text-green-500\">Γ£ô</span>\n\t\t\t\t<span>Unlimited Stops per Trip</span>\n\t\t\t</div>\n\t\t\t<div class=\"flex items-center gap-2\">\n\t\t\t\t<span class=\"text-green-500\">Γ£ô</span>\n\t\t\t\t<span>One-Click Route Optimization</span>\n\t\t\t</div>\n\t\t\t<div class=\"flex items-center gap-2\">\n\t\t\t\t<span class=\"text-green-500\">Γ£ô</span>\n\t\t\t\t<span>Unlimited Monthly Trips</span>\n\t\t\t</div>\n\t\t\t<div class=\"flex items-center gap-2\">\n\t\t\t\t<span class=\"text-green-500\">Γ£ô</span>\n\t\t\t\t<span>Data Export</span>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<div class=\"flex gap-3 justify-center pt-2\">\n\t\t\t<Button variant=\"outline\" on:click={() => (showUpgradeModal = false)}>Maybe Later</Button>\n\t\t\t<a\n\t\t\t\thref={resolve('/dashboard/settings')}\n\t\t\t\tclass=\"inline-flex items-center justify-center rounded-lg bg-orange-600 px-6 py-2.5 text-sm font-semibold text-white shadow-sm hover:bg-orange-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-orange-600\"\n\t\t\t>\n\t\t\t\tUpgrade Now\n\t\t\t</a>\n\t\t</div>\n\t</div>\n</Modal>\n\n<style>\n\t/* Use styles from New Trip page for consistency */\n\t/* Component-level override: hide old pill button and show visible checkbox + label */\n\t.item-controls .tax-pill {\n\t\tdisplay: none !important;\n\t\tvisibility: hidden !important;\n\t}\n\t.item-controls .inline-label.sr-only {\n\t\tposition: static !important;\n\t\twidth: auto !important;\n\t\theight: auto !important;\n\t\tdisplay: inline-flex !important;\n\t\talign-items: center;\n\t\tgap: 6px;\n\t}\n\t.item-controls .inline-label.sr-only input[type='checkbox'] {\n\t\tappearance: checkbox !important;\n\t\tdisplay: inline-block !important;\n\t\topacity: 1 !important;\n\t\twidth: 18px !important;\n\t\theight: 18px !important;\n\t\tmargin-right: 6px !important;\n\t}\n\t.item-controls .inline-label.sr-only::after {\n\t\tcontent: 'Tax deductible';\n\t\tmargin-left: 6px;\n\t\tfont-weight: 600;\n\t\tcolor: #374151;\n\t\tfont-size: 13px;\n\t}\n\t.item-controls .inline-label {\n\t\tdisplay: inline-flex;\n\t\talign-items: center;\n\t\tgap: 6px;\n\t}\n\t.trip-form {\n\t\tmax-width: 1300px;\n\t\tmargin: 0 auto;\n\t\tpadding: 4px;\n\t\tpadding-bottom: 90px;\n\t}\n\n\t@media (max-width: 640px) {\n\t\t.trip-form {\n\t\t\tpadding-bottom: calc(env(safe-area-inset-bottom, 0px) + 1px);\n\t\t}\n\t}\n\t.page-header {\n\t\tdisplay: flex;\n\t\tjustify-content: space-between;\n\t\talign-items: center;\n\t\tmargin-bottom: 26px;\n\t\tpadding: 0 8px;\n\t}\n\t.page-title {\n\t\tfont-size: 28px;\n\t\tfont-weight: 800;\n\t\tcolor: #111827;\n\t\tmargin: 0;\n\t}\n\t.page-subtitle {\n\t\tfont-size: 14px;\n\t\tcolor: #6b7280;\n\t\tdisplay: none;\n\t}\n\t.btn-back {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tgap: 8px;\n\t\tfont-weight: 600;\n\t\tcolor: #6b7280;\n\t\ttext-decoration: none;\n\t\tfont-size: 14px;\n\t}\n\t.form-card {\n\t\tbackground: white;\n\t\tborder: 1px solid #e5e7eb;\n\t\tborder-radius: 18px;\n\t\tpadding: 16px;\n\t\tbox-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);\n\t\tmargin-bottom: 20px;\n\t}\n\t.card-header {\n\t\tdisplay: flex;\n\t\tjustify-content: space-between;\n\t\talign-items: center;\n\t\tmargin-bottom: 26px;\n\t}\n\t.card-title {\n\t\tfont-size: 22px;\n\t\tfont-weight: 700;\n\t\tcolor: #111827;\n\t\tmargin: 0;\n\t}\n\t.form-grid {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tgap: 24px;\n\t}\n\t.form-row {\n\t\tdisplay: grid;\n\t\tgrid-template-columns: 1fr 1fr;\n\t\tgap: 20px;\n\t}\n\t.form-group {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tgap: 8px;\n\t}\n\tlabel {\n\t\tfont-size: 16px;\n\t\tfont-weight: 600;\n\t\tcolor: #374151;\n\t}\n\t.hint {\n\t\tcolor: #9ca3af;\n\t\tfont-weight: 400;\n\t}\n\tinput,\n\ttextarea {\n\t\twidth: 100%;\n\t\tpadding: 16px;\n\t\tborder: 1px solid #e5e7eb;\n\t\tborder-radius: 12px;\n\t\tfont-size: 18px;\n\t\tbackground: white;\n\t\tbox-sizing: border-box;\n\t}\n\tinput:focus,\n\ttextarea:focus {\n\t\toutline: none;\n\t\tborder-color: #ff7f50;\n\t}\n\t.readonly-field {\n\t\tbackground: #f9fafb;\n\t\tpadding: 16px;\n\t\tborder-radius: 12px;\n\t\tborder: 1px solid #e5e7eb;\n\t\tcolor: #6b7280;\n\t\tfont-weight: 500;\n\t\tfont-size: 18px;\n\t}\n\t.address-input {\n\t\tpadding-top: 20px;\n\t\tpadding-bottom: 20px;\n\t\tfont-size: 19px;\n\t}\n\t.input-money-wrapper {\n\t\tposition: relative;\n\t\twidth: 100%;\n\t}\n\t.input-money-wrapper .symbol {\n\t\tposition: absolute;\n\t\tleft: 16px;\n\t\ttop: 50%;\n\t\ttransform: translateY(-50%);\n\t\tcolor: #6b7280;\n\t\tfont-weight: 600;\n\t\tfont-size: 18px;\n\t}\n\t.input-money-wrapper input {\n\t\tpadding-left: 36px;\n\t}\n\t.input-money-wrapper.small input {\n\t\tpadding: 12px 12px 12px 30px;\n\t\tfont-size: 16px;\n\t}\n\t.input-money-wrapper.small .symbol {\n\t\tleft: 12px;\n\t\tfont-size: 16px;\n\t}\n\t.stops-container {\n\t\tmargin: 26px 0;\n\t\tborder: 1px solid #e5e7eb;\n\t\tborder-radius: 14px;\n\t\tpadding: 16px;\n\t\tbackground: #f9fafb;\n\t}\n\t.stops-header {\n\t\tdisplay: flex;\n\t\tjustify-content: space-between;\n\t\tmargin-bottom: 18px;\n\t\talign-items: center;\n\t}\n\t.stops-header h3 {\n\t\tfont-size: 18px;\n\t\tfont-weight: 700;\n\t\tmargin: 0;\n\t}\n\t.stops-header .count {\n\t\tfont-size: 14px;\n\t\tcolor: #6b7280;\n\t\tbackground: #e5e7eb;\n\t\tpadding: 5px 12px;\n\t\tborder-radius: 10px;\n\t}\n\t.stops-list {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tgap: 18px;\n\t\tmargin-bottom: 22px;\n\t}\n\t.stop-card {\n\t\tbackground: white;\n\t\tborder: 1px solid #e5e7eb;\n\t\tborder-radius: 14px;\n\t\tpadding: 18px;\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tgap: 18px;\n\t}\n\t.stop-header {\n\t\tdisplay: flex;\n\t\tjustify-content: space-between;\n\t\talign-items: center;\n\t}\n\t.stop-number {\n\t\tbackground: #ff7f50;\n\t\tcolor: white;\n\t\twidth: 30px;\n\t\theight: 30px;\n\t\tborder-radius: 8px;\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t\tfont-weight: 700;\n\t\tfont-size: 15px;\n\t}\n\t.stop-actions {\n\t\tdisplay: flex;\n\t\tgap: 18px;\n\t\talign-items: center;\n\t\tcolor: #9ca3af;\n\t}\n\t.stop-inputs {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tgap: 14px;\n\t\twidth: 100%;\n\t}\n\t.stop-inputs.new {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tgap: 14px;\n\t\tmargin-bottom: 18px;\n\t}\n\t.form-actions {\n\t\tdisplay: flex;\n\t\tgap: 18px;\n\t\tmargin-top: 36px;\n\t\tpadding-top: 26px;\n\t\tborder-top: 1px solid #e5e7eb;\n\t}\n\t.btn-primary,\n\t.btn-secondary {\n\t\tflex: 1;\n\t\tpadding: 18px;\n\t\tborder-radius: 12px;\n\t\tfont-weight: 600;\n\t\tfont-size: 18px;\n\t\tcursor: pointer;\n\t\tborder: none;\n\t\ttext-align: center;\n\t}\n\t.btn-primary {\n\t\tbackground: linear-gradient(135deg, #ff7f50 0%, #ff6a3d 100%);\n\t\tcolor: white;\n\t}\n\t.btn-secondary {\n\t\tbackground: white;\n\t\tborder: 1px solid #e5e7eb;\n\t\tcolor: #374151;\n\t}\n\t.btn-icon {\n\t\tbackground: none;\n\t\tborder: none;\n\t\tfont-size: 22px;\n\t\tcursor: pointer;\n\t\tcolor: #9ca3af;\n\t\tpadding: 6px;\n\t}\n\t.btn-icon.delete:hover {\n\t\tcolor: #dc2626;\n\t}\n\t.btn-icon.gear {\n\t\tcolor: #6b7280;\n\t\tfont-size: 18px;\n\t\tpadding: 4px;\n\t\ttransition: color 0.2s;\n\t}\n\t.btn-icon.gear:hover {\n\t\tcolor: #374151;\n\t}\n\n\t.btn-small {\n\t\tpadding: 12px 18px;\n\t\tborder-radius: 8px;\n\t\tborder: none;\n\t\tfont-weight: 600;\n\t\tfont-size: 15px;\n\t\tcursor: pointer;\n\t}\n\t.btn-small.primary {\n\t\tbackground: #10b981;\n\t\tcolor: white;\n\t}\n\t.summary-box {\n\t\tbackground: #ecfdf5;\n\t\tborder: 1px solid #a7f3d0;\n\t\tpadding: 22px;\n\t\tborder-radius: 14px;\n\t\tdisplay: flex;\n\t\tjustify-content: space-between;\n\t\talign-items: center;\n\t\tcolor: #065f46;\n\t\tmargin-bottom: 36px;\n\t\tfont-size: 18px;\n\t}\n\t.section-group {\n\t\tmargin-bottom: 36px;\n\t}\n\t.section-top {\n\t\tdisplay: flex;\n\t\tjustify-content: space-between;\n\t\tmargin-bottom: 18px;\n\t\talign-items: center;\n\t}\n\t.section-top h3 {\n\t\tfont-size: 18px;\n\t\tfont-weight: 700;\n\t\tmargin: 0;\n\t}\n\n\t.add-row {\n\t\tdisplay: flex;\n\t\tgap: 12px;\n\t\tmargin-bottom: 18px;\n\t}\n\t.select-input {\n\t\tflex: 1;\n\t\tpadding: 12px;\n\t\tborder: 1px solid #e5e7eb;\n\t\tborder-radius: 10px;\n\t\tfont-size: 16px;\n\t\tbackground: white;\n\t\tcolor: #374151;\n\t}\n\n\t.expense-row {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tjustify-content: space-between;\n\t\tgap: 14px;\n\t\tpadding: 14px 0;\n\t\tborder-bottom: 1px solid #f3f4f6;\n\t}\n\t.expense-row .name {\n\t\tfont-size: 17px;\n\t\tfont-weight: 500;\n\t\tflex: 1;\n\t}\n\t.expense-row .input-money-wrapper {\n\t\twidth: 120px;\n\t}\n\t.review-grid {\n\t\tdisplay: grid;\n\t\tgrid-template-columns: 1fr 1fr;\n\t\tgap: 18px;\n\t\tmargin-bottom: 36px;\n\t}\n\t.review-tile {\n\t\tbackground: #f9fafb;\n\t\tpadding: 18px;\n\t\tborder-radius: 14px;\n\t\tborder: 1px solid #e5e7eb;\n\t}\n\t.review-tile .review-label {\n\t\tdisplay: block;\n\t\tfont-size: 14px;\n\t\tcolor: #6b7280;\n\t\ttext-transform: uppercase;\n\t\tmargin-bottom: 4px;\n\t}\n\t.review-tile div {\n\t\tfont-weight: 700;\n\t\tfont-size: 18px;\n\t\tcolor: #111827;\n\t}\n\t.financial-summary {\n\t\tbackground: #f9fafb;\n\t\tpadding: 26px;\n\t\tborder-radius: 16px;\n\t\tborder: 1px solid #e5e7eb;\n\t}\n\t.financial-summary .row {\n\t\tdisplay: flex;\n\t\tjustify-content: space-between;\n\t\tmargin-bottom: 14px;\n\t\tfont-size: 17px;\n\t}\n\t.financial-summary .row.subheader {\n\t\tfont-weight: 700;\n\t\tcolor: #374151;\n\t\tmargin-top: 18px;\n\t\tborder-bottom: 1px solid #e5e7eb;\n\t\tpadding-bottom: 4px;\n\t\tmargin-bottom: 8px;\n\t\tfont-size: 15px;\n\t}\n\t.financial-summary .row.detail {\n\t\tfont-size: 15px;\n\t\tcolor: #6b7280;\n\t}\n\t.financial-summary .row.total-expenses {\n\t\tfont-weight: 600;\n\t\tcolor: #4b5563;\n\t\tborder-top: 1px dashed #d1d5db;\n\t\tpadding-top: 8px;\n\t}\n\t.financial-summary .total {\n\t\tborder-top: 2px solid #d1d5db;\n\t\tmargin-top: 18px;\n\t\tpadding-top: 18px;\n\t\tfont-weight: 800;\n\t\tfont-size: 20px;\n\t}\n\t.val.positive {\n\t\tcolor: #059669;\n\t}\n\t.val.negative {\n\t\tcolor: #dc2626;\n\t}\n\n\t.categories-manager {\n\t\tpadding: 4px;\n\t}\n\t.tabs {\n\t\tdisplay: flex;\n\t\tgap: 8px;\n\t\tmargin-bottom: 16px;\n\t\tborder-bottom: 1px solid #e5e7eb;\n\t}\n\t.tab-btn {\n\t\tpadding: 8px 16px;\n\t\tbackground: none;\n\t\tborder: none;\n\t\tborder-bottom: 2px solid transparent;\n\t\tfont-weight: 600;\n\t\tcolor: #6b7280;\n\t\tcursor: pointer;\n\t\ttransition: all 0.2s;\n\t}\n\t.tab-btn.active {\n\t\tcolor: #ff7f50;\n\t\tborder-bottom-color: #ff7f50;\n\t}\n\t.cat-list {\n\t\tdisplay: flex;\n\t\tflex-wrap: wrap;\n\t\tgap: 8px;\n\t\tmargin-bottom: 20px;\n\t\tmax-height: 200px;\n\t\toverflow-y: auto;\n\t}\n\t.cat-item {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tgap: 4px;\n\t\tbackground: #f3f4f6;\n\t\tpadding: 4px 4px 4px 10px;\n\t\tborder-radius: 20px;\n\t\tborder: 1px solid #e5e7eb;\n\t}\n\t.cat-badge {\n\t\tfont-size: 13px;\n\t\tfont-weight: 500;\n\t\ttext-transform: capitalize;\n\t\tpadding: 0 4px;\n\t}\n\t.cat-delete {\n\t\tborder: none;\n\t\tbackground: #e5e7eb;\n\t\tcolor: #6b7280;\n\t\tborder-radius: 50%;\n\t\twidth: 24px;\n\t\theight: 24px;\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t\tcursor: pointer;\n\t\ttransition: all 0.2s;\n\t}\n\t.cat-delete:hover {\n\t\tbackground: #ef4444;\n\t\tcolor: white;\n\t}\n\t.add-cat-form {\n\t\tdisplay: flex;\n\t\tgap: 8px;\n\t}\n\t.add-cat-form .input-field {\n\t\tflex: 1;\n\t\tpadding: 10px;\n\t\tborder: 1px solid #e5e7eb;\n\t\tborder-radius: 8px;\n\t}\n\t.modal-actions .btn-cancel {\n\t\tbackground: white;\n\t\tborder: 1px solid #e5e7eb;\n\t\tcolor: #374151;\n\t\tpadding: 12px;\n\t\tborder-radius: 8px;\n\t\tfont-weight: 600;\n\t\tcursor: pointer;\n\t\twidth: 100%;\n\t}\n\n\t@media (min-width: 768px) {\n\t\t.page-subtitle {\n\t\t\tdisplay: block;\n\t\t}\n\t\t.form-card {\n\t\t\tpadding: 48px;\n\t\t}\n\t\t.stop-card {\n\t\t\tflex-direction: row;\n\t\t\talign-items: center;\n\t\t}\n\t\t.stop-inputs {\n\t\t\tdisplay: grid;\n\t\t\tgrid-template-columns: 1fr 160px;\n\t\t}\n\t\t.stop-inputs.new {\n\t\t\tdisplay: grid;\n\t\t\tgrid-template-columns: 1fr 160px;\n\t\t}\n\t\t.form-actions {\n\t\t\tjustify-content: flex-end;\n\t\t}\n\t\t.btn-primary,\n\t\t.btn-secondary {\n\t\t\tflex: 0 0 auto;\n\t\t\twidth: auto;\n\t\t\tmin-width: 160px;\n\t\t}\n\t}\n</style>\n",
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\dashboard\\trips\\new\\+page.svelte",
		"messages": [
			{
				"ruleId": "svelte/no-navigation-without-resolve",
				"severity": 1,
				"message": "Unexpected goto() call without resolve().",
				"line": 676,
				"column": 9,
				"nodeType": null,
				"messageId": "gotoWithoutResolve",
				"endLine": 676,
				"endColumn": 36
			},
			{
				"ruleId": "svelte/no-navigation-without-resolve",
				"severity": 1,
				"message": "Unexpected href link without resolve().",
				"line": 699,
				"column": 11,
				"nodeType": null,
				"messageId": "linkWithoutResolve",
				"endLine": 699,
				"endColumn": 40
			},
			{
				"ruleId": "svelte/no-navigation-without-resolve",
				"severity": 1,
				"message": "Unexpected href link without resolve().",
				"line": 1240,
				"column": 11,
				"nodeType": null,
				"messageId": "linkWithoutResolve",
				"endLine": 1240,
				"endColumn": 30
			}
		],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 3,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"source": "<script lang=\"ts\">\n\timport { trips } from '$lib/stores/trips';\n\timport { userSettings } from '$lib/stores/userSettings';\n\timport { goto } from '$app/navigation';\n\timport { base } from '$app/paths';\n\timport { user } from '$lib/stores/auth';\n\timport { page } from '$app/stores';\n\timport { autocomplete } from '$lib/utils/autocomplete';\n\timport { optimizeRoute } from '$lib/services/maps';\n\timport Modal from '$lib/components/ui/Modal.svelte';\n\timport { toasts } from '$lib/stores/toast';\n\timport Button from '$lib/components/ui/Button.svelte';\n\timport { PLAN_LIMITS } from '$lib/constants';\n\n\tconst resolve = (href: string) => `${base}${href}`;\n\n\texport let data;\n\t$: API_KEY = String(data.googleMapsApiKey ?? '');\n\tlet dragItemIndex: number | null = null;\n\n\t$: maintenanceOptions =\n\t\t$userSettings.maintenanceCategories?.length > 0\n\t\t\t? $userSettings.maintenanceCategories\n\t\t\t: ['Oil Change', 'Tire Rotation', 'Brake Service', 'Filter Replacement'];\n\t$: suppliesOptions =\n\t\t$userSettings.supplyCategories?.length > 0\n\t\t\t? $userSettings.supplyCategories\n\t\t\t: ['Concrete', 'Poles', 'Wire', 'Tools', 'Equipment Rental'];\n\n\tlet selectedMaintenance = '';\n\tlet selectedSupply = '';\n\n\tlet isManageCategoriesOpen = false;\n\tlet activeCategoryType: 'maintenance' | 'supplies' = 'maintenance';\n\tlet newCategoryName = '';\n\t$: activeCategories = activeCategoryType === 'maintenance' ? maintenanceOptions : suppliesOptions;\n\n\t// Upgrade Modal State\n\tlet showUpgradeModal = false;\n\tlet upgradeMessage = '';\n\n\tlet isCalculating = false;\n\tfunction getLocalDate() {\n\t\tconst now = new Date();\n\t\treturn new Date(now.getTime() - now.getTimezoneOffset() * 60000).toISOString().split('T')[0];\n\t}\n\n\t// Local narrowed types for component-internal safety (ensure required fields for bindings)\n\ttype LocalStop = {\n\t\tid: string;\n\t\taddress: string;\n\t\tearnings: number;\n\t\tnotes: string;\n\t\tdistanceFromPrev?: number;\n\t\ttimeFromPrev?: number;\n\t};\n\ttype LocalTrip = {\n\t\tid: string;\n\t\tdate: string;\n\t\tpayDate: string;\n\t\tstartTime: string;\n\t\tendTime: string;\n\t\thoursWorked: number;\n\t\tstartAddress: string;\n\t\tendAddress: string;\n\t\tstops: LocalStop[];\n\t\ttotalMiles: number;\n\t\tmpg: number;\n\t\tgasPrice: number;\n\t\tfuelCost: number;\n\t\testimatedTime: number;\n\t\troundTripMiles: number;\n\t\troundTripTime: number;\n\t\tmaintenanceItems: import('$lib/types').CostItem[];\n\t\tsuppliesItems: import('$lib/types').CostItem[];\n\t\tnotes: string;\n\t\ttaxDeductible: boolean;\n\t};\n\tlet tripData: LocalTrip = {\n\t\tid: String(crypto.randomUUID()),\n\t\tdate: String(getLocalDate()),\n\t\tpayDate: String(''),\n\t\tstartTime: String('09:00'),\n\t\tendTime: String('17:00'),\n\t\thoursWorked: 0,\n\t\tstartAddress: String(($userSettings as any).defaultStartAddress || ''),\n\t\tendAddress: String(($userSettings as any).defaultEndAddress || ''),\n\t\tstops: [] as LocalStop[],\n\t\ttotalMiles: 0,\n\t\testimatedTime: 0,\n\t\troundTripMiles: 0,\n\t\troundTripTime: 0,\n\t\tmpg: $userSettings.defaultMPG ?? 25,\n\t\tgasPrice: $userSettings.defaultGasPrice ?? 3.5,\n\t\tfuelCost: 0,\n\t\tmaintenanceItems: [] as import('$lib/types').CostItem[],\n\t\tsuppliesItems: [] as import('$lib/types').CostItem[],\n\t\ttaxDeductible: false,\n\t\tnotes: ''\n\t};\n\t// Local form-bound copies (narrow types) ΓÇö ensure template bindings are provably `string`/`number`\n\tlet startAddressLocal: string = tripData.startAddress ?? '';\n\tlet endAddressLocal: string = tripData.endAddress ?? '';\n\tlet dateLocal: string = tripData.date ?? getLocalDate();\n\tlet payDateLocal: string = tripData.payDate ?? '';\n\tlet startTimeLocal: string = tripData.startTime ?? '09:00';\n\tlet endTimeLocal: string = tripData.endTime ?? '17:00';\n\tlet mpgLocal: number = Number(tripData.mpg ?? 25);\n\tlet gasPriceLocal: number = Number(tripData.gasPrice ?? 3.5);\n\tlet totalMilesLocal: number = Number(tripData.totalMiles ?? 0);\n\tlet notesLocal: string = tripData.notes ?? '';\n\t$: tripData.startAddress = startAddressLocal;\n\t$: tripData.endAddress = endAddressLocal;\n\t$: tripData.date = dateLocal;\n\t$: tripData.payDate = payDateLocal;\n\t$: tripData.startTime = startTimeLocal;\n\t$: tripData.endTime = endTimeLocal;\n\t$: tripData.mpg = mpgLocal;\n\t$: tripData.gasPrice = gasPriceLocal;\n\t$: tripData.totalMiles = totalMilesLocal;\n\t// Keep the form-local value in sync when the app recalculates totals (e.g. route API results).\n\t// Guarded assignment prevents an unnecessary reactive cycle when the user edits the input.\n\t$: if (Number(tripData.totalMiles || 0) !== Number(totalMilesLocal || 0))\n\t\ttotalMilesLocal = Number(tripData.totalMiles || 0);\n\t$: tripData.notes = notesLocal;\n\n\tlet newStop = { address: '', earnings: 0, notes: '' };\n\n\tfunction formatDuration(minutes: number): string {\n\t\tif (!minutes) return '0 min';\n\t\tconst h = Math.floor(minutes / 60);\n\t\tconst m = Math.round(minutes % 60);\n\t\tif (h > 0) return `${h} hr ${m} min`;\n\t\treturn `${m} min`;\n\t}\n\n\tfunction generateRouteKey(start: string, end: string) {\n\t\tconst s = start\n\t\t\t.toLowerCase()\n\t\t\t.trim()\n\t\t\t.replace(/[^a-z0-9]/g, '');\n\t\tconst e = end\n\t\t\t.toLowerCase()\n\t\t\t.trim()\n\t\t\t.replace(/[^a-z0-9]/g, '');\n\t\treturn `kv_route_${s}_to_${e}`;\n\t}\n\n\tasync function fetchRouteSegment(start: string, end: string) {\n\t\tif (!start || !end) return null;\n\t\tconst localKey = generateRouteKey(start, end);\n\n\t\t// If the addresses are identical, short-circuit and return 0 (cache locally)\n\t\tconst sameAddress = start.toLowerCase().trim() === end.toLowerCase().trim();\n\t\tif (sameAddress) {\n\t\t\tconst mappedResult = { distance: 0, duration: 0 };\n\t\t\tconsole.info('[route] same-address', localKey);\n\t\t\ttry {\n\t\t\t\tlocalStorage.setItem(localKey, JSON.stringify({ ...mappedResult, cachedAt: Date.now() }));\n\t\t\t} catch (e) {\n\t\t\t\tconsole.warn('[route] localStorage write failed', e);\n\t\t\t}\n\t\t\treturn mappedResult;\n\t\t}\n\n\t\t// Prefer server-side KV/cache first\n\t\ttry {\n\t\t\tconst res = await fetch(\n\t\t\t\t`/api/directions/cache?start=${encodeURIComponent(start)}&end=${encodeURIComponent(end)}`\n\t\t\t);\n\t\t\tconst result: any = await res.json().catch(() => null);\n\t\t\tif (res.ok && result && result.data) {\n\t\t\t\tconst mappedResult = {\n\t\t\t\t\tdistance: result.data.distance * 0.000621371,\n\t\t\t\t\tduration: result.data.duration / 60\n\t\t\t\t};\n\n\t\t\t\t// Only cache valid responses (non-zero)\n\t\t\t\tif ((mappedResult.distance || 0) > 0 && (mappedResult.duration || 0) > 0) {\n\t\t\t\t\tconsole.info('[route] server hit', localKey, { source: result.source });\n\t\t\t\t\ttry {\n\t\t\t\t\t\tlocalStorage.setItem(\n\t\t\t\t\t\t\tlocalKey,\n\t\t\t\t\t\t\tJSON.stringify({ ...mappedResult, cachedAt: Date.now() })\n\t\t\t\t\t\t);\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\tconsole.warn('[route] localStorage write failed', e);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tconsole.info('[route] server returned invalid metrics; not caching', localKey);\n\t\t\t\t}\n\t\t\t\treturn mappedResult;\n\t\t\t} else {\n\t\t\t\tconsole.info('[route] server miss or error', localKey);\n\t\t\t}\n\t\t} catch (err) {\n\t\t\tconsole.info('[route] server fetch failed, falling back to local cache', localKey, err);\n\t\t}\n\n\t\t// Fallback to local cache\n\t\ttry {\n\t\t\tconst cached = localStorage.getItem(localKey);\n\t\t\tif (cached) {\n\t\t\t\tconst parsed = JSON.parse(cached);\n\t\t\t\tif ((parsed.distance || 0) > 0 && (parsed.duration || 0) > 0) {\n\t\t\t\t\tconsole.info('[route] cache hit', localKey);\n\t\t\t\t\treturn { distance: parsed.distance, duration: parsed.duration };\n\t\t\t\t} else {\n\t\t\t\t\tconsole.info('[route] cache contained invalid data; ignoring', localKey);\n\t\t\t\t\tlocalStorage.removeItem(localKey);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tconsole.info('[route] cache miss', localKey);\n\t\t\t}\n\t\t} catch (e) {\n\t\t\tconsole.warn('[route] cache read failed', e);\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tasync function recalculateAllLegs() {\n\t\tisCalculating = true;\n\t\ttry {\n\t\t\tlet prevAddress = tripData.startAddress;\n\t\t\tfor (let i = 0; i < tripData.stops.length; i++) {\n\t\t\t\tconst idx = i;\n\t\t\t\tconst currentStop = tripData.stops[idx];\n\t\t\t\tif (!currentStop) continue;\n\t\t\t\tconst addr = currentStop.address;\n\t\t\t\tif (!addr) {\n\t\t\t\t\tprevAddress = addr;\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tif (prevAddress) {\n\t\t\t\t\tconst leg = await fetchRouteSegment(prevAddress, addr);\n\t\t\t\t\tif (leg) {\n\t\t\t\t\t\tconst s = tripData.stops[idx];\n\t\t\t\t\t\tif (s) {\n\t\t\t\t\t\t\ts.distanceFromPrev = leg.distance;\n\t\t\t\t\t\t\ts.timeFromPrev = leg.duration;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tprevAddress = addr;\n\t\t\t}\n\t\t\tawait recalculateTotals();\n\t\t} finally {\n\t\t\tisCalculating = false;\n\t\t}\n\t}\n\n\tasync function recalculateTotals() {\n\t\tlet miles = tripData.stops.reduce((acc, s) => acc + (s.distanceFromPrev || 0), 0);\n\t\tlet mins = tripData.stops.reduce((acc, s) => acc + (s.timeFromPrev || 0), 0);\n\t\tlet returnMiles = 0;\n\t\tlet returnMins = 0;\n\n\t\t// If there are stops, use the sum of per-leg distances (already populated by recalculateAllLegs/handleStopChange)\n\t\t// and add the final leg from last stop -> endAddress when present.\n\t\tif (tripData.stops.length > 0) {\n\t\t\tconst lastStop = tripData.stops[tripData.stops.length - 1];\n\t\t\tif (!lastStop) return;\n\t\t\tconst startPoint = lastStop.address || tripData.startAddress;\n\t\t\tconst endPoint = tripData.endAddress || tripData.startAddress;\n\t\t\tif (startPoint && endPoint && endPoint !== startPoint) {\n\t\t\t\tconst finalLeg = await fetchRouteSegment(startPoint, endPoint);\n\t\t\t\tif (finalLeg) {\n\t\t\t\t\tmiles += finalLeg.distance;\n\t\t\t\t\tmins += finalLeg.duration;\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\t// No stops: single leg from start -> end\n\t\t\tconst startPoint = tripData.startAddress;\n\t\t\tconst endPoint = tripData.endAddress || tripData.startAddress;\n\t\t\tif (startPoint && endPoint) {\n\t\t\t\tconst finalLeg = await fetchRouteSegment(startPoint, endPoint);\n\t\t\t\tif (finalLeg) {\n\t\t\t\t\tmiles += finalLeg.distance;\n\t\t\t\t\tmins += finalLeg.duration;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Compute return leg (end -> start) to show round-trip totals if end provided and different\n\t\tif (\n\t\t\ttripData.endAddress &&\n\t\t\ttripData.startAddress &&\n\t\t\ttripData.endAddress.trim() !== tripData.startAddress.trim()\n\t\t) {\n\t\t\tconst backLeg = await fetchRouteSegment(tripData.endAddress, tripData.startAddress);\n\t\t\tif (backLeg) {\n\t\t\t\treturnMiles = backLeg.distance;\n\t\t\t\treturnMins = backLeg.duration;\n\t\t\t}\n\t\t}\n\n\t\ttripData.totalMiles = parseFloat(miles.toFixed(1));\n\t\ttripData.estimatedTime = Math.round(mins);\n\t\t// Store round-trip values\n\t\ttripData.roundTripMiles = parseFloat((miles + returnMiles).toFixed(1));\n\t\ttripData.roundTripTime = Math.round(mins + returnMins);\n\n\t\t// Debug: surface calculation results to the page console for e2e troubleshooting\n\t\tconsole.log('[Trip] recalculated totals', {\n\t\t\tmiles: tripData.totalMiles,\n\t\t\tminutes: tripData.estimatedTime,\n\t\t\troundTripMiles: tripData.roundTripMiles,\n\t\t\troundTripMinutes: tripData.roundTripTime,\n\t\t\tstops: tripData.stops\n\t\t});\n\t\ttripData = { ...tripData } as LocalTrip;\n\t}\n\n\tasync function handleOptimize() {\n\t\tif (!tripData.startAddress) return toasts.error('Please enter a start address first.');\n\n\t\tif (tripData.stops.length < 2) return toasts.error('Add at least 2 stops to optimize.');\n\n\t\tisCalculating = true;\n\t\ttry {\n\t\t\tconst result: any = await optimizeRoute(\n\t\t\t\ttripData.startAddress,\n\t\t\t\ttripData.endAddress,\n\t\t\t\ttripData.stops\n\t\t\t);\n\t\t\tif (result && result.optimizedOrder) {\n\t\t\t\tconst currentStops = [...tripData.stops];\n\t\t\t\tlet orderedStops = [];\n\t\t\t\tif (!tripData.endAddress) {\n\t\t\t\t\tconst movingStops = currentStops.slice(0, -1);\n\t\t\t\t\tconst fixedLast = currentStops[currentStops.length - 1];\n\t\t\t\t\torderedStops = result.optimizedOrder.map((i: number) => movingStops[i]);\n\t\t\t\t\torderedStops.push(fixedLast);\n\t\t\t\t} else {\n\t\t\t\t\torderedStops = result.optimizedOrder.map((i: number) => currentStops[i]);\n\t\t\t\t}\n\n\t\t\t\ttripData.stops = orderedStops.map((s: any, i: number) => ({\n\t\t\t\t\t...s,\n\t\t\t\t\torder: i\n\t\t\t\t})) as LocalStop[];\n\t\t\t\tif (result.legs) {\n\t\t\t\t\ttripData.stops.forEach((stop, i) => {\n\t\t\t\t\t\tif (result.legs[i]) {\n\t\t\t\t\t\t\tstop.distanceFromPrev = result.legs[i].distance.value * 0.000621371;\n\t\t\t\t\t\t\tstop.timeFromPrev = result.legs[i].duration.value / 60;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tawait recalculateTotals();\n\t\t\t\ttoasts.success('Route optimized!');\n\t\t\t}\n\t\t} catch (e: any) {\n\t\t\tconsole.error(e);\n\t\t\tconst msg = (e.message || '').toLowerCase();\n\t\t\tif (e.code === 'PLAN_LIMIT' || msg.includes('plan limit') || msg.includes('pro feature')) {\n\t\t\t\tupgradeMessage = e.message || 'Route Optimization is a Pro feature.';\n\t\t\t\tshowUpgradeModal = true;\n\t\t\t} else {\n\t\t\t\ttoasts.error('Optimization failed: ' + e.message);\n\t\t\t}\n\t\t} finally {\n\t\t\tisCalculating = false;\n\t\t}\n\t}\n\n\tasync function handleStopChange(index: number, placeOrEvent: any) {\n\t\tconst idx = index;\n\t\tconst currentStop = tripData.stops[idx];\n\t\tif (!currentStop) return;\n\t\tconst val = placeOrEvent?.formatted_address || placeOrEvent?.name || currentStop.address;\n\t\tif (!val) return;\n\t\tcurrentStop.address = val;\n\t\tisCalculating = true;\n\t\ttry {\n\t\t\tconst prevLoc = idx === 0 ? tripData.startAddress : tripData.stops[idx - 1]?.address;\n\t\t\tif (prevLoc) {\n\t\t\t\tconst legIn = await fetchRouteSegment(prevLoc, val);\n\t\t\t\tif (legIn) {\n\t\t\t\t\tconst s = tripData.stops[idx];\n\t\t\t\t\tif (s) {\n\t\t\t\t\t\ts.distanceFromPrev = legIn.distance;\n\t\t\t\t\t\ts.timeFromPrev = legIn.duration;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tconst nextIdx = idx + 1;\n\t\t\tconst nextStop = tripData.stops[nextIdx];\n\t\t\tif (nextStop) {\n\t\t\t\tconst legOut = await fetchRouteSegment(val, nextStop.address);\n\t\t\t\tif (legOut) {\n\t\t\t\t\tconst s2 = tripData.stops[nextIdx];\n\t\t\t\t\tif (s2) {\n\t\t\t\t\t\ts2.distanceFromPrev = legOut.distance;\n\t\t\t\t\t\ts2.timeFromPrev = legOut.duration;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tawait recalculateTotals();\n\t\t} finally {\n\t\t\tisCalculating = false;\n\t\t}\n\t}\n\n\tasync function handleMainAddressChange(type: 'start' | 'end', placeOrEvent: any) {\n\t\tconst val =\n\t\t\tplaceOrEvent?.formatted_address ||\n\t\t\tplaceOrEvent?.name ||\n\t\t\t(type === 'start' ? tripData.startAddress : tripData.endAddress);\n\t\tif (type === 'start') tripData.startAddress = String(val || '');\n\t\telse tripData.endAddress = String(val || '');\n\t\tisCalculating = true;\n\t\ttry {\n\t\t\tif (type === 'start' && tripData.stops.length > 0) {\n\t\t\t\tconst idx = 0;\n\t\t\t\tconst firstStop = tripData.stops[idx];\n\t\t\t\tif (firstStop && val) {\n\t\t\t\t\tconst leg = await fetchRouteSegment(val, firstStop.address);\n\t\t\t\t\tif (leg) {\n\t\t\t\t\t\tconst s = tripData.stops[idx];\n\t\t\t\t\t\tif (s) {\n\t\t\t\t\t\t\ts.distanceFromPrev = leg.distance;\n\t\t\t\t\t\t\ts.timeFromPrev = leg.duration;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tawait recalculateTotals();\n\t\t} finally {\n\t\t\tisCalculating = false;\n\t\t}\n\t}\n\n\tasync function handleNewStopSelect(e: CustomEvent) {\n\t\tconst place = e.detail;\n\t\tif (place?.formatted_address || place?.name) {\n\t\t\tnewStop.address = place.formatted_address || place.name;\n\t\t\tawait addStop();\n\t\t}\n\t}\n\n\tasync function addStop() {\n\t\tif (!newStop.address) return;\n\n\t\tif (\n\t\t\ttripData.stops.length >= (PLAN_LIMITS.FREE.MAX_STOPS || 5) &&\n\t\t\t($user?.plan === 'free' || !$user?.plan)\n\t\t) {\n\t\t\ttoasts.error(\n\t\t\t\t`The Free plan is limited to ${PLAN_LIMITS.FREE.MAX_STOPS || 5} stops per trip.`\n\t\t\t);\n\t\t\treturn;\n\t\t}\n\n\t\tconst lastStop = tripData.stops[tripData.stops.length - 1];\n\t\tconst segmentStart = lastStop && lastStop.address ? lastStop.address : tripData.startAddress;\n\t\tif (!segmentStart) {\n\t\t\ttoasts.error('Please enter a Starting Address first.');\n\t\t\treturn;\n\t\t}\n\n\t\t// Diagnostic: log addresses being used to calculate the leg\n\t\tconsole.info('[route] addStop', { segmentStart, newStopAddress: newStop.address });\n\n\t\t// If the stop equals the segment start, surface UI hint and still add it as 0-mile stop\n\t\tconst isSame =\n\t\t\tsegmentStart.toLowerCase().trim() === (newStop.address || '').toLowerCase().trim();\n\t\tif (isSame) {\n\t\t\tconsole.info('[route] adding identical stop (0 miles)', segmentStart);\n\t\t\ttoasts.info('Stop address is the same as previous point ΓÇö distance will be 0');\n\t\t}\n\n\t\tisCalculating = true;\n\t\ttry {\n\t\t\tconst segmentData: any = await fetchRouteSegment(segmentStart, newStop.address);\n\t\t\tif (!segmentData) throw new Error('Could not calculate route.');\n\n\t\t\ttripData.stops = [\n\t\t\t\t...tripData.stops,\n\t\t\t\t{\n\t\t\t\t\t...newStop,\n\t\t\t\t\tid: crypto.randomUUID(),\n\t\t\t\t\torder: tripData.stops.length,\n\t\t\t\t\tdistanceFromPrev: segmentData.distance,\n\t\t\t\t\ttimeFromPrev: segmentData.duration\n\t\t\t\t} as LocalStop\n\t\t\t];\n\n\t\t\tawait recalculateTotals();\n\t\t\tnewStop = { address: '', earnings: 0, notes: '' };\n\t\t\t// Ensure `order` is present and typed\n\t\t\ttripData.stops = tripData.stops.map((s: LocalStop | any, i: number) => ({\n\t\t\t\t...s,\n\t\t\t\torder: i\n\t\t\t})) as LocalStop[];\n\t\t} catch (err: any) {\n\t\t\tconsole.error('addStop failed', err);\n\t\t\ttoasts.error(err?.message ? String(err.message) : 'Error calculating route.');\n\t\t} finally {\n\t\t\tisCalculating = false;\n\t\t}\n\t}\n\n\tfunction removeStop(id: string) {\n\t\ttripData.stops = tripData.stops.filter((s) => s.id !== id);\n\t\trecalculateAllLegs();\n\t}\n\n\tfunction handleDragStart(event: DragEvent, index: number) {\n\t\tdragItemIndex = index;\n\t\tif (event.dataTransfer) {\n\t\t\tevent.dataTransfer.effectAllowed = 'move';\n\t\t\tevent.dataTransfer.dropEffect = 'move';\n\t\t\tevent.dataTransfer.setData('text/plain', index.toString());\n\t\t}\n\t}\n\n\tfunction handleDragOver(event: DragEvent) {\n\t\tevent.preventDefault();\n\t\treturn false;\n\t}\n\n\tasync function handleDrop(event: DragEvent, dropIndex: number) {\n\t\tevent.preventDefault();\n\t\tif (dragItemIndex === null) return;\n\t\tconst item = tripData.stops[dragItemIndex];\n\t\tif (!item) return;\n\t\tconst newStops = tripData.stops.filter((_, i) => i !== dragItemIndex);\n\t\tnewStops.splice(dropIndex, 0, item);\n\t\ttripData.stops = newStops;\n\t\tdragItemIndex = null;\n\t\tawait recalculateAllLegs();\n\t}\n\n\tfunction addMaintenanceItem() {\n\t\tif (!selectedMaintenance) return;\n\t\ttripData.maintenanceItems = [\n\t\t\t...tripData.maintenanceItems,\n\t\t\t{ id: crypto.randomUUID(), type: selectedMaintenance, cost: 0, taxDeductible: false }\n\t\t];\n\t\tselectedMaintenance = '';\n\t}\n\tfunction removeMaintenanceItem(id: string) {\n\t\ttripData.maintenanceItems = tripData.maintenanceItems.filter((m) => m.id !== id);\n\t}\n\tfunction addSupplyItem() {\n\t\tif (!selectedSupply) return;\n\t\ttripData.suppliesItems = [\n\t\t\t...tripData.suppliesItems,\n\t\t\t{ id: crypto.randomUUID(), type: selectedSupply, cost: 0, taxDeductible: false }\n\t\t];\n\t\tselectedSupply = '';\n\t}\n\tfunction removeSupplyItem(id: string) {\n\t\ttripData.suppliesItems = tripData.suppliesItems.filter((s) => s.id !== id);\n\t}\n\n\tfunction openSettings(type: 'maintenance' | 'supplies') {\n\t\tactiveCategoryType = type;\n\t\tisManageCategoriesOpen = true;\n\t}\n\tasync function updateCategories(newCategories: string[]) {\n\t\tconst updateData: any = {};\n\t\tif (activeCategoryType === 'maintenance') {\n\t\t\tuserSettings.update((s) => ({ ...s, maintenanceCategories: newCategories }));\n\t\t\tupdateData.maintenanceCategories = newCategories;\n\t\t} else {\n\t\t\tuserSettings.update((s) => ({ ...s, supplyCategories: newCategories }));\n\t\t\tupdateData.supplyCategories = newCategories;\n\t\t}\n\t\ttry {\n\t\t\tconst { saveSettings } = await import('../../settings/lib/save-settings');\n\t\t\tconst result = await saveSettings(updateData);\n\t\t\tif (!result.ok) throw new Error(result.error);\n\t\t} catch (e) {\n\t\t\tconsole.error('Failed to sync settings', e);\n\t\t\ttoasts.error('Saved locally, but sync failed');\n\t\t}\n\t}\n\tasync function addCategory() {\n\t\tif (!newCategoryName.trim()) return;\n\t\tconst val = newCategoryName.trim().toLowerCase();\n\t\tif (activeCategories.some((c) => c.toLowerCase() === val.toLowerCase())) {\n\t\t\ttoasts.error('Category already exists');\n\t\t\treturn;\n\t\t}\n\t\tconst updated = [...activeCategories, newCategoryName.trim()];\n\t\tawait updateCategories(updated);\n\t\tnewCategoryName = '';\n\t\ttoasts.success('Category added');\n\t}\n\tasync function removeCategory(cat: string) {\n\t\tif (!confirm(`Delete \"${cat}\" category?`)) return;\n\t\tconst updated = activeCategories.filter((c) => c !== cat);\n\t\tawait updateCategories(updated);\n\t\ttoasts.success('Category removed');\n\t}\n\n\t$: {\n\t\tconst totalMiles = Number(tripData.totalMiles || 0);\n\t\tconst mpg = Number(tripData.mpg || 0);\n\t\tconst gasPrice = Number(tripData.gasPrice || 0);\n\t\tif (totalMiles && mpg && gasPrice) {\n\t\t\tconst gallons = totalMiles / mpg;\n\t\t\ttripData.fuelCost = Math.round(gallons * gasPrice * 100) / 100;\n\t\t} else {\n\t\t\ttripData.fuelCost = 0;\n\t\t}\n\t}\n\tlet totalEarnings = 0;\n\tlet totalMaintenanceCost = 0;\n\tlet totalSuppliesCost = 0;\n\tlet totalCosts = 0;\n\tlet totalProfit = 0;\n\t$: totalEarnings = tripData.stops.reduce(\n\t\t(sum, stop) => sum + (parseFloat(String(stop.earnings || 0)) || 0),\n\t\t0\n\t);\n\t$: totalMaintenanceCost = tripData.maintenanceItems.reduce(\n\t\t(sum, item) => sum + (item.cost || 0),\n\t\t0\n\t);\n\t$: totalSuppliesCost = tripData.suppliesItems.reduce((sum, item) => sum + (item.cost || 0), 0);\n\t$: totalCosts = (tripData.fuelCost || 0) + totalMaintenanceCost + totalSuppliesCost;\n\t$: totalProfit = totalEarnings - totalCosts;\n\t$: {\n\t\tconst startTime = typeof tripData.startTime === 'string' ? tripData.startTime : '';\n\t\tconst endTime = typeof tripData.endTime === 'string' ? tripData.endTime : '';\n\t\tif (startTime && endTime) {\n\t\t\tconst [startHour, startMin] = startTime.split(':').map(Number) as [number, number];\n\t\t\tconst [endHour, endMin] = endTime.split(':').map(Number) as [number, number];\n\t\t\tlet diff = endHour * 60 + endMin - (startHour * 60 + startMin);\n\t\t\tif (diff < 0) diff += 24 * 60;\n\t\t\ttripData.hoursWorked = Math.round((diff / 60) * 10) / 10;\n\t\t}\n\t}\n\n\tasync function saveTrip() {\n\t\tconst currentUser = $page.data['user'] || $user;\n\t\tconst userId = currentUser?.id || localStorage.getItem('offline_user_id');\n\t\tif (!userId) {\n\t\t\ttoasts.error('Authentication error.');\n\t\t\treturn;\n\t\t}\n\n\t\tconst tripToSave = {\n\t\t\t...tripData,\n\t\t\tmaintenanceCost: totalMaintenanceCost,\n\t\t\tsuppliesCost: totalSuppliesCost,\n\t\t\tnetProfit: totalProfit,\n\t\t\t// Include both keys for compatibility but ensure `totalMiles` is present\n\t\t\ttotalMiles: Number(tripData.totalMiles || 0),\n\t\t\ttotalMileage: Number(tripData.totalMiles || 0),\n\t\t\tfuelCost: Number(tripData.fuelCost || 0),\n\t\t\troundTripMiles: Number(tripData.roundTripMiles || 0),\n\t\t\troundTripTime: Number(tripData.roundTripTime || 0),\n\t\t\tstops: tripData.stops.map((stop, index) => ({\n\t\t\t\t...stop,\n\t\t\t\tid: String(stop.id || crypto.randomUUID()),\n\t\t\t\tearnings: Number(stop.earnings) || 0,\n\t\t\t\torder: index\n\t\t\t})),\n\n\t\t\tdestinations: tripData.stops.map((stop) => ({\n\t\t\t\taddress: stop.address,\n\t\t\t\tearnings: stop.earnings,\n\t\t\t\tnotes: stop.notes || ''\n\t\t\t})),\n\t\t\tlastModified: new Date().toISOString()\n\t\t};\n\n\t\ttry {\n\t\t\tawait trips.create(tripToSave, userId);\n\t\t\tgoto(resolve('/dashboard/trips'));\n\t\t} catch (err: any) {\n\t\t\tconsole.error('Save failed:', err);\n\t\t\tconst message = err?.message || 'Failed to create trip.';\n\t\t\ttoasts.error(message);\n\t\t}\n\t}\n\n\tfunction formatCurrency(amount: number) {\n\t\treturn new Intl.NumberFormat('en-US', {\n\t\t\tstyle: 'currency',\n\t\t\tcurrency: 'USD',\n\t\t\tminimumFractionDigits: 2\n\t\t}).format(amount);\n\t}\n</script>\n\n<div class=\"trip-form\">\n\t<div class=\"page-header\">\n\t\t<div>\n\t\t\t<h1 class=\"page-title\">New Trip</h1>\n\t\t\t<p class=\"page-subtitle\">Plan details & earnings</p>\n\t\t</div>\n\t\t<a href={resolve('/dashboard/trips')} class=\"btn-back\">\n\t\t\t<svg width=\"24\" height=\"24\" viewBox=\"0 0 20 20\" fill=\"none\"\n\t\t\t\t><path\n\t\t\t\t\td=\"M12 4L6 10L12 16\"\n\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\t\tstroke-linejoin=\"round\"\n\t\t\t\t/></svg\n\t\t\t> Back\n\t\t</a>\n\t</div>\n\n\t<div class=\"form-content\">\n\t\t<!-- Basic Information Section -->\n\t\t<div class=\"form-card\">\n\t\t\t<div class=\"card-header\"><h2 class=\"card-title\">Basic Information</h2></div>\n\t\t\t<div class=\"form-grid\">\n\t\t\t\t<div class=\"form-group\">\n\t\t\t\t\t<label for=\"trip-date\">Date</label><input\n\t\t\t\t\t\tid=\"trip-date\"\n\t\t\t\t\t\ttype=\"date\"\n\t\t\t\t\t\tbind:value={dateLocal}\n\t\t\t\t\t\trequired\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"form-group\">\n\t\t\t\t\t<label for=\"trip-pay-date\">Pay Date <span class=\"hint\">(Optional)</span></label><input\n\t\t\t\t\t\tid=\"trip-pay-date\"\n\t\t\t\t\t\ttype=\"date\"\n\t\t\t\t\t\tbind:value={payDateLocal}\n\t\t\t\t\t/>\n\t\t\t\t\t<div class=\"hint\">Tax purposes</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"form-row\">\n\t\t\t\t\t<div class=\"form-group\">\n\t\t\t\t\t\t<label for=\"start-time\">Start Time</label><input\n\t\t\t\t\t\t\tid=\"start-time\"\n\t\t\t\t\t\t\ttype=\"time\"\n\t\t\t\t\t\t\tbind:value={startTimeLocal}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"form-group\">\n\t\t\t\t\t\t<label for=\"end-time\">End Time</label><input\n\t\t\t\t\t\t\tid=\"end-time\"\n\t\t\t\t\t\t\ttype=\"time\"\n\t\t\t\t\t\t\tbind:value={endTimeLocal}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"form-group\">\n\t\t\t\t\t<label for=\"hours-display\">Hours Worked</label>\n\t\t\t\t\t<div id=\"hours-display\" class=\"readonly-field\">\n\t\t\t\t\t\t{tripData.hoursWorked.toFixed(1)} hours\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<!-- Route & Stops Section -->\n\t\t<div class=\"form-card\">\n\t\t\t<div class=\"card-header\">\n\t\t\t\t<h2 class=\"card-title\">Route & Stops</h2>\n\t\t\t\t<button\n\t\t\t\t\tclass=\"btn-small primary\"\n\t\t\t\t\ton:click={handleOptimize}\n\t\t\t\t\ttype=\"button\"\n\t\t\t\t\tdisabled={isCalculating}\n\t\t\t\t\ttitle=\"Reorder stops efficiently\">{isCalculating ? 'Optimizing...' : 'Optimize'}</button\n\t\t\t\t>\n\t\t\t</div>\n\t\t\t<div class=\"form-group\">\n\t\t\t\t<label for=\"start-address\">Starting Address</label>\n\t\t\t\t<input\n\t\t\t\t\tid=\"start-address\"\n\t\t\t\t\ttype=\"text\"\n\t\t\t\t\tvalue={startAddressLocal}\n\t\t\t\t\ton:input={(e) => (startAddressLocal = (e.target as HTMLInputElement).value || '')}\n\t\t\t\t\tuse:autocomplete={{ apiKey: API_KEY }}\n\t\t\t\t\ton:place-selected={(e) => handleMainAddressChange('start', e.detail)}\n\t\t\t\t\ton:blur={() => handleMainAddressChange('start', { formatted_address: startAddressLocal })}\n\t\t\t\t\tclass=\"address-input\"\n\t\t\t\t\tplaceholder=\"Enter start address...\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<div class=\"stops-container\">\n\t\t\t\t<div class=\"stops-header\">\n\t\t\t\t\t<h3>Stops</h3>\n\t\t\t\t\t<span class=\"count\">{tripData.stops.length} added</span>\n\t\t\t\t</div>\n\t\t\t\t{#if tripData.stops.length > 0}\n\t\t\t\t\t<div class=\"stops-list\">\n\t\t\t\t\t\t{#each tripData.stops as stop, i (stop.id)}\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tclass=\"stop-card\"\n\t\t\t\t\t\t\t\trole=\"button\"\n\t\t\t\t\t\t\t\ttabindex=\"0\"\n\t\t\t\t\t\t\t\tdraggable=\"true\"\n\t\t\t\t\t\t\t\ton:dragstart={(e) => handleDragStart(e, i)}\n\t\t\t\t\t\t\t\ton:drop={(e) => handleDrop(e, i)}\n\t\t\t\t\t\t\t\ton:dragover={handleDragOver}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<div class=\"stop-header\">\n\t\t\t\t\t\t\t\t\t<div class=\"stop-number\">{i + 1}</div>\n\t\t\t\t\t\t\t\t\t<div class=\"stop-actions\">\n\t\t\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\t\t\tclass=\"btn-icon delete\"\n\t\t\t\t\t\t\t\t\t\t\ton:click={() => removeStop(String(stop.id ?? ''))}>Γ£ò</button\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<div class=\"drag-handle\">Γÿ░</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class=\"stop-inputs\">\n\t\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\t\t\tvalue={String(stop.address ?? '')}\n\t\t\t\t\t\t\t\t\t\tuse:autocomplete={{ apiKey: API_KEY }}\n\t\t\t\t\t\t\t\t\t\ton:place-selected={(e) => handleStopChange(i, e.detail)}\n\t\t\t\t\t\t\t\t\t\ton:blur={() => handleStopChange(i, { formatted_address: stop.address })}\n\t\t\t\t\t\t\t\t\t\tclass=\"address-input\"\n\t\t\t\t\t\t\t\t\t\tplaceholder=\"Stop address\"\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t<div class=\"input-money-wrapper\">\n\t\t\t\t\t\t\t\t\t\t<span class=\"symbol\">$</span><input\n\t\t\t\t\t\t\t\t\t\t\ttype=\"number\"\n\t\t\t\t\t\t\t\t\t\t\tclass=\"input-money\"\n\t\t\t\t\t\t\t\t\t\t\tvalue={String(stop.earnings ?? 0)}\n\t\t\t\t\t\t\t\t\t\t\ton:input={(e) =>\n\t\t\t\t\t\t\t\t\t\t\t\t(stop.earnings = Number((e.target as HTMLInputElement).value) || 0)}\n\t\t\t\t\t\t\t\t\t\t\tstep=\"0.01\"\n\t\t\t\t\t\t\t\t\t\t\tplaceholder=\"Earnings\"\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t{/each}\n\t\t\t\t\t</div>\n\t\t\t\t{/if}\n\t\t\t\t<div class=\"add-stop-form\">\n\t\t\t\t\t<div class=\"stop-inputs new\">\n\t\t\t\t\t\t<input\n\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\tvalue={String(newStop.address ?? '')}\n\t\t\t\t\t\t\ton:input={(e) => (newStop.address = (e.target as HTMLInputElement).value || '')}\n\t\t\t\t\t\t\tplaceholder=\"New stop address...\"\n\t\t\t\t\t\t\tuse:autocomplete={{ apiKey: API_KEY }}\n\t\t\t\t\t\t\ton:place-selected={handleNewStopSelect}\n\t\t\t\t\t\t\tclass=\"address-input\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<div class=\"input-money-wrapper\">\n\t\t\t\t\t\t\t<span class=\"symbol\">$</span><input\n\t\t\t\t\t\t\t\ttype=\"number\"\n\t\t\t\t\t\t\t\tclass=\"input-money\"\n\t\t\t\t\t\t\t\tplaceholder=\"0.00\"\n\t\t\t\t\t\t\t\tvalue={String(newStop.earnings ?? 0)}\n\t\t\t\t\t\t\t\ton:input={(e) =>\n\t\t\t\t\t\t\t\t\t(newStop.earnings = Number((e.target as HTMLInputElement).value) || 0)}\n\t\t\t\t\t\t\t\tstep=\"0.01\"\n\t\t\t\t\t\t\t\tmin=\"0\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class=\"form-group\">\n\t\t\t\t<label for=\"end-address\">End Address (Optional)</label>\n\t\t\t\t<input\n\t\t\t\t\tid=\"end-address\"\n\t\t\t\t\ttype=\"text\"\n\t\t\t\t\tbind:value={endAddressLocal}\n\t\t\t\t\tuse:autocomplete={{ apiKey: API_KEY }}\n\t\t\t\t\ton:place-selected={(e) => handleMainAddressChange('end', e.detail)}\n\t\t\t\t\ton:blur={() => handleMainAddressChange('end', { formatted_address: endAddressLocal })}\n\t\t\t\t\tclass=\"address-input\"\n\t\t\t\t\tplaceholder=\"Same as start if empty\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<div class=\"form-row\">\n\t\t\t\t<div class=\"form-group\">\n\t\t\t\t\t<label for=\"total-miles\">Total Miles</label><input\n\t\t\t\t\t\tid=\"total-miles\"\n\t\t\t\t\t\ttype=\"number\"\n\t\t\t\t\t\tbind:value={totalMilesLocal}\n\t\t\t\t\t\tstep=\"0.1\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"form-group\">\n\t\t\t\t\t<label for=\"drive-time\">Drive Time <span class=\"hint\">(Est)</span></label>\n\t\t\t\t\t<div id=\"drive-time\" class=\"readonly-field\">\n\t\t\t\t\t\t{formatDuration(tripData.estimatedTime)}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<!-- Costs Section -->\n\t\t<div class=\"form-card\">\n\t\t\t<div class=\"card-header\"><h2 class=\"card-title\">Costs</h2></div>\n\t\t\t<div class=\"form-row\">\n\t\t\t\t<div class=\"form-group\">\n\t\t\t\t\t<label for=\"mpg\">MPG</label><input\n\t\t\t\t\t\tid=\"mpg\"\n\t\t\t\t\t\ttype=\"number\"\n\t\t\t\t\t\tbind:value={mpgLocal}\n\t\t\t\t\t\tstep=\"0.1\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"form-group\">\n\t\t\t\t\t<label for=\"gas-price\">Gas Price</label>\n\t\t\t\t\t<div class=\"input-money-wrapper\">\n\t\t\t\t\t\t<span class=\"symbol\">$</span><input\n\t\t\t\t\t\t\tid=\"gas-price\"\n\t\t\t\t\t\t\ttype=\"number\"\n\t\t\t\t\t\t\tbind:value={gasPriceLocal}\n\t\t\t\t\t\t\tstep=\"0.01\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class=\"summary-box\" style=\"margin: 40px 0;\">\n\t\t\t\t<span>Estimated Fuel Cost</span><strong>{formatCurrency(tripData.fuelCost)}</strong>\n\t\t\t</div>\n\n\t\t\t<div class=\"info-note\">\n\t\t\t\t<span\n\t\t\t\t\t><strong>Note:</strong> Use the checkboxes next to each Maintenance or Supplies item to mark\n\t\t\t\t\tthat individual item as tax-deductible.</span\n\t\t\t\t>\n\t\t\t</div>\n\t\t\t<div class=\"section-group\">\n\t\t\t\t<div class=\"section-top\">\n\t\t\t\t\t<h3>Maintenance</h3>\n\t\t\t\t\t<button\n\t\t\t\t\t\tclass=\"btn-icon gear\"\n\t\t\t\t\t\ton:click={() => openSettings('maintenance')}\n\t\t\t\t\t\ttitle=\"Manage Options\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\twidth=\"20\"\n\t\t\t\t\t\t\theight=\"20\"\n\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\t\t\t\tfill=\"none\"\n\t\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\t\t\t\tstroke-linejoin=\"round\"\n\t\t\t\t\t\t\t><circle cx=\"12\" cy=\"12\" r=\"3\"></circle><path\n\t\t\t\t\t\t\t\td=\"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z\"\n\t\t\t\t\t\t\t></path></svg\n\t\t\t\t\t\t>\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\n\t\t\t\t<div class=\"add-row\">\n\t\t\t\t\t<select\n\t\t\t\t\t\tbind:value={selectedMaintenance}\n\t\t\t\t\t\tclass=\"select-input\"\n\t\t\t\t\t\taria-label=\"Maintenance type\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<option value=\"\" disabled selected>Select Item...</option>\n\t\t\t\t\t\t{#each maintenanceOptions as option (option)}\n\t\t\t\t\t\t\t<option value={option}>{option}</option>\n\t\t\t\t\t\t{/each}\n\t\t\t\t\t</select>\n\t\t\t\t\t<button\n\t\t\t\t\t\tclass=\"btn-small primary\"\n\t\t\t\t\t\ton:click={addMaintenanceItem}\n\t\t\t\t\t\tdisabled={!selectedMaintenance}>Add</button\n\t\t\t\t\t>\n\t\t\t\t</div>\n\n\t\t\t\t{#each tripData.maintenanceItems as item, i (item.id ?? i)}\n\t\t\t\t\t<div class=\"expense-row\">\n\t\t\t\t\t\t<span class=\"name\">{item.type}</span>\n\t\t\t\t\t\t<div class=\"input-money-wrapper small\">\n\t\t\t\t\t\t\t<span class=\"symbol\">$</span>\n\t\t\t\t\t\t\t<input type=\"number\" bind:value={item.cost} placeholder=\"0.00\" />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"item-controls\">\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\tclass=\"tax-pill\"\n\t\t\t\t\t\t\t\ton:click={() => (item.taxDeductible = !item.taxDeductible)}\n\t\t\t\t\t\t\t\taria-pressed={item.taxDeductible}\n\t\t\t\t\t\t\t\ttitle=\"Mark this item as tax deductible\"\n\t\t\t\t\t\t\t\t>{item.taxDeductible ? 'Tax' : 'No Tax'}</button\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<label class=\"inline-label sr-only\"\n\t\t\t\t\t\t\t\t><input type=\"checkbox\" bind:checked={item.taxDeductible} /></label\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tclass=\"btn-icon delete\"\n\t\t\t\t\t\t\ton:click={() => removeMaintenanceItem(String(item.id ?? ''))}>Γ£ò</button\n\t\t\t\t\t\t>\n\t\t\t\t\t</div>\n\t\t\t\t{/each}\n\t\t\t</div>\n\n\t\t\t<div class=\"section-group\">\n\t\t\t\t<div class=\"section-top\">\n\t\t\t\t\t<h3>Supplies</h3>\n\t\t\t\t\t<button\n\t\t\t\t\t\tclass=\"btn-icon gear\"\n\t\t\t\t\t\ton:click={() => openSettings('supplies')}\n\t\t\t\t\t\ttitle=\"Manage Options\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\twidth=\"20\"\n\t\t\t\t\t\t\theight=\"20\"\n\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\t\t\t\tfill=\"none\"\n\t\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\t\t\t\tstroke-linejoin=\"round\"\n\t\t\t\t\t\t\t><circle cx=\"12\" cy=\"12\" r=\"3\"></circle><path\n\t\t\t\t\t\t\t\td=\"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z\"\n\t\t\t\t\t\t\t></path></svg\n\t\t\t\t\t\t>\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\n\t\t\t\t<div class=\"add-row\">\n\t\t\t\t\t<select bind:value={selectedSupply} class=\"select-input\" aria-label=\"Supply type\">\n\t\t\t\t\t\t<option value=\"\" disabled selected>Select Item...</option>\n\t\t\t\t\t\t{#each suppliesOptions as option (option)}\n\t\t\t\t\t\t\t<option value={option}>{option}</option>\n\t\t\t\t\t\t{/each}\n\t\t\t\t\t</select>\n\t\t\t\t\t<button class=\"btn-small primary\" on:click={addSupplyItem} disabled={!selectedSupply}\n\t\t\t\t\t\t>Add</button\n\t\t\t\t\t>\n\t\t\t\t</div>\n\n\t\t\t\t{#each tripData.suppliesItems as item, i (item.id ?? i)}\n\t\t\t\t\t<div class=\"expense-row\">\n\t\t\t\t\t\t<span class=\"name\">{item.type}</span>\n\t\t\t\t\t\t<div class=\"input-money-wrapper small\">\n\t\t\t\t\t\t\t<span class=\"symbol\">$</span>\n\t\t\t\t\t\t\t<input type=\"number\" bind:value={item.cost} placeholder=\"0.00\" />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"item-controls\">\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\tclass=\"tax-pill\"\n\t\t\t\t\t\t\t\ton:click={() => (item.taxDeductible = !item.taxDeductible)}\n\t\t\t\t\t\t\t\taria-pressed={item.taxDeductible}\n\t\t\t\t\t\t\t\ttitle=\"Mark this item as tax deductible\"\n\t\t\t\t\t\t\t\t>{item.taxDeductible ? 'Tax' : 'No Tax'}</button\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<label class=\"inline-label sr-only\"\n\t\t\t\t\t\t\t\t><input type=\"checkbox\" bind:checked={item.taxDeductible} /></label\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<button class=\"btn-icon delete\" on:click={() => removeSupplyItem(String(item.id ?? ''))}\n\t\t\t\t\t\t\t>Γ£ò</button\n\t\t\t\t\t\t>\n\t\t\t\t\t</div>\n\t\t\t\t{/each}\n\t\t\t</div>\n\n\t\t\t<div class=\"form-group\">\n\t\t\t\t<label for=\"notes\">Notes</label><textarea\n\t\t\t\t\tid=\"notes\"\n\t\t\t\t\tbind:value={notesLocal}\n\t\t\t\t\trows=\"3\"\n\t\t\t\t\tplaceholder=\"Trip details...\"\n\t\t\t\t></textarea>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<!-- Review Section -->\n\t\t<div class=\"form-card\">\n\t\t\t<div class=\"card-header\"><h2 class=\"card-title\">Review</h2></div>\n\t\t\t<div class=\"review-grid\">\n\t\t\t\t<div class=\"review-tile\">\n\t\t\t\t\t<span class=\"review-label\">Date</span>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t{new Date(tripData.date || '').toLocaleDateString('en-US', {\n\t\t\t\t\t\t\tmonth: 'numeric',\n\t\t\t\t\t\t\tday: 'numeric',\n\t\t\t\t\t\t\tyear: 'numeric'\n\t\t\t\t\t\t})}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"review-tile\">\n\t\t\t\t\t<span class=\"review-label\">Total Time</span>\n\t\t\t\t\t<div>{tripData.hoursWorked.toFixed(1)} hrs</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"review-tile\">\n\t\t\t\t\t<span class=\"review-label\">Drive Time</span>\n\t\t\t\t\t<div>{formatDuration(tripData.estimatedTime)}</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"review-tile\">\n\t\t\t\t\t<span class=\"review-label\">Hours Worked</span>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t{Math.max(0, tripData.hoursWorked - tripData.estimatedTime / 60).toFixed(1)} hrs\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"review-tile\">\n\t\t\t\t\t<span class=\"review-label\">Distance</span>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t{tripData.totalMiles} mi\n\t\t\t\t\t\t{#if tripData.roundTripMiles && tripData.roundTripMiles !== tripData.totalMiles}\n\t\t\t\t\t\t\tΓÇó Round trip: {tripData.roundTripMiles} mi ΓÇó {tripData.roundTripTime} min\n\t\t\t\t\t\t{/if}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"review-tile\">\n\t\t\t\t\t<span class=\"review-label\">Stops</span>\n\t\t\t\t\t<div>{tripData.stops.length}</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class=\"financial-summary\">\n\t\t\t\t<div class=\"row\">\n\t\t\t\t\t<span>Earnings</span> <span class=\"val positive\">{formatCurrency(totalEarnings)}</span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"row subheader\"><span>Expenses Breakdown</span></div>\n\t\t\t\t{#if tripData.fuelCost > 0}<div class=\"row detail\">\n\t\t\t\t\t\t<span>Fuel</span> <span class=\"val\">{formatCurrency(tripData.fuelCost)}</span>\n\t\t\t\t\t</div>{/if}{#each tripData.maintenanceItems as item, i (item.id ?? i)}<div\n\t\t\t\t\t\tclass=\"row detail\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<span>{item.type}</span> <span class=\"val\">{formatCurrency(item.cost)}</span>\n\t\t\t\t\t</div>{/each}{#each tripData.suppliesItems as item, i (item.id ?? i)}<div\n\t\t\t\t\t\tclass=\"row detail\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<span>{item.type}</span> <span class=\"val\">{formatCurrency(item.cost)}</span>\n\t\t\t\t\t</div>{/each}\n\t\t\t\t<div class=\"row total-expenses\">\n\t\t\t\t\t<span>Total Expenses</span>\n\t\t\t\t\t<span class=\"val negative\">-{formatCurrency(totalCosts)}</span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"row total\">\n\t\t\t\t\t<span>Net Profit</span>\n\t\t\t\t\t<span class=\"val\" class:positive={totalProfit >= 0}>{formatCurrency(totalProfit)}</span>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<!-- Save Button -->\n\t\t\t<div class=\"form-actions\">\n\t\t\t\t<button class=\"btn-primary full-width\" on:click={saveTrip}>Save Trip</button>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>\n\n<Modal bind:open={isManageCategoriesOpen} title=\"Manage Options\">\n\t<div class=\"categories-manager\">\n\t\t<div class=\"tabs\">\n\t\t\t<button\n\t\t\t\tclass=\"tab-btn\"\n\t\t\t\tclass:active={activeCategoryType === 'maintenance'}\n\t\t\t\ton:click={() => (activeCategoryType = 'maintenance')}>Maintenance</button\n\t\t\t>\n\t\t\t<button\n\t\t\t\tclass=\"tab-btn\"\n\t\t\t\tclass:active={activeCategoryType === 'supplies'}\n\t\t\t\ton:click={() => (activeCategoryType = 'supplies')}>Supplies</button\n\t\t\t>\n\t\t</div>\n\t\t<div class=\"cat-list\">\n\t\t\t{#each activeCategories as cat (cat)}\n\t\t\t\t<div class=\"cat-item\">\n\t\t\t\t\t<span class=\"cat-badge\">{cat}</span>\n\t\t\t\t\t<button\n\t\t\t\t\t\tclass=\"cat-delete\"\n\t\t\t\t\t\ton:click={() => removeCategory(cat)}\n\t\t\t\t\t\taria-label=\"Delete Category\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\twidth=\"16\"\n\t\t\t\t\t\t\theight=\"16\"\n\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\t\t\t\tfill=\"none\"\n\t\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\t\t\t\tstroke-linejoin=\"round\"\n\t\t\t\t\t\t\t><line x1=\"18\" y1=\"6\" x2=\"6\" y2=\"18\"></line><line x1=\"6\" y1=\"6\" x2=\"18\" y2=\"18\"\n\t\t\t\t\t\t\t></line></svg\n\t\t\t\t\t\t>\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t{:else}\n\t\t\t\t<div class=\"text-sm text-gray-400 italic text-center py-4\">No categories defined.</div>\n\t\t\t{/each}\n\t\t</div>\n\t\t<div class=\"add-cat-form\">\n\t\t\t<input\n\t\t\t\ttype=\"text\"\n\t\t\t\tbind:value={newCategoryName}\n\t\t\t\tplaceholder=\"New Item Name...\"\n\t\t\t\tclass=\"input-field\"\n\t\t\t\ton:keydown={(e) => e.key === 'Enter' && addCategory()}\n\t\t\t/>\n\t\t\t<button class=\"btn-secondary\" on:click={addCategory}>Add</button>\n\t\t</div>\n\t\t<div class=\"modal-actions mt-6\">\n\t\t\t<button class=\"btn-cancel w-full\" on:click={() => (isManageCategoriesOpen = false)}\n\t\t\t\t>Done</button\n\t\t\t>\n\t\t</div>\n\t</div>\n</Modal>\n\n<Modal bind:open={showUpgradeModal} title=\"Upgrade to Pro\">\n\t<div class=\"space-y-6 text-center py-4\">\n\t\t<div class=\"mx-auto w-16 h-16 bg-orange-100 rounded-full flex items-center justify-center mb-4\">\n\t\t\t<span class=\"text-3xl\">≡ƒÜÇ</span>\n\t\t</div>\n\n\t\t<h3 class=\"text-xl font-bold text-gray-900\">Unlock Pro Features</h3>\n\n\t\t<p class=\"text-gray-600\">\n\t\t\t{upgradeMessage || \"You've hit the limits of the Free plan.\"}\n\t\t</p>\n\n\t\t<div class=\"bg-gray-50 p-4 rounded-lg text-left text-sm space-y-2 border border-gray-100\">\n\t\t\t<div class=\"flex items-center gap-2\">\n\t\t\t\t<span class=\"text-green-500\">Γ£ô</span>\n\t\t\t\t<span>Unlimited Stops per Trip</span>\n\t\t\t</div>\n\t\t\t<div class=\"flex items-center gap-2\">\n\t\t\t\t<span class=\"text-green-500\">Γ£ô</span>\n\t\t\t\t<span>One-Click Route Optimization</span>\n\t\t\t</div>\n\t\t\t<div class=\"flex items-center gap-2\">\n\t\t\t\t<span class=\"text-green-500\">Γ£ô</span>\n\t\t\t\t<span>Unlimited Monthly Trips</span>\n\t\t\t</div>\n\t\t\t<div class=\"flex items-center gap-2\">\n\t\t\t\t<span class=\"text-green-500\">Γ£ô</span>\n\t\t\t\t<span>Data Export</span>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<div class=\"flex gap-3 justify-center pt-2\">\n\t\t\t<Button variant=\"outline\" on:click={() => (showUpgradeModal = false)}>Maybe Later</Button>\n\t\t\t<a\n\t\t\t\thref=\"/dashboard/settings\"\n\t\t\t\tclass=\"inline-flex items-center justify-center rounded-lg bg-orange-600 px-6 py-2.5 text-sm font-semibold text-white shadow-sm hover:bg-orange-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-orange-600\"\n\t\t\t>\n\t\t\t\tUpgrade Now\n\t\t\t</a>\n\t\t</div>\n\t</div>\n</Modal>\n\n<style>\n\t/* Use styles from New Trip page for consistency */\n\t/* Component-level override: hide old pill button and show visible checkbox + label */\n\t.item-controls .tax-pill {\n\t\tdisplay: none !important;\n\t\tvisibility: hidden !important;\n\t}\n\t.item-controls .inline-label.sr-only {\n\t\tposition: static !important;\n\t\twidth: auto !important;\n\t\theight: auto !important;\n\t\tdisplay: inline-flex !important;\n\t\talign-items: center;\n\t\tgap: 6px;\n\t}\n\t.item-controls .inline-label.sr-only input[type='checkbox'] {\n\t\tappearance: checkbox !important;\n\t\tdisplay: inline-block !important;\n\t\topacity: 1 !important;\n\t\twidth: 18px !important;\n\t\theight: 18px !important;\n\t\tmargin-right: 6px !important;\n\t}\n\t.item-controls .inline-label.sr-only::after {\n\t\tcontent: 'Tax deductible';\n\t\tmargin-left: 6px;\n\t\tfont-weight: 600;\n\t\tcolor: #374151;\n\t\tfont-size: 13px;\n\t}\n\t.item-controls .inline-label {\n\t\tdisplay: inline-flex;\n\t\talign-items: center;\n\t\tgap: 6px;\n\t}\n\t.trip-form {\n\t\tmax-width: 1300px;\n\t\tmargin: 0 auto;\n\t\tpadding: 4px;\n\t\tpadding-bottom: 90px;\n\t}\n\n\t@media (max-width: 640px) {\n\t\t.trip-form {\n\t\t\tpadding-bottom: calc(env(safe-area-inset-bottom, 0px) + 1px);\n\t\t}\n\t}\n\t.page-header {\n\t\tdisplay: flex;\n\t\tjustify-content: space-between;\n\t\talign-items: center;\n\t\tmargin-bottom: 26px;\n\t\tpadding: 0 8px;\n\t}\n\t.page-title {\n\t\tfont-size: 28px;\n\t\tfont-weight: 800;\n\t\tcolor: #111827;\n\t\tmargin: 0;\n\t}\n\t.page-subtitle {\n\t\tfont-size: 14px;\n\t\tcolor: #6b7280;\n\t\tdisplay: none;\n\t}\n\t.btn-back {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tgap: 8px;\n\t\tfont-weight: 600;\n\t\tcolor: #6b7280;\n\t\ttext-decoration: none;\n\t\tfont-size: 14px;\n\t}\n\t.form-card {\n\t\tbackground: white;\n\t\tborder: 1px solid #e5e7eb;\n\t\tborder-radius: 18px;\n\t\tpadding: 16px;\n\t\tbox-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);\n\t\tmargin-bottom: 20px;\n\t}\n\t.card-header {\n\t\tdisplay: flex;\n\t\tjustify-content: space-between;\n\t\talign-items: center;\n\t\tmargin-bottom: 26px;\n\t}\n\t.card-title {\n\t\tfont-size: 22px;\n\t\tfont-weight: 700;\n\t\tcolor: #111827;\n\t\tmargin: 0;\n\t}\n\t.form-grid {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tgap: 24px;\n\t}\n\t.form-row {\n\t\tdisplay: grid;\n\t\tgrid-template-columns: 1fr 1fr;\n\t\tgap: 20px;\n\t}\n\t.form-group {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tgap: 8px;\n\t}\n\tlabel {\n\t\tfont-size: 16px;\n\t\tfont-weight: 600;\n\t\tcolor: #374151;\n\t}\n\t.hint {\n\t\tcolor: #9ca3af;\n\t\tfont-weight: 400;\n\t}\n\tinput,\n\ttextarea {\n\t\twidth: 100%;\n\t\tpadding: 16px;\n\t\tborder: 1px solid #e5e7eb;\n\t\tborder-radius: 12px;\n\t\tfont-size: 18px;\n\t\tbackground: white;\n\t\tbox-sizing: border-box;\n\t}\n\tinput:focus,\n\ttextarea:focus {\n\t\toutline: none;\n\t\tborder-color: #ff7f50;\n\t}\n\t.readonly-field {\n\t\tbackground: #f9fafb;\n\t\tpadding: 16px;\n\t\tborder-radius: 12px;\n\t\tborder: 1px solid #e5e7eb;\n\t\tcolor: #6b7280;\n\t\tfont-weight: 500;\n\t\tfont-size: 18px;\n\t}\n\t.address-input {\n\t\tpadding-top: 20px;\n\t\tpadding-bottom: 20px;\n\t\tfont-size: 19px;\n\t}\n\t.input-money-wrapper {\n\t\tposition: relative;\n\t\twidth: 100%;\n\t}\n\t.input-money-wrapper .symbol {\n\t\tposition: absolute;\n\t\tleft: 16px;\n\t\ttop: 50%;\n\t\ttransform: translateY(-50%);\n\t\tcolor: #6b7280;\n\t\tfont-weight: 600;\n\t\tfont-size: 18px;\n\t}\n\t.input-money-wrapper input {\n\t\tpadding-left: 36px;\n\t}\n\t.input-money-wrapper.small input {\n\t\tpadding: 12px 12px 12px 30px;\n\t\tfont-size: 16px;\n\t}\n\t.input-money-wrapper.small .symbol {\n\t\tleft: 12px;\n\t\tfont-size: 16px;\n\t}\n\t.stops-container {\n\t\tmargin: 26px 0;\n\t\tborder: 1px solid #e5e7eb;\n\t\tborder-radius: 14px;\n\t\tpadding: 16px;\n\t\tbackground: #f9fafb;\n\t}\n\t.stops-header {\n\t\tdisplay: flex;\n\t\tjustify-content: space-between;\n\t\tmargin-bottom: 18px;\n\t\talign-items: center;\n\t}\n\t.stops-header h3 {\n\t\tfont-size: 18px;\n\t\tfont-weight: 700;\n\t\tmargin: 0;\n\t}\n\t.stops-header .count {\n\t\tfont-size: 14px;\n\t\tcolor: #6b7280;\n\t\tbackground: #e5e7eb;\n\t\tpadding: 5px 12px;\n\t\tborder-radius: 10px;\n\t}\n\t.stops-list {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tgap: 18px;\n\t\tmargin-bottom: 22px;\n\t}\n\t.stop-card {\n\t\tbackground: white;\n\t\tborder: 1px solid #e5e7eb;\n\t\tborder-radius: 14px;\n\t\tpadding: 18px;\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tgap: 18px;\n\t}\n\t.stop-header {\n\t\tdisplay: flex;\n\t\tjustify-content: space-between;\n\t\talign-items: center;\n\t}\n\t.stop-number {\n\t\tbackground: #ff7f50;\n\t\tcolor: white;\n\t\twidth: 30px;\n\t\theight: 30px;\n\t\tborder-radius: 8px;\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t\tfont-weight: 700;\n\t\tfont-size: 15px;\n\t}\n\t.stop-actions {\n\t\tdisplay: flex;\n\t\tgap: 18px;\n\t\talign-items: center;\n\t\tcolor: #9ca3af;\n\t}\n\t.stop-inputs {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tgap: 14px;\n\t\twidth: 100%;\n\t}\n\t.stop-inputs.new {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tgap: 14px;\n\t\tmargin-bottom: 18px;\n\t}\n\t.form-actions {\n\t\tdisplay: flex;\n\t\tgap: 18px;\n\t\tmargin-top: 36px;\n\t\tpadding-top: 26px;\n\t\tborder-top: 1px solid #e5e7eb;\n\t}\n\t.btn-primary,\n\t.btn-secondary {\n\t\tflex: 1;\n\t\tpadding: 18px;\n\t\tborder-radius: 12px;\n\t\tfont-weight: 600;\n\t\tfont-size: 18px;\n\t\tcursor: pointer;\n\t\tborder: none;\n\t\ttext-align: center;\n\t}\n\t.btn-primary {\n\t\tbackground: linear-gradient(135deg, #ff7f50 0%, #ff6a3d 100%);\n\t\tcolor: white;\n\t}\n\t.btn-secondary {\n\t\tbackground: white;\n\t\tborder: 1px solid #e5e7eb;\n\t\tcolor: #374151;\n\t}\n\t.btn-icon {\n\t\tbackground: none;\n\t\tborder: none;\n\t\tfont-size: 22px;\n\t\tcursor: pointer;\n\t\tcolor: #9ca3af;\n\t\tpadding: 6px;\n\t}\n\t.btn-icon.delete:hover {\n\t\tcolor: #dc2626;\n\t}\n\t.btn-icon.gear {\n\t\tcolor: #6b7280;\n\t\tfont-size: 18px;\n\t\tpadding: 4px;\n\t\ttransition: color 0.2s;\n\t}\n\t.btn-icon.gear:hover {\n\t\tcolor: #374151;\n\t}\n\n\t.btn-small {\n\t\tpadding: 12px 18px;\n\t\tborder-radius: 8px;\n\t\tborder: none;\n\t\tfont-weight: 600;\n\t\tfont-size: 15px;\n\t\tcursor: pointer;\n\t}\n\t.btn-small.primary {\n\t\tbackground: #10b981;\n\t\tcolor: white;\n\t}\n\t.summary-box {\n\t\tbackground: #ecfdf5;\n\t\tborder: 1px solid #a7f3d0;\n\t\tpadding: 22px;\n\t\tborder-radius: 14px;\n\t\tdisplay: flex;\n\t\tjustify-content: space-between;\n\t\talign-items: center;\n\t\tcolor: #065f46;\n\t\tmargin-bottom: 36px;\n\t\tfont-size: 18px;\n\t}\n\t.section-group {\n\t\tmargin-bottom: 36px;\n\t}\n\t.section-top {\n\t\tdisplay: flex;\n\t\tjustify-content: space-between;\n\t\tmargin-bottom: 18px;\n\t\talign-items: center;\n\t}\n\t.section-top h3 {\n\t\tfont-size: 18px;\n\t\tfont-weight: 700;\n\t\tmargin: 0;\n\t}\n\n\t.add-row {\n\t\tdisplay: flex;\n\t\tgap: 12px;\n\t\tmargin-bottom: 18px;\n\t}\n\t.select-input {\n\t\tflex: 1;\n\t\tpadding: 12px;\n\t\tborder: 1px solid #e5e7eb;\n\t\tborder-radius: 10px;\n\t\tfont-size: 16px;\n\t\tbackground: white;\n\t\tcolor: #374151;\n\t}\n\n\t.expense-row {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tjustify-content: space-between;\n\t\tgap: 14px;\n\t\tpadding: 14px 0;\n\t\tborder-bottom: 1px solid #f3f4f6;\n\t}\n\n\t.expense-row .name {\n\t\tfont-size: 17px;\n\t\tfont-weight: 500;\n\t\tflex: 1;\n\t}\n\t.expense-row .input-money-wrapper {\n\t\twidth: 120px;\n\t}\n\t.review-grid {\n\t\tdisplay: grid;\n\t\tgrid-template-columns: 1fr 1fr;\n\t\tgap: 18px;\n\t\tmargin-bottom: 36px;\n\t}\n\t.review-tile {\n\t\tbackground: #f9fafb;\n\t\tpadding: 18px;\n\t\tborder-radius: 14px;\n\t\tborder: 1px solid #e5e7eb;\n\t}\n\t.review-tile .review-label {\n\t\tdisplay: block;\n\t\tfont-size: 14px;\n\t\tcolor: #6b7280;\n\t\ttext-transform: uppercase;\n\t\tmargin-bottom: 4px;\n\t}\n\t.review-tile div {\n\t\tfont-weight: 700;\n\t\tfont-size: 18px;\n\t\tcolor: #111827;\n\t}\n\t.financial-summary {\n\t\tbackground: #f9fafb;\n\t\tpadding: 26px;\n\t\tborder-radius: 16px;\n\t\tborder: 1px solid #e5e7eb;\n\t\tmargin-bottom: 26px;\n\t}\n\t.financial-summary .row {\n\t\tdisplay: flex;\n\t\tjustify-content: space-between;\n\t\tmargin-bottom: 14px;\n\t\tfont-size: 17px;\n\t}\n\t.financial-summary .row.subheader {\n\t\tfont-weight: 700;\n\t\tcolor: #374151;\n\t\tmargin-top: 18px;\n\t\tborder-bottom: 1px solid #e5e7eb;\n\t\tpadding-bottom: 4px;\n\t\tmargin-bottom: 8px;\n\t\tfont-size: 15px;\n\t}\n\t.financial-summary .row.detail {\n\t\tfont-size: 15px;\n\t\tcolor: #6b7280;\n\t}\n\t.financial-summary .row.total-expenses {\n\t\tfont-weight: 600;\n\t\tcolor: #4b5563;\n\t\tborder-top: 1px dashed #d1d5db;\n\t\tpadding-top: 8px;\n\t}\n\t.financial-summary .total {\n\t\tborder-top: 2px solid #d1d5db;\n\t\tmargin-top: 18px;\n\t\tpadding-top: 18px;\n\t\tfont-weight: 800;\n\t\tfont-size: 20px;\n\t}\n\t.val.positive {\n\t\tcolor: #059669;\n\t}\n\t.val.negative {\n\t\tcolor: #dc2626;\n\t}\n\t.categories-manager {\n\t\tpadding: 4px;\n\t}\n\t.tabs {\n\t\tdisplay: flex;\n\t\tgap: 8px;\n\t\tmargin-bottom: 16px;\n\t\tborder-bottom: 1px solid #e5e7eb;\n\t}\n\t.tab-btn {\n\t\tpadding: 8px 16px;\n\t\tbackground: none;\n\t\tborder: none;\n\t\tborder-bottom: 2px solid transparent;\n\t\tfont-weight: 600;\n\t\tcolor: #6b7280;\n\t\tcursor: pointer;\n\t\ttransition: all 0.2s;\n\t}\n\t.tab-btn.active {\n\t\tcolor: #ff7f50;\n\t\tborder-bottom-color: #ff7f50;\n\t}\n\t.cat-list {\n\t\tdisplay: flex;\n\t\tflex-wrap: wrap;\n\t\tgap: 8px;\n\t\tmargin-bottom: 20px;\n\t\tmax-height: 200px;\n\t\toverflow-y: auto;\n\t}\n\t.cat-item {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tgap: 4px;\n\t\tbackground: #f3f4f6;\n\t\tpadding: 4px 4px 4px 10px;\n\t\tborder-radius: 20px;\n\t\tborder: 1px solid #e5e7eb;\n\t}\n\t.cat-badge {\n\t\tfont-size: 13px;\n\t\tfont-weight: 500;\n\t\ttext-transform: capitalize;\n\t\tpadding: 0 4px;\n\t}\n\t.cat-delete {\n\t\tborder: none;\n\t\tbackground: #e5e7eb;\n\t\tcolor: #6b7280;\n\t\tborder-radius: 50%;\n\t\twidth: 24px;\n\t\theight: 24px;\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t\tcursor: pointer;\n\t\ttransition: all 0.2s;\n\t}\n\t.cat-delete:hover {\n\t\tbackground: #ef4444;\n\t\tcolor: white;\n\t}\n\t.add-cat-form {\n\t\tdisplay: flex;\n\t\tgap: 8px;\n\t}\n\t.add-cat-form .input-field {\n\t\tflex: 1;\n\t\tpadding: 10px;\n\t\tborder: 1px solid #e5e7eb;\n\t\tborder-radius: 8px;\n\t}\n\t.modal-actions .btn-cancel {\n\t\tbackground: white;\n\t\tborder: 1px solid #e5e7eb;\n\t\tcolor: #374151;\n\t\tpadding: 12px;\n\t\tborder-radius: 8px;\n\t\tfont-weight: 600;\n\t\tcursor: pointer;\n\t\twidth: 100%;\n\t}\n\n\t@media (min-width: 768px) {\n\t\t.page-subtitle {\n\t\t\tdisplay: block;\n\t\t}\n\t\t.form-card {\n\t\t\tpadding: 48px;\n\t\t}\n\t\t.stop-card {\n\t\t\tflex-direction: row;\n\t\t\talign-items: center;\n\t\t}\n\t\t.stop-inputs {\n\t\t\tdisplay: grid;\n\t\t\tgrid-template-columns: 1fr 160px;\n\t\t}\n\t\t.stop-inputs.new {\n\t\t\tdisplay: grid;\n\t\t\tgrid-template-columns: 1fr 160px;\n\t\t}\n\t\t.form-actions {\n\t\t\tjustify-content: flex-end;\n\t\t}\n\t\t.btn-primary,\n\t\t.btn-secondary {\n\t\t\tflex: 0 0 auto;\n\t\t\twidth: auto;\n\t\t\tmin-width: 160px;\n\t\t}\n\t}\n</style>\n",
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\debug\\passkey-demo\\+page.server.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\debug\\passkey-demo\\+page.svelte",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\debug\\webauthn-test\\+server.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\docs\\+page.svelte",
		"messages": [
			{
				"ruleId": "svelte/no-navigation-without-resolve",
				"severity": 1,
				"message": "Unexpected href link without resolve().",
				"line": 60,
				"column": 15,
				"nodeType": null,
				"messageId": "linkWithoutResolve",
				"endLine": 60,
				"endColumn": 47
			}
		],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 1,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"source": "<script lang=\"ts\">\n\timport Header from '$lib/components/layout/Header.svelte';\n\timport { base } from '$app/paths';\n\tconst resolve = (href: string) => `${base}${href}`;\n\n\t// Simple smooth scroll handler\n\tfunction scrollToSection(id: string) {\n\t\tif (typeof document === 'undefined') return;\n\t\tconst element = document.getElementById(id);\n\t\tif (element) {\n\t\t\telement.scrollIntoView({ behavior: 'smooth' });\n\t\t}\n\t}\n</script>\n\n<svelte:head>\n\t<title>Documentation - Go Route Yourself</title>\n\t<meta\n\t\tname=\"description\"\n\t\tcontent=\"API documentation, user guides, and FAQs for Go Route Yourself.\"\n\t/>\n</svelte:head>\n\n<Header />\n\n<div class=\"docs-page\">\n\t<div class=\"container\">\n\t\t<div class=\"docs-layout\">\n\t\t\t<aside class=\"sidebar\">\n\t\t\t\t<div class=\"sidebar-content\">\n\t\t\t\t\t<h3 class=\"nav-title\">User Guide</h3>\n\t\t\t\t\t<button on:click={() => scrollToSection('getting-started')}>Getting Started</button>\n\t\t\t\t\t<button on:click={() => scrollToSection('profit-tracking')}>Profit Tracking</button>\n\t\t\t\t\t<button on:click={() => scrollToSection('exporting')}>Exporting Reports</button>\n\n\t\t\t\t\t<h3 class=\"nav-title\">API Reference</h3>\n\t\t\t\t\t<button on:click={() => scrollToSection('authentication')}>Authentication</button>\n\t\t\t\t\t<button on:click={() => scrollToSection('endpoints')}>Endpoints</button>\n\n\t\t\t\t\t<h3 class=\"nav-title\">Support</h3>\n\t\t\t\t\t<button on:click={() => scrollToSection('faq')}>FAQs</button>\n\t\t\t\t</div>\n\t\t\t</aside>\n\n\t\t\t<main class=\"content\">\n\t\t\t\t<div class=\"page-header\">\n\t\t\t\t\t<h1>Documentation</h1>\n\t\t\t\t\t<p>\n\t\t\t\t\t\tEverything you need to manage your routes, track profits, and integrate with our\n\t\t\t\t\t\tplatform.\n\t\t\t\t\t</p>\n\t\t\t\t</div>\n\n\t\t\t\t<section id=\"getting-started\" class=\"doc-section\">\n\t\t\t\t\t<h2>Getting Started</h2>\n\t\t\t\t\t<p>\n\t\t\t\t\t\tGo Route Yourself helps drivers plan efficient routes and track their net profit in\n\t\t\t\t\t\treal-time. To begin, create an account and set your default values (MPG, Gas Price) in\n\t\t\t\t\t\tthe\n\t\t\t\t\t\t<a href={resolve('/dashboard/settings')}>Settings</a> menu.\n\t\t\t\t\t</p>\n\t\t\t\t</section>\n\n\t\t\t\t<section id=\"profit-tracking\" class=\"doc-section\">\n\t\t\t\t\t<h2>Profit Tracking</h2>\n\t\t\t\t\t<p>\n\t\t\t\t\t\tUnlike standard GPS apps, we focus on your bottom line. Here is how we calculate your\n\t\t\t\t\t\t\"True Profit\":\n\t\t\t\t\t</p>\n\t\t\t\t\t<div class=\"info-box\">\n\t\t\t\t\t\t<strong>Formula:</strong><br />\n\t\t\t\t\t\t<code>(Stop Earnings) - (Fuel Cost + Maintenance + Supplies) = Net Profit</code>\n\t\t\t\t\t</div>\n\t\t\t\t\t<ul>\n\t\t\t\t\t\t<li><strong>Earnings:</strong> Assign a dollar value to every stop or delivery.</li>\n\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t<strong>Fuel:</strong> Calculated automatically based on your vehicle's MPG and local gas\n\t\t\t\t\t\t\tprices, or entered manually.\n\t\t\t\t\t\t</li>\n\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t<strong>Maintenance:</strong> Log oil changes, repairs, or set a \"per-mile\" wear-and-tear\n\t\t\t\t\t\t\tcost.\n\t\t\t\t\t\t</li>\n\t\t\t\t\t</ul>\n\t\t\t\t</section>\n\n\t\t\t\t<section id=\"exporting\" class=\"doc-section\">\n\t\t\t\t\t<h2>Exporting Reports</h2>\n\t\t\t\t\t<p>You can export your data for tax purposes or team reporting.</p>\n\t\t\t\t\t<ol>\n\t\t\t\t\t\t<li>Navigate to <strong>Settings > Data Management</strong>.</li>\n\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\tChoose <strong>Export All Trips (CSV)</strong> for a spreadsheet compatible with Excel/Google\n\t\t\t\t\t\t\tSheets.\n\t\t\t\t\t\t</li>\n\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\tFor a visual summary, use the <strong>Print/PDF</strong> button on the Dashboard.\n\t\t\t\t\t\t</li>\n\t\t\t\t\t</ol>\n\t\t\t\t</section>\n\n\t\t\t\t<hr class=\"divider\" />\n\n\t\t\t\t<section id=\"authentication\" class=\"doc-section\">\n\t\t\t\t\t<div class=\"badge-api\">Business Plan Only</div>\n\t\t\t\t\t<h2>API Authentication</h2>\n\t\t\t\t\t<p>\n\t\t\t\t\t\tThe Go Route Yourself API allows Business Plan users to integrate route data directly\n\t\t\t\t\t\tinto their own systems. All API requests require a Bearer Token.\n\t\t\t\t\t</p>\n\t\t\t\t\t<div class=\"code-block\">\n\t\t\t\t\t\t<div class=\"code-header\">Header Format</div>\n\t\t\t\t\t\t<pre>Authorization: Bearer YOUR_API_KEY</pre>\n\t\t\t\t\t</div>\n\t\t\t\t</section>\n\n\t\t\t\t<section id=\"endpoints\" class=\"doc-section\">\n\t\t\t\t\t<h2>Endpoints</h2>\n\n\t\t\t\t\t<div class=\"endpoint\">\n\t\t\t\t\t\t<div class=\"endpoint-header\">\n\t\t\t\t\t\t\t<span class=\"method get\">GET</span>\n\t\t\t\t\t\t\t<span class=\"url\">/v1/trips</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<p>Retrieve a list of all trips within a date range.</p>\n\t\t\t\t\t\t<div class=\"code-block\">\n\t\t\t\t\t\t\t<pre>\n// Request\nGET /v1/trips?start=2025-01-01&end=2025-01-31\n\n// Response\n&#123;\n  \"data\": [\n    &#123;\n      \"id\": \"trip_123\",\n      \"date\": \"2025-01-15\",\n      \"netProfit\": 145.50,\n      \"totalMiles\": 45.2\n    &#125;\n  ]\n&#125;</pre>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\"endpoint\">\n\t\t\t\t\t\t<div class=\"endpoint-header\">\n\t\t\t\t\t\t\t<span class=\"method post\">POST</span>\n\t\t\t\t\t\t\t<span class=\"url\">/v1/routes/optimize</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<p>Submit a list of stops to receive an optimized route order.</p>\n\t\t\t\t\t</div>\n\t\t\t\t</section>\n\n\t\t\t\t<hr class=\"divider\" />\n\n\t\t\t\t<section id=\"faq\" class=\"doc-section\">\n\t\t\t\t\t<h2>Frequently Asked Questions</h2>\n\n\t\t\t\t\t<div class=\"faq-item\">\n\t\t\t\t\t\t<h4>How accurate is the GPS mileage?</h4>\n\t\t\t\t\t\t<p>\n\t\t\t\t\t\t\tWe use the Google Maps API for high-accuracy routing. However, actual mileage may vary\n\t\t\t\t\t\t\tslightly due to road detours or GPS drift.\n\t\t\t\t\t\t</p>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\"faq-item\">\n\t\t\t\t\t\t<h4>Can I cancel my subscription?</h4>\n\t\t\t\t\t\t<p>\n\t\t\t\t\t\t\tYes, you can cancel anytime from the Settings page. Your data will be preserved for 30\n\t\t\t\t\t\t\tdays in case you decide to return.\n\t\t\t\t\t\t</p>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\"faq-item\">\n\t\t\t\t\t\t<h4>Do you support team accounts?</h4>\n\t\t\t\t\t\t<p>\n\t\t\t\t\t\t\tYes! The Business Plan allows you to add multiple drivers and view a consolidated\n\t\t\t\t\t\t\tdashboard of all fleet earnings.\n\t\t\t\t\t\t</p>\n\t\t\t\t\t</div>\n\t\t\t\t</section>\n\t\t\t</main>\n\t\t</div>\n\t</div>\n</div>\n\n<style>\n\t:global(:root) {\n\t\t--navy: #2c4a6e;\n\t\t--orange: #ff7f50;\n\t\t--blue: #29abe2;\n\t\t--gray-100: #f3f4f6;\n\t\t--gray-200: #e5e7eb;\n\t\t--gray-600: #4b5563;\n\t\t--gray-800: #1f2937;\n\t\t--gray-900: #111827;\n\t\t--bg-light: #f9fafb;\n\t}\n\n\t.docs-page {\n\t\tbackground-color: var(--bg-light);\n\t\tmin-height: 100vh;\n\t\tfont-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\n\t\tcolor: var(--gray-900);\n\t\tline-height: 1.6;\n\t}\n\n\t.container {\n\t\tmax-width: 1200px;\n\t\tmargin: 0 auto;\n\t\tpadding: 0 20px;\n\t}\n\n\t.docs-layout {\n\t\tdisplay: grid;\n\t\tgrid-template-columns: 250px 1fr;\n\t\tgap: 40px;\n\t\tpadding: 40px 0;\n\t}\n\n\t/* Sidebar */\n\t.sidebar {\n\t\tposition: sticky;\n\t\ttop: 100px; /* Offset for fixed header */\n\t\theight: calc(100vh - 140px);\n\t\toverflow-y: auto;\n\t}\n\n\t.nav-title {\n\t\tfont-size: 12px;\n\t\ttext-transform: uppercase;\n\t\tletter-spacing: 0.05em;\n\t\tcolor: var(--gray-600);\n\t\tfont-weight: 700;\n\t\tmargin: 24px 0 12px;\n\t}\n\n\t.sidebar button {\n\t\tdisplay: block;\n\t\twidth: 100%;\n\t\ttext-align: left;\n\t\tbackground: none;\n\t\tborder: none;\n\t\tpadding: 8px 0;\n\t\tcolor: var(--gray-600);\n\t\tcursor: pointer;\n\t\tfont-size: 15px;\n\t\ttransition: color 0.2s;\n\t}\n\n\t.sidebar button:hover {\n\t\tcolor: var(--orange);\n\t}\n\n\t/* Content */\n\t.content {\n\t\tbackground: white;\n\t\tpadding: 48px;\n\t\tborder-radius: 16px;\n\t\tbox-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05);\n\t\tborder: 1px solid var(--gray-200);\n\t}\n\n\t.page-header {\n\t\tmargin-bottom: 48px;\n\t\tborder-bottom: 1px solid var(--gray-200);\n\t\tpadding-bottom: 24px;\n\t}\n\n\th1 {\n\t\tfont-size: 42px;\n\t\tfont-weight: 800;\n\t\tcolor: var(--navy);\n\t\tmargin-bottom: 16px;\n\t}\n\n\t.doc-section {\n\t\tmargin-bottom: 60px;\n\t\tscroll-margin-top: 100px; /* For sticky header clearance */\n\t}\n\n\th2 {\n\t\tfont-size: 28px;\n\t\tfont-weight: 700;\n\t\tcolor: var(--navy);\n\t\tmargin-bottom: 24px;\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tgap: 12px;\n\t}\n\n\tp,\n\tli {\n\t\tcolor: var(--gray-600);\n\t\tmargin-bottom: 16px;\n\t\tfont-size: 16px;\n\t}\n\n\tul,\n\tol {\n\t\tpadding-left: 24px;\n\t\tmargin-bottom: 24px;\n\t}\n\n\tli {\n\t\tmargin-bottom: 8px;\n\t}\n\n\ta {\n\t\tcolor: var(--orange);\n\t\ttext-decoration: none;\n\t\tfont-weight: 500;\n\t}\n\ta:hover {\n\t\ttext-decoration: underline;\n\t}\n\n\t/* API Styles */\n\t.badge-api {\n\t\tdisplay: inline-block;\n\t\tbackground: var(--navy);\n\t\tcolor: white;\n\t\tfont-size: 11px;\n\t\tfont-weight: 700;\n\t\tpadding: 4px 8px;\n\t\tborder-radius: 4px;\n\t\tmargin-bottom: 8px;\n\t\ttext-transform: uppercase;\n\t}\n\n\t.code-block {\n\t\tbackground: var(--gray-900);\n\t\tcolor: var(--gray-100);\n\t\tborder-radius: 8px;\n\t\tpadding: 20px;\n\t\tfont-family: 'Monaco', 'Consolas', monospace;\n\t\tfont-size: 14px;\n\t\toverflow-x: auto;\n\t\tmargin: 16px 0;\n\t}\n\n\t.endpoint {\n\t\tmargin-bottom: 32px;\n\t\tborder: 1px solid var(--gray-200);\n\t\tborder-radius: 8px;\n\t\tpadding: 20px;\n\t}\n\n\t.endpoint-header {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tgap: 12px;\n\t\tmargin-bottom: 12px;\n\t\tfont-family: monospace;\n\t\tfont-size: 16px;\n\t}\n\n\t.method {\n\t\tfont-weight: 700;\n\t\tpadding: 4px 8px;\n\t\tborder-radius: 4px;\n\t\tcolor: white;\n\t}\n\t.method.get {\n\t\tbackground-color: var(--blue);\n\t}\n\t.method.post {\n\t\tbackground-color: var(--orange);\n\t}\n\n\t.info-box {\n\t\tbackground: #eff6ff; /* Light blue */\n\t\tborder-left: 4px solid var(--blue);\n\t\tpadding: 16px;\n\t\tmargin-bottom: 24px;\n\t\tcolor: var(--navy);\n\t}\n\n\t.divider {\n\t\tborder: 0;\n\t\theight: 1px;\n\t\tbackground: var(--gray-200);\n\t\tmargin: 40px 0;\n\t}\n\n\t.faq-item {\n\t\tmargin-bottom: 32px;\n\t}\n\n\t.faq-item h4 {\n\t\tfont-size: 18px;\n\t\tfont-weight: 600;\n\t\tcolor: var(--gray-900);\n\t\tmargin-bottom: 8px;\n\t}\n\n\t/* Responsive */\n\t@media (max-width: 900px) {\n\t\t.docs-layout {\n\t\t\tgrid-template-columns: 1fr;\n\t\t}\n\t\t.sidebar {\n\t\t\tdisplay: none; /* Hide sidebar on mobile for simplicity, or make it a dropdown */\n\t\t}\n\t\t.content {\n\t\t\tpadding: 24px;\n\t\t}\n\t\th1 {\n\t\t\tfont-size: 32px;\n\t\t}\n\t}\n</style>\n",
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\forgot-password\\+page.svelte",
		"messages": [
			{
				"ruleId": "svelte/no-navigation-without-resolve",
				"severity": 1,
				"message": "Unexpected href link without resolve().",
				"line": 47,
				"column": 13,
				"nodeType": null,
				"messageId": "linkWithoutResolve",
				"endLine": 47,
				"endColumn": 19
			}
		],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 1,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"source": "<script lang=\"ts\">\n\tlet email = '';\n\tlet loading = false;\n\tlet message = '';\n\tlet error = '';\n\n\tasync function handleSubmit() {\n\t\tloading = true;\n\t\tmessage = '';\n\t\terror = '';\n\n\t\ttry {\n\t\t\tconst res = await fetch('/forgot-password', {\n\t\t\t\tmethod: 'POST',\n\t\t\t\theaders: { 'Content-Type': 'application/json' },\n\t\t\t\tbody: JSON.stringify({ email })\n\t\t\t});\n\n\t\t\tlet data: { message?: string } | undefined;\n\t\t\ttry {\n\t\t\t\tdata = (await res.json()) as { message?: string };\n\t\t\t} catch {\n\t\t\t\t/* ignore parse errors */\n\t\t\t}\n\n\t\t\tif (res.ok) {\n\t\t\t\tmessage = 'If an account exists with that email, we have sent a reset link.';\n\t\t\t\temail = ''; // Clear form\n\t\t\t} else {\n\t\t\t\terror = (data && data.message) || 'An error occurred.';\n\t\t\t}\n\t\t} catch {\n\t\t\terror = 'Network error. Please try again.';\n\t\t} finally {\n\t\t\tloading = false;\n\t\t}\n\t}\n</script>\n\n<svelte:head>\n\t<title>Forgot Password - Go Route Yourself</title>\n</svelte:head>\n\n<div class=\"auth-page\">\n\t<div class=\"form-container\">\n\t\t<div class=\"form-header\">\n\t\t\t<a href=\"/login\" class=\"back-link\">ΓåÉ Back to Login</a>\n\t\t\t<h1>Reset Password</h1>\n\t\t\t<p>Enter your email to receive a reset link.</p>\n\t\t</div>\n\n\t\t{#if message}\n\t\t\t<div class=\"alert success\">{message}</div>\n\t\t{/if}\n\n\t\t{#if error}\n\t\t\t<div class=\"alert error\">{error}</div>\n\t\t{/if}\n\n\t\t<form on:submit|preventDefault={handleSubmit}>\n\t\t\t<div class=\"field-group\">\n\t\t\t\t<label for=\"email\">Email Address</label>\n\t\t\t\t<input\n\t\t\t\t\ttype=\"email\"\n\t\t\t\t\tid=\"email\"\n\t\t\t\t\tbind:value={email}\n\t\t\t\t\trequired\n\t\t\t\t\tplaceholder=\"Enter your email\"\n\t\t\t\t\tclass=\"input-field\"\n\t\t\t\t/>\n\t\t\t</div>\n\n\t\t\t<button type=\"submit\" class=\"btn-submit\" disabled={loading}>\n\t\t\t\t{loading ? 'Sending...' : 'Send Reset Link'}\n\t\t\t</button>\n\t\t</form>\n\t</div>\n</div>\n\n<style>\n\t/* Reusing similar styles to your login page for consistency */\n\t.auth-page {\n\t\tmin-height: 100vh;\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t\tbackground: #f9fafb;\n\t\tfont-family: 'Inter', sans-serif;\n\t}\n\t.form-container {\n\t\tbackground: white;\n\t\tpadding: 40px;\n\t\tborder-radius: 12px;\n\t\tbox-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);\n\t\twidth: 100%;\n\t\tmax-width: 400px;\n\t}\n\t.form-header {\n\t\tmargin-bottom: 24px;\n\t\ttext-align: center;\n\t}\n\th1 {\n\t\tfont-size: 24px;\n\t\tfont-weight: 700;\n\t\tcolor: #111827;\n\t\tmargin: 10px 0;\n\t}\n\tp {\n\t\tcolor: #6b7280;\n\t\tfont-size: 14px;\n\t}\n\t.back-link {\n\t\tcolor: #ff7f50;\n\t\ttext-decoration: none;\n\t\tfont-size: 14px;\n\t\tfont-weight: 600;\n\t}\n\t.input-field {\n\t\twidth: 100%;\n\t\tpadding: 12px;\n\t\tborder: 2px solid #e5e7eb;\n\t\tborder-radius: 8px;\n\t\tfont-size: 15px;\n\t\tmargin-top: 6px;\n\t}\n\t.field-group {\n\t\tmargin-bottom: 20px;\n\t}\n\t.btn-submit {\n\t\twidth: 100%;\n\t\tpadding: 12px;\n\t\tbackground: #ff7f50;\n\t\tcolor: white;\n\t\tborder: none;\n\t\tborder-radius: 8px;\n\t\tfont-weight: 600;\n\t\tcursor: pointer;\n\t}\n\t.btn-submit:disabled {\n\t\topacity: 0.7;\n\t}\n\t.alert {\n\t\tpadding: 12px;\n\t\tborder-radius: 8px;\n\t\tmargin-bottom: 20px;\n\t\tfont-size: 14px;\n\t}\n\t.alert.success {\n\t\tbackground: #f0fdf4;\n\t\tcolor: #166534;\n\t}\n\t.alert.error {\n\t\tbackground: #fef2f2;\n\t\tcolor: #991b1b;\n\t}\n</style>\n",
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\forgot-password\\+server.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\login\\+page.server.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\login\\+page.svelte",
		"messages": [
			{
				"ruleId": "svelte/no-navigation-without-resolve",
				"severity": 1,
				"message": "Unexpected goto() call without resolve().",
				"line": 30,
				"column": 8,
				"nodeType": null,
				"messageId": "gotoWithoutResolve",
				"endLine": 30,
				"endColumn": 33
			},
			{
				"ruleId": "svelte/no-navigation-without-resolve",
				"severity": 1,
				"message": "Unexpected goto() call without resolve().",
				"line": 210,
				"column": 16,
				"nodeType": null,
				"messageId": "gotoWithoutResolve",
				"endLine": 210,
				"endColumn": 28
			},
			{
				"ruleId": "svelte/no-navigation-without-resolve",
				"severity": 1,
				"message": "Unexpected goto() call without resolve().",
				"line": 347,
				"column": 16,
				"nodeType": null,
				"messageId": "gotoWithoutResolve",
				"endLine": 347,
				"endColumn": 28
			},
			{
				"ruleId": "svelte/no-navigation-without-resolve",
				"severity": 1,
				"message": "Unexpected goto() call without resolve().",
				"line": 392,
				"column": 17,
				"nodeType": null,
				"messageId": "gotoWithoutResolve",
				"endLine": 392,
				"endColumn": 29
			},
			{
				"ruleId": "svelte/no-navigation-without-resolve",
				"severity": 1,
				"message": "Unexpected href link without resolve().",
				"line": 434,
				"column": 13,
				"nodeType": null,
				"messageId": "linkWithoutResolve",
				"endLine": 434,
				"endColumn": 14
			},
			{
				"ruleId": "svelte/no-navigation-without-resolve",
				"severity": 1,
				"message": "Unexpected href link without resolve().",
				"line": 776,
				"column": 18,
				"nodeType": null,
				"messageId": "linkWithoutResolve",
				"endLine": 776,
				"endColumn": 34
			},
			{
				"ruleId": "svelte/no-navigation-without-resolve",
				"severity": 1,
				"message": "Unexpected href link without resolve().",
				"line": 820,
				"column": 48,
				"nodeType": null,
				"messageId": "linkWithoutResolve",
				"endLine": 820,
				"endColumn": 54
			},
			{
				"ruleId": "svelte/no-navigation-without-resolve",
				"severity": 1,
				"message": "Unexpected href link without resolve().",
				"line": 821,
				"column": 16,
				"nodeType": null,
				"messageId": "linkWithoutResolve",
				"endLine": 821,
				"endColumn": 24
			}
		],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 8,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"source": "<script lang=\"ts\">\n\timport { goto } from '$app/navigation';\n\timport { page } from '$app/stores';\n\timport { onMount } from 'svelte';\n\timport { toasts } from '$lib/stores/toast';\n\t// See Documentation/Simple Web Auth and Documentation/Svelte 5 for guidance on quick-sign and biometric flows\n\t// [!code ++] Import WebAuthn helper\n\timport { startAuthentication } from '@simplewebauthn/browser';\n\n\tlet username = '';\n\tlet email = '';\n\tlet password = '';\n\tlet confirmPassword = '';\n\tlet responseError: string | null = null;\n\tlet loading = false;\n\tlet registrationSuccess = false;\n\tlet submittedEmail = '';\n\n\t// Quick sign-in state: read from localStorage key 'passkey:preferred' (credentialID/email/name)\n\tlet quickPasskey: { credentialID: string; email?: string; name?: string } | null = null;\n\tlet quickLoading = false;\n\n\t// Check if we are in register mode based on URL query param\n\t$: isLogin = $page.url.searchParams.get('view') !== 'register';\n\n\tfunction toggleMode() {\n\t\tconst url = new URL($page.url);\n\t\tif (isLogin) url.searchParams.set('view', 'register');\n\t\telse url.searchParams.delete('view');\n\t\tgoto(url.pathname + url.search, { replaceState: true });\n\n\t\tusername = '';\n\t\temail = '';\n\t\tpassword = '';\n\t\tconfirmPassword = '';\n\t\tresponseError = null;\n\t\tregistrationSuccess = false;\n\t}\n\n\t// [!code ++] Biometric Login Handler\n\texport function base64UrlToBuffer(base64url: any): Uint8Array {\n\t\t// If already an ArrayBuffer or TypedArray, return a Uint8Array view\n\t\tif (!base64url) return new Uint8Array();\n\t\tif (base64url instanceof ArrayBuffer) return new Uint8Array(base64url);\n\t\tif (ArrayBuffer.isView(base64url))\n\t\t\treturn new Uint8Array(\n\t\t\t\t(base64url as any).buffer,\n\t\t\t\t(base64url as any).byteOffset || 0,\n\t\t\t\t(base64url as any).byteLength || (base64url as any).length\n\t\t\t);\n\n\t\t// Otherwise assume base64url string and decode\n\t\tif (typeof base64url !== 'string') base64url = String(base64url);\n\t\tconst pad = '=='.slice(0, (4 - (base64url.length % 4)) % 4);\n\t\tconst b64 = base64url.replace(/-/g, '+').replace(/_/g, '/') + pad;\n\t\tconst binary = atob(b64);\n\t\tconst len = binary.length;\n\t\tconst bytes = new Uint8Array(len);\n\t\tfor (let i = 0; i < len; i++) bytes[i] = binary.charCodeAt(i);\n\t\treturn bytes;\n\t}\n\n\tasync function handleBiometricLogin() {\n\t\tloading = true;\n\t\tresponseError = null;\n\n\t\ttry {\n\t\t\t// Optionally let user pick a named device first (better UX when multiple passkeys exist)\n\t\t\tlet requestedCredential: string | null = null;\n\t\t\tif (username) {\n\t\t\t\ttry {\n\t\t\t\t\tconst listResp = await fetch(\n\t\t\t\t\t\t`/api/auth/webauthn/list-for-email?email=${encodeURIComponent(username)}`\n\t\t\t\t\t);\n\t\t\t\t\tif (listResp.ok) {\n\t\t\t\t\t\tconst json: any = await listResp.json();\n\t\t\t\t\t\tconst auths = json.authenticators || [];\n\t\t\t\t\t\tif (auths.length > 1) {\n\t\t\t\t\t\t\t// Simple selection prompt (can be replaced with nicer UI)\n\t\t\t\t\t\t\tconst choices = auths\n\t\t\t\t\t\t\t\t.map(\n\t\t\t\t\t\t\t\t\t(a: any, i: number) =>\n\t\t\t\t\t\t\t\t\t\t`${i + 1}. ${a.name || 'Unnamed'} (${a.transports?.join(', ') || 'device'})`\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t.join('\\n');\n\t\t\t\t\t\t\tconst sel = prompt(`Choose a passkey:\\n${choices}\\nEnter the number to use:`);\n\t\t\t\t\t\t\tconst idx = parseInt(String(sel || ''), 10);\n\t\t\t\t\t\t\tif (!isNaN(idx) && idx >= 1 && idx <= auths.length) {\n\t\t\t\t\t\t\t\trequestedCredential = auths[idx - 1].credentialID;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else if (auths.length === 1) {\n\t\t\t\t\t\t\t// If only one passkey exists for this email, pre-select it\n\t\t\t\t\t\t\trequestedCredential = auths[0].credentialID;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} catch (e) {\n\t\t\t\t\tconsole.error('Could not fetch passkey list for email', e);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// 1. Request challenge from your server\n\t\t\tconst optionsResp = await fetch(\n\t\t\t\t`/api/auth/webauthn${requestedCredential ? `?credential=${encodeURIComponent(requestedCredential)}` : ''}`,\n\t\t\t\t{ credentials: 'same-origin' }\n\t\t\t);\n\t\t\tconst rawText = await optionsResp.text();\n\t\t\tlet optionsJson: Record<string, unknown> | undefined;\n\t\t\ttry {\n\t\t\t\toptionsJson = JSON.parse(rawText) as Record<string, unknown>;\n\t\t} catch (_err) {\n\t\t\t\tthrow new Error(errMsg);\n\t\t\t}\n\n\t\t\tconst options = optionsJson as Record<string, unknown>;\n\n\t\t\tconsole.log('[Passkey] Auth options from server (raw):', rawText);\n\t\t\tif (!options || typeof options !== 'object') {\n\t\t\t\tconsole.error('[Passkey] Invalid auth options payload:', optionsJson);\n\t\t\t\tthrow new Error('Invalid authentication options from server');\n\t\t\t}\n\n\t\t\tconst challenge = options['challenge'];\n\t\t\tif (!challenge) {\n\t\t\t\tconsole.error('[Passkey] Missing challenge in auth options:', options);\n\t\t\t\tthrow new Error('Authentication options missing challenge');\n\t\t\t}\n\n\t\t\t// Ensure challenge is a base64url string (don't convert to ArrayBuffer; the helper will manage it)\n\t\t\tif (typeof challenge !== 'string') {\n\t\t\t\tconsole.warn('[Passkey] Unexpected challenge type; converting to base64url string');\n\t\t\t\tconst bytes =\n\t\t\t\t\tchallenge instanceof Uint8Array\n\t\t\t\t\t\t? challenge\n\t\t\t\t\t\t: new Uint8Array(challenge as ArrayLike<number>);\n\t\t\t\tlet binary = '';\n\t\t\t\tfor (let i = 0; i < bytes.byteLength; i++)\n\t\t\t\t\tbinary += String.fromCharCode(Number(bytes[i] ?? 0));\n\t\t\t\toptions['challenge'] = btoa(binary)\n\t\t\t\t\t.replace(/\\+/g, '-')\n\t\t\t\t\t.replace(/\\//g, '_')\n\t\t\t\t\t.replace(/=+$/, '');\n\t\t\t}\n\n\t\t\tif (Array.isArray(options['allowCredentials'])) {\n\t\t\t\toptions['allowCredentials'] = (\n\t\t\t\t\toptions['allowCredentials'] as Array<Record<string, unknown>>\n\t\t\t\t).map((c) => ({\n\t\t\t\t\t...c,\n\t\t\t\t\tid: String((c as Record<string, unknown>)['id'])\n\t\t\t\t}));\n\t\t\t}\n\n\t\t\t// 2. Prompt user for FaceID/TouchID (Browser Native Modal)\n\t\t\tconst authResp = await startAuthentication({ optionsJSON: options as any });\n\n\t\t\t// 3. Verify signature with server (ensure credential.serializable fields are sent)\n\t\t\tfunction bufferToBase64Url(buffer: ArrayBuffer | Uint8Array) {\n\t\t\t\tconst bytes = buffer instanceof Uint8Array ? buffer : new Uint8Array(buffer);\n\t\t\t\tlet binary = '';\n\t\t\t\tfor (let i = 0; i < bytes.byteLength; i++)\n\t\t\t\t\tbinary += String.fromCharCode(Number(bytes[i] ?? 0));\n\t\t\t\treturn btoa(binary).replace(/\\+/g, '-').replace(/\\//g, '_').replace(/=+$/, '');\n\t\t\t}\n\n\t\t\tconst normalised: any = { ...authResp } as any;\n\t\t\tif (\n\t\t\t\tnormalised.rawId &&\n\t\t\t\t(normalised.rawId instanceof ArrayBuffer || ArrayBuffer.isView(normalised.rawId))\n\t\t\t) {\n\t\t\t\tnormalised.rawId = bufferToBase64Url(normalised.rawId as ArrayBuffer);\n\t\t\t}\n\t\t\tconst resp = normalised.response || {};\n\t\t\tif (\n\t\t\t\tresp.authenticatorData &&\n\t\t\t\t(resp.authenticatorData instanceof ArrayBuffer ||\n\t\t\t\t\tArrayBuffer.isView(resp.authenticatorData))\n\t\t\t)\n\t\t\t\tresp.authenticatorData = bufferToBase64Url(resp.authenticatorData);\n\t\t\tif (\n\t\t\t\tresp.clientDataJSON &&\n\t\t\t\t(resp.clientDataJSON instanceof ArrayBuffer || ArrayBuffer.isView(resp.clientDataJSON))\n\t\t\t)\n\t\t\t\tresp.clientDataJSON = bufferToBase64Url(resp.clientDataJSON);\n\t\t\tif (\n\t\t\t\tresp.signature &&\n\t\t\t\t(resp.signature instanceof ArrayBuffer || ArrayBuffer.isView(resp.signature))\n\t\t\t)\n\t\t\t\tresp.signature = bufferToBase64Url(resp.signature);\n\t\t\tif (\n\t\t\t\tresp.userHandle &&\n\t\t\t\t(resp.userHandle instanceof ArrayBuffer || ArrayBuffer.isView(resp.userHandle))\n\t\t\t)\n\t\t\t\tresp.userHandle = bufferToBase64Url(resp.userHandle);\n\n\t\t\tconst verificationResp = await fetch('/api/auth/webauthn', {\n\t\t\t\tmethod: 'POST',\n\t\t\t\tcredentials: 'same-origin',\n\t\t\t\theaders: { 'Content-Type': 'application/json' },\n\t\t\t\tbody: JSON.stringify(normalised)\n\t\t\t});\n\n\t\t\tif (!verificationResp.ok) {\n\t\t\t\tconst err: any = await verificationResp.json();\n\t\t\t\tthrow new Error(err.error || 'Verification failed');\n\t\t\t}\n\n\t\t\tconst verificationJSON: any = await verificationResp.json();\n\n\t\t\tif (verificationJSON.verified) {\n\t\t\t\tawait goto('/dashboard', { invalidateAll: true });\n\t\t\t} else {\n\t\t\t\tresponseError = 'Biometric verification failed.';\n\t\t\t}\n\t\t} catch (e: any) {\n\t\t\tconsole.error('Biometric error:', e);\n\t\t\t// Don't show error if user just cancelled the dialog\n\t\t\tif (e.name !== 'NotAllowedError') {\n\t\t\t\tresponseError = e.message || 'Biometric login failed.';\n\t\t\t}\n\t\t} finally {\n\t\t\tloading = false;\n\t\t}\n\t}\n\n\t// Load any preferred passkey saved on this device\n\tonMount(() => {\n\t\tconst raw = localStorage.getItem('passkey:preferred');\n\t\tif (raw) {\n\t\t\ttry {\n\t\t\t\tquickPasskey = JSON.parse(raw);\n\t\t\t} catch {\n\t\t\t\tquickPasskey = null;\n\t\t\t}\n\t\t}\n\t});\n\n\tasync function quickSignIn() {\n\t\tif (!quickPasskey) return;\n\t\tquickLoading = true;\n\t\tresponseError = null;\n\t\ttry {\n\t\t\tconst requestedCredential = quickPasskey.credentialID;\n\t\t\tconst optionsResp = await fetch(\n\t\t\t\t`/api/auth/webauthn?credential=${encodeURIComponent(requestedCredential)}`,\n\t\t\t\t{ credentials: 'same-origin' }\n\t\t\t);\n\t\t\tif (optionsResp.status === 401) {\n\t\t\t\ttoasts.error('Session expired. Please sign in with password.');\n\t\t\t\tquickLoading = false;\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst rawText = await optionsResp.text();\n\t\t\tlet optionsJson: Record<string, unknown> | undefined;\n\t\t\ttry {\n\t\t\t\toptionsJson = JSON.parse(rawText) as Record<string, unknown>;\n\t\t\t} catch (_err) {\n\t\t\t\tconsole.error('[Passkey] Failed to parse auth options JSON:', rawText);\n\t\t\t\tthrow new Error('Invalid authentication options response');\n\t\t\t}\n\n\t\t\tif (!optionsResp.ok) {\n\t\t\t\tthrow new Error((optionsJson && (optionsJson['error'] as string | undefined)) ?? 'Biometric login not available');\n\t\t\t}\n\n\t\t\tconst options = optionsJson as Record<string, unknown>;\n\t\t\tif (!options['challenge']) throw new Error('Authentication options missing challenge');\n\t\t\tif (typeof options['challenge'] !== 'string') {\n\t\t\t\tconst bytes =\n\t\t\t\t\toptions['challenge'] instanceof Uint8Array\n\t\t\t\t\t\t? options['challenge']\n\t\t\t\t\t\t: new Uint8Array(options['challenge'] as ArrayLike<number>);\n\t\t\t\tlet binary = '';\n\t\t\t\tfor (let i = 0; i < bytes.byteLength; i++)\n\t\t\t\t\tbinary += String.fromCharCode(Number(bytes[i] ?? 0));\n\t\t\t\toptions['challenge'] = btoa(binary)\n\t\t\t\t\t.replace(/\\+/g, '-')\n\t\t\t\t\t.replace(/\\//g, '_')\n\t\t\t\t\t.replace(/=+$/, '');\n\t\t\t}\n\n\t\t\tif (Array.isArray(options['allowCredentials'])) {\n\t\t\t\toptions['allowCredentials'] = (\n\t\t\t\t\toptions['allowCredentials'] as Array<Record<string, unknown>>\n\t\t\t\t).map((c) => ({\n\t\t\t\t\t...c,\n\t\t\t\t\tid: String((c as Record<string, unknown>)['id'])\n\t\t\t\t}));\n\t\t\t}\n\n\t\t\tconst authResp = await startAuthentication({ optionsJSON: options as any });\n\n\t\t\tfunction bufferToBase64Url(buffer: ArrayBuffer | Uint8Array) {\n\t\t\t\tconst bytes = buffer instanceof Uint8Array ? buffer : new Uint8Array(buffer);\n\t\t\t\tlet binary = '';\n\t\t\t\tfor (let i = 0; i < bytes.byteLength; i++)\n\t\t\t\t\tbinary += String.fromCharCode(Number(bytes[i] ?? 0));\n\t\t\t\treturn btoa(binary).replace(/\\+/g, '-').replace(/\\//g, '_').replace(/=+$/, '');\n\t\t\t}\n\n\t\t\tconst normalised: any = { ...authResp } as any;\n\t\t\tif (\n\t\t\t\tnormalised.rawId &&\n\t\t\t\t(normalised.rawId instanceof ArrayBuffer || ArrayBuffer.isView(normalised.rawId))\n\t\t\t) {\n\t\t\t\tnormalised.rawId = bufferToBase64Url(normalised.rawId as ArrayBuffer);\n\t\t\t}\n\t\t\tconst resp = normalised.response || {};\n\t\t\tif (\n\t\t\t\tresp.authenticatorData &&\n\t\t\t\t(resp.authenticatorData instanceof ArrayBuffer ||\n\t\t\t\t\tArrayBuffer.isView(resp.authenticatorData))\n\t\t\t)\n\t\t\t\tresp.authenticatorData = bufferToBase64Url(resp.authenticatorData);\n\t\t\tif (\n\t\t\t\tresp.clientDataJSON &&\n\t\t\t\t(resp.clientDataJSON instanceof ArrayBuffer || ArrayBuffer.isView(resp.clientDataJSON))\n\t\t\t)\n\t\t\t\tresp.clientDataJSON = bufferToBase64Url(resp.clientDataJSON);\n\t\t\tif (\n\t\t\t\tresp.signature &&\n\t\t\t\t(resp.signature instanceof ArrayBuffer || ArrayBuffer.isView(resp.signature))\n\t\t\t)\n\t\t\t\tresp.signature = bufferToBase64Url(resp.signature);\n\t\t\tif (\n\t\t\t\tresp.userHandle &&\n\t\t\t\t(resp.userHandle instanceof ArrayBuffer || ArrayBuffer.isView(resp.userHandle))\n\t\t\t)\n\t\t\t\tresp.userHandle = bufferToBase64Url(resp.userHandle);\n\n\t\t\tconst verificationResp = await fetch('/api/auth/webauthn', {\n\t\t\t\tmethod: 'POST',\n\t\t\t\tcredentials: 'same-origin',\n\t\t\t\theaders: { 'Content-Type': 'application/json' },\n\t\t\t\tbody: JSON.stringify(normalised)\n\t\t\t});\n\n\t\t\tif (!verificationResp.ok) {\n\t\t\t\tconst err: any = await verificationResp\n\t\t\t\t\t.json()\n\t\t\t\t\t.catch(() => ({ error: 'Verification failed' }));\n\t\t\t\tthrow new Error(err.error || 'Verification failed');\n\t\t\t}\n\n\t\t\tconst verificationJSON: any = await verificationResp.json();\n\n\t\t\tif (verificationJSON.verified) {\n\t\t\t\tawait goto('/dashboard', { invalidateAll: true });\n\t\t\t} else {\n\t\t\t\tresponseError = 'Biometric verification failed.';\n\t\t\t}\n\t\t} catch (e: any) {\n\t\t\tconsole.error('Quick Biometric error:', e);\n\t\t\tif (e.name !== 'NotAllowedError') {\n\t\t\t\ttoasts.error(e.message || 'Biometric login failed.');\n\t\t\t\tresponseError = e.message || 'Biometric login failed.';\n\t\t\t}\n\t\t} finally {\n\t\t\tquickLoading = false;\n\t\t}\n\t}\n\n\tasync function submitHandler() {\n\t\tresponseError = null;\n\t\tloading = true;\n\n\t\tconst endpoint = isLogin ? '/login' : '/register';\n\n\t\tlet payload = {};\n\t\tif (isLogin) {\n\t\t\tpayload = { email: username, password };\n\t\t} else {\n\t\t\tif (password !== confirmPassword) {\n\t\t\t\tresponseError = \"Passwords don't match\";\n\t\t\t\tloading = false;\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tpayload = { username, email, password };\n\t\t}\n\n\t\ttry {\n\t\t\tconst response = await fetch(endpoint, {\n\t\t\t\tmethod: 'POST',\n\t\t\t\tcredentials: 'same-origin',\n\t\t\t\theaders: { 'Content-Type': 'application/json' },\n\t\t\t\tbody: JSON.stringify(payload)\n\t\t\t});\n\n\t\t\tconst result: any = await response.json();\n\n\t\t\tif (response.ok) {\n\t\t\t\tif (isLogin) {\n\t\t\t\t\tawait goto('/dashboard', { invalidateAll: true });\n\t\t\t\t} else {\n\t\t\t\t\tsubmittedEmail = email;\n\t\t\t\t\tregistrationSuccess = true;\n\t\t\t\t\tusername = '';\n\t\t\t\t\temail = '';\n\t\t\t\t\tpassword = '';\n\t\t\t\t\tconfirmPassword = '';\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tresponseError = result.message || result.error || 'An error occurred.';\n\t\t\t}\n\t\t} catch (e) {\n\t\t\tconsole.error('Fetch error:', e);\n\t\t\tresponseError = 'Network error. Please try again.';\n\t\t} finally {\n\t\t\tloading = false;\n\t\t}\n\t}\n</script>\n\n<svelte:head>\n\t<title>{isLogin ? 'Sign In' : 'Create Account'} - Go Route Yourself</title>\n\t<meta\n\t\tname=\"description\"\n\t\tcontent={isLogin\n\t\t\t? 'Sign in to Go Route Yourself to access your route plans, profit tracking, and mileage logs.'\n\t\t\t: 'Create your free Go Route Yourself account. Start tracking routes, profits, and mileage in minutes.'}\n\t/>\n\t<meta name=\"robots\" content=\"noindex, follow\" />\n\t<link rel=\"canonical\" href=\"https://gorouteyourself.com/login\" />\n\t<link rel=\"preconnect\" href=\"https://fonts.googleapis.com\" />\n\t<link rel=\"preconnect\" href=\"https://fonts.gstatic.com\" crossorigin=\"anonymous\" />\n\t<link\n\t\thref=\"https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap\"\n\t\trel=\"stylesheet\"\n\t/>\n</svelte:head>\n\n<div class=\"auth-page\">\n\t<div class=\"auth-brand\">\n\t\t<div class=\"brand-content\">\n\t\t\t<a href=\"/\" class=\"brand-logo\">\n\t\t\t\t<picture>\n\t\t\t\t\t<source type=\"image/avif\" srcset=\"/180x75.avif 48w\" sizes=\"48px\" />\n\t\t\t\t\t<img\n\t\t\t\t\t\tsrc=\"/180x75.avif\"\n\t\t\t\t\t\talt=\"Go Route Yourself\"\n\t\t\t\t\t\twidth=\"180\"\n\t\t\t\t\t\theight=\"75\"\n\t\t\t\t\t\tdecoding=\"async\"\n\t\t\t\t\t\tstyle=\"width:180px; height:75px; object-fit:contain;\"\n\t\t\t\t\t/>\n\t\t\t\t</picture>\n\t\t\t</a>\n\n\t\t\t<div class=\"brand-text\">\n\t\t\t\t<h1>Welcome to Go Route Yourself</h1>\n\t\t\t\t<p>\n\t\t\t\t\tProfessional route planning and profit tracking for delivery drivers and field workers.\n\t\t\t\t</p>\n\t\t\t</div>\n\n\t\t\t<div class=\"brand-features\">\n\t\t\t\t<div class=\"feature-item\">\n\t\t\t\t\t<div class=\"feature-icon\">\n\t\t\t\t\t\t<svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\">\n\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\td=\"M9 11L12 14L22 4\"\n\t\t\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\t\t\t\t\tstroke-linejoin=\"round\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\td=\"M21 12V19C21 19.5304 20.7893 20.0391 20.4142 20.4142C20.0391 20.7893 19.5304 21 19 21H5C4.46957 21 3.96086 20.7893 3.58579 20.4142C3.21071 20.0391 3 19.5304 3 19V5C3 4.46957 3.21071 3.96086 3.58579 3.58579C3.96086 3.21071 4.46957 3 5 3H16\"\n\t\t\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\t\t\t\t\tstroke-linejoin=\"round\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</svg>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"feature-text\">\n\t\t\t\t\t\t<h3>Smart Route Planning</h3>\n\t\t\t\t\t\t<p>AI-powered optimization</p>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<div class=\"feature-item\">\n\t\t\t\t\t<div class=\"feature-icon\">\n\t\t\t\t\t\t<svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\">\n\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\td=\"M12 2L2 7L12 12L22 7L12 2Z\"\n\t\t\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\t\t\t\t\tstroke-linejoin=\"round\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\td=\"M2 17L12 22L22 17\"\n\t\t\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\t\t\t\t\tstroke-linejoin=\"round\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\td=\"M2 12L12 17L22 12\"\n\t\t\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\t\t\t\t\tstroke-linejoin=\"round\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</svg>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"feature-text\">\n\t\t\t\t\t\t<h3>Real-Time Analytics</h3>\n\t\t\t\t\t\t<p>Track every dollar</p>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<div class=\"feature-item\">\n\t\t\t\t\t<div class=\"feature-icon\">\n\t\t\t\t\t\t<svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\">\n\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\td=\"M21 16V8C20.9996 7.64927 20.9071 7.30481 20.7315 7.00116C20.556 6.69751 20.3037 6.44536 20 6.27L13 2.27C12.696 2.09446 12.3511 2.00205 12 2.00205C11.6489 2.00205 11.304 2.09446 11 2.27L4 6.27C3.69626 6.44536 3.44398 6.69751 3.26846 7.00116C3.09294 7.30481 3.00036 7.64927 3 8V16C3.00036 16.3507 3.09294 16.6952 3.26846 16.9988C3.44398 17.3025 3.69626 17.5546 4 17.73L11 21.73C11.304 21.9055 11.6489 21.9979 12 21.9979C12.3511 21.9979 12.696 21.9055 13 21.73L20 17.73C20.3037 17.5546 20.556 17.3025 20.7315 16.9988C20.9071 16.6952 20.9996 16.3507 21 16Z\"\n\t\t\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\t\t\t\t\tstroke-linejoin=\"round\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</svg>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"feature-text\">\n\t\t\t\t\t\t<h3>Cloud Sync</h3>\n\t\t\t\t\t\t<p>Access anywhere</p>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div class=\"brand-stats\">\n\t\t\t\t<div class=\"stat\">\n\t\t\t\t\t<div class=\"stat-value\">10K+</div>\n\t\t\t\t\t<div class=\"stat-label\">Routes</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"stat\">\n\t\t\t\t\t<div class=\"stat-value\">$2.5M+</div>\n\t\t\t\t\t<div class=\"stat-label\">Tracked</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"stat\">\n\t\t\t\t\t<div class=\"stat-value\">4.9/5</div>\n\t\t\t\t\t<div class=\"stat-label\">Rating</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\n\t<div class=\"auth-form\">\n\t\t<div class=\"form-container\">\n\t\t\t{#if registrationSuccess}\n\t\t\t\t<div style=\"text-align: center;\">\n\t\t\t\t\t<div\n\t\t\t\t\t\tclass=\"alert success\"\n\t\t\t\t\t\tstyle=\"display: block; text-align: center; background: #F0FDF4; border-color: #BBF7D0;\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\twidth=\"48\"\n\t\t\t\t\t\t\theight=\"48\"\n\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\t\t\t\tfill=\"none\"\n\t\t\t\t\t\t\tstroke=\"#166534\"\n\t\t\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\t\t\tstyle=\"margin: 0 auto 16px auto; display: block;\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\td=\"M22 2L11 13M22 2l-7 20-4-9-9-4 20-7z\"\n\t\t\t\t\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\t\t\t\t\tstroke-linejoin=\"round\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t<h3 style=\"font-size: 20px; font-weight: 700; margin-bottom: 8px; color: #166534;\">\n\t\t\t\t\t\t\tCheck your inbox!\n\t\t\t\t\t\t</h3>\n\t\t\t\t\t\t<p style=\"font-size: 15px; color: #166534;\">\n\t\t\t\t\t\t\tWe've sent a verification link to <strong>{submittedEmail}</strong>.\n\t\t\t\t\t\t</p>\n\t\t\t\t\t</div>\n\t\t\t\t\t<button\n\t\t\t\t\t\tclass=\"toggle-link\"\n\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\tregistrationSuccess = false;\n\t\t\t\t\t\t\ttoggleMode();\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\tBack to Sign In\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t{:else}\n\t\t\t\t<div class=\"form-header\">\n\t\t\t\t\t<h2>{isLogin ? 'Sign in to your account' : 'Create your account'}</h2>\n\t\t\t\t\t<p>\n\t\t\t\t\t\t{isLogin ? \"Don't have an account?\" : 'Already have an account?'}\n\t\t\t\t\t\t<button class=\"toggle-link\" on:click={toggleMode}>\n\t\t\t\t\t\t\t{isLogin ? 'Sign up' : 'Sign in'}\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</p>\n\t\t\t\t</div>\n\n\t\t\t\t<form on:submit|preventDefault={submitHandler}>\n\t\t\t\t\t{#if isLogin}\n\t\t\t\t\t\t{#if quickPasskey && (!username || username === quickPasskey.email)}\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\tclass=\"btn-secondary\"\n\t\t\t\t\t\t\t\ton:click={quickSignIn}\n\t\t\t\t\t\t\t\tdisabled={quickLoading}\n\t\t\t\t\t\t\t\tstyle=\"margin-bottom:8px; display:flex; align-items:center; justify-content:center;\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\t\t\twidth=\"16\"\n\t\t\t\t\t\t\t\t\theight=\"16\"\n\t\t\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\t\t\t\t\t\tfill=\"none\"\n\t\t\t\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\t\t\t\t\tstyle=\"margin-right:8px;\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\t\t\td=\"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z\"\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t\t{quickLoading\n\t\t\t\t\t\t\t\t\t? 'Signing in...'\n\t\t\t\t\t\t\t\t\t: `Quick sign-in${quickPasskey?.name ? ' (' + quickPasskey.name + ')' : ''}`}\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t{/if}\n\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\tclass=\"btn-biometric\"\n\t\t\t\t\t\t\ton:click={handleBiometricLogin}\n\t\t\t\t\t\t\tdisabled={loading}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\t\twidth=\"24\"\n\t\t\t\t\t\t\t\theight=\"24\"\n\t\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\t\t\t\t\tfill=\"none\"\n\t\t\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\t\td=\"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\t\td=\"M2 12C2 6.48 6.48 2 12 2s10 4.48 10 10-4.48 10-10 10S2 17.52 2 12zm10 6c3.31 0 6-2.69 6-6s-2.69-6-6-6-6 2.69-6 6 2.69 6 6 6z\"\n\t\t\t\t\t\t\t\t\tstroke-opacity=\"0.3\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\tSign in with Face ID / Touch ID\n\t\t\t\t\t\t</button>\n\n\t\t\t\t\t\t<div class=\"divider\">\n\t\t\t\t\t\t\t<span>OR</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t{/if}\n\n\t\t\t\t\t<div class=\"form-fields\">\n\t\t\t\t\t\t<div class=\"field-group\">\n\t\t\t\t\t\t\t<label for=\"username\">\n\t\t\t\t\t\t\t\t{isLogin ? 'Username or Email' : 'Username'}\n\t\t\t\t\t\t\t\t<span class=\"required\">*</span>\n\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t<div class=\"input-wrapper\">\n\t\t\t\t\t\t\t\t<svg class=\"input-icon\" width=\"20\" height=\"20\" viewBox=\"0 0 20 20\" fill=\"none\">\n\t\t\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\t\t\td=\"M10 10C12.7614 10 15 7.76142 15 5C15 2.23858 12.7614 0 10 0C7.23858 0 5 2.23858 5 5C5 7.76142 7.23858 10 10 10Z\"\n\t\t\t\t\t\t\t\t\t\tfill=\"currentColor\"\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\t\t\td=\"M10 12C4.47715 12 0 15.3579 0 19.5C0 19.7761 0.223858 20 0.5 20H19.5C19.7761 20 20 19.7761 20 19.5C20 15.3579 15.5228 12 10 12Z\"\n\t\t\t\t\t\t\t\t\t\tfill=\"currentColor\"\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\t\tid=\"username\"\n\t\t\t\t\t\t\t\t\tbind:value={username}\n\t\t\t\t\t\t\t\t\trequired\n\t\t\t\t\t\t\t\t\tplaceholder={isLogin ? 'Enter username or email' : 'Choose a username'}\n\t\t\t\t\t\t\t\t\tautocomplete=\"username\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t{#if !isLogin}\n\t\t\t\t\t\t\t<div class=\"field-group\">\n\t\t\t\t\t\t\t\t<label for=\"email\">\n\t\t\t\t\t\t\t\t\tEmail Address\n\t\t\t\t\t\t\t\t\t<span class=\"required\">*</span>\n\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t\t<div class=\"input-wrapper\">\n\t\t\t\t\t\t\t\t\t<svg class=\"input-icon\" width=\"20\" height=\"20\" viewBox=\"0 0 20 20\" fill=\"none\">\n\t\t\t\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\t\t\t\td=\"M2 4C2 3.44772 2.44772 3 3 3H17C17.5523 3 18 3.44772 18 4V16C18 16.5523 17.5523 17 17 17H3C2.44772 17 2 16.5523 2 16V4Z\"\n\t\t\t\t\t\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\t\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\t\t\t\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\t\t\t\t\t\t\t\tstroke-linejoin=\"round\"\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\t\t\t\td=\"M18 4L10 10.5L2 4\"\n\t\t\t\t\t\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\t\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\t\t\t\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\t\t\t\t\t\t\t\tstroke-linejoin=\"round\"\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\t\ttype=\"email\"\n\t\t\t\t\t\t\t\t\t\tid=\"email\"\n\t\t\t\t\t\t\t\t\t\tbind:value={email}\n\t\t\t\t\t\t\t\t\t\trequired\n\t\t\t\t\t\t\t\t\t\tplaceholder=\"Enter your email address\"\n\t\t\t\t\t\t\t\t\t\tautocomplete=\"email\"\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t{/if}\n\n\t\t\t\t\t\t<div class=\"field-group\">\n\t\t\t\t\t\t\t<label for=\"password\">\n\t\t\t\t\t\t\t\tPassword\n\t\t\t\t\t\t\t\t<span class=\"required\">*</span>\n\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t<div class=\"input-wrapper\">\n\t\t\t\t\t\t\t\t<svg class=\"input-icon\" width=\"20\" height=\"20\" viewBox=\"0 0 20 20\" fill=\"none\">\n\t\t\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\t\t\td=\"M15 7H14V5C14 3.67392 13.4732 2.40215 12.5355 1.46447C11.5979 0.526784 10.3261 0 9 0C7.67392 0 6.40215 0.526784 5.46447 1.46447C4.52678 2.40215 4 3.67392 4 5V7H3C2.46957 7 1.96086 7.21071 1.58579 7.58579C1.21071 7.96086 1 8.46957 1 9V17C1 17.5304 1.21071 18.0391 1.58579 18.4142C1.96086 18.7893 2.46957 19 3 19H15C15.5304 19 16.0391 18.7893 16.4142 18.4142C16.7893 18.0391 17 17.5304 17 17V9C17 8.46957 16.7893 7.96086 16.4142 7.58579C16.0391 7.21071 15.5304 7 15 7ZM6 5C6 4.20435 6.31607 3.44129 6.87868 2.87868C7.44129 2.31607 8.20435 2 9 2C9.79565 2 10.5587 2.31607 11.1213 2.87868C11.6839 3.44129 12 4.20435 12 5V7H6V5Z\"\n\t\t\t\t\t\t\t\t\t\tfill=\"currentColor\"\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\ttype=\"password\"\n\t\t\t\t\t\t\t\t\tid=\"password\"\n\t\t\t\t\t\t\t\t\tbind:value={password}\n\t\t\t\t\t\t\t\t\trequired\n\t\t\t\t\t\t\t\t\tplaceholder=\"Enter your password\"\n\t\t\t\t\t\t\t\t\tautocomplete={isLogin ? 'current-password' : 'new-password'}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t{#if !isLogin}\n\t\t\t\t\t\t\t<div class=\"field-group\">\n\t\t\t\t\t\t\t\t<label for=\"confirmPassword\">\n\t\t\t\t\t\t\t\t\tConfirm Password\n\t\t\t\t\t\t\t\t\t<span class=\"required\">*</span>\n\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t\t<div class=\"input-wrapper\">\n\t\t\t\t\t\t\t\t\t<svg class=\"input-icon\" width=\"20\" height=\"20\" viewBox=\"0 0 20 20\" fill=\"none\">\n\t\t\t\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\t\t\t\td=\"M15 7H14V5C14 3.67392 13.4732 2.40215 12.5355 1.46447C11.5979 0.526784 10.3261 0 9 0C7.67392 0 6.40215 0.526784 5.46447 1.46447C4.52678 2.40215 4 3.67392 4 5V7H3C2.46957 7 1.96086 7.21071 1.58579 7.58579C1.21071 7.96086 1 8.46957 1 9V17C1 17.5304 1.21071 18.0391 1.58579 18.4142C1.96086 18.7893 2.46957 19 3 19H15C15.5304 19 16.0391 18.7893 16.4142 18.4142C16.7893 18.0391 17 17.5304 17 17V9C17 8.46957 16.7893 7.96086 16.4142 7.58579C16.0391 7.21071 15.5304 7 15 7ZM6 5C6 4.20435 6.31607 3.44129 6.87868 2.87868C7.44129 2.31607 8.20435 2 9 2C9.79565 2 10.5587 2.31607 11.1213 2.87868C11.6839 3.44129 12 4.20435 12 5V7H6V5Z\"\n\t\t\t\t\t\t\t\t\t\t\tfill=\"currentColor\"\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\t\ttype=\"password\"\n\t\t\t\t\t\t\t\t\t\tid=\"confirmPassword\"\n\t\t\t\t\t\t\t\t\t\tbind:value={confirmPassword}\n\t\t\t\t\t\t\t\t\t\trequired\n\t\t\t\t\t\t\t\t\t\tplaceholder=\"Confirm your password\"\n\t\t\t\t\t\t\t\t\t\tautocomplete=\"new-password\"\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t{/if}\n\n\t\t\t\t\t\t{#if isLogin}\n\t\t\t\t\t\t\t<div class=\"form-options\">\n\t\t\t\t\t\t\t\t<label class=\"checkbox-label\">\n\t\t\t\t\t\t\t\t\t<input type=\"checkbox\" name=\"remember\" />\n\t\t\t\t\t\t\t\t\t<span>Remember me</span>\n\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t\t<a href=\"/forgot-password\" class=\"forgot-link\">Forgot password?</a>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t{/if}\n\t\t\t\t\t</div>\n\n\t\t\t\t\t{#if responseError}\n\t\t\t\t\t\t<div class=\"alert error\">\n\t\t\t\t\t\t\t<svg width=\"20\" height=\"20\" viewBox=\"0 0 20 20\" fill=\"none\">\n\t\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\t\td=\"M10 0C4.48 0 0 4.48 0 10C0 15.52 4.48 20 10 20C15.52 20 20 15.52 20 10C20 4.48 15.52 0 10 0ZM11 15H9V13H11V15ZM11 11H9V5H11V11Z\"\n\t\t\t\t\t\t\t\t\tfill=\"currentColor\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t{responseError}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t{/if}\n\n\t\t\t\t\t<button type=\"submit\" class=\"btn-submit\" disabled={loading}>\n\t\t\t\t\t\t{#if loading}\n\t\t\t\t\t\t\t<svg class=\"spinner\" width=\"20\" height=\"20\" viewBox=\"0 0 20 20\" fill=\"none\">\n\t\t\t\t\t\t\t\t<circle\n\t\t\t\t\t\t\t\t\tcx=\"10\"\n\t\t\t\t\t\t\t\t\tcy=\"10\"\n\t\t\t\t\t\t\t\t\tr=\"8\"\n\t\t\t\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\t\t\t\t\topacity=\"0.25\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\t\td=\"M10 2C10 2 10 2 10 2C14.4183 2 18 5.58172 18 10\"\n\t\t\t\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\t\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\tProcessing...\n\t\t\t\t\t\t{:else}\n\t\t\t\t\t\t\t{isLogin ? 'Sign In' : 'Create Account'}\n\t\t\t\t\t\t{/if}\n\t\t\t\t\t</button>\n\t\t\t\t</form>\n\n\t\t\t\t<div class=\"form-footer\">\n\t\t\t\t\t<p>\n\t\t\t\t\t\tBy continuing, you agree to our <a href=\"/terms\">Terms of Service</a> and\n\t\t\t\t\t\t<a href=\"/privacy\">Privacy Policy</a>\n\t\t\t\t\t</p>\n\t\t\t\t</div>\n\t\t\t{/if}\n\t\t</div>\n\t</div>\n</div>\n\n<style>\n\t/* font import moved to `src/app.css` */\n\t:root {\n\t\t--orange: #ff7f50;\n\t\t--blue: #29abe2;\n\t\t--navy: #2c4a6e;\n\t\t--green: #8dc63f;\n\t\t--purple: #8b5a9e;\n\t\t--gray-50: #f9fafb;\n\t\t--gray-100: #f3f4f6;\n\t\t--gray-600: #4b5563;\n\t\t--gray-900: #111827;\n\t}\n\n\t* {\n\t\tmargin: 0;\n\t\tpadding: 0;\n\t\tbox-sizing: border-box;\n\t}\n\n\t.auth-page {\n\t\tfont-family:\n\t\t\t'Inter',\n\t\t\t-apple-system,\n\t\t\tBlinkMacSystemFont,\n\t\t\t'Segoe UI',\n\t\t\tsans-serif;\n\t\tdisplay: grid;\n\t\tgrid-template-columns: 45% 55%;\n\t\t/* UPDATED: Dynamic viewport height */\n\t\tmin-height: 100dvh;\n\t}\n\n\t/* Left Side - Branding */\n\t.auth-brand {\n\t\tbackground: var(--gray-50);\n\t\tposition: relative;\n\t\toverflow: hidden;\n\t\tpadding: 48px;\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tborder-right: 1px solid var(--gray-100);\n\t}\n\n\t.auth-brand::after {\n\t\tdisplay: none;\n\t}\n\n\t.brand-content {\n\t\tposition: relative;\n\t\tz-index: 1;\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\theight: 100%;\n\t}\n\n\t.brand-logo {\n\t\tdisplay: block;\n\t\tmargin-bottom: 64px;\n\t}\n\n\t.brand-logo img {\n\t\twidth: 180px;\n\t\theight: 75px;\n\t\tobject-fit: contain;\n\t}\n\n\t.brand-text {\n\t\tmargin-bottom: 64px;\n\t}\n\n\t.brand-text h1 {\n\t\tfont-size: 36px;\n\t\tfont-weight: 800;\n\t\tcolor: var(--navy);\n\t\tmargin-bottom: 16px;\n\t\tline-height: 1.2;\n\t}\n\n\t.brand-text p {\n\t\tfont-size: 18px;\n\t\tcolor: var(--gray-600);\n\t\tline-height: 1.6;\n\t}\n\n\t.brand-features {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tgap: 24px;\n\t\tmargin-bottom: auto;\n\t}\n\n\t.feature-item {\n\t\tdisplay: flex;\n\t\tgap: 16px;\n\t\talign-items: start;\n\t}\n\n\t.feature-icon {\n\t\twidth: 48px;\n\t\theight: 48px;\n\t\tbackground: white;\n\t\tborder: 1px solid var(--gray-100);\n\t\tborder-radius: 12px;\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t\tcolor: var(--orange);\n\t\tflex-shrink: 0;\n\t\tbox-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);\n\t}\n\n\t.feature-text h3 {\n\t\tfont-size: 16px;\n\t\tfont-weight: 600;\n\t\tcolor: var(--navy);\n\t\tmargin-bottom: 4px;\n\t}\n\n\t.feature-text p {\n\t\tfont-size: 14px;\n\t\tcolor: var(--gray-600);\n\t}\n\n\t.brand-stats {\n\t\tdisplay: flex;\n\t\tgap: 48px;\n\t\tpadding-top: 48px;\n\t\tborder-top: 1px solid var(--gray-200);\n\t}\n\n\t.stat {\n\t\ttext-align: center;\n\t}\n\n\t.stat-value {\n\t\tfont-size: 24px;\n\t\tfont-weight: 800;\n\t\tcolor: var(--navy);\n\t\tmargin-bottom: 4px;\n\t}\n\n\t.stat-label {\n\t\tfont-size: 13px;\n\t\tcolor: var(--gray-600);\n\t}\n\n\t/* Right Side - Form */\n\t.auth-form {\n\t\tbackground: white;\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t\tpadding: 48px;\n\t}\n\n\t.form-container {\n\t\twidth: 100%;\n\t\tmax-width: 440px;\n\t}\n\n\t.form-header {\n\t\tmargin-bottom: 32px;\n\t}\n\n\t.form-header h2 {\n\t\tfont-size: 28px;\n\t\tfont-weight: 700;\n\t\tcolor: #111827;\n\t\tmargin-bottom: 8px;\n\t}\n\n\t.form-header p {\n\t\tfont-size: 15px;\n\t\tcolor: #6b7280;\n\t}\n\n\t.toggle-link {\n\t\tbackground: none;\n\t\tborder: none;\n\t\tcolor: var(--orange);\n\t\tfont-weight: 600;\n\t\tcursor: pointer;\n\t\ttext-decoration: underline;\n\t}\n\n\t.form-fields {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tgap: 20px;\n\t\tmargin-bottom: 24px;\n\t}\n\n\t.field-group {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tgap: 8px;\n\t}\n\n\tlabel {\n\t\tfont-size: 14px;\n\t\tfont-weight: 600;\n\t\tcolor: #374151;\n\t}\n\n\t.required {\n\t\tcolor: var(--orange);\n\t}\n\n\t.input-wrapper {\n\t\tposition: relative;\n\t}\n\n\t.input-icon {\n\t\tposition: absolute;\n\t\tleft: 16px;\n\t\ttop: 50%;\n\t\ttransform: translateY(-50%);\n\t\tcolor: #9ca3af;\n\t\tpointer-events: none;\n\t}\n\n\tinput[type='text'],\n\tinput[type='email'],\n\tinput[type='password'] {\n\t\twidth: 100%;\n\t\tpadding: 14px 16px 14px 48px;\n\t\tborder: 2px solid #e5e7eb;\n\t\tborder-radius: 12px;\n\t\t/* UPDATED: Increased font size to prevent iOS zoom */\n\t\tfont-size: 16px;\n\t\tfont-family: inherit;\n\t\tbackground: white;\n\t\ttransition: all 0.2s;\n\t}\n\n\tinput:focus {\n\t\toutline: none;\n\t\tborder-color: var(--orange);\n\t\tbox-shadow: 0 0 0 3px rgba(255, 127, 80, 0.1);\n\t}\n\n\t.form-options {\n\t\tdisplay: flex;\n\t\tjustify-content: space-between;\n\t\talign-items: center;\n\t}\n\n\t.checkbox-label {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tgap: 8px;\n\t\tfont-size: 14px;\n\t\tcolor: #374151;\n\t\tcursor: pointer;\n\t}\n\n\t.checkbox-label input[type='checkbox'] {\n\t\twidth: 18px;\n\t\theight: 18px;\n\t\tcursor: pointer;\n\t}\n\n\t.forgot-link {\n\t\tfont-size: 14px;\n\t\tcolor: var(--orange);\n\t\ttext-decoration: none;\n\t\tfont-weight: 600;\n\t}\n\n\t/* UPDATED: Wrap hover in media query */\n\t@media (hover: hover) {\n\t\t.forgot-link:hover {\n\t\t\ttext-decoration: underline;\n\t\t}\n\t}\n\n\t.alert {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tgap: 12px;\n\t\tpadding: 14px 16px;\n\t\tborder-radius: 12px;\n\t\tfont-size: 14px;\n\t\tmargin-bottom: 20px;\n\t}\n\n\t.alert.error {\n\t\tbackground: #fef2f2;\n\t\tcolor: #991b1b;\n\t}\n\n\t.alert.success {\n\t\tbackground: #f0fdf4;\n\t\tcolor: #166534;\n\t}\n\n\t.btn-submit {\n\t\twidth: 100%;\n\t\tpadding: 16px;\n\t\tbackground: var(--orange);\n\t\tcolor: white;\n\t\tborder: none;\n\t\tborder-radius: 12px;\n\t\tfont-size: 16px;\n\t\tfont-weight: 600;\n\t\tfont-family: inherit;\n\t\tcursor: pointer;\n\t\ttransition: all 0.2s;\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t\tgap: 8px;\n\t}\n\n\t/* UPDATED: Wrap hover in media query */\n\t@media (hover: hover) {\n\t\t.btn-submit:hover:not(:disabled) {\n\t\t\tbackground: #ff6a3d;\n\t\t\ttransform: translateY(-1px);\n\t\t\tbox-shadow: 0 8px 16px rgba(255, 127, 80, 0.3);\n\t\t}\n\t}\n\n\t.btn-submit:disabled {\n\t\topacity: 0.6;\n\t\tcursor: not-allowed;\n\t}\n\n\t.spinner {\n\t\tanimation: spin 1s linear infinite;\n\t}\n\n\t@keyframes spin {\n\t\tfrom {\n\t\t\ttransform: rotate(0deg);\n\t\t}\n\t\tto {\n\t\t\ttransform: rotate(360deg);\n\t\t}\n\t}\n\n\t.form-footer {\n\t\tmargin-top: 24px;\n\t\ttext-align: center;\n\t}\n\n\t.form-footer p {\n\t\tfont-size: 13px;\n\t\tcolor: #6b7280;\n\t}\n\n\t.form-footer a {\n\t\tcolor: var(--orange);\n\t\ttext-decoration: none;\n\t\tfont-weight: 500;\n\t}\n\n\t/* UPDATED: Wrap hover in media query */\n\t@media (hover: hover) {\n\t\t.form-footer a:hover {\n\t\t\ttext-decoration: underline;\n\t\t}\n\t}\n\n\t/* [!code ++] New Styles for Biometrics */\n\t.btn-biometric {\n\t\twidth: 100%;\n\t\tpadding: 14px;\n\t\tbackground: white;\n\t\tcolor: var(--gray-900);\n\t\tborder: 2px solid #e5e7eb;\n\t\tborder-radius: 12px;\n\t\tfont-size: 16px;\n\t\tfont-weight: 600;\n\t\tcursor: pointer;\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t\tgap: 12px;\n\t\tmargin-bottom: 24px;\n\t\ttransition: all 0.2s;\n\t\tfont-family: inherit;\n\t}\n\n\t@media (hover: hover) {\n\t\t.btn-biometric:hover:not(:disabled) {\n\t\t\tbackground: var(--gray-50);\n\t\t\tborder-color: #d1d5db;\n\t\t}\n\t}\n\n\t.divider {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\ttext-align: center;\n\t\tmargin-bottom: 24px;\n\t\tcolor: #6b7280;\n\t\tfont-size: 13px;\n\t\tfont-weight: 500;\n\t}\n\n\t.divider::before,\n\t.divider::after {\n\t\tcontent: '';\n\t\tflex: 1;\n\t\tborder-bottom: 1px solid #e5e7eb;\n\t}\n\n\t.divider span {\n\t\tpadding: 0 12px;\n\t\tcolor: #9ca3af;\n\t\tfont-weight: 600;\n\t\tfont-size: 12px;\n\t}\n\n\t/* Responsive */\n\t@media (max-width: 1024px) {\n\t\t.auth-page {\n\t\t\tgrid-template-columns: 1fr;\n\t\t}\n\n\t\t.auth-brand {\n\t\t\tdisplay: none;\n\t\t}\n\t}\n\n\t@media (max-width: 640px) {\n\t\t.auth-form {\n\t\t\tpadding: 24px;\n\t\t}\n\n\t\t.form-header h2 {\n\t\t\tfont-size: 24px;\n\t\t}\n\t}\n</style>\n",
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\login\\+server.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\logout\\+server.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\privacy\\+page.svelte",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\register\\+page.server.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\register\\+server.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\reset-password\\+page.svelte",
		"messages": [
			{
				"ruleId": "svelte/no-navigation-without-resolve",
				"severity": 1,
				"message": "Unexpected goto() call without resolve().",
				"line": 41,
				"column": 27,
				"nodeType": null,
				"messageId": "gotoWithoutResolve",
				"endLine": 41,
				"endColumn": 44
			},
			{
				"ruleId": "svelte/no-navigation-without-resolve",
				"severity": 1,
				"message": "Unexpected href link without resolve().",
				"line": 61,
				"column": 12,
				"nodeType": null,
				"messageId": "linkWithoutResolve",
				"endLine": 61,
				"endColumn": 41
			}
		],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 2,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"source": "<script lang=\"ts\">\n\timport { page } from '$app/stores';\n\timport { goto } from '$app/navigation';\n\timport { base } from '$app/paths';\n\tconst resolve = (href: string) => `${base}${href}`;\n\n\tlet password = '';\n\tlet confirmPassword = '';\n\tlet loading = false;\n\tlet error = '';\n\tlet success = false;\n\n\t// Get token from URL\n\t$: token = $page.url.searchParams.get('token');\n\n\tasync function handleReset() {\n\t\tif (password !== confirmPassword) {\n\t\t\terror = 'Passwords do not match';\n\t\t\treturn;\n\t\t}\n\n\t\tloading = true;\n\t\terror = '';\n\n\t\ttry {\n\t\t\tconst res = await fetch('/reset-password', {\n\t\t\t\tmethod: 'POST',\n\t\t\t\theaders: { 'Content-Type': 'application/json' },\n\t\t\t\tbody: JSON.stringify({ token, password })\n\t\t\t});\n\n\t\t\tlet data: { message?: string } | undefined;\n\t\t\ttry {\n\t\t\t\tdata = (await res.json()) as { message?: string };\n\t\t\t} catch {\n\t\t\t\t// ignore parse errors\n\t\t\t}\n\n\t\t\tif (res.ok) {\n\t\t\t\tsuccess = true;\n\t\t\t\tsetTimeout(() => goto(resolve('/login')), 3000);\n\t\t\t} else {\n\t\t\t\terror = (data && data.message) || 'Failed to reset password.';\n\t\t\t}\n\t\t} catch {\n\t\t\terror = 'Network error occurred.';\n\t\t} finally {\n\t\t\tloading = false;\n\t\t}\n\t}\n</script>\n\n<svelte:head>\n\t<title>Set New Password - Go Route Yourself</title>\n</svelte:head>\n\n<div class=\"auth-page\">\n\t<div class=\"form-container\">\n\t\t{#if !token}\n\t\t\t<div class=\"alert error\">Invalid link. Please request a new password reset.</div>\n\t\t\t<a href={resolve('/forgot-password')} class=\"back-link\">Go to Forgot Password</a>\n\t\t{:else if success}\n\t\t\t<div class=\"alert success\">\n\t\t\t\t<h3>Success!</h3>\n\t\t\t\t<p>Your password has been reset. Redirecting to login...</p>\n\t\t\t</div>\n\t\t{:else}\n\t\t\t<div class=\"form-header\">\n\t\t\t\t<h1>New Password</h1>\n\t\t\t\t<p>Enter your new secure password.</p>\n\t\t\t</div>\n\n\t\t\t{#if error}\n\t\t\t\t<div class=\"alert error\">{error}</div>\n\t\t\t{/if}\n\n\t\t\t<form on:submit|preventDefault={handleReset}>\n\t\t\t\t<div class=\"field-group\">\n\t\t\t\t\t<label for=\"pass\">New Password</label>\n\t\t\t\t\t<input\n\t\t\t\t\t\ttype=\"password\"\n\t\t\t\t\t\tid=\"pass\"\n\t\t\t\t\t\tbind:value={password}\n\t\t\t\t\t\trequired\n\t\t\t\t\t\tclass=\"input-field\"\n\t\t\t\t\t\tminlength=\"6\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\n\t\t\t\t<div class=\"field-group\">\n\t\t\t\t\t<label for=\"conf\">Confirm Password</label>\n\t\t\t\t\t<input\n\t\t\t\t\t\ttype=\"password\"\n\t\t\t\t\t\tid=\"conf\"\n\t\t\t\t\t\tbind:value={confirmPassword}\n\t\t\t\t\t\trequired\n\t\t\t\t\t\tclass=\"input-field\"\n\t\t\t\t\t\tminlength=\"6\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\n\t\t\t\t<button type=\"submit\" class=\"btn-submit\" disabled={loading}>\n\t\t\t\t\t{loading ? 'Updating...' : 'Set Password'}\n\t\t\t\t</button>\n\t\t\t</form>\n\t\t{/if}\n\t</div>\n</div>\n\n<style>\n\t/* Same styles as above */\n\t.auth-page {\n\t\tmin-height: 100vh;\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t\tbackground: #f9fafb;\n\t\tfont-family: 'Inter', sans-serif;\n\t}\n\t.form-container {\n\t\tbackground: white;\n\t\tpadding: 40px;\n\t\tborder-radius: 12px;\n\t\tbox-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);\n\t\twidth: 100%;\n\t\tmax-width: 400px;\n\t}\n\t.form-header {\n\t\tmargin-bottom: 24px;\n\t\ttext-align: center;\n\t}\n\th1 {\n\t\tfont-size: 24px;\n\t\tfont-weight: 700;\n\t\tcolor: #111827;\n\t\tmargin: 10px 0;\n\t}\n\tp {\n\t\tcolor: #6b7280;\n\t\tfont-size: 14px;\n\t}\n\t.input-field {\n\t\twidth: 100%;\n\t\tpadding: 12px;\n\t\tborder: 2px solid #e5e7eb;\n\t\tborder-radius: 8px;\n\t\tfont-size: 15px;\n\t\tmargin-top: 6px;\n\t}\n\t.field-group {\n\t\tmargin-bottom: 20px;\n\t}\n\t.btn-submit {\n\t\twidth: 100%;\n\t\tpadding: 12px;\n\t\tbackground: #ff7f50;\n\t\tcolor: white;\n\t\tborder: none;\n\t\tborder-radius: 8px;\n\t\tfont-weight: 600;\n\t\tcursor: pointer;\n\t}\n\t.alert {\n\t\tpadding: 12px;\n\t\tborder-radius: 8px;\n\t\tmargin-bottom: 20px;\n\t\tfont-size: 14px;\n\t}\n\t.alert.success {\n\t\tbackground: #f0fdf4;\n\t\tcolor: #166534;\n\t\ttext-align: center;\n\t}\n\t.alert.error {\n\t\tbackground: #fef2f2;\n\t\tcolor: #991b1b;\n\t}\n\t.back-link {\n\t\tdisplay: block;\n\t\ttext-align: center;\n\t\tcolor: #ff7f50;\n\t\tmargin-top: 20px;\n\t\ttext-decoration: none;\n\t}\n</style>\n",
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\reset-password\\+server.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\support\\+page.svelte",
		"messages": [
			{
				"ruleId": "svelte/no-navigation-without-resolve",
				"severity": 1,
				"message": "Unexpected href link without resolve().",
				"line": 39,
				"column": 14,
				"nodeType": null,
				"messageId": "linkWithoutResolve",
				"endLine": 39,
				"endColumn": 30
			}
		],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 1,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"source": "<script lang=\"ts\">\n\timport Header from '$lib/components/layout/Header.svelte';\n</script>\n\n<svelte:head>\n\t<title>Support - Go Route Yourself</title>\n</svelte:head>\n\n<Header />\n\n<div class=\"support-page\">\n\t<div class=\"container\">\n\t\t<div class=\"page-header\">\n\t\t\t<h1 class=\"title\">Support Center</h1>\n\t\t\t<p class=\"subtitle\">Need help? We've got you covered.</p>\n\t\t</div>\n\n\t\t<div class=\"content\">\n\t\t\t<section>\n\t\t\t\t<h2>Contact Us</h2>\n\t\t\t\t<p>\n\t\t\t\t\tWhether you have a question about features, pricing, need a demo, or anything else, our\n\t\t\t\t\tteam is ready to answer all your questions.\n\t\t\t\t</p>\n\t\t\t\t<div class=\"contact-box\">\n\t\t\t\t\t<strong>Email Support</strong><br />\n\t\t\t\t\tFor general inquiries and technical support:<br />\n\t\t\t\t\t<a href=\"mailto:support@gorouteyourself.com\">support@gorouteyourself.com</a>\n\t\t\t\t</div>\n\t\t\t</section>\n\n\t\t\t<section>\n\t\t\t\t<h2>Frequently Asked Questions</h2>\n\n\t\t\t\t<div class=\"faq-item\">\n\t\t\t\t\t<h3>How do I reset my password?</h3>\n\t\t\t\t\t<p>\n\t\t\t\t\t\tIf you've forgotten your password, you can request a reset link by visiting the <a\n\t\t\t\t\t\t\thref=\"/forgot-password\">Forgot Password</a\n\t\t\t\t\t\t> page.\n\t\t\t\t\t</p>\n\t\t\t\t</div>\n\n\t\t\t\t<div class=\"faq-item\">\n\t\t\t\t\t<h3>How does data syncing work?</h3>\n\t\t\t\t\t<p>\n\t\t\t\t\t\tYour trips and routes automatically sync across all your devices when you are logged in.\n\t\t\t\t\t\tIf you notice data missing, check the \"Sync Status\" indicator in the navigation bar to\n\t\t\t\t\t\tensure you are connected.\n\t\t\t\t\t</p>\n\t\t\t\t</div>\n\n\t\t\t\t<div class=\"faq-item\">\n\t\t\t\t\t<h3>Can I export my route data?</h3>\n\t\t\t\t\t<p>\n\t\t\t\t\t\tYes. You can export your tracks and logs in standard formats like GPX or JSON from your\n\t\t\t\t\t\tDashboard. Visit the \"Data\" tab in your dashboard to manage your exports.\n\t\t\t\t\t</p>\n\t\t\t\t</div>\n\n\t\t\t\t<div class=\"faq-item\">\n\t\t\t\t\t<h3>How do I report a bug?</h3>\n\t\t\t\t\t<p>\n\t\t\t\t\t\tPlease email us at <a href=\"mailto:support@gorouteyourself.com\"\n\t\t\t\t\t\t\t>support@gorouteyourself.com</a\n\t\t\t\t\t\t> with a description of the issue. Including screenshots and details about your device helps\n\t\t\t\t\t\tus resolve issues faster.\n\t\t\t\t\t</p>\n\t\t\t\t</div>\n\t\t\t</section>\n\t\t</div>\n\t</div>\n</div>\n\n<style>\n\t/* Styles consistent with Privacy/Terms pages */\n\t:global(:root) {\n\t\t--navy: #2c4a6e;\n\t\t--orange: #ff7f50;\n\t\t--gray-600: #4b5563;\n\t\t--gray-900: #111827;\n\t\t--bg-light: #f9fafb;\n\t}\n\n\t.support-page {\n\t\tbackground-color: var(--bg-light);\n\t\tmin-height: 100vh;\n\t\tpadding-bottom: 80px;\n\t\tfont-family:\n\t\t\t-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;\n\t\tcolor: var(--gray-900);\n\t\tline-height: 1.6;\n\t}\n\n\t@media (max-width: 640px) {\n\t\t.support-page {\n\t\t\tpadding-bottom: calc(env(safe-area-inset-bottom, 0px) + 1px);\n\t\t}\n\t}\n\n\t.container {\n\t\tmax-width: 800px;\n\t\tmargin: 0 auto;\n\t\tpadding: 40px 20px;\n\t}\n\n\t.page-header {\n\t\ttext-align: center;\n\t\tmargin-bottom: 60px;\n\t\tpadding-bottom: 40px;\n\t\tborder-bottom: 1px solid #e5e7eb;\n\t}\n\n\t.title {\n\t\tfont-size: 42px;\n\t\tfont-weight: 800;\n\t\tcolor: var(--navy);\n\t\tmargin-bottom: 16px;\n\t}\n\n\t.subtitle {\n\t\tfont-size: 18px;\n\t\tcolor: var(--gray-600);\n\t}\n\n\t.content {\n\t\tbackground: white;\n\t\tpadding: 48px;\n\t\tborder-radius: 16px;\n\t\tbox-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05);\n\t\tborder: 1px solid #e5e7eb;\n\t}\n\n\tsection {\n\t\tmargin-bottom: 40px;\n\t}\n\n\th2 {\n\t\tfont-size: 24px;\n\t\tfont-weight: 700;\n\t\tcolor: var(--navy);\n\t\tmargin-bottom: 20px;\n\t\tpadding-bottom: 10px;\n\t\tborder-bottom: 2px solid #f3f4f6;\n\t}\n\n\th3 {\n\t\tfont-size: 18px;\n\t\tfont-weight: 600;\n\t\tcolor: var(--navy);\n\t\tmargin: 24px 0 8px;\n\t}\n\n\tp {\n\t\tmargin-bottom: 16px;\n\t\tcolor: var(--gray-600);\n\t\tfont-size: 16px;\n\t}\n\n\t.contact-box {\n\t\tbackground: #f3f4f6;\n\t\tpadding: 24px;\n\t\tborder-radius: 8px;\n\t\tmargin-top: 20px;\n\t\tcolor: var(--navy);\n\t\tborder-left: 4px solid var(--orange);\n\t}\n\n\t.faq-item {\n\t\tmargin-bottom: 24px;\n\t}\n\n\ta {\n\t\tcolor: var(--orange);\n\t\ttext-decoration: none;\n\t\tfont-weight: 500;\n\t}\n\n\ta:hover {\n\t\ttext-decoration: underline;\n\t}\n\n\t@media (max-width: 768px) {\n\t\t.content {\n\t\t\tpadding: 24px;\n\t\t}\n\t\t.title {\n\t\t\tfont-size: 32px;\n\t\t}\n\t}\n</style>\n",
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\terms\\+page.svelte",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\tools\\assign-stops\\+page.server.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\tools\\assign-stops\\+page.svelte",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\tools\\assign-stops\\+server.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\routes\\tools\\assign-stops\\assign-stops.spec.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\service-worker.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\types\\simplewebauthn.d.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\vitest.setup.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	},
	{
		"filePath": "C:\\Users\\James\\Desktop\\Beta Go Route Yourself\\SvelteKit Rebuild\\Go Route Yourslef Svelte 5\\src\\worker-entry.ts",
		"messages": [],
		"suppressedMessages": [],
		"errorCount": 0,
		"fatalErrorCount": 0,
		"warningCount": 0,
		"fixableErrorCount": 0,
		"fixableWarningCount": 0,
		"usedDeprecatedRules": []
	}
]
