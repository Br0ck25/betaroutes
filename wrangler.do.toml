name = "trip-index-worker"
main = "src/do-worker.ts"
compatibility_date = "2024-12-05"
compatibility_flags = ["nodejs_compat"]

# 1. Trip Index DO Binding
[[durable_objects.bindings]]
name = "TRIP_INDEX_DO"
class_name = "TripIndexSQL"

# 2. Places Index DO Binding
[[durable_objects.bindings]]
name = "PLACES_INDEX_DO"
class_name = "PlacesIndexSQL"

# --- MIGRATIONS ---

[[migrations]]
tag = "v1"
new_classes = ["TripIndexDO"]

[[migrations]]
tag = "v2"
new_classes = ["PlacesIndexDO"]

# Force provisioning of SQLite storage for the new class names
[[migrations]]
tag = "v3"
new_sqlite_classes = ["TripIndexSQL", "PlacesIndexSQL"]